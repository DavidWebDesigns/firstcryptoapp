var g4=Object.defineProperty,v4=Object.defineProperties;var y4=Object.getOwnPropertyDescriptors;var cf=Object.getOwnPropertySymbols;var Zb=Object.prototype.hasOwnProperty,$b=Object.prototype.propertyIsEnumerable;var Kb=(e,t,r)=>t in e?g4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,me=(e,t)=>{for(var r in t||(t={}))Zb.call(t,r)&&Kb(e,r,t[r]);if(cf)for(var r of cf(t))$b.call(t,r)&&Kb(e,r,t[r]);return e},qe=(e,t)=>v4(e,y4(t));var e2=(e,t)=>{var r={};for(var i in e)Zb.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&cf)for(var i of cf(e))t.indexOf(i)<0&&$b.call(e,i)&&(r[i]=e[i]);return r};var x4=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var Xte=x4((pn,mn)=>{const w4=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}};w4();var a3=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Yr={exports:{}},Rt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gd=Symbol.for("react.element"),b4=Symbol.for("react.portal"),_4=Symbol.for("react.fragment"),S4=Symbol.for("react.strict_mode"),M4=Symbol.for("react.profiler"),A4=Symbol.for("react.provider"),E4=Symbol.for("react.context"),C4=Symbol.for("react.forward_ref"),T4=Symbol.for("react.suspense"),D4=Symbol.for("react.memo"),P4=Symbol.for("react.lazy"),t2=Symbol.iterator;function L4(e){return e===null||typeof e!="object"?null:(e=t2&&e[t2]||e["@@iterator"],typeof e=="function"?e:null)}var o3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},l3=Object.assign,h3={};function Pu(e,t,r){this.props=e,this.context=t,this.refs=h3,this.updater=r||o3}Pu.prototype.isReactComponent={};Pu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Pu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function u3(){}u3.prototype=Pu.prototype;function Ix(e,t,r){this.props=e,this.context=t,this.refs=h3,this.updater=r||o3}var Nx=Ix.prototype=new u3;Nx.constructor=Ix;l3(Nx,Pu.prototype);Nx.isPureReactComponent=!0;var r2=Array.isArray,c3=Object.prototype.hasOwnProperty,Bx={current:null},d3={key:!0,ref:!0,__self:!0,__source:!0};function f3(e,t,r){var i,n={},s=null,a=null;if(t!=null)for(i in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)c3.call(t,i)&&!d3.hasOwnProperty(i)&&(n[i]=t[i]);var o=arguments.length-2;if(o===1)n.children=r;else if(1<o){for(var l=Array(o),h=0;h<o;h++)l[h]=arguments[h+2];n.children=l}if(e&&e.defaultProps)for(i in o=e.defaultProps,o)n[i]===void 0&&(n[i]=o[i]);return{$$typeof:Gd,type:e,key:s,ref:a,props:n,_owner:Bx.current}}function R4(e,t){return{$$typeof:Gd,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function kx(e){return typeof e=="object"&&e!==null&&e.$$typeof===Gd}function O4(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var i2=/\/+/g;function sg(e,t){return typeof e=="object"&&e!==null&&e.key!=null?O4(""+e.key):t.toString(36)}function Tp(e,t,r,i,n){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case Gd:case b4:a=!0}}if(a)return a=e,n=n(a),e=i===""?"."+sg(a,0):i,r2(n)?(r="",e!=null&&(r=e.replace(i2,"$&/")+"/"),Tp(n,t,r,"",function(h){return h})):n!=null&&(kx(n)&&(n=R4(n,r+(!n.key||a&&a.key===n.key?"":(""+n.key).replace(i2,"$&/")+"/")+e)),t.push(n)),1;if(a=0,i=i===""?".":i+":",r2(e))for(var o=0;o<e.length;o++){s=e[o];var l=i+sg(s,o);a+=Tp(s,t,r,l,n)}else if(l=L4(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=i+sg(s,o++),a+=Tp(s,t,r,l,n);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function df(e,t,r){if(e==null)return e;var i=[],n=0;return Tp(e,i,"","",function(s){return t.call(r,s,n++)}),i}function I4(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ki={current:null},Dp={transition:null},N4={ReactCurrentDispatcher:ki,ReactCurrentBatchConfig:Dp,ReactCurrentOwner:Bx};Rt.Children={map:df,forEach:function(e,t,r){df(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return df(e,function(){t++}),t},toArray:function(e){return df(e,function(t){return t})||[]},only:function(e){if(!kx(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Rt.Component=Pu;Rt.Fragment=_4;Rt.Profiler=M4;Rt.PureComponent=Ix;Rt.StrictMode=S4;Rt.Suspense=T4;Rt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N4;Rt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=l3({},e.props),n=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=Bx.current),t.key!==void 0&&(n=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)c3.call(t,l)&&!d3.hasOwnProperty(l)&&(i[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)i.children=r;else if(1<l){o=Array(l);for(var h=0;h<l;h++)o[h]=arguments[h+2];i.children=o}return{$$typeof:Gd,type:e.type,key:n,ref:s,props:i,_owner:a}};Rt.createContext=function(e){return e={$$typeof:E4,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:A4,_context:e},e.Consumer=e};Rt.createElement=f3;Rt.createFactory=function(e){var t=f3.bind(null,e);return t.type=e,t};Rt.createRef=function(){return{current:null}};Rt.forwardRef=function(e){return{$$typeof:C4,render:e}};Rt.isValidElement=kx;Rt.lazy=function(e){return{$$typeof:P4,_payload:{_status:-1,_result:e},_init:I4}};Rt.memo=function(e,t){return{$$typeof:D4,type:e,compare:t===void 0?null:t}};Rt.startTransition=function(e){var t=Dp.transition;Dp.transition={};try{e()}finally{Dp.transition=t}};Rt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Rt.useCallback=function(e,t){return ki.current.useCallback(e,t)};Rt.useContext=function(e){return ki.current.useContext(e)};Rt.useDebugValue=function(){};Rt.useDeferredValue=function(e){return ki.current.useDeferredValue(e)};Rt.useEffect=function(e,t){return ki.current.useEffect(e,t)};Rt.useId=function(){return ki.current.useId()};Rt.useImperativeHandle=function(e,t,r){return ki.current.useImperativeHandle(e,t,r)};Rt.useInsertionEffect=function(e,t){return ki.current.useInsertionEffect(e,t)};Rt.useLayoutEffect=function(e,t){return ki.current.useLayoutEffect(e,t)};Rt.useMemo=function(e,t){return ki.current.useMemo(e,t)};Rt.useReducer=function(e,t,r){return ki.current.useReducer(e,t,r)};Rt.useRef=function(e){return ki.current.useRef(e)};Rt.useState=function(e){return ki.current.useState(e)};Rt.useSyncExternalStore=function(e,t,r){return ki.current.useSyncExternalStore(e,t,r)};Rt.useTransition=function(){return ki.current.useTransition()};Rt.version="18.1.0";Yr.exports=Rt;var Zs=Yr.exports,m1={},p3={exports:{}},xn={},m3={exports:{}},g3={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(C,I){var k=C.length;C.push(I);e:for(;0<k;){var L=k-1>>>1,w=C[L];if(0<n(w,I))C[L]=I,C[k]=w,k=L;else break e}}function r(C){return C.length===0?null:C[0]}function i(C){if(C.length===0)return null;var I=C[0],k=C.pop();if(k!==I){C[0]=k;e:for(var L=0,w=C.length,N=w>>>1;L<N;){var X=2*(L+1)-1,T=C[X],U=X+1,q=C[U];if(0>n(T,k))U<w&&0>n(q,T)?(C[L]=q,C[U]=k,L=U):(C[L]=T,C[X]=k,L=X);else if(U<w&&0>n(q,k))C[L]=q,C[U]=k,L=U;else break e}}return I}function n(C,I){var k=C.sortIndex-I.sortIndex;return k!==0?k:C.id-I.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],h=[],u=1,c=null,d=3,f=!1,p=!1,m=!1,g=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(C){for(var I=r(h);I!==null;){if(I.callback===null)i(h);else if(I.startTime<=C)i(h),I.sortIndex=I.expirationTime,t(l,I);else break;I=r(h)}}function _(C){if(m=!1,b(C),!p)if(r(l)!==null)p=!0,D(E);else{var I=r(h);I!==null&&O(_,I.startTime-C)}}function E(C,I){p=!1,m&&(m=!1,v(M),M=-1),f=!0;var k=d;try{for(b(I),c=r(l);c!==null&&(!(c.expirationTime>I)||C&&!H());){var L=c.callback;if(typeof L=="function"){c.callback=null,d=c.priorityLevel;var w=L(c.expirationTime<=I);I=e.unstable_now(),typeof w=="function"?c.callback=w:c===r(l)&&i(l),b(I)}else i(l);c=r(l)}if(c!==null)var N=!0;else{var X=r(h);X!==null&&O(_,X.startTime-I),N=!1}return N}finally{c=null,d=k,f=!1}}var S=!1,P=null,M=-1,B=5,R=-1;function H(){return!(e.unstable_now()-R<B)}function Q(){if(P!==null){var C=e.unstable_now();R=C;var I=!0;try{I=P(!0,C)}finally{I?z():(S=!1,P=null)}}else S=!1}var z;if(typeof x=="function")z=function(){x(Q)};else if(typeof MessageChannel!="undefined"){var y=new MessageChannel,A=y.port2;y.port1.onmessage=Q,z=function(){A.postMessage(null)}}else z=function(){g(Q,0)};function D(C){P=C,S||(S=!0,z())}function O(C,I){M=g(function(){C(e.unstable_now())},I)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(C){C.callback=null},e.unstable_continueExecution=function(){p||f||(p=!0,D(E))},e.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<C?Math.floor(1e3/C):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(C){switch(d){case 1:case 2:case 3:var I=3;break;default:I=d}var k=d;d=I;try{return C()}finally{d=k}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(C,I){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var k=d;d=C;try{return I()}finally{d=k}},e.unstable_scheduleCallback=function(C,I,k){var L=e.unstable_now();switch(typeof k=="object"&&k!==null?(k=k.delay,k=typeof k=="number"&&0<k?L+k:L):k=L,C){case 1:var w=-1;break;case 2:w=250;break;case 5:w=1073741823;break;case 4:w=1e4;break;default:w=5e3}return w=k+w,C={id:u++,callback:I,priorityLevel:C,startTime:k,expirationTime:w,sortIndex:-1},k>L?(C.sortIndex=k,t(h,C),r(l)===null&&C===r(h)&&(m?(v(M),M=-1):m=!0,O(_,k-L))):(C.sortIndex=w,t(l,C),p||f||(p=!0,D(E))),C},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(C){var I=d;return function(){var k=d;d=I;try{return C.apply(this,arguments)}finally{d=k}}}})(g3);m3.exports=g3;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v3=Yr.exports,vn=m3.exports;function Se(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var y3=new Set,od={};function Jl(e,t){pu(e,t),pu(e+"Capture",t)}function pu(e,t){for(od[e]=t,e=0;e<t.length;e++)y3.add(t[e])}var qa=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),g1=Object.prototype.hasOwnProperty,B4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,n2={},s2={};function k4(e){return g1.call(s2,e)?!0:g1.call(n2,e)?!1:B4.test(e)?s2[e]=!0:(n2[e]=!0,!1)}function z4(e,t,r,i){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return i?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function F4(e,t,r,i){if(t===null||typeof t=="undefined"||z4(e,t,r,i))return!0;if(i)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function zi(e,t,r,i,n,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=i,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var ni={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ni[e]=new zi(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ni[t]=new zi(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ni[e]=new zi(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ni[e]=new zi(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ni[e]=new zi(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ni[e]=new zi(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ni[e]=new zi(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ni[e]=new zi(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ni[e]=new zi(e,5,!1,e.toLowerCase(),null,!1,!1)});var zx=/[\-:]([a-z])/g;function Fx(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(zx,Fx);ni[t]=new zi(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(zx,Fx);ni[t]=new zi(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(zx,Fx);ni[t]=new zi(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ni[e]=new zi(e,1,!1,e.toLowerCase(),null,!1,!1)});ni.xlinkHref=new zi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ni[e]=new zi(e,1,!1,e.toLowerCase(),null,!0,!0)});function Ux(e,t,r,i){var n=ni.hasOwnProperty(t)?ni[t]:null;(n!==null?n.type!==0:i||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(F4(t,r,n,i)&&(r=null),i||n===null?k4(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=r===null?n.type===3?!1:"":r:(t=n.attributeName,i=n.attributeNamespace,r===null?e.removeAttribute(t):(n=n.type,r=n===3||n===4&&r===!0?"":""+r,i?e.setAttributeNS(i,t,r):e.setAttribute(t,r))))}var ro=v3.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ff=Symbol.for("react.element"),Oh=Symbol.for("react.portal"),Ih=Symbol.for("react.fragment"),Hx=Symbol.for("react.strict_mode"),v1=Symbol.for("react.profiler"),x3=Symbol.for("react.provider"),w3=Symbol.for("react.context"),Gx=Symbol.for("react.forward_ref"),y1=Symbol.for("react.suspense"),x1=Symbol.for("react.suspense_list"),Vx=Symbol.for("react.memo"),Mo=Symbol.for("react.lazy"),b3=Symbol.for("react.offscreen"),a2=Symbol.iterator;function Zu(e){return e===null||typeof e!="object"?null:(e=a2&&e[a2]||e["@@iterator"],typeof e=="function"?e:null)}var dr=Object.assign,ag;function Mc(e){if(ag===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ag=t&&t[1]||""}return`
`+ag+e}var og=!1;function lg(e,t){if(!e||og)return"";og=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var i=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){i=h}e.call(t.prototype)}else{try{throw Error()}catch(h){i=h}e()}}catch(h){if(h&&i&&typeof h.stack=="string"){for(var n=h.stack.split(`
`),s=i.stack.split(`
`),a=n.length-1,o=s.length-1;1<=a&&0<=o&&n[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(n[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||n[a]!==s[o]){var l=`
`+n[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{og=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Mc(e):""}function U4(e){switch(e.tag){case 5:return Mc(e.type);case 16:return Mc("Lazy");case 13:return Mc("Suspense");case 19:return Mc("SuspenseList");case 0:case 2:case 15:return e=lg(e.type,!1),e;case 11:return e=lg(e.type.render,!1),e;case 1:return e=lg(e.type,!0),e;default:return""}}function w1(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ih:return"Fragment";case Oh:return"Portal";case v1:return"Profiler";case Hx:return"StrictMode";case y1:return"Suspense";case x1:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case w3:return(e.displayName||"Context")+".Consumer";case x3:return(e._context.displayName||"Context")+".Provider";case Gx:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Vx:return t=e.displayName||null,t!==null?t:w1(e.type)||"Memo";case Mo:t=e._payload,e=e._init;try{return w1(e(t))}catch{}}return null}function H4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return w1(t);case 8:return t===Hx?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Qo(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function _3(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function G4(e){var t=_3(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),i=""+e[t];if(!e.hasOwnProperty(t)&&typeof r!="undefined"&&typeof r.get=="function"&&typeof r.set=="function"){var n=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function pf(e){e._valueTracker||(e._valueTracker=G4(e))}function S3(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),i="";return e&&(i=_3(e)?e.checked?"true":"false":e.value),e=i,e!==r?(t.setValue(e),!0):!1}function r0(e){if(e=e||(typeof document!="undefined"?document:void 0),typeof e=="undefined")return null;try{return e.activeElement||e.body}catch{return e.body}}function b1(e,t){var r=t.checked;return dr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r!=null?r:e._wrapperState.initialChecked})}function o2(e,t){var r=t.defaultValue==null?"":t.defaultValue,i=t.checked!=null?t.checked:t.defaultChecked;r=Qo(t.value!=null?t.value:r),e._wrapperState={initialChecked:i,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function M3(e,t){t=t.checked,t!=null&&Ux(e,"checked",t,!1)}function _1(e,t){M3(e,t);var r=Qo(t.value),i=t.type;if(r!=null)i==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(i==="submit"||i==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?S1(e,t.type,r):t.hasOwnProperty("defaultValue")&&S1(e,t.type,Qo(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function l2(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var i=t.type;if(!(i!=="submit"&&i!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function S1(e,t,r){(t!=="number"||r0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ac=Array.isArray;function $h(e,t,r,i){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&i&&(e[r].defaultSelected=!0)}else{for(r=""+Qo(r),t=null,n=0;n<e.length;n++){if(e[n].value===r){e[n].selected=!0,i&&(e[n].defaultSelected=!0);return}t!==null||e[n].disabled||(t=e[n])}t!==null&&(t.selected=!0)}}function M1(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Se(91));return dr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function h2(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Se(92));if(Ac(r)){if(1<r.length)throw Error(Se(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Qo(r)}}function A3(e,t){var r=Qo(t.value),i=Qo(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),i!=null&&(e.defaultValue=""+i)}function u2(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function E3(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function A1(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?E3(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mf,C3=function(e){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(t,r,i,n){MSApp.execUnsafeLocalFunction(function(){return e(t,r,i,n)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(mf=mf||document.createElement("div"),mf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=mf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ld(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var zc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},V4=["Webkit","ms","Moz","O"];Object.keys(zc).forEach(function(e){V4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zc[t]=zc[e]})});function T3(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||zc.hasOwnProperty(e)&&zc[e]?(""+t).trim():t+"px"}function D3(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var i=r.indexOf("--")===0,n=T3(r,t[r],i);r==="float"&&(r="cssFloat"),i?e.setProperty(r,n):e[r]=n}}var j4=dr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function E1(e,t){if(t){if(j4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Se(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Se(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Se(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Se(62))}}function C1(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var T1=null;function jx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var D1=null,eu=null,tu=null;function c2(e){if(e=Wd(e)){if(typeof D1!="function")throw Error(Se(280));var t=e.stateNode;t&&(t=cm(t),D1(e.stateNode,e.type,t))}}function P3(e){eu?tu?tu.push(e):tu=[e]:eu=e}function L3(){if(eu){var e=eu,t=tu;if(tu=eu=null,c2(e),t)for(e=0;e<t.length;e++)c2(t[e])}}function R3(e,t){return e(t)}function O3(){}var hg=!1;function I3(e,t,r){if(hg)return e(t,r);hg=!0;try{return R3(e,t,r)}finally{hg=!1,(eu!==null||tu!==null)&&(O3(),L3())}}function hd(e,t){var r=e.stateNode;if(r===null)return null;var i=cm(r);if(i===null)return null;r=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(e=e.type,i=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!i;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Se(231,t,typeof r));return r}var P1=!1;if(qa)try{var $u={};Object.defineProperty($u,"passive",{get:function(){P1=!0}}),window.addEventListener("test",$u,$u),window.removeEventListener("test",$u,$u)}catch{P1=!1}function W4(e,t,r,i,n,s,a,o,l){var h=Array.prototype.slice.call(arguments,3);try{t.apply(r,h)}catch(u){this.onError(u)}}var Fc=!1,i0=null,n0=!1,L1=null,q4={onError:function(e){Fc=!0,i0=e}};function Y4(e,t,r,i,n,s,a,o,l){Fc=!1,i0=null,W4.apply(q4,arguments)}function X4(e,t,r,i,n,s,a,o,l){if(Y4.apply(this,arguments),Fc){if(Fc){var h=i0;Fc=!1,i0=null}else throw Error(Se(198));n0||(n0=!0,L1=h)}}function Kl(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function N3(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function d2(e){if(Kl(e)!==e)throw Error(Se(188))}function Q4(e){var t=e.alternate;if(!t){if(t=Kl(e),t===null)throw Error(Se(188));return t!==e?null:e}for(var r=e,i=t;;){var n=r.return;if(n===null)break;var s=n.alternate;if(s===null){if(i=n.return,i!==null){r=i;continue}break}if(n.child===s.child){for(s=n.child;s;){if(s===r)return d2(n),e;if(s===i)return d2(n),t;s=s.sibling}throw Error(Se(188))}if(r.return!==i.return)r=n,i=s;else{for(var a=!1,o=n.child;o;){if(o===r){a=!0,r=n,i=s;break}if(o===i){a=!0,i=n,r=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===r){a=!0,r=s,i=n;break}if(o===i){a=!0,i=s,r=n;break}o=o.sibling}if(!a)throw Error(Se(189))}}if(r.alternate!==i)throw Error(Se(190))}if(r.tag!==3)throw Error(Se(188));return r.stateNode.current===r?e:t}function B3(e){return e=Q4(e),e!==null?k3(e):null}function k3(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=k3(e);if(t!==null)return t;e=e.sibling}return null}var z3=vn.unstable_scheduleCallback,f2=vn.unstable_cancelCallback,J4=vn.unstable_shouldYield,K4=vn.unstable_requestPaint,Sr=vn.unstable_now,Z4=vn.unstable_getCurrentPriorityLevel,Wx=vn.unstable_ImmediatePriority,F3=vn.unstable_UserBlockingPriority,s0=vn.unstable_NormalPriority,$4=vn.unstable_LowPriority,U3=vn.unstable_IdlePriority,om=null,$s=null;function eL(e){if($s&&typeof $s.onCommitFiberRoot=="function")try{$s.onCommitFiberRoot(om,e,void 0,(e.current.flags&128)===128)}catch{}}var ds=Math.clz32?Math.clz32:iL,tL=Math.log,rL=Math.LN2;function iL(e){return e>>>=0,e===0?32:31-(tL(e)/rL|0)|0}var gf=64,vf=4194304;function Ec(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function a0(e,t){var r=e.pendingLanes;if(r===0)return 0;var i=0,n=e.suspendedLanes,s=e.pingedLanes,a=r&268435455;if(a!==0){var o=a&~n;o!==0?i=Ec(o):(s&=a,s!==0&&(i=Ec(s)))}else a=r&~n,a!==0?i=Ec(a):s!==0&&(i=Ec(s));if(i===0)return 0;if(t!==0&&t!==i&&(t&n)===0&&(n=i&-i,s=t&-t,n>=s||n===16&&(s&4194240)!==0))return t;if((i&4)!==0&&(i|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=i;0<t;)r=31-ds(t),n=1<<r,i|=e[r],t&=~n;return i}function nL(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function sL(e,t){for(var r=e.suspendedLanes,i=e.pingedLanes,n=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-ds(s),o=1<<a,l=n[a];l===-1?((o&r)===0||(o&i)!==0)&&(n[a]=nL(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function R1(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function H3(){var e=gf;return gf<<=1,(gf&4194240)===0&&(gf=64),e}function ug(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Vd(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ds(t),e[t]=r}function aL(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var i=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-ds(r),s=1<<n;t[n]=0,i[n]=-1,e[n]=-1,r&=~s}}function qx(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var i=31-ds(r),n=1<<i;n&t|e[i]&t&&(e[i]|=t),r&=~n}}var Jt=0;function G3(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var V3,Yx,j3,W3,q3,O1=!1,yf=[],Uo=null,Ho=null,Go=null,ud=new Map,cd=new Map,To=[],oL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function p2(e,t){switch(e){case"focusin":case"focusout":Uo=null;break;case"dragenter":case"dragleave":Ho=null;break;case"mouseover":case"mouseout":Go=null;break;case"pointerover":case"pointerout":ud.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":cd.delete(t.pointerId)}}function ec(e,t,r,i,n,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:i,nativeEvent:s,targetContainers:[n]},t!==null&&(t=Wd(t),t!==null&&Yx(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,n!==null&&t.indexOf(n)===-1&&t.push(n),e)}function lL(e,t,r,i,n){switch(t){case"focusin":return Uo=ec(Uo,e,t,r,i,n),!0;case"dragenter":return Ho=ec(Ho,e,t,r,i,n),!0;case"mouseover":return Go=ec(Go,e,t,r,i,n),!0;case"pointerover":var s=n.pointerId;return ud.set(s,ec(ud.get(s)||null,e,t,r,i,n)),!0;case"gotpointercapture":return s=n.pointerId,cd.set(s,ec(cd.get(s)||null,e,t,r,i,n)),!0}return!1}function Y3(e){var t=xl(e.target);if(t!==null){var r=Kl(t);if(r!==null){if(t=r.tag,t===13){if(t=N3(r),t!==null){e.blockedOn=t,q3(e.priority,function(){j3(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Pp(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=I1(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var i=new r.constructor(r.type,r);T1=i,r.target.dispatchEvent(i),T1=null}else return t=Wd(r),t!==null&&Yx(t),e.blockedOn=r,!1;t.shift()}return!0}function m2(e,t,r){Pp(e)&&r.delete(t)}function hL(){O1=!1,Uo!==null&&Pp(Uo)&&(Uo=null),Ho!==null&&Pp(Ho)&&(Ho=null),Go!==null&&Pp(Go)&&(Go=null),ud.forEach(m2),cd.forEach(m2)}function tc(e,t){e.blockedOn===t&&(e.blockedOn=null,O1||(O1=!0,vn.unstable_scheduleCallback(vn.unstable_NormalPriority,hL)))}function dd(e){function t(n){return tc(n,e)}if(0<yf.length){tc(yf[0],e);for(var r=1;r<yf.length;r++){var i=yf[r];i.blockedOn===e&&(i.blockedOn=null)}}for(Uo!==null&&tc(Uo,e),Ho!==null&&tc(Ho,e),Go!==null&&tc(Go,e),ud.forEach(t),cd.forEach(t),r=0;r<To.length;r++)i=To[r],i.blockedOn===e&&(i.blockedOn=null);for(;0<To.length&&(r=To[0],r.blockedOn===null);)Y3(r),r.blockedOn===null&&To.shift()}var ru=ro.ReactCurrentBatchConfig,o0=!0;function uL(e,t,r,i){var n=Jt,s=ru.transition;ru.transition=null;try{Jt=1,Xx(e,t,r,i)}finally{Jt=n,ru.transition=s}}function cL(e,t,r,i){var n=Jt,s=ru.transition;ru.transition=null;try{Jt=4,Xx(e,t,r,i)}finally{Jt=n,ru.transition=s}}function Xx(e,t,r,i){if(o0){var n=I1(e,t,r,i);if(n===null)wg(e,t,i,l0,r),p2(e,i);else if(lL(n,e,t,r,i))i.stopPropagation();else if(p2(e,i),t&4&&-1<oL.indexOf(e)){for(;n!==null;){var s=Wd(n);if(s!==null&&V3(s),s=I1(e,t,r,i),s===null&&wg(e,t,i,l0,r),s===n)break;n=s}n!==null&&i.stopPropagation()}else wg(e,t,i,null,r)}}var l0=null;function I1(e,t,r,i){if(l0=null,e=jx(i),e=xl(e),e!==null)if(t=Kl(e),t===null)e=null;else if(r=t.tag,r===13){if(e=N3(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return l0=e,null}function X3(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Z4()){case Wx:return 1;case F3:return 4;case s0:case $4:return 16;case U3:return 536870912;default:return 16}default:return 16}}var Ro=null,Qx=null,Lp=null;function Q3(){if(Lp)return Lp;var e,t=Qx,r=t.length,i,n="value"in Ro?Ro.value:Ro.textContent,s=n.length;for(e=0;e<r&&t[e]===n[e];e++);var a=r-e;for(i=1;i<=a&&t[r-i]===n[s-i];i++);return Lp=n.slice(e,1<i?1-i:void 0)}function Rp(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function xf(){return!0}function g2(){return!1}function wn(e){function t(r,i,n,s,a){this._reactName=r,this._targetInst=n,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?xf:g2,this.isPropagationStopped=g2,this}return dr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=xf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=xf)},persist:function(){},isPersistent:xf}),t}var Lu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jx=wn(Lu),jd=dr({},Lu,{view:0,detail:0}),dL=wn(jd),cg,dg,rc,lm=dr({},jd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kx,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==rc&&(rc&&e.type==="mousemove"?(cg=e.screenX-rc.screenX,dg=e.screenY-rc.screenY):dg=cg=0,rc=e),cg)},movementY:function(e){return"movementY"in e?e.movementY:dg}}),v2=wn(lm),fL=dr({},lm,{dataTransfer:0}),pL=wn(fL),mL=dr({},jd,{relatedTarget:0}),fg=wn(mL),gL=dr({},Lu,{animationName:0,elapsedTime:0,pseudoElement:0}),vL=wn(gL),yL=dr({},Lu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xL=wn(yL),wL=dr({},Lu,{data:0}),y2=wn(wL),bL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_L={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},SL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ML(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=SL[e])?!!t[e]:!1}function Kx(){return ML}var AL=dr({},jd,{key:function(e){if(e.key){var t=bL[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Rp(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?_L[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kx,charCode:function(e){return e.type==="keypress"?Rp(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Rp(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),EL=wn(AL),CL=dr({},lm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),x2=wn(CL),TL=dr({},jd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kx}),DL=wn(TL),PL=dr({},Lu,{propertyName:0,elapsedTime:0,pseudoElement:0}),LL=wn(PL),RL=dr({},lm,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),OL=wn(RL),IL=[9,13,27,32],Zx=qa&&"CompositionEvent"in window,Uc=null;qa&&"documentMode"in document&&(Uc=document.documentMode);var NL=qa&&"TextEvent"in window&&!Uc,J3=qa&&(!Zx||Uc&&8<Uc&&11>=Uc),w2=String.fromCharCode(32),b2=!1;function K3(e,t){switch(e){case"keyup":return IL.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Z3(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Nh=!1;function BL(e,t){switch(e){case"compositionend":return Z3(t);case"keypress":return t.which!==32?null:(b2=!0,w2);case"textInput":return e=t.data,e===w2&&b2?null:e;default:return null}}function kL(e,t){if(Nh)return e==="compositionend"||!Zx&&K3(e,t)?(e=Q3(),Lp=Qx=Ro=null,Nh=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return J3&&t.locale!=="ko"?null:t.data;default:return null}}var zL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!zL[e.type]:t==="textarea"}function $3(e,t,r,i){P3(i),t=h0(t,"onChange"),0<t.length&&(r=new Jx("onChange","change",null,r,i),e.push({event:r,listeners:t}))}var Hc=null,fd=null;function FL(e){uC(e,0)}function hm(e){var t=zh(e);if(S3(t))return e}function UL(e,t){if(e==="change")return t}var eC=!1;if(qa){var pg;if(qa){var mg="oninput"in document;if(!mg){var S2=document.createElement("div");S2.setAttribute("oninput","return;"),mg=typeof S2.oninput=="function"}pg=mg}else pg=!1;eC=pg&&(!document.documentMode||9<document.documentMode)}function M2(){Hc&&(Hc.detachEvent("onpropertychange",tC),fd=Hc=null)}function tC(e){if(e.propertyName==="value"&&hm(fd)){var t=[];$3(t,fd,e,jx(e)),I3(FL,t)}}function HL(e,t,r){e==="focusin"?(M2(),Hc=t,fd=r,Hc.attachEvent("onpropertychange",tC)):e==="focusout"&&M2()}function GL(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return hm(fd)}function VL(e,t){if(e==="click")return hm(t)}function jL(e,t){if(e==="input"||e==="change")return hm(t)}function WL(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var fs=typeof Object.is=="function"?Object.is:WL;function pd(e,t){if(fs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(i=0;i<r.length;i++){var n=r[i];if(!g1.call(t,n)||!fs(e[n],t[n]))return!1}return!0}function A2(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function E2(e,t){var r=A2(e);e=0;for(var i;r;){if(r.nodeType===3){if(i=e+r.textContent.length,e<=t&&i>=t)return{node:r,offset:t-e};e=i}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=A2(r)}}function rC(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?rC(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function iC(){for(var e=window,t=r0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=r0(e.document)}return t}function $x(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function qL(e){var t=iC(),r=e.focusedElem,i=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&rC(r.ownerDocument.documentElement,r)){if(i!==null&&$x(r)){if(t=i.start,e=i.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var n=r.textContent.length,s=Math.min(i.start,n);i=i.end===void 0?s:Math.min(i.end,n),!e.extend&&s>i&&(n=i,i=s,s=n),n=E2(r,s);var a=E2(r,i);n&&a&&(e.rangeCount!==1||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(n.node,n.offset),e.removeAllRanges(),s>i?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var YL=qa&&"documentMode"in document&&11>=document.documentMode,Bh=null,N1=null,Gc=null,B1=!1;function C2(e,t,r){var i=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;B1||Bh==null||Bh!==r0(i)||(i=Bh,"selectionStart"in i&&$x(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Gc&&pd(Gc,i)||(Gc=i,i=h0(N1,"onSelect"),0<i.length&&(t=new Jx("onSelect","select",null,t,r),e.push({event:t,listeners:i}),t.target=Bh)))}function wf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var kh={animationend:wf("Animation","AnimationEnd"),animationiteration:wf("Animation","AnimationIteration"),animationstart:wf("Animation","AnimationStart"),transitionend:wf("Transition","TransitionEnd")},gg={},nC={};qa&&(nC=document.createElement("div").style,"AnimationEvent"in window||(delete kh.animationend.animation,delete kh.animationiteration.animation,delete kh.animationstart.animation),"TransitionEvent"in window||delete kh.transitionend.transition);function um(e){if(gg[e])return gg[e];if(!kh[e])return e;var t=kh[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in nC)return gg[e]=t[r];return e}var sC=um("animationend"),aC=um("animationiteration"),oC=um("animationstart"),lC=um("transitionend"),hC=new Map,T2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function il(e,t){hC.set(e,t),Jl(t,[e])}for(var vg=0;vg<T2.length;vg++){var yg=T2[vg],XL=yg.toLowerCase(),QL=yg[0].toUpperCase()+yg.slice(1);il(XL,"on"+QL)}il(sC,"onAnimationEnd");il(aC,"onAnimationIteration");il(oC,"onAnimationStart");il("dblclick","onDoubleClick");il("focusin","onFocus");il("focusout","onBlur");il(lC,"onTransitionEnd");pu("onMouseEnter",["mouseout","mouseover"]);pu("onMouseLeave",["mouseout","mouseover"]);pu("onPointerEnter",["pointerout","pointerover"]);pu("onPointerLeave",["pointerout","pointerover"]);Jl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Jl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Jl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Jl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Jl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Jl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JL=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cc));function D2(e,t,r){var i=e.type||"unknown-event";e.currentTarget=r,X4(i,t,void 0,e),e.currentTarget=null}function uC(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var i=e[r],n=i.event;i=i.listeners;e:{var s=void 0;if(t)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,h=o.currentTarget;if(o=o.listener,l!==s&&n.isPropagationStopped())break e;D2(n,o,h),s=l}else for(a=0;a<i.length;a++){if(o=i[a],l=o.instance,h=o.currentTarget,o=o.listener,l!==s&&n.isPropagationStopped())break e;D2(n,o,h),s=l}}}if(n0)throw e=L1,n0=!1,L1=null,e}function tr(e,t){var r=t[H1];r===void 0&&(r=t[H1]=new Set);var i=e+"__bubble";r.has(i)||(cC(t,e,2,!1),r.add(i))}function xg(e,t,r){var i=0;t&&(i|=4),cC(r,e,i,t)}var bf="_reactListening"+Math.random().toString(36).slice(2);function md(e){if(!e[bf]){e[bf]=!0,y3.forEach(function(r){r!=="selectionchange"&&(JL.has(r)||xg(r,!1,e),xg(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[bf]||(t[bf]=!0,xg("selectionchange",!1,t))}}function cC(e,t,r,i){switch(X3(t)){case 1:var n=uL;break;case 4:n=cL;break;default:n=Xx}r=n.bind(null,t,r,e),n=void 0,!P1||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(n=!0),i?n!==void 0?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):n!==void 0?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function wg(e,t,r,i,n){var s=i;if((t&1)===0&&(t&2)===0&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===n||o.nodeType===8&&o.parentNode===n)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===n||l.nodeType===8&&l.parentNode===n))return;a=a.return}for(;o!==null;){if(a=xl(o),a===null)return;if(l=a.tag,l===5||l===6){i=s=a;continue e}o=o.parentNode}}i=i.return}I3(function(){var h=s,u=jx(r),c=[];e:{var d=hC.get(e);if(d!==void 0){var f=Jx,p=e;switch(e){case"keypress":if(Rp(r)===0)break e;case"keydown":case"keyup":f=EL;break;case"focusin":p="focus",f=fg;break;case"focusout":p="blur",f=fg;break;case"beforeblur":case"afterblur":f=fg;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=v2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=pL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=DL;break;case sC:case aC:case oC:f=vL;break;case lC:f=LL;break;case"scroll":f=dL;break;case"wheel":f=OL;break;case"copy":case"cut":case"paste":f=xL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=x2}var m=(t&4)!==0,g=!m&&e==="scroll",v=m?d!==null?d+"Capture":null:d;m=[];for(var x=h,b;x!==null;){b=x;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,v!==null&&(_=hd(x,v),_!=null&&m.push(gd(x,_,b)))),g)break;x=x.return}0<m.length&&(d=new f(d,p,null,r,u),c.push({event:d,listeners:m}))}}if((t&7)===0){e:{if(d=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",d&&r!==T1&&(p=r.relatedTarget||r.fromElement)&&(xl(p)||p[Ya]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=r.relatedTarget||r.toElement,f=h,p=p?xl(p):null,p!==null&&(g=Kl(p),p!==g||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=h),f!==p)){if(m=v2,_="onMouseLeave",v="onMouseEnter",x="mouse",(e==="pointerout"||e==="pointerover")&&(m=x2,_="onPointerLeave",v="onPointerEnter",x="pointer"),g=f==null?d:zh(f),b=p==null?d:zh(p),d=new m(_,x+"leave",f,r,u),d.target=g,d.relatedTarget=b,_=null,xl(u)===h&&(m=new m(v,x+"enter",p,r,u),m.target=b,m.relatedTarget=g,_=m),g=_,f&&p)t:{for(m=f,v=p,x=0,b=m;b;b=ih(b))x++;for(b=0,_=v;_;_=ih(_))b++;for(;0<x-b;)m=ih(m),x--;for(;0<b-x;)v=ih(v),b--;for(;x--;){if(m===v||v!==null&&m===v.alternate)break t;m=ih(m),v=ih(v)}m=null}else m=null;f!==null&&P2(c,d,f,m,!1),p!==null&&g!==null&&P2(c,g,p,m,!0)}}e:{if(d=h?zh(h):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var E=UL;else if(_2(d))if(eC)E=jL;else{E=GL;var S=HL}else(f=d.nodeName)&&f.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(E=VL);if(E&&(E=E(e,h))){$3(c,E,r,u);break e}S&&S(e,d,h),e==="focusout"&&(S=d._wrapperState)&&S.controlled&&d.type==="number"&&S1(d,"number",d.value)}switch(S=h?zh(h):window,e){case"focusin":(_2(S)||S.contentEditable==="true")&&(Bh=S,N1=h,Gc=null);break;case"focusout":Gc=N1=Bh=null;break;case"mousedown":B1=!0;break;case"contextmenu":case"mouseup":case"dragend":B1=!1,C2(c,r,u);break;case"selectionchange":if(YL)break;case"keydown":case"keyup":C2(c,r,u)}var P;if(Zx)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else Nh?K3(e,r)&&(M="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(M="onCompositionStart");M&&(J3&&r.locale!=="ko"&&(Nh||M!=="onCompositionStart"?M==="onCompositionEnd"&&Nh&&(P=Q3()):(Ro=u,Qx="value"in Ro?Ro.value:Ro.textContent,Nh=!0)),S=h0(h,M),0<S.length&&(M=new y2(M,e,null,r,u),c.push({event:M,listeners:S}),P?M.data=P:(P=Z3(r),P!==null&&(M.data=P)))),(P=NL?BL(e,r):kL(e,r))&&(h=h0(h,"onBeforeInput"),0<h.length&&(u=new y2("onBeforeInput","beforeinput",null,r,u),c.push({event:u,listeners:h}),u.data=P))}uC(c,t)})}function gd(e,t,r){return{instance:e,listener:t,currentTarget:r}}function h0(e,t){for(var r=t+"Capture",i=[];e!==null;){var n=e,s=n.stateNode;n.tag===5&&s!==null&&(n=s,s=hd(e,r),s!=null&&i.unshift(gd(e,s,n)),s=hd(e,t),s!=null&&i.push(gd(e,s,n))),e=e.return}return i}function ih(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function P2(e,t,r,i,n){for(var s=t._reactName,a=[];r!==null&&r!==i;){var o=r,l=o.alternate,h=o.stateNode;if(l!==null&&l===i)break;o.tag===5&&h!==null&&(o=h,n?(l=hd(r,s),l!=null&&a.unshift(gd(r,l,o))):n||(l=hd(r,s),l!=null&&a.push(gd(r,l,o)))),r=r.return}a.length!==0&&e.push({event:t,listeners:a})}var KL=/\r\n?/g,ZL=/\u0000|\uFFFD/g;function L2(e){return(typeof e=="string"?e:""+e).replace(KL,`
`).replace(ZL,"")}function _f(e,t,r){if(t=L2(t),L2(e)!==t&&r)throw Error(Se(425))}function u0(){}var k1=null,z1=null;function F1(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var U1=typeof setTimeout=="function"?setTimeout:void 0,$L=typeof clearTimeout=="function"?clearTimeout:void 0,R2=typeof Promise=="function"?Promise:void 0,eR=typeof queueMicrotask=="function"?queueMicrotask:typeof R2!="undefined"?function(e){return R2.resolve(null).then(e).catch(tR)}:U1;function tR(e){setTimeout(function(){throw e})}function bg(e,t){var r=t,i=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&n.nodeType===8)if(r=n.data,r==="/$"){if(i===0){e.removeChild(n),dd(t);return}i--}else r!=="$"&&r!=="$?"&&r!=="$!"||i++;r=n}while(r);dd(t)}function Ba(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function O2(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ru=Math.random().toString(36).slice(2),Fs="__reactFiber$"+Ru,vd="__reactProps$"+Ru,Ya="__reactContainer$"+Ru,H1="__reactEvents$"+Ru,rR="__reactListeners$"+Ru,iR="__reactHandles$"+Ru;function xl(e){var t=e[Fs];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Ya]||r[Fs]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=O2(e);e!==null;){if(r=e[Fs])return r;e=O2(e)}return t}e=r,r=e.parentNode}return null}function Wd(e){return e=e[Fs]||e[Ya],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function zh(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Se(33))}function cm(e){return e[vd]||null}var G1=[],Fh=-1;function nl(e){return{current:e}}function ir(e){0>Fh||(e.current=G1[Fh],G1[Fh]=null,Fh--)}function $t(e,t){Fh++,G1[Fh]=e.current,e.current=t}var Jo={},_i=nl(Jo),Zi=nl(!1),Ol=Jo;function mu(e,t){var r=e.type.contextTypes;if(!r)return Jo;var i=e.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===t)return i.__reactInternalMemoizedMaskedChildContext;var n={},s;for(s in r)n[s]=t[s];return i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=n),n}function $i(e){return e=e.childContextTypes,e!=null}function c0(){ir(Zi),ir(_i)}function I2(e,t,r){if(_i.current!==Jo)throw Error(Se(168));$t(_i,t),$t(Zi,r)}function dC(e,t,r){var i=e.stateNode;if(t=t.childContextTypes,typeof i.getChildContext!="function")return r;i=i.getChildContext();for(var n in i)if(!(n in t))throw Error(Se(108,H4(e)||"Unknown",n));return dr({},r,i)}function d0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Jo,Ol=_i.current,$t(_i,e),$t(Zi,Zi.current),!0}function N2(e,t,r){var i=e.stateNode;if(!i)throw Error(Se(169));r?(e=dC(e,t,Ol),i.__reactInternalMemoizedMergedChildContext=e,ir(Zi),ir(_i),$t(_i,e)):ir(Zi),$t(Zi,r)}var Ia=null,dm=!1,_g=!1;function fC(e){Ia===null?Ia=[e]:Ia.push(e)}function nR(e){dm=!0,fC(e)}function sl(){if(!_g&&Ia!==null){_g=!0;var e=0,t=Jt;try{var r=Ia;for(Jt=1;e<r.length;e++){var i=r[e];do i=i(!0);while(i!==null)}Ia=null,dm=!1}catch(n){throw Ia!==null&&(Ia=Ia.slice(e+1)),z3(Wx,sl),n}finally{Jt=t,_g=!1}}return null}var sR=ro.ReactCurrentBatchConfig;function rs(e,t){if(e&&e.defaultProps){t=dr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}var f0=nl(null),p0=null,Uh=null,ew=null;function tw(){ew=Uh=p0=null}function rw(e){var t=f0.current;ir(f0),e._currentValue=t}function V1(e,t,r){for(;e!==null;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,i!==null&&(i.childLanes|=t)):i!==null&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===r)break;e=e.return}}function iu(e,t){p0=e,ew=Uh=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&t)!==0&&(Qi=!0),e.firstContext=null)}function Fn(e){var t=e._currentValue;if(ew!==e)if(e={context:e,memoizedValue:t,next:null},Uh===null){if(p0===null)throw Error(Se(308));Uh=e,p0.dependencies={lanes:0,firstContext:e}}else Uh=Uh.next=e;return t}var ls=null,Ao=!1;function iw(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function pC(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ha(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Vo(e,t){var r=e.updateQueue;r!==null&&(r=r.shared,iT(e)?(e=r.interleaved,e===null?(t.next=t,ls===null?ls=[r]:ls.push(r)):(t.next=e.next,e.next=t),r.interleaved=t):(e=r.pending,e===null?t.next=t:(t.next=e.next,e.next=t),r.pending=t))}function Op(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,qx(e,r)}}function B2(e,t){var r=e.updateQueue,i=e.alternate;if(i!==null&&(i=i.updateQueue,r===i)){var n=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?n=s=a:s=s.next=a,r=r.next}while(r!==null);s===null?n=s=t:s=s.next=t}else n=s=t;r={baseState:i.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:i.shared,effects:i.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function m0(e,t,r,i){var n=e.updateQueue;Ao=!1;var s=n.firstBaseUpdate,a=n.lastBaseUpdate,o=n.shared.pending;if(o!==null){n.shared.pending=null;var l=o,h=l.next;l.next=null,a===null?s=h:a.next=h,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=h:o.next=h,u.lastBaseUpdate=l))}if(s!==null){var c=n.baseState;a=0,u=h=l=null,o=s;do{var d=o.lane,f=o.eventTime;if((i&d)===d){u!==null&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(d=t,f=r,m.tag){case 1:if(p=m.payload,typeof p=="function"){c=p.call(f,c,d);break e}c=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,d=typeof p=="function"?p.call(f,c,d):p,d==null)break e;c=dr({},c,d);break e;case 2:Ao=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=n.effects,d===null?n.effects=[o]:d.push(o))}else f={eventTime:f,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(h=u=f,l=c):u=u.next=f,a|=d;if(o=o.next,o===null){if(o=n.shared.pending,o===null)break;d=o,o=d.next,d.next=null,n.lastBaseUpdate=d,n.shared.pending=null}}while(1);if(u===null&&(l=c),n.baseState=l,n.firstBaseUpdate=h,n.lastBaseUpdate=u,t=n.shared.interleaved,t!==null){n=t;do a|=n.lane,n=n.next;while(n!==t)}else s===null&&(n.shared.lanes=0);Bl|=a,e.lanes=a,e.memoizedState=c}}function k2(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var i=e[t],n=i.callback;if(n!==null){if(i.callback=null,i=r,typeof n!="function")throw Error(Se(191,n));n.call(i)}}}var mC=new v3.Component().refs;function j1(e,t,r,i){t=e.memoizedState,r=r(i,t),r=r==null?t:dr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var fm={isMounted:function(e){return(e=e._reactInternals)?Kl(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var i=Ri(),n=Wo(e),s=Ha(i,n);s.payload=t,r!=null&&(s.callback=r),Vo(e,s),t=zn(e,n,i),t!==null&&Op(t,e,n)},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var i=Ri(),n=Wo(e),s=Ha(i,n);s.tag=1,s.payload=t,r!=null&&(s.callback=r),Vo(e,s),t=zn(e,n,i),t!==null&&Op(t,e,n)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Ri(),i=Wo(e),n=Ha(r,i);n.tag=2,t!=null&&(n.callback=t),Vo(e,n),t=zn(e,i,r),t!==null&&Op(t,e,i)}};function z2(e,t,r,i,n,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(i,s,a):t.prototype&&t.prototype.isPureReactComponent?!pd(r,i)||!pd(n,s):!0}function gC(e,t,r){var i=!1,n=Jo,s=t.contextType;return typeof s=="object"&&s!==null?s=Fn(s):(n=$i(t)?Ol:_i.current,i=t.contextTypes,s=(i=i!=null)?mu(e,n):Jo),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=fm,e.stateNode=t,t._reactInternals=e,i&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),t}function F2(e,t,r,i){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,i),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,i),t.state!==e&&fm.enqueueReplaceState(t,t.state,null)}function W1(e,t,r,i){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs=mC,iw(e);var s=t.contextType;typeof s=="object"&&s!==null?n.context=Fn(s):(s=$i(t)?Ol:_i.current,n.context=mu(e,s)),n.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(j1(e,t,s,r),n.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof n.getSnapshotBeforeUpdate=="function"||typeof n.UNSAFE_componentWillMount!="function"&&typeof n.componentWillMount!="function"||(t=n.state,typeof n.componentWillMount=="function"&&n.componentWillMount(),typeof n.UNSAFE_componentWillMount=="function"&&n.UNSAFE_componentWillMount(),t!==n.state&&fm.enqueueReplaceState(n,n.state,null),m0(e,r,n,i),n.state=e.memoizedState),typeof n.componentDidMount=="function"&&(e.flags|=4194308)}var Hh=[],Gh=0,g0=null,v0=0,In=[],Nn=0,Il=null,ka=1,za="";function pl(e,t){Hh[Gh++]=v0,Hh[Gh++]=g0,g0=e,v0=t}function vC(e,t,r){In[Nn++]=ka,In[Nn++]=za,In[Nn++]=Il,Il=e;var i=ka;e=za;var n=32-ds(i)-1;i&=~(1<<n),r+=1;var s=32-ds(t)+n;if(30<s){var a=n-n%5;s=(i&(1<<a)-1).toString(32),i>>=a,n-=a,ka=1<<32-ds(t)+n|r<<n|i,za=s+e}else ka=1<<s|r<<n|i,za=e}function nw(e){e.return!==null&&(pl(e,1),vC(e,1,0))}function sw(e){for(;e===g0;)g0=Hh[--Gh],Hh[Gh]=null,v0=Hh[--Gh],Hh[Gh]=null;for(;e===Il;)Il=In[--Nn],In[Nn]=null,za=In[--Nn],In[Nn]=null,ka=In[--Nn],In[Nn]=null}var gn=null,ji=null,sr=!1,ss=null;function yC(e,t){var r=Bn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function U2(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,gn=e,ji=Ba(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,gn=e,ji=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Il!==null?{id:ka,overflow:za}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Bn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,gn=e,ji=null,!0):!1;default:return!1}}function q1(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Y1(e){if(sr){var t=ji;if(t){var r=t;if(!U2(e,t)){if(q1(e))throw Error(Se(418));t=Ba(r.nextSibling);var i=gn;t&&U2(e,t)?yC(i,r):(e.flags=e.flags&-4097|2,sr=!1,gn=e)}}else{if(q1(e))throw Error(Se(418));e.flags=e.flags&-4097|2,sr=!1,gn=e}}}function H2(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;gn=e}function ic(e){if(e!==gn)return!1;if(!sr)return H2(e),sr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!F1(e.type,e.memoizedProps)),t&&(t=ji)){if(q1(e)){for(e=ji;e;)e=Ba(e.nextSibling);throw Error(Se(418))}for(;t;)yC(e,t),t=Ba(t.nextSibling)}if(H2(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Se(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ji=Ba(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ji=null}}else ji=gn?Ba(e.stateNode.nextSibling):null;return!0}function gu(){ji=gn=null,sr=!1}function aw(e){ss===null?ss=[e]:ss.push(e)}function nc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Se(309));var i=r.stateNode}if(!i)throw Error(Se(147,e));var n=i,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=n.refs;o===mC&&(o=n.refs={}),a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(Se(284));if(!r._owner)throw Error(Se(290,e))}return e}function Sf(e,t){throw e=Object.prototype.toString.call(t),Error(Se(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function G2(e){var t=e._init;return t(e._payload)}function xC(e){function t(v,x){if(e){var b=v.deletions;b===null?(v.deletions=[x],v.flags|=16):b.push(x)}}function r(v,x){if(!e)return null;for(;x!==null;)t(v,x),x=x.sibling;return null}function i(v,x){for(v=new Map;x!==null;)x.key!==null?v.set(x.key,x):v.set(x.index,x),x=x.sibling;return v}function n(v,x){return v=Ko(v,x),v.index=0,v.sibling=null,v}function s(v,x,b){return v.index=b,e?(b=v.alternate,b!==null?(b=b.index,b<x?(v.flags|=2,x):b):(v.flags|=2,x)):(v.flags|=1048576,x)}function a(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,x,b,_){return x===null||x.tag!==6?(x=Tg(b,v.mode,_),x.return=v,x):(x=n(x,b),x.return=v,x)}function l(v,x,b,_){var E=b.type;return E===Ih?u(v,x,b.props.children,_,b.key):x!==null&&(x.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Mo&&G2(E)===x.type)?(_=n(x,b.props),_.ref=nc(v,x,b),_.return=v,_):(_=zp(b.type,b.key,b.props,null,v.mode,_),_.ref=nc(v,x,b),_.return=v,_)}function h(v,x,b,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=Dg(b,v.mode,_),x.return=v,x):(x=n(x,b.children||[]),x.return=v,x)}function u(v,x,b,_,E){return x===null||x.tag!==7?(x=Al(b,v.mode,_,E),x.return=v,x):(x=n(x,b),x.return=v,x)}function c(v,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Tg(""+x,v.mode,b),x.return=v,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ff:return b=zp(x.type,x.key,x.props,null,v.mode,b),b.ref=nc(v,null,x),b.return=v,b;case Oh:return x=Dg(x,v.mode,b),x.return=v,x;case Mo:var _=x._init;return c(v,_(x._payload),b)}if(Ac(x)||Zu(x))return x=Al(x,v.mode,b,null),x.return=v,x;Sf(v,x)}return null}function d(v,x,b,_){var E=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return E!==null?null:o(v,x,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ff:return b.key===E?l(v,x,b,_):null;case Oh:return b.key===E?h(v,x,b,_):null;case Mo:return E=b._init,d(v,x,E(b._payload),_)}if(Ac(b)||Zu(b))return E!==null?null:u(v,x,b,_,null);Sf(v,b)}return null}function f(v,x,b,_,E){if(typeof _=="string"&&_!==""||typeof _=="number")return v=v.get(b)||null,o(x,v,""+_,E);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case ff:return v=v.get(_.key===null?b:_.key)||null,l(x,v,_,E);case Oh:return v=v.get(_.key===null?b:_.key)||null,h(x,v,_,E);case Mo:var S=_._init;return f(v,x,b,S(_._payload),E)}if(Ac(_)||Zu(_))return v=v.get(b)||null,u(x,v,_,E,null);Sf(x,_)}return null}function p(v,x,b,_){for(var E=null,S=null,P=x,M=x=0,B=null;P!==null&&M<b.length;M++){P.index>M?(B=P,P=null):B=P.sibling;var R=d(v,P,b[M],_);if(R===null){P===null&&(P=B);break}e&&P&&R.alternate===null&&t(v,P),x=s(R,x,M),S===null?E=R:S.sibling=R,S=R,P=B}if(M===b.length)return r(v,P),sr&&pl(v,M),E;if(P===null){for(;M<b.length;M++)P=c(v,b[M],_),P!==null&&(x=s(P,x,M),S===null?E=P:S.sibling=P,S=P);return sr&&pl(v,M),E}for(P=i(v,P);M<b.length;M++)B=f(P,v,M,b[M],_),B!==null&&(e&&B.alternate!==null&&P.delete(B.key===null?M:B.key),x=s(B,x,M),S===null?E=B:S.sibling=B,S=B);return e&&P.forEach(function(H){return t(v,H)}),sr&&pl(v,M),E}function m(v,x,b,_){var E=Zu(b);if(typeof E!="function")throw Error(Se(150));if(b=E.call(b),b==null)throw Error(Se(151));for(var S=E=null,P=x,M=x=0,B=null,R=b.next();P!==null&&!R.done;M++,R=b.next()){P.index>M?(B=P,P=null):B=P.sibling;var H=d(v,P,R.value,_);if(H===null){P===null&&(P=B);break}e&&P&&H.alternate===null&&t(v,P),x=s(H,x,M),S===null?E=H:S.sibling=H,S=H,P=B}if(R.done)return r(v,P),sr&&pl(v,M),E;if(P===null){for(;!R.done;M++,R=b.next())R=c(v,R.value,_),R!==null&&(x=s(R,x,M),S===null?E=R:S.sibling=R,S=R);return sr&&pl(v,M),E}for(P=i(v,P);!R.done;M++,R=b.next())R=f(P,v,M,R.value,_),R!==null&&(e&&R.alternate!==null&&P.delete(R.key===null?M:R.key),x=s(R,x,M),S===null?E=R:S.sibling=R,S=R);return e&&P.forEach(function(Q){return t(v,Q)}),sr&&pl(v,M),E}function g(v,x,b,_){if(typeof b=="object"&&b!==null&&b.type===Ih&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case ff:e:{for(var E=b.key,S=x;S!==null;){if(S.key===E){if(E=b.type,E===Ih){if(S.tag===7){r(v,S.sibling),x=n(S,b.props.children),x.return=v,v=x;break e}}else if(S.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Mo&&G2(E)===S.type){r(v,S.sibling),x=n(S,b.props),x.ref=nc(v,S,b),x.return=v,v=x;break e}r(v,S);break}else t(v,S);S=S.sibling}b.type===Ih?(x=Al(b.props.children,v.mode,_,b.key),x.return=v,v=x):(_=zp(b.type,b.key,b.props,null,v.mode,_),_.ref=nc(v,x,b),_.return=v,v=_)}return a(v);case Oh:e:{for(S=b.key;x!==null;){if(x.key===S)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){r(v,x.sibling),x=n(x,b.children||[]),x.return=v,v=x;break e}else{r(v,x);break}else t(v,x);x=x.sibling}x=Dg(b,v.mode,_),x.return=v,v=x}return a(v);case Mo:return S=b._init,g(v,x,S(b._payload),_)}if(Ac(b))return p(v,x,b,_);if(Zu(b))return m(v,x,b,_);Sf(v,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(r(v,x.sibling),x=n(x,b),x.return=v,v=x):(r(v,x),x=Tg(b,v.mode,_),x.return=v,v=x),a(v)):r(v,x)}return g}var vu=xC(!0),wC=xC(!1),qd={},ea=nl(qd),yd=nl(qd),xd=nl(qd);function wl(e){if(e===qd)throw Error(Se(174));return e}function ow(e,t){switch($t(xd,t),$t(yd,e),$t(ea,qd),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:A1(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=A1(t,e)}ir(ea),$t(ea,t)}function yu(){ir(ea),ir(yd),ir(xd)}function bC(e){wl(xd.current);var t=wl(ea.current),r=A1(t,e.type);t!==r&&($t(yd,e),$t(ea,r))}function lw(e){yd.current===e&&(ir(ea),ir(yd))}var hr=nl(0);function y0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Sg=[];function hw(){for(var e=0;e<Sg.length;e++)Sg[e]._workInProgressVersionPrimary=null;Sg.length=0}var Ip=ro.ReactCurrentDispatcher,Mg=ro.ReactCurrentBatchConfig,Nl=0,cr=null,zr=null,Wr=null,x0=!1,Vc=!1,wd=0,aR=0;function hi(){throw Error(Se(321))}function uw(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!fs(e[r],t[r]))return!1;return!0}function cw(e,t,r,i,n,s){if(Nl=s,cr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ip.current=e===null||e.memoizedState===null?uR:cR,e=r(i,n),Vc){s=0;do{if(Vc=!1,wd=0,25<=s)throw Error(Se(301));s+=1,Wr=zr=null,t.updateQueue=null,Ip.current=dR,e=r(i,n)}while(Vc)}if(Ip.current=w0,t=zr!==null&&zr.next!==null,Nl=0,Wr=zr=cr=null,x0=!1,t)throw Error(Se(300));return e}function dw(){var e=wd!==0;return wd=0,e}function Ps(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wr===null?cr.memoizedState=Wr=e:Wr=Wr.next=e,Wr}function Un(){if(zr===null){var e=cr.alternate;e=e!==null?e.memoizedState:null}else e=zr.next;var t=Wr===null?cr.memoizedState:Wr.next;if(t!==null)Wr=t,zr=e;else{if(e===null)throw Error(Se(310));zr=e,e={memoizedState:zr.memoizedState,baseState:zr.baseState,baseQueue:zr.baseQueue,queue:zr.queue,next:null},Wr===null?cr.memoizedState=Wr=e:Wr=Wr.next=e}return Wr}function bd(e,t){return typeof t=="function"?t(e):t}function Ag(e){var t=Un(),r=t.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=e;var i=zr,n=i.baseQueue,s=r.pending;if(s!==null){if(n!==null){var a=n.next;n.next=s.next,s.next=a}i.baseQueue=n=s,r.pending=null}if(n!==null){s=n.next,i=i.baseState;var o=a=null,l=null,h=s;do{var u=h.lane;if((Nl&u)===u)l!==null&&(l=l.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),i=h.hasEagerState?h.eagerState:e(i,h.action);else{var c={lane:u,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};l===null?(o=l=c,a=i):l=l.next=c,cr.lanes|=u,Bl|=u}h=h.next}while(h!==null&&h!==s);l===null?a=i:l.next=o,fs(i,t.memoizedState)||(Qi=!0),t.memoizedState=i,t.baseState=a,t.baseQueue=l,r.lastRenderedState=i}if(e=r.interleaved,e!==null){n=e;do s=n.lane,cr.lanes|=s,Bl|=s,n=n.next;while(n!==e)}else n===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Eg(e){var t=Un(),r=t.queue;if(r===null)throw Error(Se(311));r.lastRenderedReducer=e;var i=r.dispatch,n=r.pending,s=t.memoizedState;if(n!==null){r.pending=null;var a=n=n.next;do s=e(s,a.action),a=a.next;while(a!==n);fs(s,t.memoizedState)||(Qi=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,i]}function _C(){}function SC(e,t){var r=cr,i=Un(),n=t(),s=!fs(i.memoizedState,n);if(s&&(i.memoizedState=n,Qi=!0),i=i.queue,fw(EC.bind(null,r,i,e),[e]),i.getSnapshot!==t||s||Wr!==null&&Wr.memoizedState.tag&1){if(r.flags|=2048,_d(9,AC.bind(null,r,i,n,t),void 0,null),Hr===null)throw Error(Se(349));(Nl&30)!==0||MC(r,t,n)}return n}function MC(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=cr.updateQueue,t===null?(t={lastEffect:null,stores:null},cr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function AC(e,t,r,i){t.value=r,t.getSnapshot=i,CC(t)&&zn(e,1,-1)}function EC(e,t,r){return r(function(){CC(t)&&zn(e,1,-1)})}function CC(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!fs(e,r)}catch{return!0}}function V2(e){var t=Ps();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bd,lastRenderedState:e},t.queue=e,e=e.dispatch=hR.bind(null,cr,e),[t.memoizedState,e]}function _d(e,t,r,i){return e={tag:e,create:t,destroy:r,deps:i,next:null},t=cr.updateQueue,t===null?(t={lastEffect:null,stores:null},cr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(i=r.next,r.next=e,e.next=i,t.lastEffect=e)),e}function TC(){return Un().memoizedState}function Np(e,t,r,i){var n=Ps();cr.flags|=e,n.memoizedState=_d(1|t,r,void 0,i===void 0?null:i)}function pm(e,t,r,i){var n=Un();i=i===void 0?null:i;var s=void 0;if(zr!==null){var a=zr.memoizedState;if(s=a.destroy,i!==null&&uw(i,a.deps)){n.memoizedState=_d(t,r,s,i);return}}cr.flags|=e,n.memoizedState=_d(1|t,r,s,i)}function j2(e,t){return Np(8390656,8,e,t)}function fw(e,t){return pm(2048,8,e,t)}function DC(e,t){return pm(4,2,e,t)}function PC(e,t){return pm(4,4,e,t)}function LC(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function RC(e,t,r){return r=r!=null?r.concat([e]):null,pm(4,4,LC.bind(null,t,e),r)}function pw(){}function OC(e,t){var r=Un();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&uw(t,i[1])?i[0]:(r.memoizedState=[e,t],e)}function IC(e,t){var r=Un();t=t===void 0?null:t;var i=r.memoizedState;return i!==null&&t!==null&&uw(t,i[1])?i[0]:(e=e(),r.memoizedState=[e,t],e)}function NC(e,t,r){return(Nl&21)===0?(e.baseState&&(e.baseState=!1,Qi=!0),e.memoizedState=r):(fs(r,t)||(r=H3(),cr.lanes|=r,Bl|=r,e.baseState=!0),t)}function oR(e,t){var r=Jt;Jt=r!==0&&4>r?r:4,e(!0);var i=Mg.transition;Mg.transition={};try{e(!1),t()}finally{Jt=r,Mg.transition=i}}function BC(){return Un().memoizedState}function lR(e,t,r){var i=Wo(e);r={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null},kC(e)?zC(t,r):(FC(e,t,r),r=Ri(),e=zn(e,i,r),e!==null&&UC(e,t,i))}function hR(e,t,r){var i=Wo(e),n={lane:i,action:r,hasEagerState:!1,eagerState:null,next:null};if(kC(e))zC(t,n);else{FC(e,t,n);var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,r);if(n.hasEagerState=!0,n.eagerState=o,fs(o,a))return}catch{}finally{}r=Ri(),e=zn(e,i,r),e!==null&&UC(e,t,i)}}function kC(e){var t=e.alternate;return e===cr||t!==null&&t===cr}function zC(e,t){Vc=x0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function FC(e,t,r){iT(e)?(e=t.interleaved,e===null?(r.next=r,ls===null?ls=[t]:ls.push(t)):(r.next=e.next,e.next=r),t.interleaved=r):(e=t.pending,e===null?r.next=r:(r.next=e.next,e.next=r),t.pending=r)}function UC(e,t,r){if((r&4194240)!==0){var i=t.lanes;i&=e.pendingLanes,r|=i,t.lanes=r,qx(e,r)}}var w0={readContext:Fn,useCallback:hi,useContext:hi,useEffect:hi,useImperativeHandle:hi,useInsertionEffect:hi,useLayoutEffect:hi,useMemo:hi,useReducer:hi,useRef:hi,useState:hi,useDebugValue:hi,useDeferredValue:hi,useTransition:hi,useMutableSource:hi,useSyncExternalStore:hi,useId:hi,unstable_isNewReconciler:!1},uR={readContext:Fn,useCallback:function(e,t){return Ps().memoizedState=[e,t===void 0?null:t],e},useContext:Fn,useEffect:j2,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Np(4194308,4,LC.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Np(4194308,4,e,t)},useInsertionEffect:function(e,t){return Np(4,2,e,t)},useMemo:function(e,t){var r=Ps();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var i=Ps();return t=r!==void 0?r(t):t,i.memoizedState=i.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},i.queue=e,e=e.dispatch=lR.bind(null,cr,e),[i.memoizedState,e]},useRef:function(e){var t=Ps();return e={current:e},t.memoizedState=e},useState:V2,useDebugValue:pw,useDeferredValue:function(e){return Ps().memoizedState=e},useTransition:function(){var e=V2(!1),t=e[0];return e=oR.bind(null,e[1]),Ps().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var i=cr,n=Ps();if(sr){if(r===void 0)throw Error(Se(407));r=r()}else{if(r=t(),Hr===null)throw Error(Se(349));(Nl&30)!==0||MC(i,t,r)}n.memoizedState=r;var s={value:r,getSnapshot:t};return n.queue=s,j2(EC.bind(null,i,s,e),[e]),i.flags|=2048,_d(9,AC.bind(null,i,s,r,t),void 0,null),r},useId:function(){var e=Ps(),t=Hr.identifierPrefix;if(sr){var r=za,i=ka;r=(i&~(1<<32-ds(i)-1)).toString(32)+r,t=":"+t+"R"+r,r=wd++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=aR++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},cR={readContext:Fn,useCallback:OC,useContext:Fn,useEffect:fw,useImperativeHandle:RC,useInsertionEffect:DC,useLayoutEffect:PC,useMemo:IC,useReducer:Ag,useRef:TC,useState:function(){return Ag(bd)},useDebugValue:pw,useDeferredValue:function(e){var t=Un();return NC(t,zr.memoizedState,e)},useTransition:function(){var e=Ag(bd)[0],t=Un().memoizedState;return[e,t]},useMutableSource:_C,useSyncExternalStore:SC,useId:BC,unstable_isNewReconciler:!1},dR={readContext:Fn,useCallback:OC,useContext:Fn,useEffect:fw,useImperativeHandle:RC,useInsertionEffect:DC,useLayoutEffect:PC,useMemo:IC,useReducer:Eg,useRef:TC,useState:function(){return Eg(bd)},useDebugValue:pw,useDeferredValue:function(e){var t=Un();return zr===null?t.memoizedState=e:NC(t,zr.memoizedState,e)},useTransition:function(){var e=Eg(bd)[0],t=Un().memoizedState;return[e,t]},useMutableSource:_C,useSyncExternalStore:SC,useId:BC,unstable_isNewReconciler:!1};function mw(e,t){try{var r="",i=t;do r+=U4(i),i=i.return;while(i);var n=r}catch(s){n=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:n}}function X1(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var fR=typeof WeakMap=="function"?WeakMap:Map;function HC(e,t,r){r=Ha(-1,r),r.tag=3,r.payload={element:null};var i=t.value;return r.callback=function(){_0||(_0=!0,iy=i),X1(e,t)},r}function GC(e,t,r){r=Ha(-1,r),r.tag=3;var i=e.type.getDerivedStateFromError;if(typeof i=="function"){var n=t.value;r.payload=function(){return i(n)},r.callback=function(){X1(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){X1(e,t),typeof i!="function"&&(jo===null?jo=new Set([this]):jo.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),r}function W2(e,t,r){var i=e.pingCache;if(i===null){i=e.pingCache=new fR;var n=new Set;i.set(t,n)}else n=i.get(t),n===void 0&&(n=new Set,i.set(t,n));n.has(r)||(n.add(r),e=ER.bind(null,e,t,r),t.then(e,e))}function q2(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Y2(e,t,r,i,n){return(e.mode&1)===0?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ha(-1,1),t.tag=2,Vo(r,t))),r.lanes|=1),e):(e.flags|=65536,e.lanes=n,e)}var VC,Q1,jC,WC;VC=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Q1=function(){};jC=function(e,t,r,i){var n=e.memoizedProps;if(n!==i){e=t.stateNode,wl(ea.current);var s=null;switch(r){case"input":n=b1(e,n),i=b1(e,i),s=[];break;case"select":n=dr({},n,{value:void 0}),i=dr({},i,{value:void 0}),s=[];break;case"textarea":n=M1(e,n),i=M1(e,i),s=[];break;default:typeof n.onClick!="function"&&typeof i.onClick=="function"&&(e.onclick=u0)}E1(r,i);var a;r=null;for(h in n)if(!i.hasOwnProperty(h)&&n.hasOwnProperty(h)&&n[h]!=null)if(h==="style"){var o=n[h];for(a in o)o.hasOwnProperty(a)&&(r||(r={}),r[a]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(od.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in i){var l=i[h];if(o=n!=null?n[h]:void 0,i.hasOwnProperty(h)&&l!==o&&(l!=null||o!=null))if(h==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(r||(r={}),r[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(r||(r={}),r[a]=l[a])}else r||(s||(s=[]),s.push(h,r)),r=l;else h==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(h,l)):h==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(h,""+l):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(od.hasOwnProperty(h)?(l!=null&&h==="onScroll"&&tr("scroll",e),s||o===l||(s=[])):(s=s||[]).push(h,l))}r&&(s=s||[]).push("style",r);var h=s;(t.updateQueue=h)&&(t.flags|=4)}};WC=function(e,t,r,i){r!==i&&(t.flags|=4)};function sc(e,t){if(!sr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var i=null;r!==null;)r.alternate!==null&&(i=r),r=r.sibling;i===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:i.sibling=null}}function ui(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,i=0;if(t)for(var n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags&14680064,i|=n.flags&14680064,n.return=e,n=n.sibling;else for(n=e.child;n!==null;)r|=n.lanes|n.childLanes,i|=n.subtreeFlags,i|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=i,e.childLanes=r,t}function pR(e,t,r){var i=t.pendingProps;switch(sw(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ui(t),null;case 1:return $i(t.type)&&c0(),ui(t),null;case 3:return i=t.stateNode,yu(),ir(Zi),ir(_i),hw(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(e===null||e.child===null)&&(ic(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,ss!==null&&(ay(ss),ss=null))),Q1(e,t),ui(t),null;case 5:lw(t);var n=wl(xd.current);if(r=t.type,e!==null&&t.stateNode!=null)jC(e,t,r,i,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!i){if(t.stateNode===null)throw Error(Se(166));return ui(t),null}if(e=wl(ea.current),ic(t)){i=t.stateNode,r=t.type;var s=t.memoizedProps;switch(i[Fs]=t,i[vd]=s,e=(t.mode&1)!==0,r){case"dialog":tr("cancel",i),tr("close",i);break;case"iframe":case"object":case"embed":tr("load",i);break;case"video":case"audio":for(n=0;n<Cc.length;n++)tr(Cc[n],i);break;case"source":tr("error",i);break;case"img":case"image":case"link":tr("error",i),tr("load",i);break;case"details":tr("toggle",i);break;case"input":o2(i,s),tr("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},tr("invalid",i);break;case"textarea":h2(i,s),tr("invalid",i)}E1(r,s),n=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?i.textContent!==o&&(s.suppressHydrationWarning!==!0&&_f(i.textContent,o,e),n=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&_f(i.textContent,o,e),n=["children",""+o]):od.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&tr("scroll",i)}switch(r){case"input":pf(i),l2(i,s,!0);break;case"textarea":pf(i),u2(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=u0)}i=n,t.updateQueue=i,i!==null&&(t.flags|=4)}else{a=n.nodeType===9?n:n.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=E3(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof i.is=="string"?e=a.createElement(r,{is:i.is}):(e=a.createElement(r),r==="select"&&(a=e,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):e=a.createElementNS(e,r),e[Fs]=t,e[vd]=i,VC(e,t,!1,!1),t.stateNode=e;e:{switch(a=C1(r,i),r){case"dialog":tr("cancel",e),tr("close",e),n=i;break;case"iframe":case"object":case"embed":tr("load",e),n=i;break;case"video":case"audio":for(n=0;n<Cc.length;n++)tr(Cc[n],e);n=i;break;case"source":tr("error",e),n=i;break;case"img":case"image":case"link":tr("error",e),tr("load",e),n=i;break;case"details":tr("toggle",e),n=i;break;case"input":o2(e,i),n=b1(e,i),tr("invalid",e);break;case"option":n=i;break;case"select":e._wrapperState={wasMultiple:!!i.multiple},n=dr({},i,{value:void 0}),tr("invalid",e);break;case"textarea":h2(e,i),n=M1(e,i),tr("invalid",e);break;default:n=i}E1(r,n),o=n;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?D3(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&C3(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ld(e,l):typeof l=="number"&&ld(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(od.hasOwnProperty(s)?l!=null&&s==="onScroll"&&tr("scroll",e):l!=null&&Ux(e,s,l,a))}switch(r){case"input":pf(e),l2(e,i,!1);break;case"textarea":pf(e),u2(e);break;case"option":i.value!=null&&e.setAttribute("value",""+Qo(i.value));break;case"select":e.multiple=!!i.multiple,s=i.value,s!=null?$h(e,!!i.multiple,s,!1):i.defaultValue!=null&&$h(e,!!i.multiple,i.defaultValue,!0);break;default:typeof n.onClick=="function"&&(e.onclick=u0)}switch(r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ui(t),null;case 6:if(e&&t.stateNode!=null)WC(e,t,e.memoizedProps,i);else{if(typeof i!="string"&&t.stateNode===null)throw Error(Se(166));if(r=wl(xd.current),wl(ea.current),ic(t)){if(i=t.stateNode,r=t.memoizedProps,i[Fs]=t,(s=i.nodeValue!==r)&&(e=gn,e!==null))switch(e.tag){case 3:_f(i.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&_f(i.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else i=(r.nodeType===9?r:r.ownerDocument).createTextNode(i),i[Fs]=t,t.stateNode=i}return ui(t),null;case 13:if(ir(hr),i=t.memoizedState,sr&&ji!==null&&(t.mode&1)!==0&&(t.flags&128)===0){for(i=ji;i;)i=Ba(i.nextSibling);return gu(),t.flags|=98560,t}if(i!==null&&i.dehydrated!==null){if(i=ic(t),e===null){if(!i)throw Error(Se(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Se(317));i[Fs]=t}else gu(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;return ui(t),null}return ss!==null&&(ay(ss),ss=null),(t.flags&128)!==0?(t.lanes=r,t):(i=i!==null,r=!1,e===null?ic(t):r=e.memoizedState!==null,i!==r&&i&&(t.child.flags|=8192,(t.mode&1)!==0&&(e===null||(hr.current&1)!==0?Ur===0&&(Ur=3):bw())),t.updateQueue!==null&&(t.flags|=4),ui(t),null);case 4:return yu(),Q1(e,t),e===null&&md(t.stateNode.containerInfo),ui(t),null;case 10:return rw(t.type._context),ui(t),null;case 17:return $i(t.type)&&c0(),ui(t),null;case 19:if(ir(hr),s=t.memoizedState,s===null)return ui(t),null;if(i=(t.flags&128)!==0,a=s.rendering,a===null)if(i)sc(s,!1);else{if(Ur!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(a=y0(e),a!==null){for(t.flags|=128,sc(s,!1),i=a.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),t.subtreeFlags=0,i=r,r=t.child;r!==null;)s=r,e=i,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return $t(hr,hr.current&1|2),t.child}e=e.sibling}s.tail!==null&&Sr()>xu&&(t.flags|=128,i=!0,sc(s,!1),t.lanes=4194304)}else{if(!i)if(e=y0(a),e!==null){if(t.flags|=128,i=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),sc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!sr)return ui(t),null}else 2*Sr()-s.renderingStartTime>xu&&r!==1073741824&&(t.flags|=128,i=!0,sc(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(r=s.last,r!==null?r.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Sr(),t.sibling=null,r=hr.current,$t(hr,i?r&1|2:r&1),t):(ui(t),null);case 22:case 23:return ww(),i=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==i&&(t.flags|=8192),i&&(t.mode&1)!==0?(ln&1073741824)!==0&&(ui(t),t.subtreeFlags&6&&(t.flags|=8192)):ui(t),null;case 24:return null;case 25:return null}throw Error(Se(156,t.tag))}var mR=ro.ReactCurrentOwner,Qi=!1;function Ci(e,t,r,i){t.child=e===null?wC(t,null,r,i):vu(t,e.child,r,i)}function X2(e,t,r,i,n){r=r.render;var s=t.ref;return iu(t,n),i=cw(e,t,r,i,s,n),r=dw(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Xa(e,t,n)):(sr&&r&&nw(t),t.flags|=1,Ci(e,t,i,n),t.child)}function Q2(e,t,r,i,n){if(e===null){var s=r.type;return typeof s=="function"&&!_w(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,qC(e,t,s,i,n)):(e=zp(r.type,null,i,t,t.mode,n),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,(e.lanes&n)===0){var a=s.memoizedProps;if(r=r.compare,r=r!==null?r:pd,r(a,i)&&e.ref===t.ref)return Xa(e,t,n)}return t.flags|=1,e=Ko(s,i),e.ref=t.ref,e.return=t,t.child=e}function qC(e,t,r,i,n){if(e!==null){var s=e.memoizedProps;if(pd(s,i)&&e.ref===t.ref)if(Qi=!1,t.pendingProps=i=s,(e.lanes&n)!==0)(e.flags&131072)!==0&&(Qi=!0);else return t.lanes=e.lanes,Xa(e,t,n)}return J1(e,t,r,i,n)}function YC(e,t,r){var i=t.pendingProps,n=i.children,s=e!==null?e.memoizedState:null;if(i.mode==="hidden")if((t.mode&1)===0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},$t(jh,ln),ln|=r;else if((r&1073741824)!==0)t.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:r,$t(jh,ln),ln|=i;else return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,$t(jh,ln),ln|=e,null;else s!==null?(i=s.baseLanes|r,t.memoizedState=null):i=r,$t(jh,ln),ln|=i;return Ci(e,t,n,r),t.child}function XC(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function J1(e,t,r,i,n){var s=$i(r)?Ol:_i.current;return s=mu(t,s),iu(t,n),r=cw(e,t,r,i,s,n),i=dw(),e!==null&&!Qi?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Xa(e,t,n)):(sr&&i&&nw(t),t.flags|=1,Ci(e,t,r,n),t.child)}function J2(e,t,r,i,n){if($i(r)){var s=!0;d0(t)}else s=!1;if(iu(t,n),t.stateNode===null)e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),gC(t,r,i),W1(t,r,i,n),i=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,h=r.contextType;typeof h=="object"&&h!==null?h=Fn(h):(h=$i(r)?Ol:_i.current,h=mu(t,h));var u=r.getDerivedStateFromProps,c=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";c||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==i||l!==h)&&F2(t,a,i,h),Ao=!1;var d=t.memoizedState;a.state=d,m0(t,i,a,n),l=t.memoizedState,o!==i||d!==l||Zi.current||Ao?(typeof u=="function"&&(j1(t,r,u,i),l=t.memoizedState),(o=Ao||z2(t,r,o,i,d,l,h))?(c||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),a.props=i,a.state=l,a.context=h,i=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),i=!1)}else{a=t.stateNode,pC(e,t),o=t.memoizedProps,h=t.type===t.elementType?o:rs(t.type,o),a.props=h,c=t.pendingProps,d=a.context,l=r.contextType,typeof l=="object"&&l!==null?l=Fn(l):(l=$i(r)?Ol:_i.current,l=mu(t,l));var f=r.getDerivedStateFromProps;(u=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==c||d!==l)&&F2(t,a,i,l),Ao=!1,d=t.memoizedState,a.state=d,m0(t,i,a,n);var p=t.memoizedState;o!==c||d!==p||Zi.current||Ao?(typeof f=="function"&&(j1(t,r,f,i),p=t.memoizedState),(h=Ao||z2(t,r,h,i,d,p,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,p,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,p,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),a.props=i,a.state=p,a.context=l,i=h):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),i=!1)}return K1(e,t,r,i,s,n)}function K1(e,t,r,i,n,s){XC(e,t);var a=(t.flags&128)!==0;if(!i&&!a)return n&&N2(t,r,!1),Xa(e,t,s);i=t.stateNode,mR.current=t;var o=a&&typeof r.getDerivedStateFromError!="function"?null:i.render();return t.flags|=1,e!==null&&a?(t.child=vu(t,e.child,null,s),t.child=vu(t,null,o,s)):Ci(e,t,o,s),t.memoizedState=i.state,n&&N2(t,r,!0),t.child}function QC(e){var t=e.stateNode;t.pendingContext?I2(e,t.pendingContext,t.pendingContext!==t.context):t.context&&I2(e,t.context,!1),ow(e,t.containerInfo)}function K2(e,t,r,i,n){return gu(),aw(n),t.flags|=256,Ci(e,t,r,i),t.child}var Mf={dehydrated:null,treeContext:null,retryLane:0};function Af(e){return{baseLanes:e,cachePool:null,transitions:null}}function Z2(e,t){return{baseLanes:e.baseLanes|t,cachePool:null,transitions:e.transitions}}function JC(e,t,r){var i=t.pendingProps,n=hr.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(n&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(n|=1),$t(hr,n&1),e===null)return Y1(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((t.mode&1)===0?t.lanes=1:e.data==="$!"?t.lanes=8:t.lanes=1073741824,null):(n=i.children,e=i.fallback,s?(i=t.mode,s=t.child,n={mode:"hidden",children:n},(i&1)===0&&s!==null?(s.childLanes=0,s.pendingProps=n):s=A0(n,i,0,null),e=Al(e,i,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Af(r),t.memoizedState=Mf,e):Z1(t,n));if(n=e.memoizedState,n!==null){if(o=n.dehydrated,o!==null){if(a)return t.flags&256?(t.flags&=-257,Ef(e,t,r,Error(Se(422)))):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=i.fallback,n=t.mode,i=A0({mode:"visible",children:i.children},n,0,null),s=Al(s,n,r,null),s.flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,(t.mode&1)!==0&&vu(t,e.child,null,r),t.child.memoizedState=Af(r),t.memoizedState=Mf,s);if((t.mode&1)===0)t=Ef(e,t,r,null);else if(o.data==="$!")t=Ef(e,t,r,Error(Se(419)));else if(i=(r&e.childLanes)!==0,Qi||i){if(i=Hr,i!==null){switch(r&-r){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}i=(s&(i.suspendedLanes|r))!==0?0:s,i!==0&&i!==n.retryLane&&(n.retryLane=i,zn(e,i,-1))}bw(),t=Ef(e,t,r,Error(Se(421)))}else o.data==="$?"?(t.flags|=128,t.child=e.child,t=CR.bind(null,e),o._reactRetry=t,t=null):(r=n.treeContext,ji=Ba(o.nextSibling),gn=t,sr=!0,ss=null,r!==null&&(In[Nn++]=ka,In[Nn++]=za,In[Nn++]=Il,ka=r.id,za=r.overflow,Il=t),t=Z1(t,t.pendingProps.children),t.flags|=4096);return t}return s?(i=e_(e,t,i.children,i.fallback,r),s=t.child,n=e.child.memoizedState,s.memoizedState=n===null?Af(r):Z2(n,r),s.childLanes=e.childLanes&~r,t.memoizedState=Mf,i):(r=$2(e,t,i.children,r),t.memoizedState=null,r)}return s?(i=e_(e,t,i.children,i.fallback,r),s=t.child,n=e.child.memoizedState,s.memoizedState=n===null?Af(r):Z2(n,r),s.childLanes=e.childLanes&~r,t.memoizedState=Mf,i):(r=$2(e,t,i.children,r),t.memoizedState=null,r)}function Z1(e,t){return t=A0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function $2(e,t,r,i){var n=e.child;return e=n.sibling,r=Ko(n,{mode:"visible",children:r}),(t.mode&1)===0&&(r.lanes=i),r.return=t,r.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=r}function e_(e,t,r,i,n){var s=t.mode;e=e.child;var a=e.sibling,o={mode:"hidden",children:r};return(s&1)===0&&t.child!==e?(r=t.child,r.childLanes=0,r.pendingProps=o,t.deletions=null):(r=Ko(e,o),r.subtreeFlags=e.subtreeFlags&14680064),a!==null?i=Ko(a,i):(i=Al(i,s,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,i}function Ef(e,t,r,i){return i!==null&&aw(i),vu(t,e.child,null,r),e=Z1(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function t_(e,t,r){e.lanes|=t;var i=e.alternate;i!==null&&(i.lanes|=t),V1(e.return,t,r)}function Cg(e,t,r,i,n){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:r,tailMode:n}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=r,s.tailMode=n)}function KC(e,t,r){var i=t.pendingProps,n=i.revealOrder,s=i.tail;if(Ci(e,t,i.children,r),i=hr.current,(i&2)!==0)i=i&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&t_(e,r,t);else if(e.tag===19)t_(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}i&=1}if($t(hr,i),(t.mode&1)===0)t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;r!==null;)e=r.alternate,e!==null&&y0(e)===null&&(n=r),r=r.sibling;r=n,r===null?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),Cg(t,!1,n,r,s);break;case"backwards":for(r=null,n=t.child,t.child=null;n!==null;){if(e=n.alternate,e!==null&&y0(e)===null){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}Cg(t,!0,r,null,s);break;case"together":Cg(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Xa(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Bl|=t.lanes,(r&t.childLanes)===0)return null;if(e!==null&&t.child!==e.child)throw Error(Se(153));if(t.child!==null){for(e=t.child,r=Ko(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ko(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function gR(e,t,r){switch(t.tag){case 3:QC(t),gu();break;case 5:bC(t);break;case 1:$i(t.type)&&d0(t);break;case 4:ow(t,t.stateNode.containerInfo);break;case 10:var i=t.type._context,n=t.memoizedProps.value;$t(f0,i._currentValue),i._currentValue=n;break;case 13:if(i=t.memoizedState,i!==null)return i.dehydrated!==null?($t(hr,hr.current&1),t.flags|=128,null):(r&t.child.childLanes)!==0?JC(e,t,r):($t(hr,hr.current&1),e=Xa(e,t,r),e!==null?e.sibling:null);$t(hr,hr.current&1);break;case 19:if(i=(r&t.childLanes)!==0,(e.flags&128)!==0){if(i)return KC(e,t,r);t.flags|=128}if(n=t.memoizedState,n!==null&&(n.rendering=null,n.tail=null,n.lastEffect=null),$t(hr,hr.current),i)break;return null;case 22:case 23:return t.lanes=0,YC(e,t,r)}return Xa(e,t,r)}function vR(e,t){switch(sw(t),t.tag){case 1:return $i(t.type)&&c0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return yu(),ir(Zi),ir(_i),hw(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 5:return lw(t),null;case 13:if(ir(hr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Se(340));gu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ir(hr),null;case 4:return yu(),null;case 10:return rw(t.type._context),null;case 22:case 23:return ww(),null;case 24:return null;default:return null}}var Cf=!1,pi=!1,yR=typeof WeakSet=="function"?WeakSet:Set,Ye=null;function Vh(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(i){gr(e,t,i)}else r.current=null}function $1(e,t,r){try{r()}catch(i){gr(e,t,i)}}var r_=!1;function xR(e,t){if(k1=o0,e=iC(),$x(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var i=r.getSelection&&r.getSelection();if(i&&i.rangeCount!==0){r=i.anchorNode;var n=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var a=0,o=-1,l=-1,h=0,u=0,c=e,d=null;t:for(;;){for(var f;c!==r||n!==0&&c.nodeType!==3||(o=a+n),c!==s||i!==0&&c.nodeType!==3||(l=a+i),c.nodeType===3&&(a+=c.nodeValue.length),(f=c.firstChild)!==null;)d=c,c=f;for(;;){if(c===e)break t;if(d===r&&++h===n&&(o=a),d===s&&++u===i&&(l=a),(f=c.nextSibling)!==null)break;c=d,d=c.parentNode}c=f}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(z1={focusedElem:e,selectionRange:r},o0=!1,Ye=t;Ye!==null;)if(t=Ye,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ye=e;else for(;Ye!==null;){t=Ye;try{var p=t.alternate;if((t.flags&1024)!==0)switch(t.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,g=p.memoizedState,v=t.stateNode,x=v.getSnapshotBeforeUpdate(t.elementType===t.type?m:rs(t.type,m),g);v.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=t.stateNode.containerInfo;if(b.nodeType===1)b.textContent="";else if(b.nodeType===9){var _=b.body;_!=null&&(_.textContent="")}break;case 5:case 6:case 4:case 17:break;default:throw Error(Se(163))}}catch(E){gr(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,Ye=e;break}Ye=t.return}return p=r_,r_=!1,p}function jc(e,t,r){var i=t.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var n=i=i.next;do{if((n.tag&e)===e){var s=n.destroy;n.destroy=void 0,s!==void 0&&$1(t,r,s)}n=n.next}while(n!==i)}}function mm(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var i=r.create;r.destroy=i()}r=r.next}while(r!==t)}}function ey(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function ZC(e){var t=e.alternate;t!==null&&(e.alternate=null,ZC(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fs],delete t[vd],delete t[H1],delete t[rR],delete t[iR])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function $C(e){return e.tag===5||e.tag===3||e.tag===4}function i_(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||$C(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ty(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=u0));else if(i!==4&&(e=e.child,e!==null))for(ty(e,t,r),e=e.sibling;e!==null;)ty(e,t,r),e=e.sibling}function ry(e,t,r){var i=e.tag;if(i===5||i===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(i!==4&&(e=e.child,e!==null))for(ry(e,t,r),e=e.sibling;e!==null;)ry(e,t,r),e=e.sibling}var $r=null,ns=!1;function lo(e,t,r){for(r=r.child;r!==null;)eT(e,t,r),r=r.sibling}function eT(e,t,r){if($s&&typeof $s.onCommitFiberUnmount=="function")try{$s.onCommitFiberUnmount(om,r)}catch{}switch(r.tag){case 5:pi||Vh(r,t);case 6:var i=$r,n=ns;$r=null,lo(e,t,r),$r=i,ns=n,$r!==null&&(ns?(e=$r,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):$r.removeChild(r.stateNode));break;case 18:$r!==null&&(ns?(e=$r,r=r.stateNode,e.nodeType===8?bg(e.parentNode,r):e.nodeType===1&&bg(e,r),dd(e)):bg($r,r.stateNode));break;case 4:i=$r,n=ns,$r=r.stateNode.containerInfo,ns=!0,lo(e,t,r),$r=i,ns=n;break;case 0:case 11:case 14:case 15:if(!pi&&(i=r.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){n=i=i.next;do{var s=n,a=s.destroy;s=s.tag,a!==void 0&&((s&2)!==0||(s&4)!==0)&&$1(r,t,a),n=n.next}while(n!==i)}lo(e,t,r);break;case 1:if(!pi&&(Vh(r,t),i=r.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=r.memoizedProps,i.state=r.memoizedState,i.componentWillUnmount()}catch(o){gr(r,t,o)}lo(e,t,r);break;case 21:lo(e,t,r);break;case 22:r.mode&1?(pi=(i=pi)||r.memoizedState!==null,lo(e,t,r),pi=i):lo(e,t,r);break;default:lo(e,t,r)}}function n_(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new yR),t.forEach(function(i){var n=TR.bind(null,e,i);r.has(i)||(r.add(i),i.then(n,n))})}}function Wn(e,t){var r=t.deletions;if(r!==null)for(var i=0;i<r.length;i++){var n=r[i];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:$r=o.stateNode,ns=!1;break e;case 3:$r=o.stateNode.containerInfo,ns=!0;break e;case 4:$r=o.stateNode.containerInfo,ns=!0;break e}o=o.return}if($r===null)throw Error(Se(160));eT(s,a,n),$r=null,ns=!1;var l=n.alternate;l!==null&&(l.return=null),n.return=null}catch(h){gr(n,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)tT(t,e),t=t.sibling}function tT(e,t){var r=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Wn(t,e),bs(e),i&4){try{jc(3,e,e.return),mm(3,e)}catch(p){gr(e,e.return,p)}try{jc(5,e,e.return)}catch(p){gr(e,e.return,p)}}break;case 1:Wn(t,e),bs(e),i&512&&r!==null&&Vh(r,r.return);break;case 5:if(Wn(t,e),bs(e),i&512&&r!==null&&Vh(r,r.return),e.flags&32){var n=e.stateNode;try{ld(n,"")}catch(p){gr(e,e.return,p)}}if(i&4&&(n=e.stateNode,n!=null)){var s=e.memoizedProps,a=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&M3(n,s),C1(o,a);var h=C1(o,s);for(a=0;a<l.length;a+=2){var u=l[a],c=l[a+1];u==="style"?D3(n,c):u==="dangerouslySetInnerHTML"?C3(n,c):u==="children"?ld(n,c):Ux(n,u,c,h)}switch(o){case"input":_1(n,s);break;case"textarea":A3(n,s);break;case"select":var d=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?$h(n,!!s.multiple,f,!1):d!==!!s.multiple&&(s.defaultValue!=null?$h(n,!!s.multiple,s.defaultValue,!0):$h(n,!!s.multiple,s.multiple?[]:"",!1))}n[vd]=s}catch(p){gr(e,e.return,p)}}break;case 6:if(Wn(t,e),bs(e),i&4){if(e.stateNode===null)throw Error(Se(162));h=e.stateNode,u=e.memoizedProps;try{h.nodeValue=u}catch(p){gr(e,e.return,p)}}break;case 3:if(Wn(t,e),bs(e),i&4&&r!==null&&r.memoizedState.isDehydrated)try{dd(t.containerInfo)}catch(p){gr(e,e.return,p)}break;case 4:Wn(t,e),bs(e);break;case 13:Wn(t,e),bs(e),h=e.child,h.flags&8192&&h.memoizedState!==null&&(h.alternate===null||h.alternate.memoizedState===null)&&(yw=Sr()),i&4&&n_(e);break;case 22:if(h=r!==null&&r.memoizedState!==null,e.mode&1?(pi=(u=pi)||h,Wn(t,e),pi=u):Wn(t,e),bs(e),i&8192){u=e.memoizedState!==null;e:for(c=null,d=e;;){if(d.tag===5){if(c===null){c=d;try{n=d.stateNode,u?(s=n.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=T3("display",a))}catch(p){gr(e,e.return,p)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(p){gr(e,e.return,p)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}if(u&&!h&&(e.mode&1)!==0)for(Ye=e,e=e.child;e!==null;){for(h=Ye=e;Ye!==null;){switch(u=Ye,c=u.child,u.tag){case 0:case 11:case 14:case 15:jc(4,u,u.return);break;case 1:if(Vh(u,u.return),s=u.stateNode,typeof s.componentWillUnmount=="function"){d=u,f=u.return;try{n=d,s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(p){gr(d,f,p)}}break;case 5:Vh(u,u.return);break;case 22:if(u.memoizedState!==null){a_(h);continue}}c!==null?(c.return=u,Ye=c):a_(h)}e=e.sibling}}break;case 19:Wn(t,e),bs(e),i&4&&n_(e);break;case 21:break;default:Wn(t,e),bs(e)}}function bs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if($C(r)){var i=r;break e}r=r.return}throw Error(Se(160))}switch(i.tag){case 5:var n=i.stateNode;i.flags&32&&(ld(n,""),i.flags&=-33);var s=i_(e);ry(e,s,n);break;case 3:case 4:var a=i.stateNode.containerInfo,o=i_(e);ty(e,o,a);break;default:throw Error(Se(161))}}catch(l){gr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function wR(e,t,r){Ye=e,rT(e)}function rT(e,t,r){for(var i=(e.mode&1)!==0;Ye!==null;){var n=Ye,s=n.child;if(n.tag===22&&i){var a=n.memoizedState!==null||Cf;if(!a){var o=n.alternate,l=o!==null&&o.memoizedState!==null||pi;o=Cf;var h=pi;if(Cf=a,(pi=l)&&!h)for(Ye=n;Ye!==null;)a=Ye,l=a.child,a.tag===22&&a.memoizedState!==null?o_(n):l!==null?(l.return=a,Ye=l):o_(n);for(;s!==null;)Ye=s,rT(s),s=s.sibling;Ye=n,Cf=o,pi=h}s_(e)}else(n.subtreeFlags&8772)!==0&&s!==null?(s.return=n,Ye=s):s_(e)}}function s_(e){for(;Ye!==null;){var t=Ye;if((t.flags&8772)!==0){var r=t.alternate;try{if((t.flags&8772)!==0)switch(t.tag){case 0:case 11:case 15:pi||mm(5,t);break;case 1:var i=t.stateNode;if(t.flags&4&&!pi)if(r===null)i.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:rs(t.type,r.memoizedProps);i.componentDidUpdate(n,r.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&k2(t,s,i);break;case 3:var a=t.updateQueue;if(a!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}k2(t,a,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var u=h.memoizedState;if(u!==null){var c=u.dehydrated;c!==null&&dd(c)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(Se(163))}pi||t.flags&512&&ey(t)}catch(d){gr(t,t.return,d)}}if(t===e){Ye=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ye=r;break}Ye=t.return}}function a_(e){for(;Ye!==null;){var t=Ye;if(t===e){Ye=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ye=r;break}Ye=t.return}}function o_(e){for(;Ye!==null;){var t=Ye;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{mm(4,t)}catch(l){gr(t,r,l)}break;case 1:var i=t.stateNode;if(typeof i.componentDidMount=="function"){var n=t.return;try{i.componentDidMount()}catch(l){gr(t,n,l)}}var s=t.return;try{ey(t)}catch(l){gr(t,s,l)}break;case 5:var a=t.return;try{ey(t)}catch(l){gr(t,a,l)}}}catch(l){gr(t,t.return,l)}if(t===e){Ye=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ye=o;break}Ye=t.return}}var bR=Math.ceil,b0=ro.ReactCurrentDispatcher,gw=ro.ReactCurrentOwner,kn=ro.ReactCurrentBatchConfig,Ht=0,Hr=null,Lr=null,ri=0,ln=0,jh=nl(0),Ur=0,Sd=null,Bl=0,gm=0,vw=0,Wc=null,Vi=null,yw=0,xu=1/0,Pa=null,_0=!1,iy=null,jo=null,Tf=!1,Oo=null,S0=0,qc=0,ny=null,Bp=-1,kp=0;function Ri(){return(Ht&6)!==0?Sr():Bp!==-1?Bp:Bp=Sr()}function Wo(e){return(e.mode&1)===0?1:(Ht&2)!==0&&ri!==0?ri&-ri:sR.transition!==null?(kp===0&&(kp=H3()),kp):(e=Jt,e!==0||(e=window.event,e=e===void 0?16:X3(e.type)),e)}function zn(e,t,r){if(50<qc)throw qc=0,ny=null,Error(Se(185));var i=vm(e,t);return i===null?null:(Vd(i,t,r),((Ht&2)===0||i!==Hr)&&(i===Hr&&((Ht&2)===0&&(gm|=t),Ur===4&&Do(i,ri)),en(i,r),t===1&&Ht===0&&(e.mode&1)===0&&(xu=Sr()+500,dm&&sl())),i)}function vm(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}function iT(e){return(Hr!==null||ls!==null)&&(e.mode&1)!==0&&(Ht&2)===0}function en(e,t){var r=e.callbackNode;sL(e,t);var i=a0(e,e===Hr?ri:0);if(i===0)r!==null&&f2(r),e.callbackNode=null,e.callbackPriority=0;else if(t=i&-i,e.callbackPriority!==t){if(r!=null&&f2(r),t===1)e.tag===0?nR(l_.bind(null,e)):fC(l_.bind(null,e)),eR(function(){Ht===0&&sl()}),r=null;else{switch(G3(i)){case 1:r=Wx;break;case 4:r=F3;break;case 16:r=s0;break;case 536870912:r=U3;break;default:r=s0}r=cT(r,nT.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function nT(e,t){if(Bp=-1,kp=0,(Ht&6)!==0)throw Error(Se(327));var r=e.callbackNode;if(nu()&&e.callbackNode!==r)return null;var i=a0(e,e===Hr?ri:0);if(i===0)return null;if((i&30)!==0||(i&e.expiredLanes)!==0||t)t=M0(e,i);else{t=i;var n=Ht;Ht|=2;var s=aT();(Hr!==e||ri!==t)&&(Pa=null,xu=Sr()+500,Ml(e,t));do try{MR();break}catch(o){sT(e,o)}while(1);tw(),b0.current=s,Ht=n,Lr!==null?t=0:(Hr=null,ri=0,t=Ur)}if(t!==0){if(t===2&&(n=R1(e),n!==0&&(i=n,t=sy(e,n))),t===1)throw r=Sd,Ml(e,0),Do(e,i),en(e,Sr()),r;if(t===6)Do(e,i);else{if(n=e.current.alternate,(i&30)===0&&!_R(n)&&(t=M0(e,i),t===2&&(s=R1(e),s!==0&&(i=s,t=sy(e,s))),t===1))throw r=Sd,Ml(e,0),Do(e,i),en(e,Sr()),r;switch(e.finishedWork=n,e.finishedLanes=i,t){case 0:case 1:throw Error(Se(345));case 2:ml(e,Vi,Pa);break;case 3:if(Do(e,i),(i&130023424)===i&&(t=yw+500-Sr(),10<t)){if(a0(e,0)!==0)break;if(n=e.suspendedLanes,(n&i)!==i){Ri(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=U1(ml.bind(null,e,Vi,Pa),t);break}ml(e,Vi,Pa);break;case 4:if(Do(e,i),(i&4194240)===i)break;for(t=e.eventTimes,n=-1;0<i;){var a=31-ds(i);s=1<<a,a=t[a],a>n&&(n=a),i&=~s}if(i=n,i=Sr()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*bR(i/1960))-i,10<i){e.timeoutHandle=U1(ml.bind(null,e,Vi,Pa),i);break}ml(e,Vi,Pa);break;case 5:ml(e,Vi,Pa);break;default:throw Error(Se(329))}}}return en(e,Sr()),e.callbackNode===r?nT.bind(null,e):null}function sy(e,t){var r=Wc;return e.current.memoizedState.isDehydrated&&(Ml(e,t).flags|=256),e=M0(e,t),e!==2&&(t=Vi,Vi=r,t!==null&&ay(t)),e}function ay(e){Vi===null?Vi=e:Vi.push.apply(Vi,e)}function _R(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var i=0;i<r.length;i++){var n=r[i],s=n.getSnapshot;n=n.value;try{if(!fs(s(),n))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Do(e,t){for(t&=~vw,t&=~gm,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ds(t),i=1<<r;e[r]=-1,t&=~i}}function l_(e){if((Ht&6)!==0)throw Error(Se(327));nu();var t=a0(e,0);if((t&1)===0)return en(e,Sr()),null;var r=M0(e,t);if(e.tag!==0&&r===2){var i=R1(e);i!==0&&(t=i,r=sy(e,i))}if(r===1)throw r=Sd,Ml(e,0),Do(e,t),en(e,Sr()),r;if(r===6)throw Error(Se(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ml(e,Vi,Pa),en(e,Sr()),null}function xw(e,t){var r=Ht;Ht|=1;try{return e(t)}finally{Ht=r,Ht===0&&(xu=Sr()+500,dm&&sl())}}function kl(e){Oo!==null&&Oo.tag===0&&(Ht&6)===0&&nu();var t=Ht;Ht|=1;var r=kn.transition,i=Jt;try{if(kn.transition=null,Jt=1,e)return e()}finally{Jt=i,kn.transition=r,Ht=t,(Ht&6)===0&&sl()}}function ww(){ln=jh.current,ir(jh)}function Ml(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,$L(r)),Lr!==null)for(r=Lr.return;r!==null;){var i=r;switch(sw(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&c0();break;case 3:yu(),ir(Zi),ir(_i),hw();break;case 5:lw(i);break;case 4:yu();break;case 13:ir(hr);break;case 19:ir(hr);break;case 10:rw(i.type._context);break;case 22:case 23:ww()}r=r.return}if(Hr=e,Lr=e=Ko(e.current,null),ri=ln=t,Ur=0,Sd=null,vw=gm=Bl=0,Vi=Wc=null,ls!==null){for(t=0;t<ls.length;t++)if(r=ls[t],i=r.interleaved,i!==null){r.interleaved=null;var n=i.next,s=r.pending;if(s!==null){var a=s.next;s.next=n,i.next=a}r.pending=i}ls=null}return e}function sT(e,t){do{var r=Lr;try{if(tw(),Ip.current=w0,x0){for(var i=cr.memoizedState;i!==null;){var n=i.queue;n!==null&&(n.pending=null),i=i.next}x0=!1}if(Nl=0,Wr=zr=cr=null,Vc=!1,wd=0,gw.current=null,r===null||r.return===null){Ur=1,Sd=t,Lr=null;break}e:{var s=e,a=r.return,o=r,l=t;if(t=ri,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var h=l,u=o,c=u.tag;if((u.mode&1)===0&&(c===0||c===11||c===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=q2(a);if(f!==null){f.flags&=-257,Y2(f,a,o,s,t),f.mode&1&&W2(s,h,t),t=f,l=h;var p=t.updateQueue;if(p===null){var m=new Set;m.add(l),t.updateQueue=m}else p.add(l);break e}else{if((t&1)===0){W2(s,h,t),bw();break e}l=Error(Se(426))}}else if(sr&&o.mode&1){var g=q2(a);if(g!==null){(g.flags&65536)===0&&(g.flags|=256),Y2(g,a,o,s,t),aw(l);break e}}s=l,Ur!==4&&(Ur=2),Wc===null?Wc=[s]:Wc.push(s),l=mw(l,o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var v=HC(o,l,t);B2(o,v);break e;case 1:s=l;var x=o.type,b=o.stateNode;if((o.flags&128)===0&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(jo===null||!jo.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var _=GC(o,s,t);B2(o,_);break e}}o=o.return}while(o!==null)}lT(r)}catch(E){t=E,Lr===r&&r!==null&&(Lr=r=r.return);continue}break}while(1)}function aT(){var e=b0.current;return b0.current=w0,e===null?w0:e}function bw(){(Ur===0||Ur===3||Ur===2)&&(Ur=4),Hr===null||(Bl&268435455)===0&&(gm&268435455)===0||Do(Hr,ri)}function M0(e,t){var r=Ht;Ht|=2;var i=aT();(Hr!==e||ri!==t)&&(Pa=null,Ml(e,t));do try{SR();break}catch(n){sT(e,n)}while(1);if(tw(),Ht=r,b0.current=i,Lr!==null)throw Error(Se(261));return Hr=null,ri=0,Ur}function SR(){for(;Lr!==null;)oT(Lr)}function MR(){for(;Lr!==null&&!J4();)oT(Lr)}function oT(e){var t=uT(e.alternate,e,ln);e.memoizedProps=e.pendingProps,t===null?lT(e):Lr=t,gw.current=null}function lT(e){var t=e;do{var r=t.alternate;if(e=t.return,(t.flags&32768)===0){if(r=pR(r,t,ln),r!==null){Lr=r;return}}else{if(r=vR(r,t),r!==null){r.flags&=32767,Lr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ur=6,Lr=null;return}}if(t=t.sibling,t!==null){Lr=t;return}Lr=t=e}while(t!==null);Ur===0&&(Ur=5)}function ml(e,t,r){var i=Jt,n=kn.transition;try{kn.transition=null,Jt=1,AR(e,t,r,i)}finally{kn.transition=n,Jt=i}return null}function AR(e,t,r,i){do nu();while(Oo!==null);if((Ht&6)!==0)throw Error(Se(327));r=e.finishedWork;var n=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Se(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(aL(e,s),e===Hr&&(Lr=Hr=null,ri=0),(r.subtreeFlags&2064)===0&&(r.flags&2064)===0||Tf||(Tf=!0,cT(s0,function(){return nu(),null})),s=(r.flags&15990)!==0,(r.subtreeFlags&15990)!==0||s){s=kn.transition,kn.transition=null;var a=Jt;Jt=1;var o=Ht;Ht|=4,gw.current=null,xR(e,r),tT(r,e),qL(z1),o0=!!k1,z1=k1=null,e.current=r,wR(r),K4(),Ht=o,Jt=a,kn.transition=s}else e.current=r;if(Tf&&(Tf=!1,Oo=e,S0=n),s=e.pendingLanes,s===0&&(jo=null),eL(r.stateNode),en(e,Sr()),t!==null)for(i=e.onRecoverableError,r=0;r<t.length;r++)i(t[r]);if(_0)throw _0=!1,e=iy,iy=null,e;return(S0&1)!==0&&e.tag!==0&&nu(),s=e.pendingLanes,(s&1)!==0?e===ny?qc++:(qc=0,ny=e):qc=0,sl(),null}function nu(){if(Oo!==null){var e=G3(S0),t=kn.transition,r=Jt;try{if(kn.transition=null,Jt=16>e?16:e,Oo===null)var i=!1;else{if(e=Oo,Oo=null,S0=0,(Ht&6)!==0)throw Error(Se(331));var n=Ht;for(Ht|=4,Ye=e.current;Ye!==null;){var s=Ye,a=s.child;if((Ye.flags&16)!==0){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var h=o[l];for(Ye=h;Ye!==null;){var u=Ye;switch(u.tag){case 0:case 11:case 15:jc(8,u,s)}var c=u.child;if(c!==null)c.return=u,Ye=c;else for(;Ye!==null;){u=Ye;var d=u.sibling,f=u.return;if(ZC(u),u===h){Ye=null;break}if(d!==null){d.return=f,Ye=d;break}Ye=f}}}var p=s.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(m!==null)}}Ye=s}}if((s.subtreeFlags&2064)!==0&&a!==null)a.return=s,Ye=a;else e:for(;Ye!==null;){if(s=Ye,(s.flags&2048)!==0)switch(s.tag){case 0:case 11:case 15:jc(9,s,s.return)}var v=s.sibling;if(v!==null){v.return=s.return,Ye=v;break e}Ye=s.return}}var x=e.current;for(Ye=x;Ye!==null;){a=Ye;var b=a.child;if((a.subtreeFlags&2064)!==0&&b!==null)b.return=a,Ye=b;else e:for(a=x;Ye!==null;){if(o=Ye,(o.flags&2048)!==0)try{switch(o.tag){case 0:case 11:case 15:mm(9,o)}}catch(E){gr(o,o.return,E)}if(o===a){Ye=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,Ye=_;break e}Ye=o.return}}if(Ht=n,sl(),$s&&typeof $s.onPostCommitFiberRoot=="function")try{$s.onPostCommitFiberRoot(om,e)}catch{}i=!0}return i}finally{Jt=r,kn.transition=t}}return!1}function h_(e,t,r){t=mw(r,t),t=HC(e,t,1),Vo(e,t),t=Ri(),e=vm(e,1),e!==null&&(Vd(e,1,t),en(e,t))}function gr(e,t,r){if(e.tag===3)h_(e,e,r);else for(;t!==null;){if(t.tag===3){h_(t,e,r);break}else if(t.tag===1){var i=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(jo===null||!jo.has(i))){e=mw(r,e),e=GC(t,e,1),Vo(t,e),e=Ri(),t=vm(t,1),t!==null&&(Vd(t,1,e),en(t,e));break}}t=t.return}}function ER(e,t,r){var i=e.pingCache;i!==null&&i.delete(t),t=Ri(),e.pingedLanes|=e.suspendedLanes&r,Hr===e&&(ri&r)===r&&(Ur===4||Ur===3&&(ri&130023424)===ri&&500>Sr()-yw?Ml(e,0):vw|=r),en(e,t)}function hT(e,t){t===0&&((e.mode&1)===0?t=1:(t=vf,vf<<=1,(vf&130023424)===0&&(vf=4194304)));var r=Ri();e=vm(e,t),e!==null&&(Vd(e,t,r),en(e,r))}function CR(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),hT(e,r)}function TR(e,t){var r=0;switch(e.tag){case 13:var i=e.stateNode,n=e.memoizedState;n!==null&&(r=n.retryLane);break;case 19:i=e.stateNode;break;default:throw Error(Se(314))}i!==null&&i.delete(t),hT(e,r)}var uT;uT=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Zi.current)Qi=!0;else{if((e.lanes&r)===0&&(t.flags&128)===0)return Qi=!1,gR(e,t,r);Qi=(e.flags&131072)!==0}else Qi=!1,sr&&(t.flags&1048576)!==0&&vC(t,v0,t.index);switch(t.lanes=0,t.tag){case 2:var i=t.type;e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var n=mu(t,_i.current);iu(t,r),n=cw(null,t,i,e,n,r);var s=dw();return t.flags|=1,typeof n=="object"&&n!==null&&typeof n.render=="function"&&n.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,$i(i)?(s=!0,d0(t)):s=!1,t.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,iw(t),n.updater=fm,t.stateNode=n,n._reactInternals=t,W1(t,i,e,r),t=K1(null,t,i,!0,s,r)):(t.tag=0,sr&&s&&nw(t),Ci(null,t,n,r),t=t.child),t;case 16:i=t.elementType;e:{switch(e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,n=i._init,i=n(i._payload),t.type=i,n=t.tag=PR(i),e=rs(i,e),n){case 0:t=J1(null,t,i,e,r);break e;case 1:t=J2(null,t,i,e,r);break e;case 11:t=X2(null,t,i,e,r);break e;case 14:t=Q2(null,t,i,rs(i.type,e),r);break e}throw Error(Se(306,i,""))}return t;case 0:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:rs(i,n),J1(e,t,i,n,r);case 1:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:rs(i,n),J2(e,t,i,n,r);case 3:e:{if(QC(t),e===null)throw Error(Se(387));i=t.pendingProps,s=t.memoizedState,n=s.element,pC(e,t),m0(t,i,null,r);var a=t.memoizedState;if(i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){n=Error(Se(423)),t=K2(e,t,i,r,n);break e}else if(i!==n){n=Error(Se(424)),t=K2(e,t,i,r,n);break e}else for(ji=Ba(t.stateNode.containerInfo.firstChild),gn=t,sr=!0,ss=null,r=wC(t,null,i,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(gu(),i===n){t=Xa(e,t,r);break e}Ci(e,t,i,r)}t=t.child}return t;case 5:return bC(t),e===null&&Y1(t),i=t.type,n=t.pendingProps,s=e!==null?e.memoizedProps:null,a=n.children,F1(i,n)?a=null:s!==null&&F1(i,s)&&(t.flags|=32),XC(e,t),Ci(e,t,a,r),t.child;case 6:return e===null&&Y1(t),null;case 13:return JC(e,t,r);case 4:return ow(t,t.stateNode.containerInfo),i=t.pendingProps,e===null?t.child=vu(t,null,i,r):Ci(e,t,i,r),t.child;case 11:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:rs(i,n),X2(e,t,i,n,r);case 7:return Ci(e,t,t.pendingProps,r),t.child;case 8:return Ci(e,t,t.pendingProps.children,r),t.child;case 12:return Ci(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(i=t.type._context,n=t.pendingProps,s=t.memoizedProps,a=n.value,$t(f0,i._currentValue),i._currentValue=a,s!==null)if(fs(s.value,a)){if(s.children===n.children&&!Zi.current){t=Xa(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=Ha(-1,r&-r),l.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var u=h.pending;u===null?l.next=l:(l.next=u.next,u.next=l),h.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),V1(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Se(341));a.lanes|=r,o=a.alternate,o!==null&&(o.lanes|=r),V1(a,r,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Ci(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,i=t.pendingProps.children,iu(t,r),n=Fn(n),i=i(n),t.flags|=1,Ci(e,t,i,r),t.child;case 14:return i=t.type,n=rs(i,t.pendingProps),n=rs(i.type,n),Q2(e,t,i,n,r);case 15:return qC(e,t,t.type,t.pendingProps,r);case 17:return i=t.type,n=t.pendingProps,n=t.elementType===i?n:rs(i,n),e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,$i(i)?(e=!0,d0(t)):e=!1,iu(t,r),gC(t,i,n),W1(t,i,n,r),K1(null,t,i,!0,e,r);case 19:return KC(e,t,r);case 22:return YC(e,t,r)}throw Error(Se(156,t.tag))};function cT(e,t){return z3(e,t)}function DR(e,t,r,i){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(e,t,r,i){return new DR(e,t,r,i)}function _w(e){return e=e.prototype,!(!e||!e.isReactComponent)}function PR(e){if(typeof e=="function")return _w(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Gx)return 11;if(e===Vx)return 14}return 2}function Ko(e,t){var r=e.alternate;return r===null?(r=Bn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function zp(e,t,r,i,n,s){var a=2;if(i=e,typeof e=="function")_w(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Ih:return Al(r.children,n,s,t);case Hx:a=8,n|=8;break;case v1:return e=Bn(12,r,t,n|2),e.elementType=v1,e.lanes=s,e;case y1:return e=Bn(13,r,t,n),e.elementType=y1,e.lanes=s,e;case x1:return e=Bn(19,r,t,n),e.elementType=x1,e.lanes=s,e;case b3:return A0(r,n,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case x3:a=10;break e;case w3:a=9;break e;case Gx:a=11;break e;case Vx:a=14;break e;case Mo:a=16,i=null;break e}throw Error(Se(130,e==null?e:typeof e,""))}return t=Bn(a,r,t,n),t.elementType=e,t.type=i,t.lanes=s,t}function Al(e,t,r,i){return e=Bn(7,e,i,t),e.lanes=r,e}function A0(e,t,r,i){return e=Bn(22,e,i,t),e.elementType=b3,e.lanes=r,e.stateNode={},e}function Tg(e,t,r){return e=Bn(6,e,null,t),e.lanes=r,e}function Dg(e,t,r){return t=Bn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function LR(e,t,r,i,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ug(0),this.expirationTimes=ug(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ug(0),this.identifierPrefix=i,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Sw(e,t,r,i,n,s,a,o,l){return e=new LR(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Bn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:i,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},iw(s),e}function RR(e,t,r){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Oh,key:i==null?null:""+i,children:e,containerInfo:t,implementation:r}}function dT(e){if(!e)return Jo;e=e._reactInternals;e:{if(Kl(e)!==e||e.tag!==1)throw Error(Se(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if($i(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Se(171))}if(e.tag===1){var r=e.type;if($i(r))return dC(e,r,t)}return t}function fT(e,t,r,i,n,s,a,o,l){return e=Sw(r,i,!0,e,n,s,a,o,l),e.context=dT(null),r=e.current,i=Ri(),n=Wo(r),s=Ha(i,n),s.callback=t!=null?t:null,Vo(r,s),e.current.lanes=n,Vd(e,n,i),en(e,i),e}function ym(e,t,r,i){var n=t.current,s=Ri(),a=Wo(n);return r=dT(r),t.context===null?t.context=r:t.pendingContext=r,t=Ha(s,a),t.payload={element:e},i=i===void 0?null:i,i!==null&&(t.callback=i),Vo(n,t),e=zn(n,a,s),e!==null&&Op(e,n,a),a}function E0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function u_(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Mw(e,t){u_(e,t),(e=e.alternate)&&u_(e,t)}function OR(){return null}var pT=typeof reportError=="function"?reportError:function(e){console.error(e)};function Aw(e){this._internalRoot=e}xm.prototype.render=Aw.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Se(409));ym(e,t,null,null)};xm.prototype.unmount=Aw.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;kl(function(){ym(null,e,null,null)}),t[Ya]=null}};function xm(e){this._internalRoot=e}xm.prototype.unstable_scheduleHydration=function(e){if(e){var t=W3();e={blockedOn:null,target:e,priority:t};for(var r=0;r<To.length&&t!==0&&t<To[r].priority;r++);To.splice(r,0,e),r===0&&Y3(e)}};function Ew(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function wm(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function c_(){}function IR(e,t,r,i,n){if(n){if(typeof i=="function"){var s=i;i=function(){var h=E0(a);s.call(h)}}var a=fT(t,i,e,0,null,!1,!1,"",c_);return e._reactRootContainer=a,e[Ya]=a.current,md(e.nodeType===8?e.parentNode:e),kl(),a}for(;n=e.lastChild;)e.removeChild(n);if(typeof i=="function"){var o=i;i=function(){var h=E0(l);o.call(h)}}var l=Sw(e,0,!1,null,null,!1,!1,"",c_);return e._reactRootContainer=l,e[Ya]=l.current,md(e.nodeType===8?e.parentNode:e),kl(function(){ym(t,l,r,i)}),l}function bm(e,t,r,i,n){var s=r._reactRootContainer;if(s){var a=s;if(typeof n=="function"){var o=n;n=function(){var l=E0(a);o.call(l)}}ym(t,a,e,n)}else a=IR(r,t,e,n,i);return E0(a)}V3=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ec(t.pendingLanes);r!==0&&(qx(t,r|1),en(t,Sr()),(Ht&6)===0&&(xu=Sr()+500,sl()))}break;case 13:var i=Ri();kl(function(){return zn(e,1,i)}),Mw(e,1)}};Yx=function(e){if(e.tag===13){var t=Ri();zn(e,134217728,t),Mw(e,134217728)}};j3=function(e){if(e.tag===13){var t=Ri(),r=Wo(e);zn(e,r,t),Mw(e,r)}};W3=function(){return Jt};q3=function(e,t){var r=Jt;try{return Jt=e,t()}finally{Jt=r}};D1=function(e,t,r){switch(t){case"input":if(_1(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var i=r[t];if(i!==e&&i.form===e.form){var n=cm(i);if(!n)throw Error(Se(90));S3(i),_1(i,n)}}}break;case"textarea":A3(e,r);break;case"select":t=r.value,t!=null&&$h(e,!!r.multiple,t,!1)}};R3=xw;O3=kl;var NR={usingClientEntryPoint:!1,Events:[Wd,zh,cm,P3,L3,xw]},ac={findFiberByHostInstance:xl,bundleType:0,version:"18.1.0",rendererPackageName:"react-dom"},BR={bundleType:ac.bundleType,version:ac.version,rendererPackageName:ac.rendererPackageName,rendererConfig:ac.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ro.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=B3(e),e===null?null:e.stateNode},findFiberByHostInstance:ac.findFiberByHostInstance||OR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.1.0-next-22edb9f77-20220426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var Df=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Df.isDisabled&&Df.supportsFiber)try{om=Df.inject(BR),$s=Df}catch{}}xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NR;xn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ew(t))throw Error(Se(200));return RR(e,t,null,r)};xn.createRoot=function(e,t){if(!Ew(e))throw Error(Se(299));var r=!1,i="",n=pT;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(n=t.onRecoverableError)),t=Sw(e,1,!1,null,null,r,!1,i,n),e[Ya]=t.current,md(e.nodeType===8?e.parentNode:e),new Aw(t)};xn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Se(188)):(e=Object.keys(e).join(","),Error(Se(268,e)));return e=B3(t),e=e===null?null:e.stateNode,e};xn.flushSync=function(e){return kl(e)};xn.hydrate=function(e,t,r){if(!wm(t))throw Error(Se(200));return bm(null,e,t,!0,r)};xn.hydrateRoot=function(e,t,r){if(!Ew(e))throw Error(Se(405));var i=r!=null&&r.hydratedSources||null,n=!1,s="",a=pT;if(r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(a=r.onRecoverableError)),t=fT(t,null,e,1,r!=null?r:null,n,!1,s,a),e[Ya]=t.current,md(e),i)for(e=0;e<i.length;e++)r=i[e],n=r._getVersion,n=n(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new xm(t)};xn.render=function(e,t,r){if(!wm(t))throw Error(Se(200));return bm(null,e,t,!1,r)};xn.unmountComponentAtNode=function(e){if(!wm(e))throw Error(Se(40));return e._reactRootContainer?(kl(function(){bm(null,null,e,!1,function(){e._reactRootContainer=null,e[Ya]=null})}),!0):!1};xn.unstable_batchedUpdates=xw;xn.unstable_renderSubtreeIntoContainer=function(e,t,r,i){if(!wm(r))throw Error(Se(200));if(e==null||e._reactInternals===void 0)throw Error(Se(38));return bm(e,t,r,!1,i)};xn.version="18.1.0-next-22edb9f77-20220426";function mT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mT)}catch(e){console.error(e)}}mT(),p3.exports=xn;var d_=p3.exports;m1.createRoot=d_.createRoot,m1.hydrateRoot=d_.hydrateRoot;const kR="modulepreload",f_={},zR="/mailmeta/",FR=function(t,r){return!r||r.length===0?t():Promise.all(r.map(i=>{if(i=`${zR}${i}`,i in f_)return;f_[i]=!0;const n=i.endsWith(".css"),s=n?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${s}`))return;const a=document.createElement("link");if(a.rel=n?"stylesheet":kR,n||(a.as="script",a.crossOrigin=""),a.href=i,document.head.appendChild(a),n)return new Promise((o,l)=>{a.addEventListener("load",o),a.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t())};var UR=Object.create,Cw=Object.defineProperty,HR=Object.getOwnPropertyDescriptor,GR=Object.getOwnPropertyNames,VR=Object.getPrototypeOf,jR=Object.prototype.hasOwnProperty,WR=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),gT=(e,t)=>{for(var r in t)Cw(e,r,{get:t[r],enumerable:!0})},qR=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of GR(t))!jR.call(e,n)&&n!==r&&Cw(e,n,{get:()=>t[n],enumerable:!(i=HR(t,n))||i.enumerable});return e},YR=(e,t,r)=>(r=e!=null?UR(VR(e)):{},qR(t||!e||!e.__esModule?Cw(r,"default",{value:e,enumerable:!0}):r,e)),XR=WR((e,t)=>{(function(r,i){typeof e=="object"&&typeof t<"u"?i(e):typeof define=="function"&&define.amd?define(["exports"],i):i((r=typeof globalThis<"u"?globalThis:r||self).SVDJS={})})(e,function(r){r.SVD=function(i,n,s,a,o){if(n=n===void 0||n,s=s===void 0||s,o=1e-64/(a=a||Math.pow(2,-52)),!i)throw new TypeError("Matrix a is not defined");var l,h,u,c,d,f,p,m,g,v,x,b,_=i[0].length,E=i.length;if(E<_)throw new TypeError("Invalid matrix: m < n");for(var S=[],P=[],M=[],B=n==="f"?E:_,R=v=p=0;R<E;R++)P[R]=new Array(B).fill(0);for(R=0;R<_;R++)M[R]=new Array(_).fill(0);var H,Q=new Array(_).fill(0);for(R=0;R<E;R++)for(l=0;l<_;l++)P[R][l]=i[R][l];for(R=0;R<_;R++){for(S[R]=p,g=0,u=R+1,l=R;l<E;l++)g+=Math.pow(P[l][R],2);if(g<o)p=0;else for(m=(f=P[R][R])*(p=f<0?Math.sqrt(g):-Math.sqrt(g))-g,P[R][R]=f-p,l=u;l<_;l++){for(g=0,h=R;h<E;h++)g+=P[h][R]*P[h][l];for(f=g/m,h=R;h<E;h++)P[h][l]=P[h][l]+f*P[h][R]}for(Q[R]=p,g=0,l=u;l<_;l++)g+=Math.pow(P[R][l],2);if(g<o)p=0;else{for(m=(f=P[R][R+1])*(p=f<0?Math.sqrt(g):-Math.sqrt(g))-g,P[R][R+1]=f-p,l=u;l<_;l++)S[l]=P[R][l]/m;for(l=u;l<E;l++){for(g=0,h=u;h<_;h++)g+=P[l][h]*P[R][h];for(h=u;h<_;h++)P[l][h]=P[l][h]+g*S[h]}}v<(x=Math.abs(Q[R])+Math.abs(S[R]))&&(v=x)}if(s)for(R=_-1;0<=R;R--){if(p!==0){for(m=P[R][R+1]*p,l=u;l<_;l++)M[l][R]=P[R][l]/m;for(l=u;l<_;l++){for(g=0,h=u;h<_;h++)g+=P[R][h]*M[h][l];for(h=u;h<_;h++)M[h][l]=M[h][l]+g*M[h][R]}}for(l=u;l<_;l++)M[R][l]=0,M[l][R]=0;M[R][R]=1,p=S[R],u=R}if(n){if(n==="f")for(R=_;R<E;R++){for(l=_;l<E;l++)P[R][l]=0;P[R][R]=1}for(R=_-1;0<=R;R--){for(u=R+1,p=Q[R],l=u;l<B;l++)P[R][l]=0;if(p!==0){for(m=P[R][R]*p,l=u;l<B;l++){for(g=0,h=u;h<E;h++)g+=P[h][R]*P[h][l];for(f=g/m,h=R;h<E;h++)P[h][l]=P[h][l]+f*P[h][R]}for(l=R;l<E;l++)P[l][R]=P[l][R]/p}else for(l=R;l<E;l++)P[l][R]=0;P[R][R]=P[R][R]+1}}for(a*=v,h=_-1;0<=h;h--)for(var z=0;z<50;z++){for(H=!1,u=h;0<=u;u--){if(Math.abs(S[u])<=a){H=!0;break}if(Math.abs(Q[u-1])<=a)break}if(!H){for(d=0,c=u-(g=1),R=u;R<h+1&&(f=g*S[R],S[R]=d*S[R],!(Math.abs(f)<=a));R++)if(p=Q[R],Q[R]=Math.sqrt(f*f+p*p),d=p/(m=Q[R]),g=-f/m,n)for(l=0;l<E;l++)x=P[l][c],b=P[l][R],P[l][c]=x*d+b*g,P[l][R]=-x*g+b*d}if(b=Q[h],u===h){if(b<0&&(Q[h]=-b,s))for(l=0;l<_;l++)M[l][h]=-M[l][h];break}for(v=Q[u],f=(((x=Q[h-1])-b)*(x+b)+((p=S[h-1])-(m=S[h]))*(p+m))/(2*m*x),p=Math.sqrt(f*f+1),f=((v-b)*(v+b)+m*(x/(f<0?f-p:f+p)-m))/v,R=u+(g=d=1);R<h+1;R++){if(p=S[R],x=Q[R],m=g*p,p*=d,b=Math.sqrt(f*f+m*m),f=v*(d=f/(S[R-1]=b))+p*(g=m/b),p=-v*g+p*d,m=x*g,x*=d,s)for(l=0;l<_;l++)v=M[l][R-1],b=M[l][R],M[l][R-1]=v*d+b*g,M[l][R]=-v*g+b*d;if(b=Math.sqrt(f*f+m*m),f=(d=f/(Q[R-1]=b))*p+(g=m/b)*x,v=-g*p+d*x,n)for(l=0;l<E;l++)x=P[l][R-1],b=P[l][R],P[l][R-1]=x*d+b*g,P[l][R]=-x*g+b*d}S[u]=0,S[h]=f,Q[h]=v}for(R=0;R<_;R++)Q[R]<a&&(Q[R]=0);return{u:P,q:Q,v:M}},r.VERSION="1.1.1",Object.defineProperty(r,"__esModule",{value:!0})})}),Yd="141",Sn={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},QR=0,p_=1,JR=2,Tw=1,vT=2,Tc=3,Zo=0,yi=1,ti=2,KR=1,ii=0,El=1,m_=2,g_=3,v_=4,ZR=5,Ah=100,$R=101,eO=102,y_=103,x_=104,tO=200,rO=201,iO=202,nO=203,yT=204,xT=205,sO=206,aO=207,oO=208,lO=209,hO=210,uO=0,cO=1,dO=2,oy=3,fO=4,pO=5,mO=6,gO=7,_m=0,vO=1,yO=2,Ga=0,xO=1,wO=2,bO=3,_O=4,SO=5,wT=300,zl=301,Fl=302,ly=303,hy=304,Xd=306,Md=1e3,Ti=1001,uy=1002,mi=1003,w_=1004,b_=1005,Wt=1006,MO=1007,Ou=1008,Si=1009,AO=1010,EO=1011,bT=1012,CO=1013,Io=1014,bl=1015,Ad=1016,TO=1017,DO=1018,Cl=1020,PO=1021,LO=1022,hs=1023,RO=1024,OO=1025,Tl=1026,Ul=1027,IO=1028,NO=1029,BO=1030,kO=1031,zO=1033,Pg=33776,Lg=33777,Rg=33778,Og=33779,__=35840,S_=35841,M_=35842,A_=35843,FO=36196,E_=37492,C_=37496,T_=37808,D_=37809,P_=37810,L_=37811,R_=37812,O_=37813,I_=37814,N_=37815,B_=37816,k_=37817,z_=37818,F_=37819,U_=37820,H_=37821,G_=36492,la=3e3,St=3001,io=3200,UO=3201,Iu=0,HO=1,La="srgb",_l="srgb-linear",Ig=7680,GO=519,cy=35044,V_="300 es",dy=1035,nn=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let r=this._listeners;return r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let r=this._listeners[e];if(r!==void 0){let i=r.indexOf(t);i!==-1&&r.splice(i,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let r=t.slice(0);for(let i=0,n=r.length;i<n;i++)r[i].call(this,e);e.target=null}}},Kr=[];for(let e=0;e<256;e++)Kr[e]=(e<16?"0":"")+e.toString(16);var j_=1234567,Yc=Math.PI/180,Ed=180/Math.PI;function ta(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Kr[e&255]+Kr[e>>8&255]+Kr[e>>16&255]+Kr[e>>24&255]+"-"+Kr[t&255]+Kr[t>>8&255]+"-"+Kr[t>>16&15|64]+Kr[t>>24&255]+"-"+Kr[r&63|128]+Kr[r>>8&255]+"-"+Kr[r>>16&255]+Kr[r>>24&255]+Kr[i&255]+Kr[i>>8&255]+Kr[i>>16&255]+Kr[i>>24&255]).toLowerCase()}function Pr(e,t,r){return Math.max(t,Math.min(r,e))}function Dw(e,t){return(e%t+t)%t}function VO(e,t,r,i,n){return i+(e-t)*(n-i)/(r-t)}function jO(e,t,r){return e!==t?(r-e)/(t-e):0}function Xc(e,t,r){return(1-r)*e+r*t}function WO(e,t,r,i){return Xc(e,t,1-Math.exp(-r*i))}function qO(e,t=1){return t-Math.abs(Dw(e,t*2)-t)}function YO(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*(3-2*e))}function XO(e,t,r){return e<=t?0:e>=r?1:(e=(e-t)/(r-t),e*e*e*(e*(e*6-15)+10))}function QO(e,t){return e+Math.floor(Math.random()*(t-e+1))}function JO(e,t){return e+Math.random()*(t-e)}function KO(e){return e*(.5-Math.random())}function ZO(e){e!==void 0&&(j_=e);let t=j_+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function $O(e){return e*Yc}function eI(e){return e*Ed}function fy(e){return(e&e-1)===0&&e!==0}function tI(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function C0(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function rI(e,t,r,i,n){let s=Math.cos,a=Math.sin,o=s(r/2),l=a(r/2),h=s((t+i)/2),u=a((t+i)/2),c=s((t-i)/2),d=a((t-i)/2),f=s((i-t)/2),p=a((i-t)/2);switch(n){case"XYX":e.set(o*u,l*c,l*d,o*h);break;case"YZY":e.set(l*d,o*u,l*c,o*h);break;case"ZXZ":e.set(l*c,l*d,o*u,o*h);break;case"XZX":e.set(o*u,l*p,l*f,o*h);break;case"YXY":e.set(l*f,o*u,l*p,o*h);break;case"ZYZ":e.set(l*p,l*f,o*u,o*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function iI(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function nI(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var kt=Object.freeze({__proto__:null,DEG2RAD:Yc,RAD2DEG:Ed,generateUUID:ta,clamp:Pr,euclideanModulo:Dw,mapLinear:VO,inverseLerp:jO,lerp:Xc,damp:WO,pingpong:qO,smoothstep:YO,smootherstep:XO,randInt:QO,randFloat:JO,randFloatSpread:KO,seededRandom:ZO,degToRad:$O,radToDeg:eI,isPowerOfTwo:fy,ceilPowerOfTwo:tI,floorPowerOfTwo:C0,setQuaternionFromProperEuler:rI,normalize:nI,denormalize:iI}),$=class{constructor(e=0,t=0){this.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let r=Math.cos(t),i=Math.sin(t),n=this.x-e.x,s=this.y-e.y;return this.x=n*r-s*i+e.x,this.y=n*i+s*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},xi=class{constructor(){this.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,i,n,s,a,o,l){let h=this.elements;return h[0]=e,h[1]=i,h[2]=a,h[3]=t,h[4]=n,h[5]=o,h[6]=r,h[7]=s,h[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,s=r[0],a=r[3],o=r[6],l=r[1],h=r[4],u=r[7],c=r[2],d=r[5],f=r[8],p=i[0],m=i[3],g=i[6],v=i[1],x=i[4],b=i[7],_=i[2],E=i[5],S=i[8];return n[0]=s*p+a*v+o*_,n[3]=s*m+a*x+o*E,n[6]=s*g+a*b+o*S,n[1]=l*p+h*v+u*_,n[4]=l*m+h*x+u*E,n[7]=l*g+h*b+u*S,n[2]=c*p+d*v+f*_,n[5]=c*m+d*x+f*E,n[8]=c*g+d*b+f*S,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],h=e[8];return t*s*h-t*a*l-r*n*h+r*a*o+i*n*l-i*s*o}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],h=e[8],u=h*s-a*l,c=a*o-h*n,d=l*n-s*o,f=t*u+r*c+i*d;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return e[0]=u*p,e[1]=(i*l-h*r)*p,e[2]=(a*r-i*s)*p,e[3]=c*p,e[4]=(h*t-i*o)*p,e[5]=(i*n-a*t)*p,e[6]=d*p,e[7]=(r*o-l*t)*p,e[8]=(s*t-r*n)*p,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,n,s,a){let o=Math.cos(n),l=Math.sin(n);return this.set(r*o,r*l,-r*(o*s+l*a)+s+e,-i*l,i*o,-i*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){let r=this.elements;return r[0]*=e,r[3]*=e,r[6]*=e,r[1]*=t,r[4]*=t,r[7]*=t,this}rotate(e){let t=Math.cos(e),r=Math.sin(e),i=this.elements,n=i[0],s=i[3],a=i[6],o=i[1],l=i[4],h=i[7];return i[0]=t*n+r*o,i[3]=t*s+r*l,i[6]=t*a+r*h,i[1]=-r*n+t*o,i[4]=-r*s+t*l,i[7]=-r*a+t*h,this}translate(e,t){let r=this.elements;return r[0]+=e*r[2],r[3]+=e*r[5],r[6]+=e*r[8],r[1]+=t*r[2],r[4]+=t*r[5],r[7]+=t*r[8],this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}};function _T(e){for(let t=e.length-1;t>=0;--t)if(e[t]>65535)return!0;return!1}var sI={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Pf(e,t){return new sI[e](t)}function T0(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Dl(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function Fp(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var Ng={[La]:{[_l]:Dl},[_l]:{[La]:Fp}},qn={legacyMode:!0,get workingColorSpace(){return _l},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,r){if(this.legacyMode||t===r||!t||!r)return e;if(Ng[t]&&Ng[t][r]!==void 0){let i=Ng[t][r];return e.r=i(e.r),e.g=i(e.g),e.b=i(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},ST={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Br={r:0,g:0,b:0},Yn={h:0,s:0,l:0},Lf={h:0,s:0,l:0};function Bg(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*6*(2/3-r):e}function Rf(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var Ue=class{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&r===void 0?this.set(e):this.setRGB(e,t,r)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=La){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,qn.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=_l){return this.r=e,this.g=t,this.b=r,qn.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=_l){if(e=Dw(e,1),t=Pr(t,0,1),r=Pr(r,0,1),t===0)this.r=this.g=this.b=r;else{let n=r<=.5?r*(1+t):r+t-r*t,s=2*r-n;this.r=Bg(s,n,e+1/3),this.g=Bg(s,n,e),this.b=Bg(s,n,e-1/3)}return qn.toWorkingColorSpace(this,i),this}setStyle(e,t=La){function r(n){n!==void 0&&parseFloat(n)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let n,s=i[1],a=i[2];switch(s){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,qn.toWorkingColorSpace(this,t),r(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,qn.toWorkingColorSpace(this,t),r(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a)){let o=parseFloat(n[1])/360,l=parseInt(n[2],10)/100,h=parseInt(n[3],10)/100;return r(n[4]),this.setHSL(o,l,h,t)}break}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){let n=i[1],s=n.length;if(s===3)return this.r=parseInt(n.charAt(0)+n.charAt(0),16)/255,this.g=parseInt(n.charAt(1)+n.charAt(1),16)/255,this.b=parseInt(n.charAt(2)+n.charAt(2),16)/255,qn.toWorkingColorSpace(this,t),this;if(s===6)return this.r=parseInt(n.charAt(0)+n.charAt(1),16)/255,this.g=parseInt(n.charAt(2)+n.charAt(3),16)/255,this.b=parseInt(n.charAt(4)+n.charAt(5),16)/255,qn.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=La){let r=ST[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Dl(e.r),this.g=Dl(e.g),this.b=Dl(e.b),this}copyLinearToSRGB(e){return this.r=Fp(e.r),this.g=Fp(e.g),this.b=Fp(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=La){return qn.fromWorkingColorSpace(Rf(this,Br),e),Pr(Br.r*255,0,255)<<16^Pr(Br.g*255,0,255)<<8^Pr(Br.b*255,0,255)<<0}getHexString(e=La){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=_l){qn.fromWorkingColorSpace(Rf(this,Br),t);let r=Br.r,i=Br.g,n=Br.b,s=Math.max(r,i,n),a=Math.min(r,i,n),o,l,h=(a+s)/2;if(a===s)o=0,l=0;else{let u=s-a;switch(l=h<=.5?u/(s+a):u/(2-s-a),s){case r:o=(i-n)/u+(i<n?6:0);break;case i:o=(n-r)/u+2;break;case n:o=(r-i)/u+4;break}o/=6}return e.h=o,e.s=l,e.l=h,e}getRGB(e,t=_l){return qn.fromWorkingColorSpace(Rf(this,Br),t),e.r=Br.r,e.g=Br.g,e.b=Br.b,e}getStyle(e=La){return qn.fromWorkingColorSpace(Rf(this,Br),e),e!==La?`color(${e} ${Br.r} ${Br.g} ${Br.b})`:`rgb(${Br.r*255|0},${Br.g*255|0},${Br.b*255|0})`}offsetHSL(e,t,r){return this.getHSL(Yn),Yn.h+=e,Yn.s+=t,Yn.l+=r,this.setHSL(Yn.h,Yn.s,Yn.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Yn),e.getHSL(Lf);let r=Xc(Yn.h,Lf.h,t),i=Xc(Yn.s,Lf.s,t),n=Xc(Yn.l,Lf.l,t);return this.setHSL(r,i,n),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};Ue.NAMES=ST;var nh,MT=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{nh===void 0&&(nh=T0("canvas")),nh.width=e.width,nh.height=e.height;let r=nh.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=nh}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=T0("canvas");t.width=e.width,t.height=e.height;let r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let i=r.getImageData(0,0,e.width,e.height),n=i.data;for(let s=0;s<n.length;s++)n[s]=Dl(n[s]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){let t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Dl(t[r]/255)*255):t[r]=Dl(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},AT=class{constructor(e=null){this.isSource=!0,this.uuid=ta(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let n;if(Array.isArray(i)){n=[];for(let s=0,a=i.length;s<a;s++)i[s].isDataTexture?n.push(kg(i[s].image)):n.push(kg(i[s]))}else n=kg(i);r.url=n}return t||(e.images[this.uuid]=r),r}};function kg(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?MT.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var aI=0,Qr=class extends nn{constructor(e=Qr.DEFAULT_IMAGE,t=Qr.DEFAULT_MAPPING,r=Ti,i=Ti,n=Wt,s=Ou,a=hs,o=Si,l=1,h=la){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:aI++}),this.uuid=ta(),this.name="",this.source=new AT(e),this.mipmaps=[],this.mapping=t,this.wrapS=r,this.wrapT=i,this.magFilter=n,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new $(0,0),this.repeat=new $(1,1),this.center=new $(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new xi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=h,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==wT)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Md:e.x=e.x-Math.floor(e.x);break;case Ti:e.x=e.x<0?0:1;break;case uy:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Md:e.y=e.y-Math.floor(e.y);break;case Ti:e.y=e.y<0?0:1;break;case uy:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};Qr.DEFAULT_IMAGE=null;Qr.DEFAULT_MAPPING=wT;var Tt=class{constructor(e=0,t=0,r=0,i=1){this.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=this.w,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i+s[12]*n,this.y=s[1]*t+s[5]*r+s[9]*i+s[13]*n,this.z=s[2]*t+s[6]*r+s[10]*i+s[14]*n,this.w=s[3]*t+s[7]*r+s[11]*i+s[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,n,s=e.elements,a=s[0],o=s[4],l=s[8],h=s[1],u=s[5],c=s[9],d=s[2],f=s[6],p=s[10];if(Math.abs(o-h)<.01&&Math.abs(l-d)<.01&&Math.abs(c-f)<.01){if(Math.abs(o+h)<.1&&Math.abs(l+d)<.1&&Math.abs(c+f)<.1&&Math.abs(a+u+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let g=(a+1)/2,v=(u+1)/2,x=(p+1)/2,b=(o+h)/4,_=(l+d)/4,E=(c+f)/4;return g>v&&g>x?g<.01?(r=0,i=.707106781,n=.707106781):(r=Math.sqrt(g),i=b/r,n=_/r):v>x?v<.01?(r=.707106781,i=0,n=.707106781):(i=Math.sqrt(v),r=b/i,n=E/i):x<.01?(r=.707106781,i=.707106781,n=0):(n=Math.sqrt(x),r=_/n,i=E/n),this.set(r,i,n,t),this}let m=Math.sqrt((f-c)*(f-c)+(l-d)*(l-d)+(h-o)*(h-o));return Math.abs(m)<.001&&(m=1),this.x=(f-c)/m,this.y=(l-d)/m,this.z=(h-o)/m,this.w=Math.acos((a+u+p-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Or=class extends nn{constructor(e,t,r={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Tt(0,0,e,t),this.scissorTest=!1,this.viewport=new Tt(0,0,e,t);let i={width:e,height:t,depth:1};this.texture=new Qr(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.internalFormat=r.internalFormat!==void 0?r.internalFormat:null,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:Wt,this.depthBuffer=r.depthBuffer!==void 0?r.depthBuffer:!0,this.stencilBuffer=r.stencilBuffer!==void 0?r.stencilBuffer:!1,this.depthTexture=r.depthTexture!==void 0?r.depthTexture:null,this.samples=r.samples!==void 0?r.samples:0}setSize(e,t,r=1){(this.width!==e||this.height!==t||this.depth!==r)&&(this.width=e,this.height=t,this.depth=r,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new AT(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},ET=class extends Qr{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=mi,this.minFilter=mi,this.wrapR=Ti,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},oI=class extends Qr{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=mi,this.minFilter=mi,this.wrapR=Ti,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},yn=class{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerp(e,t,r,i){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),r.slerpQuaternions(e,t,i)}static slerpFlat(e,t,r,i,n,s,a){let o=r[i+0],l=r[i+1],h=r[i+2],u=r[i+3],c=n[s+0],d=n[s+1],f=n[s+2],p=n[s+3];if(a===0){e[t+0]=o,e[t+1]=l,e[t+2]=h,e[t+3]=u;return}if(a===1){e[t+0]=c,e[t+1]=d,e[t+2]=f,e[t+3]=p;return}if(u!==p||o!==c||l!==d||h!==f){let m=1-a,g=o*c+l*d+h*f+u*p,v=g>=0?1:-1,x=1-g*g;if(x>Number.EPSILON){let _=Math.sqrt(x),E=Math.atan2(_,g*v);m=Math.sin(m*E)/_,a=Math.sin(a*E)/_}let b=a*v;if(o=o*m+c*b,l=l*m+d*b,h=h*m+f*b,u=u*m+p*b,m===1-a){let _=1/Math.sqrt(o*o+l*l+h*h+u*u);o*=_,l*=_,h*=_,u*=_}}e[t]=o,e[t+1]=l,e[t+2]=h,e[t+3]=u}static multiplyQuaternionsFlat(e,t,r,i,n,s){let a=r[i],o=r[i+1],l=r[i+2],h=r[i+3],u=n[s],c=n[s+1],d=n[s+2],f=n[s+3];return e[t]=a*f+h*u+o*d-l*c,e[t+1]=o*f+h*c+l*u-a*d,e[t+2]=l*f+h*d+a*c-o*u,e[t+3]=h*f-a*u-o*c-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");let r=e._x,i=e._y,n=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(r/2),h=a(i/2),u=a(n/2),c=o(r/2),d=o(i/2),f=o(n/2);switch(s){case"XYZ":this._x=c*h*u+l*d*f,this._y=l*d*u-c*h*f,this._z=l*h*f+c*d*u,this._w=l*h*u-c*d*f;break;case"YXZ":this._x=c*h*u+l*d*f,this._y=l*d*u-c*h*f,this._z=l*h*f-c*d*u,this._w=l*h*u+c*d*f;break;case"ZXY":this._x=c*h*u-l*d*f,this._y=l*d*u+c*h*f,this._z=l*h*f+c*d*u,this._w=l*h*u-c*d*f;break;case"ZYX":this._x=c*h*u-l*d*f,this._y=l*d*u+c*h*f,this._z=l*h*f-c*d*u,this._w=l*h*u+c*d*f;break;case"YZX":this._x=c*h*u+l*d*f,this._y=l*d*u+c*h*f,this._z=l*h*f-c*d*u,this._w=l*h*u-c*d*f;break;case"XZY":this._x=c*h*u-l*d*f,this._y=l*d*u-c*h*f,this._z=l*h*f+c*d*u,this._w=l*h*u+c*d*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,r=t[0],i=t[4],n=t[8],s=t[1],a=t[5],o=t[9],l=t[2],h=t[6],u=t[10],c=r+a+u;if(c>0){let d=.5/Math.sqrt(c+1);this._w=.25/d,this._x=(h-o)*d,this._y=(n-l)*d,this._z=(s-i)*d}else if(r>a&&r>u){let d=2*Math.sqrt(1+r-a-u);this._w=(h-o)/d,this._x=.25*d,this._y=(i+s)/d,this._z=(n+l)/d}else if(a>u){let d=2*Math.sqrt(1+a-r-u);this._w=(n-l)/d,this._x=(i+s)/d,this._y=.25*d,this._z=(o+h)/d}else{let d=2*Math.sqrt(1+u-r-a);this._w=(s-i)/d,this._x=(n+l)/d,this._y=(o+h)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Pr(this.dot(e),-1,1)))}rotateTowards(e,t){let r=this.angleTo(e);if(r===0)return this;let i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let r=e._x,i=e._y,n=e._z,s=e._w,a=t._x,o=t._y,l=t._z,h=t._w;return this._x=r*h+s*a+i*l-n*o,this._y=i*h+s*o+n*a-r*l,this._z=n*h+s*l+r*o-i*a,this._w=s*h-r*a-i*o-n*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let r=this._x,i=this._y,n=this._z,s=this._w,a=s*e._w+r*e._x+i*e._y+n*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=r,this._y=i,this._z=n,this;let o=1-a*a;if(o<=Number.EPSILON){let d=1-t;return this._w=d*s+t*this._w,this._x=d*r+t*this._x,this._y=d*i+t*this._y,this._z=d*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),h=Math.atan2(l,a),u=Math.sin((1-t)*h)/l,c=Math.sin(t*h)/l;return this._w=s*u+this._w*c,this._x=r*u+this._x*c,this._y=i*u+this._y*c,this._z=n*u+this._z*c,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){let e=Math.random(),t=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(i),r*Math.sin(n),r*Math.cos(n),t*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},F=class{constructor(e=0,t=0,r=0){this.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(W_.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(W_.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[3]*r+n[6]*i,this.y=n[1]*t+n[4]*r+n[7]*i,this.z=n[2]*t+n[5]*r+n[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,r=this.y,i=this.z,n=e.elements,s=1/(n[3]*t+n[7]*r+n[11]*i+n[15]);return this.x=(n[0]*t+n[4]*r+n[8]*i+n[12])*s,this.y=(n[1]*t+n[5]*r+n[9]*i+n[13])*s,this.z=(n[2]*t+n[6]*r+n[10]*i+n[14])*s,this}applyQuaternion(e){let t=this.x,r=this.y,i=this.z,n=e.x,s=e.y,a=e.z,o=e.w,l=o*t+s*i-a*r,h=o*r+a*t-n*i,u=o*i+n*r-s*t,c=-n*t-s*r-a*i;return this.x=l*o+c*-n+h*-a-u*-s,this.y=h*o+c*-s+u*-n-l*-a,this.z=u*o+c*-a+l*-s-h*-n,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,r=this.y,i=this.z,n=e.elements;return this.x=n[0]*t+n[4]*r+n[8]*i,this.y=n[1]*t+n[5]*r+n[9]*i,this.z=n[2]*t+n[6]*r+n[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(t,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){let r=e.x,i=e.y,n=e.z,s=t.x,a=t.y,o=t.z;return this.x=i*o-n*a,this.y=n*s-r*o,this.z=r*a-i*s,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return zg.copy(this).projectOnVector(e),this.sub(zg)}reflect(e){return this.sub(zg.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let r=this.dot(e)/t;return Math.acos(Pr(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){let i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,r){return r!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(t),this.y=r*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},zg=new F,W_=new yn,gs=class{constructor(e=new F(1/0,1/0,1/0),t=new F(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.length;o<l;o+=3){let h=e[o],u=e[o+1],c=e[o+2];h<t&&(t=h),u<r&&(r=u),c<i&&(i=c),h>n&&(n=h),u>s&&(s=u),c>a&&(a=c)}return this.min.set(t,r,i),this.max.set(n,s,a),this}setFromBufferAttribute(e){let t=1/0,r=1/0,i=1/0,n=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.count;o<l;o++){let h=e.getX(o),u=e.getY(o),c=e.getZ(o);h<t&&(t=h),u<r&&(r=u),c<i&&(i=c),h>n&&(n=h),u>s&&(s=u),c>a&&(a=c)}return this.min.set(t,r,i),this.max.set(n,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let r=ul.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(r!==void 0)if(t&&r.attributes!=null&&r.attributes.position!==void 0){let n=r.attributes.position;for(let s=0,a=n.count;s<a;s++)ul.fromBufferAttribute(n,s).applyMatrix4(e.matrixWorld),this.expandByPoint(ul)}else r.boundingBox===null&&r.computeBoundingBox(),Fg.copy(r.boundingBox),Fg.applyMatrix4(e.matrixWorld),this.union(Fg);let i=e.children;for(let n=0,s=i.length;n<s;n++)this.expandByObject(i[n],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,ul),ul.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(oc),Of.subVectors(this.max,oc),sh.subVectors(e.a,oc),ah.subVectors(e.b,oc),oh.subVectors(e.c,oc),ho.subVectors(ah,sh),uo.subVectors(oh,ah),cl.subVectors(sh,oh);let t=[0,-ho.z,ho.y,0,-uo.z,uo.y,0,-cl.z,cl.y,ho.z,0,-ho.x,uo.z,0,-uo.x,cl.z,0,-cl.x,-ho.y,ho.x,0,-uo.y,uo.x,0,-cl.y,cl.x,0];return!Ug(t,sh,ah,oh,Of)||(t=[1,0,0,0,1,0,0,0,1],!Ug(t,sh,ah,oh,Of))?!1:(If.crossVectors(ho,uo),t=[If.x,If.y,If.z],Ug(t,sh,ah,oh,Of))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return ul.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(ul).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(_a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),_a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),_a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),_a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),_a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),_a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),_a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),_a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(_a),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},_a=[new F,new F,new F,new F,new F,new F,new F,new F],ul=new F,Fg=new gs,sh=new F,ah=new F,oh=new F,ho=new F,uo=new F,cl=new F,oc=new F,Of=new F,If=new F,dl=new F;function Ug(e,t,r,i,n){for(let s=0,a=e.length-3;s<=a;s+=3){dl.fromArray(e,s);let o=n.x*Math.abs(dl.x)+n.y*Math.abs(dl.y)+n.z*Math.abs(dl.z),l=t.dot(dl),h=r.dot(dl),u=i.dot(dl);if(Math.max(-Math.max(l,h,u),Math.min(l,h,u))>o)return!1}return!0}var lI=new gs,q_=new F,Nf=new F,Hg=new F,ha=class{constructor(e=new F,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let r=this.center;t!==void 0?r.copy(t):lI.setFromPoints(e).getCenter(r);let i=0;for(let n=0,s=e.length;n<s;n++)i=Math.max(i,r.distanceToSquared(e[n]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){Hg.subVectors(e,this.center);let t=Hg.lengthSq();if(t>this.radius*this.radius){let r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.add(Hg.multiplyScalar(i/r)),this.radius+=i}return this}union(e){return this.center.equals(e.center)===!0?Nf.set(0,0,1).multiplyScalar(e.radius):Nf.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(q_.copy(e.center).add(Nf)),this.expandByPoint(q_.copy(e.center).sub(Nf)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},Sa=new F,Gg=new F,Bf=new F,co=new F,Vg=new F,kf=new F,jg=new F,Sm=class{constructor(e=new F,t=new F(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Sa)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(r).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=Sa.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Sa.copy(this.direction).multiplyScalar(t).add(this.origin),Sa.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){Gg.copy(e).add(t).multiplyScalar(.5),Bf.copy(t).sub(e).normalize(),co.copy(this.origin).sub(Gg);let n=e.distanceTo(t)*.5,s=-this.direction.dot(Bf),a=co.dot(this.direction),o=-co.dot(Bf),l=co.lengthSq(),h=Math.abs(1-s*s),u,c,d,f;if(h>0)if(u=s*o-a,c=s*a-o,f=n*h,u>=0)if(c>=-f)if(c<=f){let p=1/h;u*=p,c*=p,d=u*(u+s*c+2*a)+c*(s*u+c+2*o)+l}else c=n,u=Math.max(0,-(s*c+a)),d=-u*u+c*(c+2*o)+l;else c=-n,u=Math.max(0,-(s*c+a)),d=-u*u+c*(c+2*o)+l;else c<=-f?(u=Math.max(0,-(-s*n+a)),c=u>0?-n:Math.min(Math.max(-n,-o),n),d=-u*u+c*(c+2*o)+l):c<=f?(u=0,c=Math.min(Math.max(-n,-o),n),d=c*(c+2*o)+l):(u=Math.max(0,-(s*n+a)),c=u>0?n:Math.min(Math.max(-n,-o),n),d=-u*u+c*(c+2*o)+l);else c=s>0?-n:n,u=Math.max(0,-(s*c+a)),d=-u*u+c*(c+2*o)+l;return r&&r.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(Bf).multiplyScalar(c).add(Gg),d}intersectSphere(e,t){Sa.subVectors(e.center,this.origin);let r=Sa.dot(this.direction),i=Sa.dot(Sa)-r*r,n=e.radius*e.radius;if(i>n)return null;let s=Math.sqrt(n-i),a=r-s,o=r+s;return a<0&&o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){let r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,n,s,a,o,l=1/this.direction.x,h=1/this.direction.y,u=1/this.direction.z,c=this.origin;return l>=0?(r=(e.min.x-c.x)*l,i=(e.max.x-c.x)*l):(r=(e.max.x-c.x)*l,i=(e.min.x-c.x)*l),h>=0?(n=(e.min.y-c.y)*h,s=(e.max.y-c.y)*h):(n=(e.max.y-c.y)*h,s=(e.min.y-c.y)*h),r>s||n>i||((n>r||r!==r)&&(r=n),(s<i||i!==i)&&(i=s),u>=0?(a=(e.min.z-c.z)*u,o=(e.max.z-c.z)*u):(a=(e.max.z-c.z)*u,o=(e.min.z-c.z)*u),r>o||a>i)||((a>r||r!==r)&&(r=a),(o<i||i!==i)&&(i=o),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,Sa)!==null}intersectTriangle(e,t,r,i,n){Vg.subVectors(t,e),kf.subVectors(r,e),jg.crossVectors(Vg,kf);let s=this.direction.dot(jg),a;if(s>0){if(i)return null;a=1}else if(s<0)a=-1,s=-s;else return null;co.subVectors(this.origin,e);let o=a*this.direction.dot(kf.crossVectors(co,kf));if(o<0)return null;let l=a*this.direction.dot(Vg.cross(co));if(l<0||o+l>s)return null;let h=-a*co.dot(jg);return h<0?null:this.at(h/s,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},wt=class{constructor(){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,r,i,n,s,a,o,l,h,u,c,d,f,p,m){let g=this.elements;return g[0]=e,g[4]=t,g[8]=r,g[12]=i,g[1]=n,g[5]=s,g[9]=a,g[13]=o,g[2]=l,g[6]=h,g[10]=u,g[14]=c,g[3]=d,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new wt().fromArray(this.elements)}copy(e){let t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){let t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,r=e.elements,i=1/lh.setFromMatrixColumn(e,0).length(),n=1/lh.setFromMatrixColumn(e,1).length(),s=1/lh.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=0,t[8]=r[8]*s,t[9]=r[9]*s,t[10]=r[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");let t=this.elements,r=e.x,i=e.y,n=e.z,s=Math.cos(r),a=Math.sin(r),o=Math.cos(i),l=Math.sin(i),h=Math.cos(n),u=Math.sin(n);if(e.order==="XYZ"){let c=s*h,d=s*u,f=a*h,p=a*u;t[0]=o*h,t[4]=-o*u,t[8]=l,t[1]=d+f*l,t[5]=c-p*l,t[9]=-a*o,t[2]=p-c*l,t[6]=f+d*l,t[10]=s*o}else if(e.order==="YXZ"){let c=o*h,d=o*u,f=l*h,p=l*u;t[0]=c+p*a,t[4]=f*a-d,t[8]=s*l,t[1]=s*u,t[5]=s*h,t[9]=-a,t[2]=d*a-f,t[6]=p+c*a,t[10]=s*o}else if(e.order==="ZXY"){let c=o*h,d=o*u,f=l*h,p=l*u;t[0]=c-p*a,t[4]=-s*u,t[8]=f+d*a,t[1]=d+f*a,t[5]=s*h,t[9]=p-c*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if(e.order==="ZYX"){let c=s*h,d=s*u,f=a*h,p=a*u;t[0]=o*h,t[4]=f*l-d,t[8]=c*l+p,t[1]=o*u,t[5]=p*l+c,t[9]=d*l-f,t[2]=-l,t[6]=a*o,t[10]=s*o}else if(e.order==="YZX"){let c=s*o,d=s*l,f=a*o,p=a*l;t[0]=o*h,t[4]=p-c*u,t[8]=f*u+d,t[1]=u,t[5]=s*h,t[9]=-a*h,t[2]=-l*h,t[6]=d*u+f,t[10]=c-p*u}else if(e.order==="XZY"){let c=s*o,d=s*l,f=a*o,p=a*l;t[0]=o*h,t[4]=-u,t[8]=l*h,t[1]=c*u+p,t[5]=s*h,t[9]=d*u-f,t[2]=f*u-d,t[6]=a*h,t[10]=p*u+c}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(hI,e,uI)}lookAt(e,t,r){let i=this.elements;return sn.subVectors(e,t),sn.lengthSq()===0&&(sn.z=1),sn.normalize(),fo.crossVectors(r,sn),fo.lengthSq()===0&&(Math.abs(r.z)===1?sn.x+=1e-4:sn.z+=1e-4,sn.normalize(),fo.crossVectors(r,sn)),fo.normalize(),zf.crossVectors(sn,fo),i[0]=fo.x,i[4]=zf.x,i[8]=sn.x,i[1]=fo.y,i[5]=zf.y,i[9]=sn.y,i[2]=fo.z,i[6]=zf.z,i[10]=sn.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let r=e.elements,i=t.elements,n=this.elements,s=r[0],a=r[4],o=r[8],l=r[12],h=r[1],u=r[5],c=r[9],d=r[13],f=r[2],p=r[6],m=r[10],g=r[14],v=r[3],x=r[7],b=r[11],_=r[15],E=i[0],S=i[4],P=i[8],M=i[12],B=i[1],R=i[5],H=i[9],Q=i[13],z=i[2],y=i[6],A=i[10],D=i[14],O=i[3],C=i[7],I=i[11],k=i[15];return n[0]=s*E+a*B+o*z+l*O,n[4]=s*S+a*R+o*y+l*C,n[8]=s*P+a*H+o*A+l*I,n[12]=s*M+a*Q+o*D+l*k,n[1]=h*E+u*B+c*z+d*O,n[5]=h*S+u*R+c*y+d*C,n[9]=h*P+u*H+c*A+d*I,n[13]=h*M+u*Q+c*D+d*k,n[2]=f*E+p*B+m*z+g*O,n[6]=f*S+p*R+m*y+g*C,n[10]=f*P+p*H+m*A+g*I,n[14]=f*M+p*Q+m*D+g*k,n[3]=v*E+x*B+b*z+_*O,n[7]=v*S+x*R+b*y+_*C,n[11]=v*P+x*H+b*A+_*I,n[15]=v*M+x*Q+b*D+_*k,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],r=e[4],i=e[8],n=e[12],s=e[1],a=e[5],o=e[9],l=e[13],h=e[2],u=e[6],c=e[10],d=e[14],f=e[3],p=e[7],m=e[11],g=e[15];return f*(+n*o*u-i*l*u-n*a*c+r*l*c+i*a*d-r*o*d)+p*(+t*o*d-t*l*c+n*s*c-i*s*d+i*l*h-n*o*h)+m*(+t*l*u-t*a*d-n*s*u+r*s*d+n*a*h-r*l*h)+g*(-i*a*h-t*o*u+t*a*c+i*s*u-r*s*c+r*o*h)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){let i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){let e=this.elements,t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],a=e[5],o=e[6],l=e[7],h=e[8],u=e[9],c=e[10],d=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=u*m*l-p*c*l+p*o*d-a*m*d-u*o*g+a*c*g,x=f*c*l-h*m*l-f*o*d+s*m*d+h*o*g-s*c*g,b=h*p*l-f*u*l+f*a*d-s*p*d-h*a*g+s*u*g,_=f*u*o-h*p*o-f*a*c+s*p*c+h*a*m-s*u*m,E=t*v+r*x+i*b+n*_;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let S=1/E;return e[0]=v*S,e[1]=(p*c*n-u*m*n-p*i*d+r*m*d+u*i*g-r*c*g)*S,e[2]=(a*m*n-p*o*n+p*i*l-r*m*l-a*i*g+r*o*g)*S,e[3]=(u*o*n-a*c*n-u*i*l+r*c*l+a*i*d-r*o*d)*S,e[4]=x*S,e[5]=(h*m*n-f*c*n+f*i*d-t*m*d-h*i*g+t*c*g)*S,e[6]=(f*o*n-s*m*n-f*i*l+t*m*l+s*i*g-t*o*g)*S,e[7]=(s*c*n-h*o*n+h*i*l-t*c*l-s*i*d+t*o*d)*S,e[8]=b*S,e[9]=(f*u*n-h*p*n-f*r*d+t*p*d+h*r*g-t*u*g)*S,e[10]=(s*p*n-f*a*n+f*r*l-t*p*l-s*r*g+t*a*g)*S,e[11]=(h*a*n-s*u*n-h*r*l+t*u*l+s*r*d-t*a*d)*S,e[12]=_*S,e[13]=(h*p*i-f*u*i+f*r*c-t*p*c-h*r*m+t*u*m)*S,e[14]=(f*a*i-s*p*i-f*r*o+t*p*o+s*r*m-t*a*m)*S,e[15]=(s*u*i-h*a*i+h*r*o-t*u*o-s*r*c+t*a*c)*S,this}scale(e){let t=this.elements,r=e.x,i=e.y,n=e.z;return t[0]*=r,t[4]*=i,t[8]*=n,t[1]*=r,t[5]*=i,t[9]*=n,t[2]*=r,t[6]*=i,t[10]*=n,t[3]*=r,t[7]*=i,t[11]*=n,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let r=Math.cos(t),i=Math.sin(t),n=1-r,s=e.x,a=e.y,o=e.z,l=n*s,h=n*a;return this.set(l*s+r,l*a-i*o,l*o+i*a,0,l*a+i*o,h*a+r,h*o-i*s,0,l*o-i*a,h*o+i*s,n*o*o+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,n,s){return this.set(1,r,n,0,e,1,s,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){let i=this.elements,n=t._x,s=t._y,a=t._z,o=t._w,l=n+n,h=s+s,u=a+a,c=n*l,d=n*h,f=n*u,p=s*h,m=s*u,g=a*u,v=o*l,x=o*h,b=o*u,_=r.x,E=r.y,S=r.z;return i[0]=(1-(p+g))*_,i[1]=(d+b)*_,i[2]=(f-x)*_,i[3]=0,i[4]=(d-b)*E,i[5]=(1-(c+g))*E,i[6]=(m+v)*E,i[7]=0,i[8]=(f+x)*S,i[9]=(m-v)*S,i[10]=(1-(c+p))*S,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){let i=this.elements,n=lh.set(i[0],i[1],i[2]).length(),s=lh.set(i[4],i[5],i[6]).length(),a=lh.set(i[8],i[9],i[10]).length();this.determinant()<0&&(n=-n),e.x=i[12],e.y=i[13],e.z=i[14],Xn.copy(this);let o=1/n,l=1/s,h=1/a;return Xn.elements[0]*=o,Xn.elements[1]*=o,Xn.elements[2]*=o,Xn.elements[4]*=l,Xn.elements[5]*=l,Xn.elements[6]*=l,Xn.elements[8]*=h,Xn.elements[9]*=h,Xn.elements[10]*=h,t.setFromRotationMatrix(Xn),r.x=n,r.y=s,r.z=a,this}makePerspective(e,t,r,i,n,s){s===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");let a=this.elements,o=2*n/(t-e),l=2*n/(r-i),h=(t+e)/(t-e),u=(r+i)/(r-i),c=-(s+n)/(s-n),d=-2*s*n/(s-n);return a[0]=o,a[4]=0,a[8]=h,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=c,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,r,i,n,s){let a=this.elements,o=1/(t-e),l=1/(r-i),h=1/(s-n),u=(t+e)*o,c=(r+i)*l,d=(s+n)*h;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-c,a[2]=0,a[6]=0,a[10]=-2*h,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){let t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){let r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}},lh=new F,Xn=new wt,hI=new F(0,0,0),uI=new F(1,1,1),fo=new F,zf=new F,sn=new F,Y_=new wt,X_=new yn,Hl=class{constructor(e=0,t=0,r=0,i=Hl.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){let i=e.elements,n=i[0],s=i[4],a=i[8],o=i[1],l=i[5],h=i[9],u=i[2],c=i[6],d=i[10];switch(t){case"XYZ":this._y=Math.asin(Pr(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-h,d),this._z=Math.atan2(-s,n)):(this._x=Math.atan2(c,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Pr(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,n),this._z=0);break;case"ZXY":this._x=Math.asin(Pr(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,n));break;case"ZYX":this._y=Math.asin(-Pr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(c,d),this._z=Math.atan2(o,n)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(Pr(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-h,l),this._y=Math.atan2(-u,n)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-Pr(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(c,l),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-h,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return Y_.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Y_,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return X_.setFromEuler(this),this.setFromQuaternion(X_,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}};Hl.DefaultOrder="XYZ";Hl.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var Pw=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},cI=0,Q_=new F,hh=new yn,Ma=new wt,Ff=new F,lc=new F,dI=new F,fI=new yn,J_=new F(1,0,0),K_=new F(0,1,0),Z_=new F(0,0,1),pI={type:"added"},$_={type:"removed"},er=class extends nn{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:cI++}),this.uuid=ta(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=er.DefaultUp.clone();let e=new F,t=new Hl,r=new yn,i=new F(1,1,1);function n(){r.setFromEuler(t,!1)}function s(){t.setFromQuaternion(r,void 0,!1)}t._onChange(n),r._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new wt},normalMatrix:{value:new xi}}),this.matrix=new wt,this.matrixWorld=new wt,this.matrixAutoUpdate=er.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Pw,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return hh.setFromAxisAngle(e,t),this.quaternion.multiply(hh),this}rotateOnWorldAxis(e,t){return hh.setFromAxisAngle(e,t),this.quaternion.premultiply(hh),this}rotateX(e){return this.rotateOnAxis(J_,e)}rotateY(e){return this.rotateOnAxis(K_,e)}rotateZ(e){return this.rotateOnAxis(Z_,e)}translateOnAxis(e,t){return Q_.copy(e).applyQuaternion(this.quaternion),this.position.add(Q_.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(J_,e)}translateY(e){return this.translateOnAxis(K_,e)}translateZ(e){return this.translateOnAxis(Z_,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Ma.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?Ff.copy(e):Ff.set(e,t,r);let i=this.parent;this.updateWorldMatrix(!0,!1),lc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ma.lookAt(lc,Ff,this.up):Ma.lookAt(Ff,lc,this.up),this.quaternion.setFromRotationMatrix(Ma),i&&(Ma.extractRotation(i.matrixWorld),hh.setFromRotationMatrix(Ma),this.quaternion.premultiply(hh.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(pI)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent($_)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent($_)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Ma.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ma.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ma),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){let n=this.children[r].getObjectByProperty(e,t);if(n!==void 0)return n}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(lc,e,dI),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(lc,fI,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){let r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let i=this.children;for(let n=0,s=i.length;n<s;n++)i[n].updateWorldMatrix(!1,!0)}}toJSON(e){let t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON()));function n(a,o){return a[o.uuid]===void 0&&(a[o.uuid]=o.toJSON(e)),o.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=n(e.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let o=a.shapes;if(Array.isArray(o))for(let l=0,h=o.length;l<h;l++){let u=o[l];n(e.shapes,u)}else n(e.shapes,o)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(n(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let o=0,l=this.material.length;o<l;o++)a.push(n(e.materials,this.material[o]));i.material=a}else i.material=n(e.materials,this.material);if(this.children.length>0){i.children=[];for(let a=0;a<this.children.length;a++)i.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let a=0;a<this.animations.length;a++){let o=this.animations[a];i.animations.push(n(e.animations,o))}}if(t){let a=s(e.geometries),o=s(e.materials),l=s(e.textures),h=s(e.images),u=s(e.shapes),c=s(e.skeletons),d=s(e.animations),f=s(e.nodes);a.length>0&&(r.geometries=a),o.length>0&&(r.materials=o),l.length>0&&(r.textures=l),h.length>0&&(r.images=h),u.length>0&&(r.shapes=u),c.length>0&&(r.skeletons=c),d.length>0&&(r.animations=d),f.length>0&&(r.nodes=f)}return r.object=i,r;function s(a){let o=[];for(let l in a){let h=a[l];delete h.metadata,o.push(h)}return o}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){let i=e.children[r];this.add(i.clone())}return this}};er.DefaultUp=new F(0,1,0);er.DefaultMatrixAutoUpdate=!0;var Qn=new F,Aa=new F,Wg=new F,Ea=new F,uh=new F,ch=new F,eS=new F,qg=new F,Yg=new F,Xg=new F,Us=class{constructor(e=new F,t=new F,r=new F){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),Qn.subVectors(e,t),i.cross(Qn);let n=i.lengthSq();return n>0?i.multiplyScalar(1/Math.sqrt(n)):i.set(0,0,0)}static getBarycoord(e,t,r,i,n){Qn.subVectors(i,t),Aa.subVectors(r,t),Wg.subVectors(e,t);let s=Qn.dot(Qn),a=Qn.dot(Aa),o=Qn.dot(Wg),l=Aa.dot(Aa),h=Aa.dot(Wg),u=s*l-a*a;if(u===0)return n.set(-2,-1,-1);let c=1/u,d=(l*o-a*h)*c,f=(s*h-a*o)*c;return n.set(1-d-f,f,d)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,Ea),Ea.x>=0&&Ea.y>=0&&Ea.x+Ea.y<=1}static getUV(e,t,r,i,n,s,a,o){return this.getBarycoord(e,t,r,i,Ea),o.set(0,0),o.addScaledVector(n,Ea.x),o.addScaledVector(s,Ea.y),o.addScaledVector(a,Ea.z),o}static isFrontFacing(e,t,r,i){return Qn.subVectors(r,t),Aa.subVectors(e,t),Qn.cross(Aa).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Qn.subVectors(this.c,this.b),Aa.subVectors(this.a,this.b),Qn.cross(Aa).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Us.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Us.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,r,i,n){return Us.getUV(e,this.a,this.b,this.c,t,r,i,n)}containsPoint(e){return Us.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Us.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let r=this.a,i=this.b,n=this.c,s,a;uh.subVectors(i,r),ch.subVectors(n,r),qg.subVectors(e,r);let o=uh.dot(qg),l=ch.dot(qg);if(o<=0&&l<=0)return t.copy(r);Yg.subVectors(e,i);let h=uh.dot(Yg),u=ch.dot(Yg);if(h>=0&&u<=h)return t.copy(i);let c=o*u-h*l;if(c<=0&&o>=0&&h<=0)return s=o/(o-h),t.copy(r).addScaledVector(uh,s);Xg.subVectors(e,n);let d=uh.dot(Xg),f=ch.dot(Xg);if(f>=0&&d<=f)return t.copy(n);let p=d*l-o*f;if(p<=0&&l>=0&&f<=0)return a=l/(l-f),t.copy(r).addScaledVector(ch,a);let m=h*f-d*u;if(m<=0&&u-h>=0&&d-f>=0)return eS.subVectors(n,i),a=(u-h)/(u-h+(d-f)),t.copy(i).addScaledVector(eS,a);let g=1/(m+p+c);return s=p*g,a=c*g,t.copy(r).addScaledVector(uh,s).addScaledVector(ch,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},mI=0,ai=class extends nn{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:mI++}),this.uuid=ta(),this.name="",this.type="Material",this.blending=El,this.side=Zo,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=yT,this.blendDst=xT,this.blendEquation=Ah,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=oy,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=GO,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ig,this.stencilZFail=Ig,this.stencilZPass=Ig,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let r=e[t];if(r===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===KR;continue}let i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==El&&(r.blending=this.blending),this.side!==Zo&&(r.side=this.side),this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,r.colorWrite=this.colorWrite,r.stencilWrite=this.stencilWrite,r.stencilWriteMask=this.stencilWriteMask,r.stencilFunc=this.stencilFunc,r.stencilRef=this.stencilRef,r.stencilFuncMask=this.stencilFuncMask,r.stencilFail=this.stencilFail,r.stencilZFail=this.stencilZFail,r.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(r.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=this.flatShading),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData);function i(n){let s=[];for(let a in n){let o=n[a];delete o.metadata,s.push(o)}return s}if(t){let n=i(e.textures),s=i(e.images);n.length>0&&(r.textures=n),s.length>0&&(r.images=s)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,r=null;if(t!==null){let i=t.length;r=new Array(i);for(let n=0;n!==i;++n)r[n]=t[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}get vertexTangents(){return console.warn("THREE."+this.type+": .vertexTangents has been removed."),!1}set vertexTangents(e){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}};ai.fromType=function(){return null};var Gl=class extends ai{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ue(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=_m,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Ar=new F,Uf=new $,Ct=class{constructor(e,t,r){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r===!0,this.usage=cy,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,n=this.itemSize;i<n;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new Ue),t[r++]=s.r,t[r++]=s.g,t[r++]=s.b}return this}copyVector2sArray(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new $),t[r++]=s.x,t[r++]=s.y}return this}copyVector3sArray(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new F),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z}return this}copyVector4sArray(e){let t=this.array,r=0;for(let i=0,n=e.length;i<n;i++){let s=e[i];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new Tt),t[r++]=s.x,t[r++]=s.y,t[r++]=s.z,t[r++]=s.w}return this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)Uf.fromBufferAttribute(this,t),Uf.applyMatrix3(e),this.setXY(t,Uf.x,Uf.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)Ar.fromBufferAttribute(this,t),Ar.applyMatrix3(e),this.setXYZ(t,Ar.x,Ar.y,Ar.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)Ar.fromBufferAttribute(this,t),Ar.applyMatrix4(e),this.setXYZ(t,Ar.x,Ar.y,Ar.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ar.fromBufferAttribute(this,t),Ar.applyNormalMatrix(e),this.setXYZ(t,Ar.x,Ar.y,Ar.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ar.fromBufferAttribute(this,t),Ar.transformDirection(e),this.setXYZ(t,Ar.x,Ar.y,Ar.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==cy&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}},CT=class extends Ct{constructor(e,t,r){super(new Uint16Array(e),t,r)}},Qc=class extends Ct{constructor(e,t,r){super(new Uint32Array(e),t,r)}},Ge=class extends Ct{constructor(e,t,r){super(new Float32Array(e),t,r)}},gI=0,Mn=new wt,Qg=new er,dh=new F,an=new gs,hc=new gs,Vr=new F,vt=class extends nn{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:gI++}),this.uuid=ta(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(_T(e)?Qc:CT)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let r=this.attributes.normal;if(r!==void 0){let n=new xi().getNormalMatrix(e);r.applyNormalMatrix(n),r.needsUpdate=!0}let i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Mn.makeRotationFromQuaternion(e),this.applyMatrix4(Mn),this}rotateX(e){return Mn.makeRotationX(e),this.applyMatrix4(Mn),this}rotateY(e){return Mn.makeRotationY(e),this.applyMatrix4(Mn),this}rotateZ(e){return Mn.makeRotationZ(e),this.applyMatrix4(Mn),this}translate(e,t,r){return Mn.makeTranslation(e,t,r),this.applyMatrix4(Mn),this}scale(e,t,r){return Mn.makeScale(e,t,r),this.applyMatrix4(Mn),this}lookAt(e){return Qg.lookAt(e),Qg.updateMatrix(),this.applyMatrix4(Qg.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(dh).negate(),this.translate(dh.x,dh.y,dh.z),this}setFromPoints(e){let t=[];for(let r=0,i=e.length;r<i;r++){let n=e[r];t.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new Ge(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gs);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new F(-1/0,-1/0,-1/0),new F(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){let n=t[r];an.setFromBufferAttribute(n),this.morphTargetsRelative?(Vr.addVectors(this.boundingBox.min,an.min),this.boundingBox.expandByPoint(Vr),Vr.addVectors(this.boundingBox.max,an.max),this.boundingBox.expandByPoint(Vr)):(this.boundingBox.expandByPoint(an.min),this.boundingBox.expandByPoint(an.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ha);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new F,1/0);return}if(e){let r=this.boundingSphere.center;if(an.setFromBufferAttribute(e),t)for(let n=0,s=t.length;n<s;n++){let a=t[n];hc.setFromBufferAttribute(a),this.morphTargetsRelative?(Vr.addVectors(an.min,hc.min),an.expandByPoint(Vr),Vr.addVectors(an.max,hc.max),an.expandByPoint(Vr)):(an.expandByPoint(hc.min),an.expandByPoint(hc.max))}an.getCenter(r);let i=0;for(let n=0,s=e.count;n<s;n++)Vr.fromBufferAttribute(e,n),i=Math.max(i,r.distanceToSquared(Vr));if(t)for(let n=0,s=t.length;n<s;n++){let a=t[n],o=this.morphTargetsRelative;for(let l=0,h=a.count;l<h;l++)Vr.fromBufferAttribute(a,l),o&&(dh.fromBufferAttribute(e,l),Vr.add(dh)),i=Math.max(i,r.distanceToSquared(Vr))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=e.array,i=t.position.array,n=t.normal.array,s=t.uv.array,a=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ct(new Float32Array(4*a),4));let o=this.getAttribute("tangent").array,l=[],h=[];for(let B=0;B<a;B++)l[B]=new F,h[B]=new F;let u=new F,c=new F,d=new F,f=new $,p=new $,m=new $,g=new F,v=new F;function x(B,R,H){u.fromArray(i,B*3),c.fromArray(i,R*3),d.fromArray(i,H*3),f.fromArray(s,B*2),p.fromArray(s,R*2),m.fromArray(s,H*2),c.sub(u),d.sub(u),p.sub(f),m.sub(f);let Q=1/(p.x*m.y-m.x*p.y);!isFinite(Q)||(g.copy(c).multiplyScalar(m.y).addScaledVector(d,-p.y).multiplyScalar(Q),v.copy(d).multiplyScalar(p.x).addScaledVector(c,-m.x).multiplyScalar(Q),l[B].add(g),l[R].add(g),l[H].add(g),h[B].add(v),h[R].add(v),h[H].add(v))}let b=this.groups;b.length===0&&(b=[{start:0,count:r.length}]);for(let B=0,R=b.length;B<R;++B){let H=b[B],Q=H.start,z=H.count;for(let y=Q,A=Q+z;y<A;y+=3)x(r[y+0],r[y+1],r[y+2])}let _=new F,E=new F,S=new F,P=new F;function M(B){S.fromArray(n,B*3),P.copy(S);let R=l[B];_.copy(R),_.sub(S.multiplyScalar(S.dot(R))).normalize(),E.crossVectors(P,R);let H=E.dot(h[B])<0?-1:1;o[B*4]=_.x,o[B*4+1]=_.y,o[B*4+2]=_.z,o[B*4+3]=H}for(let B=0,R=b.length;B<R;++B){let H=b[B],Q=H.start,z=H.count;for(let y=Q,A=Q+z;y<A;y+=3)M(r[y+0]),M(r[y+1]),M(r[y+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ct(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let c=0,d=r.count;c<d;c++)r.setXYZ(c,0,0,0);let i=new F,n=new F,s=new F,a=new F,o=new F,l=new F,h=new F,u=new F;if(e)for(let c=0,d=e.count;c<d;c+=3){let f=e.getX(c+0),p=e.getX(c+1),m=e.getX(c+2);i.fromBufferAttribute(t,f),n.fromBufferAttribute(t,p),s.fromBufferAttribute(t,m),h.subVectors(s,n),u.subVectors(i,n),h.cross(u),a.fromBufferAttribute(r,f),o.fromBufferAttribute(r,p),l.fromBufferAttribute(r,m),a.add(h),o.add(h),l.add(h),r.setXYZ(f,a.x,a.y,a.z),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(m,l.x,l.y,l.z)}else for(let c=0,d=t.count;c<d;c+=3)i.fromBufferAttribute(t,c+0),n.fromBufferAttribute(t,c+1),s.fromBufferAttribute(t,c+2),h.subVectors(s,n),u.subVectors(i,n),h.cross(u),r.setXYZ(c+0,h.x,h.y,h.z),r.setXYZ(c+1,h.x,h.y,h.z),r.setXYZ(c+2,h.x,h.y,h.z);this.normalizeNormals(),r.needsUpdate=!0}}merge(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));let r=this.attributes;for(let i in r){if(e.attributes[i]===void 0)continue;let n=r[i].array,s=e.attributes[i],a=s.array,o=s.itemSize*t,l=Math.min(a.length,n.length-o);for(let h=0,u=o;h<l;h++,u++)n[u]=a[h]}return this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)Vr.fromBufferAttribute(e,t),Vr.normalize(),e.setXYZ(t,Vr.x,Vr.y,Vr.z)}toNonIndexed(){function e(a,o){let l=a.array,h=a.itemSize,u=a.normalized,c=new l.constructor(o.length*h),d=0,f=0;for(let p=0,m=o.length;p<m;p++){a.isInterleavedBufferAttribute?d=o[p]*a.data.stride+a.offset:d=o[p]*h;for(let g=0;g<h;g++)c[f++]=l[d++]}return new Ct(c,h,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new vt,r=this.index.array,i=this.attributes;for(let a in i){let o=i[a],l=e(o,r);t.setAttribute(a,l)}let n=this.morphAttributes;for(let a in n){let o=[],l=n[a];for(let h=0,u=l.length;h<u;h++){let c=l[h],d=e(c,r);o.push(d)}t.morphAttributes[a]=o}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,o=s.length;a<o;a++){let l=s[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let o=this.parameters;for(let l in o)o[l]!==void 0&&(e[l]=o[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let r=this.attributes;for(let o in r){let l=r[o];e.data.attributes[o]=l.toJSON(e.data)}let i={},n=!1;for(let o in this.morphAttributes){let l=this.morphAttributes[o],h=[];for(let u=0,c=l.length;u<c;u++){let d=l[u];h.push(d.toJSON(e.data))}h.length>0&&(i[o]=h,n=!0)}n&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let r=e.index;r!==null&&this.setIndex(r.clone(t));let i=e.attributes;for(let l in i){let h=i[l];this.setAttribute(l,h.clone(t))}let n=e.morphAttributes;for(let l in n){let h=[],u=n[l];for(let c=0,d=u.length;c<d;c++)h.push(u[c].clone(t));this.morphAttributes[l]=h}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let l=0,h=s.length;l<h;l++){let u=s[l];this.addGroup(u.start,u.count,u.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let o=e.boundingSphere;return o!==null&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},tS=new wt,fh=new Sm,Jg=new ha,po=new F,mo=new F,go=new F,Kg=new F,Zg=new F,$g=new F,Hf=new F,Gf=new F,Vf=new F,jf=new $,Wf=new $,qf=new $,ev=new F,Yf=new F,Ji=class extends er{constructor(e=new vt,t=new Gl){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let s=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}raycast(e,t){let r=this.geometry,i=this.material,n=this.matrixWorld;if(i===void 0||(r.boundingSphere===null&&r.computeBoundingSphere(),Jg.copy(r.boundingSphere),Jg.applyMatrix4(n),e.ray.intersectsSphere(Jg)===!1)||(tS.copy(n).invert(),fh.copy(e.ray).applyMatrix4(tS),r.boundingBox!==null&&fh.intersectsBox(r.boundingBox)===!1))return;let s,a=r.index,o=r.attributes.position,l=r.morphAttributes.position,h=r.morphTargetsRelative,u=r.attributes.uv,c=r.attributes.uv2,d=r.groups,f=r.drawRange;if(a!==null)if(Array.isArray(i))for(let p=0,m=d.length;p<m;p++){let g=d[p],v=i[g.materialIndex],x=Math.max(g.start,f.start),b=Math.min(a.count,Math.min(g.start+g.count,f.start+f.count));for(let _=x,E=b;_<E;_+=3){let S=a.getX(_),P=a.getX(_+1),M=a.getX(_+2);s=Xf(this,v,e,fh,o,l,h,u,c,S,P,M),s&&(s.faceIndex=Math.floor(_/3),s.face.materialIndex=g.materialIndex,t.push(s))}}else{let p=Math.max(0,f.start),m=Math.min(a.count,f.start+f.count);for(let g=p,v=m;g<v;g+=3){let x=a.getX(g),b=a.getX(g+1),_=a.getX(g+2);s=Xf(this,i,e,fh,o,l,h,u,c,x,b,_),s&&(s.faceIndex=Math.floor(g/3),t.push(s))}}else if(o!==void 0)if(Array.isArray(i))for(let p=0,m=d.length;p<m;p++){let g=d[p],v=i[g.materialIndex],x=Math.max(g.start,f.start),b=Math.min(o.count,Math.min(g.start+g.count,f.start+f.count));for(let _=x,E=b;_<E;_+=3){let S=_,P=_+1,M=_+2;s=Xf(this,v,e,fh,o,l,h,u,c,S,P,M),s&&(s.faceIndex=Math.floor(_/3),s.face.materialIndex=g.materialIndex,t.push(s))}}else{let p=Math.max(0,f.start),m=Math.min(o.count,f.start+f.count);for(let g=p,v=m;g<v;g+=3){let x=g,b=g+1,_=g+2;s=Xf(this,i,e,fh,o,l,h,u,c,x,b,_),s&&(s.faceIndex=Math.floor(g/3),t.push(s))}}}};function vI(e,t,r,i,n,s,a,o){let l;if(t.side===yi?l=i.intersectTriangle(a,s,n,!0,o):l=i.intersectTriangle(n,s,a,t.side!==ti,o),l===null)return null;Yf.copy(o),Yf.applyMatrix4(e.matrixWorld);let h=r.ray.origin.distanceTo(Yf);return h<r.near||h>r.far?null:{distance:h,point:Yf.clone(),object:e}}function Xf(e,t,r,i,n,s,a,o,l,h,u,c){po.fromBufferAttribute(n,h),mo.fromBufferAttribute(n,u),go.fromBufferAttribute(n,c);let d=e.morphTargetInfluences;if(s&&d){Hf.set(0,0,0),Gf.set(0,0,0),Vf.set(0,0,0);for(let p=0,m=s.length;p<m;p++){let g=d[p],v=s[p];g!==0&&(Kg.fromBufferAttribute(v,h),Zg.fromBufferAttribute(v,u),$g.fromBufferAttribute(v,c),a?(Hf.addScaledVector(Kg,g),Gf.addScaledVector(Zg,g),Vf.addScaledVector($g,g)):(Hf.addScaledVector(Kg.sub(po),g),Gf.addScaledVector(Zg.sub(mo),g),Vf.addScaledVector($g.sub(go),g)))}po.add(Hf),mo.add(Gf),go.add(Vf)}e.isSkinnedMesh&&(e.boneTransform(h,po),e.boneTransform(u,mo),e.boneTransform(c,go));let f=vI(e,t,r,i,po,mo,go,ev);if(f){o&&(jf.fromBufferAttribute(o,h),Wf.fromBufferAttribute(o,u),qf.fromBufferAttribute(o,c),f.uv=Us.getUV(ev,po,mo,go,jf,Wf,qf,new $)),l&&(jf.fromBufferAttribute(l,h),Wf.fromBufferAttribute(l,u),qf.fromBufferAttribute(l,c),f.uv2=Us.getUV(ev,po,mo,go,jf,Wf,qf,new $));let p={a:h,b:u,c,normal:new F,materialIndex:0};Us.getNormal(po,mo,go,p.normal),f.face=p}return f}var $o=class extends vt{constructor(e=1,t=1,r=1,i=1,n=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:n,depthSegments:s};let a=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s);let o=[],l=[],h=[],u=[],c=0,d=0;f("z","y","x",-1,-1,r,t,e,s,n,0),f("z","y","x",1,-1,r,t,-e,s,n,1),f("x","z","y",1,1,e,r,t,i,s,2),f("x","z","y",1,-1,e,r,-t,i,s,3),f("x","y","z",1,-1,e,t,r,i,n,4),f("x","y","z",-1,-1,e,t,-r,i,n,5),this.setIndex(o),this.setAttribute("position",new Ge(l,3)),this.setAttribute("normal",new Ge(h,3)),this.setAttribute("uv",new Ge(u,2));function f(p,m,g,v,x,b,_,E,S,P,M){let B=b/S,R=_/P,H=b/2,Q=_/2,z=E/2,y=S+1,A=P+1,D=0,O=0,C=new F;for(let I=0;I<A;I++){let k=I*R-Q;for(let L=0;L<y;L++){let w=L*B-H;C[p]=w*v,C[m]=k*x,C[g]=z,l.push(C.x,C.y,C.z),C[p]=0,C[m]=0,C[g]=E>0?1:-1,h.push(C.x,C.y,C.z),u.push(L/S),u.push(1-I/P),D+=1}}for(let I=0;I<P;I++)for(let k=0;k<S;k++){let L=c+k+y*I,w=c+k+y*(I+1),N=c+(k+1)+y*(I+1),X=c+(k+1)+y*I;o.push(L,w,X),o.push(w,N,X),O+=6}a.addGroup(d,O,M),d+=O,c+=D}}static fromJSON(e){return new $o(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function wu(e){let t={};for(let r in e){t[r]={};for(let i in e[r]){let n=e[r][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[r][i]=n.clone():Array.isArray(n)?t[r][i]=n.slice():t[r][i]=n}}return t}function ci(e){let t={};for(let r=0;r<e.length;r++){let i=wu(e[r]);for(let n in i)t[n]=i[n]}return t}var Nu={clone:wu,merge:ci},yI=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,xI=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,Gr=class extends ai{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=yI,this.fragmentShader=xI,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=wu(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let i in this.uniforms){let n=this.uniforms[i].value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let r={};for(let i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}},Bu=class extends er{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new wt,this.projectionMatrix=new wt,this.projectionMatrixInverse=new wt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},gi=class extends Bu{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=Ed*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Yc*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Ed*2*Math.atan(Math.tan(Yc*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,r,i,n,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Yc*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,n=-.5*i,s=this.view;if(this.view!==null&&this.view.enabled){let o=s.fullWidth,l=s.fullHeight;n+=s.offsetX*i/o,t-=s.offsetY*r/l,i*=s.width/o,r*=s.height/l}let a=this.filmOffset;a!==0&&(n+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+i,t,t-r,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},ph=90,mh=1,wI=class extends er{constructor(e,t,r){if(super(),this.type="CubeCamera",r.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=r;let i=new gi(ph,mh,e,t);i.layers=this.layers,i.up.set(0,-1,0),i.lookAt(new F(1,0,0)),this.add(i);let n=new gi(ph,mh,e,t);n.layers=this.layers,n.up.set(0,-1,0),n.lookAt(new F(-1,0,0)),this.add(n);let s=new gi(ph,mh,e,t);s.layers=this.layers,s.up.set(0,0,1),s.lookAt(new F(0,1,0)),this.add(s);let a=new gi(ph,mh,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(new F(0,-1,0)),this.add(a);let o=new gi(ph,mh,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new F(0,0,1)),this.add(o);let l=new gi(ph,mh,e,t);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new F(0,0,-1)),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let r=this.renderTarget,[i,n,s,a,o,l]=this.children,h=e.getRenderTarget(),u=e.toneMapping,c=e.xr.enabled;e.toneMapping=Ga,e.xr.enabled=!1;let d=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0),e.render(t,i),e.setRenderTarget(r,1),e.render(t,n),e.setRenderTarget(r,2),e.render(t,s),e.setRenderTarget(r,3),e.render(t,a),e.setRenderTarget(r,4),e.render(t,o),r.texture.generateMipmaps=d,e.setRenderTarget(r,5),e.render(t,l),e.setRenderTarget(h),e.toneMapping=u,e.xr.enabled=c,r.texture.needsPMREMUpdate=!0}},Lw=class extends Qr{constructor(e,t,r,i,n,s,a,o,l,h){e=e!==void 0?e:[],t=t!==void 0?t:zl,super(e,t,r,i,n,s,a,o,l,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},bI=class extends Or{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new Lw(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Wt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new $o(5,5,5),n=new Gr({name:"CubemapFromEquirect",uniforms:wu(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:yi,blending:ii});n.uniforms.tEquirect.value=t;let s=new Ji(i,n),a=t.minFilter;return t.minFilter===Ou&&(t.minFilter=Wt),new wI(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,r,i){let n=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,r,i);e.setRenderTarget(n)}},tv=new F,_I=new F,SI=new xi,Ns=class{constructor(e=new F(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){let i=tv.subVectors(r,t).cross(_I.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let r=e.delta(tv),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/i;return n<0||n>1?null:t.copy(r).multiplyScalar(n).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let r=t||SI.getNormalMatrix(e),i=this.coplanarPoint(tv).applyMatrix4(e),n=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},gh=new ha,Qf=new F,Rw=class{constructor(e=new Ns,t=new Ns,r=new Ns,i=new Ns,n=new Ns,s=new Ns){this.planes=[e,t,r,i,n,s]}set(e,t,r,i,n,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(r),a[3].copy(i),a[4].copy(n),a[5].copy(s),this}copy(e){let t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e){let t=this.planes,r=e.elements,i=r[0],n=r[1],s=r[2],a=r[3],o=r[4],l=r[5],h=r[6],u=r[7],c=r[8],d=r[9],f=r[10],p=r[11],m=r[12],g=r[13],v=r[14],x=r[15];return t[0].setComponents(a-i,u-o,p-c,x-m).normalize(),t[1].setComponents(a+i,u+o,p+c,x+m).normalize(),t[2].setComponents(a+n,u+l,p+d,x+g).normalize(),t[3].setComponents(a-n,u-l,p-d,x-g).normalize(),t[4].setComponents(a-s,u-h,p-f,x-v).normalize(),t[5].setComponents(a+s,u+h,p+f,x+v).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),gh.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(gh)}intersectsSprite(e){return gh.center.set(0,0,0),gh.radius=.7071067811865476,gh.applyMatrix4(e.matrixWorld),this.intersectsSphere(gh)}intersectsSphere(e){let t=this.planes,r=e.center,i=-e.radius;for(let n=0;n<6;n++)if(t[n].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){let t=this.planes;for(let r=0;r<6;r++){let i=t[r];if(Qf.x=i.normal.x>0?e.max.x:e.min.x,Qf.y=i.normal.y>0?e.max.y:e.min.y,Qf.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Qf)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function TT(){let e=null,t=!1,r=null,i=null;function n(s,a){r(s,a),i=e.requestAnimationFrame(n)}return{start:function(){t!==!0&&r!==null&&(i=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(s){r=s},setContext:function(s){e=s}}}function MI(e,t){let r=t.isWebGL2,i=new WeakMap;function n(h,u){let c=h.array,d=h.usage,f=e.createBuffer();e.bindBuffer(u,f),e.bufferData(u,c,d),h.onUploadCallback();let p;if(c instanceof Float32Array)p=5126;else if(c instanceof Uint16Array)if(h.isFloat16BufferAttribute)if(r)p=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else p=5123;else if(c instanceof Int16Array)p=5122;else if(c instanceof Uint32Array)p=5125;else if(c instanceof Int32Array)p=5124;else if(c instanceof Int8Array)p=5120;else if(c instanceof Uint8Array)p=5121;else if(c instanceof Uint8ClampedArray)p=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:f,type:p,bytesPerElement:c.BYTES_PER_ELEMENT,version:h.version}}function s(h,u,c){let d=u.array,f=u.updateRange;e.bindBuffer(c,h),f.count===-1?e.bufferSubData(c,0,d):(r?e.bufferSubData(c,f.offset*d.BYTES_PER_ELEMENT,d,f.offset,f.count):e.bufferSubData(c,f.offset*d.BYTES_PER_ELEMENT,d.subarray(f.offset,f.offset+f.count)),f.count=-1)}function a(h){return h.isInterleavedBufferAttribute&&(h=h.data),i.get(h)}function o(h){h.isInterleavedBufferAttribute&&(h=h.data);let u=i.get(h);u&&(e.deleteBuffer(u.buffer),i.delete(h))}function l(h,u){if(h.isGLBufferAttribute){let d=i.get(h);(!d||d.version<h.version)&&i.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);let c=i.get(h);c===void 0?i.set(h,n(h,u)):c.version<h.version&&(s(c.buffer,h,u),c.version=h.version)}return{get:a,remove:o,update:l}}var Mm=class extends vt{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};let n=e/2,s=t/2,a=Math.floor(r),o=Math.floor(i),l=a+1,h=o+1,u=e/a,c=t/o,d=[],f=[],p=[],m=[];for(let g=0;g<h;g++){let v=g*c-s;for(let x=0;x<l;x++){let b=x*u-n;f.push(b,-v,0),p.push(0,0,1),m.push(x/a),m.push(1-g/o)}}for(let g=0;g<o;g++)for(let v=0;v<a;v++){let x=v+l*g,b=v+l*(g+1),_=v+1+l*(g+1),E=v+1+l*g;d.push(x,b,E),d.push(b,_,E)}this.setIndex(d),this.setAttribute("position",new Ge(f,3)),this.setAttribute("normal",new Ge(p,3)),this.setAttribute("uv",new Ge(m,2))}static fromJSON(e){return new Mm(e.width,e.height,e.widthSegments,e.heightSegments)}},AI=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,EI=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,CI=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,TI=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,DI=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,PI=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,LI="vec3 transformed = vec3( position );",RI=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,OI=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = mix(F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence);
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,II=`#ifdef USE_IRIDESCENCE
const mat3 XYZ_TO_REC709 = mat3(
    3.2404542, -0.9692660,  0.0556434,
   -1.5371385,  1.8760108, -0.2040259,
   -0.4985314,  0.0415560,  1.0572252
);
vec3 Fresnel0ToIor( vec3 fresnel0 ) {
   vec3 sqrtF0 = sqrt( fresnel0 );
   return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
}
vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
   return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
}
float IorToFresnel0( float transmittedIor, float incidentIor ) {
   return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
}
vec3 evalSensitivity( float OPD, vec3 shift ) {
   float phase = 2.0 * PI * OPD * 1.0e-9;
   vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
   vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
   vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
   vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( -pow2( phase ) * var );
   xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[0] ) * exp( -4.5282e+09 * pow2( phase ) );
   xyz /= 1.0685e-7;
   vec3 srgb = XYZ_TO_REC709 * xyz;
   return srgb;
}
vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
   vec3 I;
   float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
   float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
   float cosTheta2Sq = 1.0 - sinTheta2Sq;
   if ( cosTheta2Sq < 0.0 ) {
       return vec3( 1.0 );
   }
   float cosTheta2 = sqrt( cosTheta2Sq );
   float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
   float R12 = F_Schlick( R0, 1.0, cosTheta1 );
   float R21 = R12;
   float T121 = 1.0 - R12;
   float phi12 = 0.0;
   if ( iridescenceIOR < outsideIOR ) phi12 = PI;
   float phi21 = PI - phi12;
   vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );   vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
   vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
   vec3 phi23 = vec3( 0.0 );
   if ( baseIOR[0] < iridescenceIOR ) phi23[0] = PI;
   if ( baseIOR[1] < iridescenceIOR ) phi23[1] = PI;
   if ( baseIOR[2] < iridescenceIOR ) phi23[2] = PI;
   float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
   vec3 phi = vec3( phi21 ) + phi23;
   vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
   vec3 r123 = sqrt( R123 );
   vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
   vec3 C0 = R12 + Rs;
   I = C0;
   vec3 Cm = Rs - T121;
   for ( int m = 1; m <= 2; ++m ) {
       Cm *= r123;
       vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
       I += Cm * Sm;
   }
   return max( I, vec3( 0.0 ) );
}
#endif`,NI=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,BI=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,kI=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,zI=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,FI=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,UI=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,HI=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,GI=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,VI=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,jI=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,WI=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,qI=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,YI=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,XI=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,QI=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,JI=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,KI="gl_FragColor = linearToOutputTexel( gl_FragColor );",ZI=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,$I=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,eN=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,tN=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,rN=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,iN=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,nN=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,sN=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,aN=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,oN=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,lN=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,hN=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,uN=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,cN=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,dN=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,fN=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,pN=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,mN=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,gN=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,vN=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,yN=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,xN=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,wN=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
float dotNVi = saturate( dot( normal, geometry.viewDir ) );
if ( material.iridescenceThickness == 0.0 ) {
	material.iridescence = 0.0;
} else {
	material.iridescence = saturate( material.iridescence );
}
if ( material.iridescence > 0.0 ) {
	material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
	material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,bN=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,_N=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,SN=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,MN=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,AN=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,EN=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,CN=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,TN=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,DN=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,PN=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,LN=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,RN=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,ON=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,IN=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,NN=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,BN=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,kN=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,zN=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,FN=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,UN=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,HN=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,GN=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,VN=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,jN=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,WN=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,qN=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,YN=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,XN=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,QN=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,JN=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,KN=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,ZN=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,$N=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,eB=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,tB=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,rB=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,iB=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,nB=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,sB=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,aB=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,oB=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,lB=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,hB=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,uB=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,cB=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,dB=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,fB=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,pB=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,mB=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,gB=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,vB=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,yB=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,xB=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,wB=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,bB=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,_B=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,SB=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,MB=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,AB=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,EB=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,CB=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,TB=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,DB=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,PB=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,LB=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,RB=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,OB=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,IB=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,NB=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,BB=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,kB=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zB=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,FB=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,UB=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,HB=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,GB=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,VB=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,jB=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,WB=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qB=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,YB=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,XB=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,QB=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,JB=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,KB=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ZB=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,$B=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,_t={alphamap_fragment:AI,alphamap_pars_fragment:EI,alphatest_fragment:CI,alphatest_pars_fragment:TI,aomap_fragment:DI,aomap_pars_fragment:PI,begin_vertex:LI,beginnormal_vertex:RI,bsdfs:OI,iridescence_fragment:II,bumpmap_pars_fragment:NI,clipping_planes_fragment:BI,clipping_planes_pars_fragment:kI,clipping_planes_pars_vertex:zI,clipping_planes_vertex:FI,color_fragment:UI,color_pars_fragment:HI,color_pars_vertex:GI,color_vertex:VI,common:jI,cube_uv_reflection_fragment:WI,defaultnormal_vertex:qI,displacementmap_pars_vertex:YI,displacementmap_vertex:XI,emissivemap_fragment:QI,emissivemap_pars_fragment:JI,encodings_fragment:KI,encodings_pars_fragment:ZI,envmap_fragment:$I,envmap_common_pars_fragment:eN,envmap_pars_fragment:tN,envmap_pars_vertex:rN,envmap_physical_pars_fragment:fN,envmap_vertex:iN,fog_vertex:nN,fog_pars_vertex:sN,fog_fragment:aN,fog_pars_fragment:oN,gradientmap_pars_fragment:lN,lightmap_fragment:hN,lightmap_pars_fragment:uN,lights_lambert_vertex:cN,lights_pars_begin:dN,lights_toon_fragment:pN,lights_toon_pars_fragment:mN,lights_phong_fragment:gN,lights_phong_pars_fragment:vN,lights_physical_fragment:yN,lights_physical_pars_fragment:xN,lights_fragment_begin:wN,lights_fragment_maps:bN,lights_fragment_end:_N,logdepthbuf_fragment:SN,logdepthbuf_pars_fragment:MN,logdepthbuf_pars_vertex:AN,logdepthbuf_vertex:EN,map_fragment:CN,map_pars_fragment:TN,map_particle_fragment:DN,map_particle_pars_fragment:PN,metalnessmap_fragment:LN,metalnessmap_pars_fragment:RN,morphcolor_vertex:ON,morphnormal_vertex:IN,morphtarget_pars_vertex:NN,morphtarget_vertex:BN,normal_fragment_begin:kN,normal_fragment_maps:zN,normal_pars_fragment:FN,normal_pars_vertex:UN,normal_vertex:HN,normalmap_pars_fragment:GN,clearcoat_normal_fragment_begin:VN,clearcoat_normal_fragment_maps:jN,clearcoat_pars_fragment:WN,iridescence_pars_fragment:qN,output_fragment:YN,packing:XN,premultiplied_alpha_fragment:QN,project_vertex:JN,dithering_fragment:KN,dithering_pars_fragment:ZN,roughnessmap_fragment:$N,roughnessmap_pars_fragment:eB,shadowmap_pars_fragment:tB,shadowmap_pars_vertex:rB,shadowmap_vertex:iB,shadowmask_pars_fragment:nB,skinbase_vertex:sB,skinning_pars_vertex:aB,skinning_vertex:oB,skinnormal_vertex:lB,specularmap_fragment:hB,specularmap_pars_fragment:uB,tonemapping_fragment:cB,tonemapping_pars_fragment:dB,transmission_fragment:fB,transmission_pars_fragment:pB,uv_pars_fragment:mB,uv_pars_vertex:gB,uv_vertex:vB,uv2_pars_fragment:yB,uv2_pars_vertex:xB,uv2_vertex:wB,worldpos_vertex:bB,background_vert:_B,background_frag:SB,cube_vert:MB,cube_frag:AB,depth_vert:EB,depth_frag:CB,distanceRGBA_vert:TB,distanceRGBA_frag:DB,equirect_vert:PB,equirect_frag:LB,linedashed_vert:RB,linedashed_frag:OB,meshbasic_vert:IB,meshbasic_frag:NB,meshlambert_vert:BB,meshlambert_frag:kB,meshmatcap_vert:zB,meshmatcap_frag:FB,meshnormal_vert:UB,meshnormal_frag:HB,meshphong_vert:GB,meshphong_frag:VB,meshphysical_vert:jB,meshphysical_frag:WB,meshtoon_vert:qB,meshtoon_frag:YB,points_vert:XB,points_frag:QB,shadow_vert:JB,shadow_frag:KB,sprite_vert:ZB,sprite_frag:$B},Pe={common:{diffuse:{value:new Ue(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new xi},uv2Transform:{value:new xi},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new $(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ue(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ue(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new xi}},sprite:{diffuse:{value:new Ue(16777215)},opacity:{value:1},center:{value:new $(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new xi}}},Bs={basic:{uniforms:ci([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.fog]),vertexShader:_t.meshbasic_vert,fragmentShader:_t.meshbasic_frag},lambert:{uniforms:ci([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.fog,Pe.lights,{emissive:{value:new Ue(0)}}]),vertexShader:_t.meshlambert_vert,fragmentShader:_t.meshlambert_frag},phong:{uniforms:ci([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,Pe.lights,{emissive:{value:new Ue(0)},specular:{value:new Ue(1118481)},shininess:{value:30}}]),vertexShader:_t.meshphong_vert,fragmentShader:_t.meshphong_frag},standard:{uniforms:ci([Pe.common,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.roughnessmap,Pe.metalnessmap,Pe.fog,Pe.lights,{emissive:{value:new Ue(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:_t.meshphysical_vert,fragmentShader:_t.meshphysical_frag},toon:{uniforms:ci([Pe.common,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.gradientmap,Pe.fog,Pe.lights,{emissive:{value:new Ue(0)}}]),vertexShader:_t.meshtoon_vert,fragmentShader:_t.meshtoon_frag},matcap:{uniforms:ci([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,{matcap:{value:null}}]),vertexShader:_t.meshmatcap_vert,fragmentShader:_t.meshmatcap_frag},points:{uniforms:ci([Pe.points,Pe.fog]),vertexShader:_t.points_vert,fragmentShader:_t.points_frag},dashed:{uniforms:ci([Pe.common,Pe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:_t.linedashed_vert,fragmentShader:_t.linedashed_frag},depth:{uniforms:ci([Pe.common,Pe.displacementmap]),vertexShader:_t.depth_vert,fragmentShader:_t.depth_frag},normal:{uniforms:ci([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,{opacity:{value:1}}]),vertexShader:_t.meshnormal_vert,fragmentShader:_t.meshnormal_frag},sprite:{uniforms:ci([Pe.sprite,Pe.fog]),vertexShader:_t.sprite_vert,fragmentShader:_t.sprite_frag},background:{uniforms:{uvTransform:{value:new xi},t2D:{value:null}},vertexShader:_t.background_vert,fragmentShader:_t.background_frag},cube:{uniforms:ci([Pe.envmap,{opacity:{value:1}}]),vertexShader:_t.cube_vert,fragmentShader:_t.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:_t.equirect_vert,fragmentShader:_t.equirect_frag},distanceRGBA:{uniforms:ci([Pe.common,Pe.displacementmap,{referencePosition:{value:new F},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:_t.distanceRGBA_vert,fragmentShader:_t.distanceRGBA_frag},shadow:{uniforms:ci([Pe.lights,Pe.fog,{color:{value:new Ue(0)},opacity:{value:1}}]),vertexShader:_t.shadow_vert,fragmentShader:_t.shadow_frag}};Bs.physical={uniforms:ci([Bs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new $(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ue(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new $},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ue(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ue(1,1,1)},specularColorMap:{value:null}}]),vertexShader:_t.meshphysical_vert,fragmentShader:_t.meshphysical_frag};function ek(e,t,r,i,n,s){let a=new Ue(0),o=n===!0?0:1,l,h,u=null,c=0,d=null;function f(m,g){let v=!1,x=g.isScene===!0?g.background:null;x&&x.isTexture&&(x=t.get(x));let b=e.xr,_=b.getSession&&b.getSession();_&&_.environmentBlendMode==="additive"&&(x=null),x===null?p(a,o):x&&x.isColor&&(p(x,1),v=!0),(e.autoClear||v)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),x&&(x.isCubeTexture||x.mapping===Xd)?(h===void 0&&(h=new Ji(new $o(1,1,1),new Gr({name:"BackgroundCubeMaterial",uniforms:wu(Bs.cube.uniforms),vertexShader:Bs.cube.vertexShader,fragmentShader:Bs.cube.fragmentShader,side:yi,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(E,S,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(h)),h.material.uniforms.envMap.value=x,h.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,(u!==x||c!==x.version||d!==e.toneMapping)&&(h.material.needsUpdate=!0,u=x,c=x.version,d=e.toneMapping),h.layers.enableAll(),m.unshift(h,h.geometry,h.material,0,0,null)):x&&x.isTexture&&(l===void 0&&(l=new Ji(new Mm(2,2),new Gr({name:"BackgroundMaterial",uniforms:wu(Bs.background.uniforms),vertexShader:Bs.background.vertexShader,fragmentShader:Bs.background.fragmentShader,side:Zo,depthTest:!1,depthWrite:!1,fog:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(l)),l.material.uniforms.t2D.value=x,x.matrixAutoUpdate===!0&&x.updateMatrix(),l.material.uniforms.uvTransform.value.copy(x.matrix),(u!==x||c!==x.version||d!==e.toneMapping)&&(l.material.needsUpdate=!0,u=x,c=x.version,d=e.toneMapping),l.layers.enableAll(),m.unshift(l,l.geometry,l.material,0,0,null))}function p(m,g){r.buffers.color.setClear(m.r,m.g,m.b,g,s)}return{getClearColor:function(){return a},setClearColor:function(m,g=1){a.set(m),o=g,p(a,o)},getClearAlpha:function(){return o},setClearAlpha:function(m){o=m,p(a,o)},render:f}}function tk(e,t,r,i){let n=e.getParameter(34921),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),a=i.isWebGL2||s!==null,o={},l=g(null),h=l,u=!1;function c(y,A,D,O,C){let I=!1;if(a){let k=m(O,D,A);h!==k&&(h=k,f(h.object)),I=v(y,O,D,C),I&&x(y,O,D,C)}else{let k=A.wireframe===!0;(h.geometry!==O.id||h.program!==D.id||h.wireframe!==k)&&(h.geometry=O.id,h.program=D.id,h.wireframe=k,I=!0)}C!==null&&r.update(C,34963),(I||u)&&(u=!1,M(y,A,D,O),C!==null&&e.bindBuffer(34963,r.get(C).buffer))}function d(){return i.isWebGL2?e.createVertexArray():s.createVertexArrayOES()}function f(y){return i.isWebGL2?e.bindVertexArray(y):s.bindVertexArrayOES(y)}function p(y){return i.isWebGL2?e.deleteVertexArray(y):s.deleteVertexArrayOES(y)}function m(y,A,D){let O=D.wireframe===!0,C=o[y.id];C===void 0&&(C={},o[y.id]=C);let I=C[A.id];I===void 0&&(I={},C[A.id]=I);let k=I[O];return k===void 0&&(k=g(d()),I[O]=k),k}function g(y){let A=[],D=[],O=[];for(let C=0;C<n;C++)A[C]=0,D[C]=0,O[C]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:A,enabledAttributes:D,attributeDivisors:O,object:y,attributes:{},index:null}}function v(y,A,D,O){let C=h.attributes,I=A.attributes,k=0,L=D.getAttributes();for(let w in L)if(L[w].location>=0){let N=C[w],X=I[w];if(X===void 0&&(w==="instanceMatrix"&&y.instanceMatrix&&(X=y.instanceMatrix),w==="instanceColor"&&y.instanceColor&&(X=y.instanceColor)),N===void 0||N.attribute!==X||X&&N.data!==X.data)return!0;k++}return h.attributesNum!==k||h.index!==O}function x(y,A,D,O){let C={},I=A.attributes,k=0,L=D.getAttributes();for(let w in L)if(L[w].location>=0){let N=I[w];N===void 0&&(w==="instanceMatrix"&&y.instanceMatrix&&(N=y.instanceMatrix),w==="instanceColor"&&y.instanceColor&&(N=y.instanceColor));let X={};X.attribute=N,N&&N.data&&(X.data=N.data),C[w]=X,k++}h.attributes=C,h.attributesNum=k,h.index=O}function b(){let y=h.newAttributes;for(let A=0,D=y.length;A<D;A++)y[A]=0}function _(y){E(y,0)}function E(y,A){let D=h.newAttributes,O=h.enabledAttributes,C=h.attributeDivisors;D[y]=1,O[y]===0&&(e.enableVertexAttribArray(y),O[y]=1),C[y]!==A&&((i.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](y,A),C[y]=A)}function S(){let y=h.newAttributes,A=h.enabledAttributes;for(let D=0,O=A.length;D<O;D++)A[D]!==y[D]&&(e.disableVertexAttribArray(D),A[D]=0)}function P(y,A,D,O,C,I){i.isWebGL2===!0&&(D===5124||D===5125)?e.vertexAttribIPointer(y,A,D,C,I):e.vertexAttribPointer(y,A,D,O,C,I)}function M(y,A,D,O){if(i.isWebGL2===!1&&(y.isInstancedMesh||O.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;b();let C=O.attributes,I=D.getAttributes(),k=A.defaultAttributeValues;for(let L in I){let w=I[L];if(w.location>=0){let N=C[L];if(N===void 0&&(L==="instanceMatrix"&&y.instanceMatrix&&(N=y.instanceMatrix),L==="instanceColor"&&y.instanceColor&&(N=y.instanceColor)),N!==void 0){let X=N.normalized,T=N.itemSize,U=r.get(N);if(U===void 0)continue;let q=U.buffer,W=U.type,J=U.bytesPerElement;if(N.isInterleavedBufferAttribute){let K=N.data,ie=K.stride,Z=N.offset;if(K.isInstancedInterleavedBuffer){for(let ue=0;ue<w.locationSize;ue++)E(w.location+ue,K.meshPerAttribute);y.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=K.meshPerAttribute*K.count)}else for(let ue=0;ue<w.locationSize;ue++)_(w.location+ue);e.bindBuffer(34962,q);for(let ue=0;ue<w.locationSize;ue++)P(w.location+ue,T/w.locationSize,W,X,ie*J,(Z+T/w.locationSize*ue)*J)}else{if(N.isInstancedBufferAttribute){for(let K=0;K<w.locationSize;K++)E(w.location+K,N.meshPerAttribute);y.isInstancedMesh!==!0&&O._maxInstanceCount===void 0&&(O._maxInstanceCount=N.meshPerAttribute*N.count)}else for(let K=0;K<w.locationSize;K++)_(w.location+K);e.bindBuffer(34962,q);for(let K=0;K<w.locationSize;K++)P(w.location+K,T/w.locationSize,W,X,T*J,T/w.locationSize*K*J)}}else if(k!==void 0){let X=k[L];if(X!==void 0)switch(X.length){case 2:e.vertexAttrib2fv(w.location,X);break;case 3:e.vertexAttrib3fv(w.location,X);break;case 4:e.vertexAttrib4fv(w.location,X);break;default:e.vertexAttrib1fv(w.location,X)}}}}S()}function B(){Q();for(let y in o){let A=o[y];for(let D in A){let O=A[D];for(let C in O)p(O[C].object),delete O[C];delete A[D]}delete o[y]}}function R(y){if(o[y.id]===void 0)return;let A=o[y.id];for(let D in A){let O=A[D];for(let C in O)p(O[C].object),delete O[C];delete A[D]}delete o[y.id]}function H(y){for(let A in o){let D=o[A];if(D[y.id]===void 0)continue;let O=D[y.id];for(let C in O)p(O[C].object),delete O[C];delete D[y.id]}}function Q(){z(),u=!0,h!==l&&(h=l,f(h.object))}function z(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:c,reset:Q,resetDefaultState:z,dispose:B,releaseStatesOfGeometry:R,releaseStatesOfProgram:H,initAttributes:b,enableAttribute:_,disableUnusedAttributes:S}}function rk(e,t,r,i){let n=i.isWebGL2,s;function a(h){s=h}function o(h,u){e.drawArrays(s,h,u),r.update(u,s,1)}function l(h,u,c){if(c===0)return;let d,f;if(n)d=e,f="drawArraysInstanced";else if(d=t.get("ANGLE_instanced_arrays"),f="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[f](s,h,u,c),r.update(u,s,c)}this.setMode=a,this.render=o,this.renderInstances=l}function ik(e,t,r){let i;function n(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){let P=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(P.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(P){if(P==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";P="mediump"}return P==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let a=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&e instanceof WebGL2ComputeRenderingContext,o=r.precision!==void 0?r.precision:"highp",l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);let h=a||t.has("WEBGL_draw_buffers"),u=r.logarithmicDepthBuffer===!0,c=e.getParameter(34930),d=e.getParameter(35660),f=e.getParameter(3379),p=e.getParameter(34076),m=e.getParameter(34921),g=e.getParameter(36347),v=e.getParameter(36348),x=e.getParameter(36349),b=d>0,_=a||t.has("OES_texture_float"),E=b&&_,S=a?e.getParameter(36183):0;return{isWebGL2:a,drawBuffers:h,getMaxAnisotropy:n,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:d,maxTextureSize:f,maxCubemapSize:p,maxAttributes:m,maxVertexUniforms:g,maxVaryings:v,maxFragmentUniforms:x,vertexTextures:b,floatFragmentTextures:_,floatVertexTextures:E,maxSamples:S}}function nk(e){let t=this,r=null,i=0,n=!1,s=!1,a=new Ns,o=new xi,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(c,d,f){let p=c.length!==0||d||i!==0||n;return n=d,r=u(c,f,0),i=c.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1,h()},this.setState=function(c,d,f){let p=c.clippingPlanes,m=c.clipIntersection,g=c.clipShadows,v=e.get(c);if(!n||p===null||p.length===0||s&&!g)s?u(null):h();else{let x=s?0:i,b=x*4,_=v.clippingState||null;l.value=_,_=u(p,d,b,f);for(let E=0;E!==b;++E)_[E]=r[E];v.clippingState=_,this.numIntersection=m?this.numPlanes:0,this.numPlanes+=x}};function h(){l.value!==r&&(l.value=r,l.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function u(c,d,f,p){let m=c!==null?c.length:0,g=null;if(m!==0){if(g=l.value,p!==!0||g===null){let v=f+m*4,x=d.matrixWorldInverse;o.getNormalMatrix(x),(g===null||g.length<v)&&(g=new Float32Array(v));for(let b=0,_=f;b!==m;++b,_+=4)a.copy(c[b]).applyMatrix4(x,o),a.normal.toArray(g,_),g[_+3]=a.constant}l.value=g,l.needsUpdate=!0}return t.numPlanes=m,t.numIntersection=0,g}}function sk(e){let t=new WeakMap;function r(a,o){return o===ly?a.mapping=zl:o===hy&&(a.mapping=Fl),a}function i(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){let o=a.mapping;if(o===ly||o===hy)if(t.has(a)){let l=t.get(a).texture;return r(l,a.mapping)}else{let l=a.image;if(l&&l.height>0){let h=new bI(l.height/2);return h.fromEquirectangularTexture(e,a),t.set(a,h),a.addEventListener("dispose",n),r(h.texture,a.mapping)}else return null}}return a}function n(a){let o=a.target;o.removeEventListener("dispose",n);let l=t.get(o);l!==void 0&&(t.delete(o),l.dispose())}function s(){t=new WeakMap}return{get:i,dispose:s}}var Ow=class extends Bu{constructor(e=-1,t=1,r=1,i=-1,n=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=n,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,n,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=n,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2,n=r-e,s=r+e,a=i+t,o=i-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=l*this.view.offsetX,s=n+l*this.view.width,a-=h*this.view.offsetY,o=a-h*this.view.height}this.projectionMatrix.makeOrthographic(n,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},Wh=4,rS=[.125,.215,.35,.446,.526,.582],yl=20,rv=new Ow,iS=new Ue,iv=null,gl=(1+Math.sqrt(5))/2,vh=1/gl,nS=[new F(1,1,1),new F(-1,1,1),new F(1,1,-1),new F(-1,1,-1),new F(0,gl,vh),new F(0,gl,-vh),new F(vh,0,gl),new F(-vh,0,gl),new F(gl,vh,0),new F(-gl,vh,0)],sS=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100){iv=this._renderer.getRenderTarget(),this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,r,i,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=lS(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=oS(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(iv),e.scissorTest=!1,Jf(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===zl||e.mapping===Fl?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),iv=this._renderer.getRenderTarget();let r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:Wt,minFilter:Wt,generateMipmaps:!1,type:Ad,format:hs,encoding:la,depthBuffer:!1},i=aS(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=aS(e,t,r);let{_lodMax:n}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=ak(n)),this._blurMaterial=ok(n,e,t)}return i}_compileMaterial(e){let t=new Ji(this._lodPlanes[0],e);this._renderer.compile(t,rv)}_sceneToCubeUV(e,t,r,i){let n=new gi(90,1,t,r),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,h=o.toneMapping;o.getClearColor(iS),o.toneMapping=Ga,o.autoClear=!1;let u=new Gl({name:"PMREM.Background",side:yi,depthWrite:!1,depthTest:!1}),c=new Ji(new $o,u),d=!1,f=e.background;f?f.isColor&&(u.color.copy(f),e.background=null,d=!0):(u.color.copy(iS),d=!0);for(let p=0;p<6;p++){let m=p%3;m===0?(n.up.set(0,s[p],0),n.lookAt(a[p],0,0)):m===1?(n.up.set(0,0,s[p]),n.lookAt(0,a[p],0)):(n.up.set(0,s[p],0),n.lookAt(0,0,a[p]));let g=this._cubeSize;Jf(i,m*g,p>2?g:0,g,g),o.setRenderTarget(i),d&&o.render(c,n),o.render(e,n)}c.geometry.dispose(),c.material.dispose(),o.toneMapping=h,o.autoClear=l,e.background=f}_textureToCubeUV(e,t){let r=this._renderer,i=e.mapping===zl||e.mapping===Fl;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=lS()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=oS());let n=i?this._cubemapMaterial:this._equirectMaterial,s=new Ji(this._lodPlanes[0],n),a=n.uniforms;a.envMap.value=e;let o=this._cubeSize;Jf(t,0,0,3*o,2*o),r.setRenderTarget(t),r.render(s,rv)}_applyPMREM(e){let t=this._renderer,r=t.autoClear;t.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){let n=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),s=nS[(i-1)%nS.length];this._blur(e,i-1,i,n,s)}t.autoClear=r}_blur(e,t,r,i,n){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,r,i,"latitudinal",n),this._halfBlur(s,e,r,r,i,"longitudinal",n)}_halfBlur(e,t,r,i,n,s,a){let o=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let h=3,u=new Ji(this._lodPlanes[i],l),c=l.uniforms,d=this._sizeLods[r]-1,f=isFinite(n)?Math.PI/(2*d):2*Math.PI/(2*yl-1),p=n/f,m=isFinite(n)?1+Math.floor(h*p):yl;m>yl&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${yl}`);let g=[],v=0;for(let S=0;S<yl;++S){let P=S/p,M=Math.exp(-P*P/2);g.push(M),S===0?v+=M:S<m&&(v+=2*M)}for(let S=0;S<g.length;S++)g[S]=g[S]/v;c.envMap.value=e.texture,c.samples.value=m,c.weights.value=g,c.latitudinal.value=s==="latitudinal",a&&(c.poleAxis.value=a);let{_lodMax:x}=this;c.dTheta.value=f,c.mipInt.value=x-r;let b=this._sizeLods[i],_=3*b*(i>x-Wh?i-x+Wh:0),E=4*(this._cubeSize-b);Jf(t,_,E,3*b,2*b),o.setRenderTarget(t),o.render(u,rv)}};function ak(e){let t=[],r=[],i=[],n=e,s=e-Wh+1+rS.length;for(let a=0;a<s;a++){let o=Math.pow(2,n);r.push(o);let l=1/o;a>e-Wh?l=rS[a-e+Wh-1]:a===0&&(l=0),i.push(l);let h=1/(o-2),u=-h,c=1+h,d=[u,u,c,u,c,c,u,u,c,c,u,c],f=6,p=6,m=3,g=2,v=1,x=new Float32Array(m*p*f),b=new Float32Array(g*p*f),_=new Float32Array(v*p*f);for(let S=0;S<f;S++){let P=S%3*2/3-1,M=S>2?0:-1,B=[P,M,0,P+2/3,M,0,P+2/3,M+1,0,P,M,0,P+2/3,M+1,0,P,M+1,0];x.set(B,m*p*S),b.set(d,g*p*S);let R=[S,S,S,S,S,S];_.set(R,v*p*S)}let E=new vt;E.setAttribute("position",new Ct(x,m)),E.setAttribute("uv",new Ct(b,g)),E.setAttribute("faceIndex",new Ct(_,v)),t.push(E),n>Wh&&n--}return{lodPlanes:t,sizeLods:r,sigmas:i}}function aS(e,t,r){let i=new Or(e,t,r);return i.texture.mapping=Xd,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Jf(e,t,r,i,n){e.viewport.set(t,r,i,n),e.scissor.set(t,r,i,n)}function ok(e,t,r){let i=new Float32Array(yl),n=new F(0,1,0);return new Gr({name:"SphericalGaussianBlur",defines:{n:yl,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:Iw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ii,depthTest:!1,depthWrite:!1})}function oS(){return new Gr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Iw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ii,depthTest:!1,depthWrite:!1})}function lS(){return new Gr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Iw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ii,depthTest:!1,depthWrite:!1})}function Iw(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function lk(e){let t=new WeakMap,r=null;function i(o){if(o&&o.isTexture){let l=o.mapping,h=l===ly||l===hy,u=l===zl||l===Fl;if(h||u)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let c=t.get(o);return r===null&&(r=new sS(e)),c=h?r.fromEquirectangular(o,c):r.fromCubemap(o,c),t.set(o,c),c.texture}else{if(t.has(o))return t.get(o).texture;{let c=o.image;if(h&&c&&c.height>0||u&&c&&n(c)){r===null&&(r=new sS(e));let d=h?r.fromEquirectangular(o):r.fromCubemap(o);return t.set(o,d),o.addEventListener("dispose",s),d.texture}else return null}}}return o}function n(o){let l=0,h=6;for(let u=0;u<h;u++)o[u]!==void 0&&l++;return l===h}function s(o){let l=o.target;l.removeEventListener("dispose",s);let h=t.get(l);h!==void 0&&(t.delete(l),h.dispose())}function a(){t=new WeakMap,r!==null&&(r.dispose(),r=null)}return{get:i,dispose:a}}function hk(e){let t={};function r(i){if(t[i]!==void 0)return t[i];let n;switch(i){case"WEBGL_depth_texture":n=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=e.getExtension(i)}return t[i]=n,n}return{has:function(i){return r(i)!==null},init:function(i){i.isWebGL2?r("EXT_color_buffer_float"):(r("WEBGL_depth_texture"),r("OES_texture_float"),r("OES_texture_half_float"),r("OES_texture_half_float_linear"),r("OES_standard_derivatives"),r("OES_element_index_uint"),r("OES_vertex_array_object"),r("ANGLE_instanced_arrays")),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture")},get:function(i){let n=r(i);return n===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}}function uk(e,t,r,i){let n={},s=new WeakMap;function a(c){let d=c.target;d.index!==null&&t.remove(d.index);for(let p in d.attributes)t.remove(d.attributes[p]);d.removeEventListener("dispose",a),delete n[d.id];let f=s.get(d);f&&(t.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,r.memory.geometries--}function o(c,d){return n[d.id]===!0||(d.addEventListener("dispose",a),n[d.id]=!0,r.memory.geometries++),d}function l(c){let d=c.attributes;for(let p in d)t.update(d[p],34962);let f=c.morphAttributes;for(let p in f){let m=f[p];for(let g=0,v=m.length;g<v;g++)t.update(m[g],34962)}}function h(c){let d=[],f=c.index,p=c.attributes.position,m=0;if(f!==null){let x=f.array;m=f.version;for(let b=0,_=x.length;b<_;b+=3){let E=x[b+0],S=x[b+1],P=x[b+2];d.push(E,S,S,P,P,E)}}else{let x=p.array;m=p.version;for(let b=0,_=x.length/3-1;b<_;b+=3){let E=b+0,S=b+1,P=b+2;d.push(E,S,S,P,P,E)}}let g=new(_T(d)?Qc:CT)(d,1);g.version=m;let v=s.get(c);v&&t.remove(v),s.set(c,g)}function u(c){let d=s.get(c);if(d){let f=c.index;f!==null&&d.version<f.version&&h(c)}else h(c);return s.get(c)}return{get:o,update:l,getWireframeAttribute:u}}function ck(e,t,r,i){let n=i.isWebGL2,s;function a(d){s=d}let o,l;function h(d){o=d.type,l=d.bytesPerElement}function u(d,f){e.drawElements(s,f,o,d*l),r.update(f,s,1)}function c(d,f,p){if(p===0)return;let m,g;if(n)m=e,g="drawElementsInstanced";else if(m=t.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[g](s,f,o,d*l,p),r.update(f,s,p)}this.setMode=a,this.setIndex=h,this.render=u,this.renderInstances=c}function dk(e){let t={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(r.calls++,a){case 4:r.triangles+=o*(s/3);break;case 1:r.lines+=o*(s/2);break;case 3:r.lines+=o*(s-1);break;case 2:r.lines+=o*s;break;case 0:r.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function n(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:t,render:r,programs:null,autoReset:!0,reset:n,update:i}}function fk(e,t){return e[0]-t[0]}function pk(e,t){return Math.abs(t[1])-Math.abs(e[1])}function nv(e,t){let r=1,i=t.isInterleavedBufferAttribute?t.data.array:t.array;i instanceof Int8Array?r=127:i instanceof Int16Array?r=32767:i instanceof Int32Array?r=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),e.divideScalar(r)}function mk(e,t,r){let i={},n=new Float32Array(8),s=new WeakMap,a=new Tt,o=[];for(let h=0;h<8;h++)o[h]=[h,0];function l(h,u,c,d){let f=h.morphTargetInfluences;if(t.isWebGL2===!0){let p=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,m=p!==void 0?p.length:0,g=s.get(u);if(g===void 0||g.count!==m){let b=function(){y.dispose(),s.delete(u),u.removeEventListener("dispose",b)};g!==void 0&&g.texture.dispose();let _=u.morphAttributes.position!==void 0,E=u.morphAttributes.normal!==void 0,S=u.morphAttributes.color!==void 0,P=u.morphAttributes.position||[],M=u.morphAttributes.normal||[],B=u.morphAttributes.color||[],R=0;_===!0&&(R=1),E===!0&&(R=2),S===!0&&(R=3);let H=u.attributes.position.count*R,Q=1;H>t.maxTextureSize&&(Q=Math.ceil(H/t.maxTextureSize),H=t.maxTextureSize);let z=new Float32Array(H*Q*4*m),y=new ET(z,H,Q,m);y.type=bl,y.needsUpdate=!0;let A=R*4;for(let D=0;D<m;D++){let O=P[D],C=M[D],I=B[D],k=H*Q*4*D;for(let L=0;L<O.count;L++){let w=L*A;_===!0&&(a.fromBufferAttribute(O,L),O.normalized===!0&&nv(a,O),z[k+w+0]=a.x,z[k+w+1]=a.y,z[k+w+2]=a.z,z[k+w+3]=0),E===!0&&(a.fromBufferAttribute(C,L),C.normalized===!0&&nv(a,C),z[k+w+4]=a.x,z[k+w+5]=a.y,z[k+w+6]=a.z,z[k+w+7]=0),S===!0&&(a.fromBufferAttribute(I,L),I.normalized===!0&&nv(a,I),z[k+w+8]=a.x,z[k+w+9]=a.y,z[k+w+10]=a.z,z[k+w+11]=I.itemSize===4?a.w:1)}}g={count:m,texture:y,size:new $(H,Q)},s.set(u,g),u.addEventListener("dispose",b)}let v=0;for(let b=0;b<f.length;b++)v+=f[b];let x=u.morphTargetsRelative?1:1-v;d.getUniforms().setValue(e,"morphTargetBaseInfluence",x),d.getUniforms().setValue(e,"morphTargetInfluences",f),d.getUniforms().setValue(e,"morphTargetsTexture",g.texture,r),d.getUniforms().setValue(e,"morphTargetsTextureSize",g.size)}else{let p=f===void 0?0:f.length,m=i[u.id];if(m===void 0||m.length!==p){m=[];for(let _=0;_<p;_++)m[_]=[_,0];i[u.id]=m}for(let _=0;_<p;_++){let E=m[_];E[0]=_,E[1]=f[_]}m.sort(pk);for(let _=0;_<8;_++)_<p&&m[_][1]?(o[_][0]=m[_][0],o[_][1]=m[_][1]):(o[_][0]=Number.MAX_SAFE_INTEGER,o[_][1]=0);o.sort(fk);let g=u.morphAttributes.position,v=u.morphAttributes.normal,x=0;for(let _=0;_<8;_++){let E=o[_],S=E[0],P=E[1];S!==Number.MAX_SAFE_INTEGER&&P?(g&&u.getAttribute("morphTarget"+_)!==g[S]&&u.setAttribute("morphTarget"+_,g[S]),v&&u.getAttribute("morphNormal"+_)!==v[S]&&u.setAttribute("morphNormal"+_,v[S]),n[_]=P,x+=P):(g&&u.hasAttribute("morphTarget"+_)===!0&&u.deleteAttribute("morphTarget"+_),v&&u.hasAttribute("morphNormal"+_)===!0&&u.deleteAttribute("morphNormal"+_),n[_]=0)}let b=u.morphTargetsRelative?1:1-x;d.getUniforms().setValue(e,"morphTargetBaseInfluence",b),d.getUniforms().setValue(e,"morphTargetInfluences",n)}}return{update:l}}function gk(e,t,r,i){let n=new WeakMap;function s(l){let h=i.render.frame,u=l.geometry,c=t.get(l,u);return n.get(c)!==h&&(t.update(c),n.set(c,h)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),r.update(l.instanceMatrix,34962),l.instanceColor!==null&&r.update(l.instanceColor,34962)),c}function a(){n=new WeakMap}function o(l){let h=l.target;h.removeEventListener("dispose",o),r.remove(h.instanceMatrix),h.instanceColor!==null&&r.remove(h.instanceColor)}return{update:s,dispose:a}}var DT=new Qr,PT=new ET,LT=new oI,RT=new Lw,hS=[],uS=[],cS=new Float32Array(16),dS=new Float32Array(9),fS=new Float32Array(4);function ku(e,t,r){let i=e[0];if(i<=0||i>0)return e;let n=t*r,s=hS[n];if(s===void 0&&(s=new Float32Array(n),hS[n]=s),t!==0){i.toArray(s,0);for(let a=1,o=0;a!==t;++a)o+=r,e[a].toArray(s,o)}return s}function Oi(e,t){if(e.length!==t.length)return!1;for(let r=0,i=e.length;r<i;r++)if(e[r]!==t[r])return!1;return!0}function Ii(e,t){for(let r=0,i=t.length;r<i;r++)e[r]=t[r]}function Am(e,t){let r=uS[t];r===void 0&&(r=new Int32Array(t),uS[t]=r);for(let i=0;i!==t;++i)r[i]=e.allocateTextureUnit();return r}function vk(e,t){let r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function yk(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(Oi(r,t))return;e.uniform2fv(this.addr,t),Ii(r,t)}}function xk(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(t.r!==void 0)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(Oi(r,t))return;e.uniform3fv(this.addr,t),Ii(r,t)}}function wk(e,t){let r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(Oi(r,t))return;e.uniform4fv(this.addr,t),Ii(r,t)}}function bk(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Oi(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),Ii(r,t)}else{if(Oi(r,i))return;fS.set(i),e.uniformMatrix2fv(this.addr,!1,fS),Ii(r,i)}}function _k(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Oi(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),Ii(r,t)}else{if(Oi(r,i))return;dS.set(i),e.uniformMatrix3fv(this.addr,!1,dS),Ii(r,i)}}function Sk(e,t){let r=this.cache,i=t.elements;if(i===void 0){if(Oi(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),Ii(r,t)}else{if(Oi(r,i))return;cS.set(i),e.uniformMatrix4fv(this.addr,!1,cS),Ii(r,i)}}function Mk(e,t){let r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function Ak(e,t){let r=this.cache;Oi(r,t)||(e.uniform2iv(this.addr,t),Ii(r,t))}function Ek(e,t){let r=this.cache;Oi(r,t)||(e.uniform3iv(this.addr,t),Ii(r,t))}function Ck(e,t){let r=this.cache;Oi(r,t)||(e.uniform4iv(this.addr,t),Ii(r,t))}function Tk(e,t){let r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function Dk(e,t){let r=this.cache;Oi(r,t)||(e.uniform2uiv(this.addr,t),Ii(r,t))}function Pk(e,t){let r=this.cache;Oi(r,t)||(e.uniform3uiv(this.addr,t),Ii(r,t))}function Lk(e,t){let r=this.cache;Oi(r,t)||(e.uniform4uiv(this.addr,t),Ii(r,t))}function Rk(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2D(t||DT,n)}function Ok(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture3D(t||LT,n)}function Ik(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTextureCube(t||RT,n)}function Nk(e,t,r){let i=this.cache,n=r.allocateTextureUnit();i[0]!==n&&(e.uniform1i(this.addr,n),i[0]=n),r.setTexture2DArray(t||PT,n)}function Bk(e){switch(e){case 5126:return vk;case 35664:return yk;case 35665:return xk;case 35666:return wk;case 35674:return bk;case 35675:return _k;case 35676:return Sk;case 5124:case 35670:return Mk;case 35667:case 35671:return Ak;case 35668:case 35672:return Ek;case 35669:case 35673:return Ck;case 5125:return Tk;case 36294:return Dk;case 36295:return Pk;case 36296:return Lk;case 35678:case 36198:case 36298:case 36306:case 35682:return Rk;case 35679:case 36299:case 36307:return Ok;case 35680:case 36300:case 36308:case 36293:return Ik;case 36289:case 36303:case 36311:case 36292:return Nk}}function kk(e,t){e.uniform1fv(this.addr,t)}function zk(e,t){let r=ku(t,this.size,2);e.uniform2fv(this.addr,r)}function Fk(e,t){let r=ku(t,this.size,3);e.uniform3fv(this.addr,r)}function Uk(e,t){let r=ku(t,this.size,4);e.uniform4fv(this.addr,r)}function Hk(e,t){let r=ku(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function Gk(e,t){let r=ku(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function Vk(e,t){let r=ku(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function jk(e,t){e.uniform1iv(this.addr,t)}function Wk(e,t){e.uniform2iv(this.addr,t)}function qk(e,t){e.uniform3iv(this.addr,t)}function Yk(e,t){e.uniform4iv(this.addr,t)}function Xk(e,t){e.uniform1uiv(this.addr,t)}function Qk(e,t){e.uniform2uiv(this.addr,t)}function Jk(e,t){e.uniform3uiv(this.addr,t)}function Kk(e,t){e.uniform4uiv(this.addr,t)}function Zk(e,t,r){let i=t.length,n=Am(r,i);e.uniform1iv(this.addr,n);for(let s=0;s!==i;++s)r.setTexture2D(t[s]||DT,n[s])}function $k(e,t,r){let i=t.length,n=Am(r,i);e.uniform1iv(this.addr,n);for(let s=0;s!==i;++s)r.setTexture3D(t[s]||LT,n[s])}function e8(e,t,r){let i=t.length,n=Am(r,i);e.uniform1iv(this.addr,n);for(let s=0;s!==i;++s)r.setTextureCube(t[s]||RT,n[s])}function t8(e,t,r){let i=t.length,n=Am(r,i);e.uniform1iv(this.addr,n);for(let s=0;s!==i;++s)r.setTexture2DArray(t[s]||PT,n[s])}function r8(e){switch(e){case 5126:return kk;case 35664:return zk;case 35665:return Fk;case 35666:return Uk;case 35674:return Hk;case 35675:return Gk;case 35676:return Vk;case 5124:case 35670:return jk;case 35667:case 35671:return Wk;case 35668:case 35672:return qk;case 35669:case 35673:return Yk;case 5125:return Xk;case 36294:return Qk;case 36295:return Jk;case 36296:return Kk;case 35678:case 36198:case 36298:case 36306:case 35682:return Zk;case 35679:case 36299:case 36307:return $k;case 35680:case 36300:case 36308:case 36293:return e8;case 36289:case 36303:case 36311:case 36292:return t8}}var i8=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.setValue=Bk(t.type)}},n8=class{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.size=t.size,this.setValue=r8(t.type)}},s8=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){let i=this.seq;for(let n=0,s=i.length;n!==s;++n){let a=i[n];a.setValue(e,t[a.id],r)}}},sv=/(\w+)(\])?(\[|\.)?/g;function pS(e,t){e.seq.push(t),e.map[t.id]=t}function a8(e,t,r){let i=e.name,n=i.length;for(sv.lastIndex=0;;){let s=sv.exec(i),a=sv.lastIndex,o=s[1],l=s[2]==="]",h=s[3];if(l&&(o=o|0),h===void 0||h==="["&&a+2===n){pS(r,h===void 0?new i8(o,e,t):new n8(o,e,t));break}else{let u=r.map[o];u===void 0&&(u=new s8(o),pS(r,u)),r=u}}}var Up=class{constructor(e,t){this.seq=[],this.map={};let r=e.getProgramParameter(t,35718);for(let i=0;i<r;++i){let n=e.getActiveUniform(t,i),s=e.getUniformLocation(t,n.name);a8(n,s,this)}}setValue(e,t,r,i){let n=this.map[t];n!==void 0&&n.setValue(e,r,i)}setOptional(e,t,r){let i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let n=0,s=t.length;n!==s;++n){let a=t[n],o=r[a.id];o.needsUpdate!==!1&&a.setValue(e,o.value,i)}}static seqWithValue(e,t){let r=[];for(let i=0,n=e.length;i!==n;++i){let s=e[i];s.id in t&&r.push(s)}return r}};function mS(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}var o8=0;function l8(e,t){let r=e.split(`
`),i=[],n=Math.max(t-6,0),s=Math.min(t+6,r.length);for(let a=n;a<s;a++){let o=a+1;i.push(`${o===t?">":" "} ${o}: ${r[a]}`)}return i.join(`
`)}function h8(e){switch(e){case la:return["Linear","( value )"];case St:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function gS(e,t,r){let i=e.getShaderParameter(t,35713),n=e.getShaderInfoLog(t).trim();if(i&&n==="")return"";let s=/ERROR: 0:(\d+)/.exec(n);if(s){let a=parseInt(s[1]);return r.toUpperCase()+`

`+n+`

`+l8(e.getShaderSource(t),a)}else return n}function u8(e,t){let r=h8(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function c8(e,t){let r;switch(t){case xO:r="Linear";break;case wO:r="Reinhard";break;case bO:r="OptimizedCineon";break;case _O:r="ACESFilmic";break;case SO:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function d8(e){return[e.extensionDerivatives||!!e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Dc).join(`
`)}function f8(e){let t=[];for(let r in e){let i=e[r];i!==!1&&t.push("#define "+r+" "+i)}return t.join(`
`)}function p8(e,t){let r={},i=e.getProgramParameter(t,35721);for(let n=0;n<i;n++){let s=e.getActiveAttrib(t,n),a=s.name,o=1;s.type===35674&&(o=2),s.type===35675&&(o=3),s.type===35676&&(o=4),r[a]={type:s.type,location:e.getAttribLocation(t,a),locationSize:o}}return r}function Dc(e){return e!==""}function vS(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function yS(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var m8=/^[ \t]*#include +<([\w\d./]+)>/gm;function py(e){return e.replace(m8,g8)}function g8(e,t){let r=_t[t];if(r===void 0)throw new Error("Can not resolve #include <"+t+">");return py(r)}var v8=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,y8=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function xS(e){return e.replace(y8,OT).replace(v8,x8)}function x8(e,t,r,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),OT(e,t,r,i)}function OT(e,t,r,i){let n="";for(let s=parseInt(t);s<parseInt(r);s++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return n}function wS(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function w8(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===Tw?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===vT?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Tc&&(t="SHADOWMAP_TYPE_VSM"),t}function b8(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case zl:case Fl:t="ENVMAP_TYPE_CUBE";break;case Xd:t="ENVMAP_TYPE_CUBE_UV";break}return t}function _8(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Fl:t="ENVMAP_MODE_REFRACTION";break}return t}function S8(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case _m:t="ENVMAP_BLENDING_MULTIPLY";break;case vO:t="ENVMAP_BLENDING_MIX";break;case yO:t="ENVMAP_BLENDING_ADD";break}return t}function M8(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let r=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),7*16)),texelHeight:i,maxMip:r}}function A8(e,t,r,i){let n=e.getContext(),s=r.defines,a=r.vertexShader,o=r.fragmentShader,l=w8(r),h=b8(r),u=_8(r),c=S8(r),d=M8(r),f=r.isWebGL2?"":d8(r),p=f8(s),m=n.createProgram(),g,v,x=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(g=[p].filter(Dc).join(`
`),g.length>0&&(g+=`
`),v=[f,p].filter(Dc).join(`
`),v.length>0&&(v+=`
`)):(g=[wS(r),"#define SHADER_NAME "+r.shaderName,p,r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.supportsVertexTextures?"#define VERTEX_TEXTURES":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.displacementMap&&r.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors&&r.isWebGL2?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0&&r.isWebGL2?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Dc).join(`
`),v=[f,wS(r),"#define SHADER_NAME "+r.shaderName,p,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+h:"",r.envMap?"#define "+u:"",r.envMap?"#define "+c:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMap&&r.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",r.normalMap&&r.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",r.specularColorMap?"#define USE_SPECULARCOLORMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEENCOLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.vertexTangents?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUvs?"#define USE_UV":"",r.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.logarithmicDepthBuffer&&r.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==Ga?"#define TONE_MAPPING":"",r.toneMapping!==Ga?_t.tonemapping_pars_fragment:"",r.toneMapping!==Ga?c8("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",_t.encodings_pars_fragment,u8("linearToOutputTexel",r.outputEncoding),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(Dc).join(`
`)),a=py(a),a=vS(a,r),a=yS(a,r),o=py(o),o=vS(o,r),o=yS(o,r),a=xS(a),o=xS(o),r.isWebGL2&&r.isRawShaderMaterial!==!0&&(x=`#version 300 es
`,g=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,v=["#define varying in",r.glslVersion===V_?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===V_?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);let b=x+g+a,_=x+v+o,E=mS(n,35633,b),S=mS(n,35632,_);if(n.attachShader(m,E),n.attachShader(m,S),r.index0AttributeName!==void 0?n.bindAttribLocation(m,0,r.index0AttributeName):r.morphTargets===!0&&n.bindAttribLocation(m,0,"position"),n.linkProgram(m),e.debug.checkShaderErrors){let B=n.getProgramInfoLog(m).trim(),R=n.getShaderInfoLog(E).trim(),H=n.getShaderInfoLog(S).trim(),Q=!0,z=!0;if(n.getProgramParameter(m,35714)===!1){Q=!1;let y=gS(n,E,"vertex"),A=gS(n,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(m,35715)+`

Program Info Log: `+B+`
`+y+`
`+A)}else B!==""?console.warn("THREE.WebGLProgram: Program Info Log:",B):(R===""||H==="")&&(z=!1);z&&(this.diagnostics={runnable:Q,programLog:B,vertexShader:{log:R,prefix:g},fragmentShader:{log:H,prefix:v}})}n.deleteShader(E),n.deleteShader(S);let P;this.getUniforms=function(){return P===void 0&&(P=new Up(n,m)),P};let M;return this.getAttributes=function(){return M===void 0&&(M=p8(n,m)),M},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(m),this.program=void 0},this.name=r.shaderName,this.id=o8++,this.cacheKey=t,this.usedTimes=1,this.program=m,this.vertexShader=E,this.fragmentShader=S,this}var E8=0,C8=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),n=this._getShaderStage(r),s=this._getShaderCacheForMaterial(e);return s.has(i)===!1&&(s.add(i),i.usedTimes++),s.has(n)===!1&&(s.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache;return t.has(e)===!1&&t.set(e,new Set),t.get(e)}_getShaderStage(e){let t=this.shaderCache;if(t.has(e)===!1){let r=new T8(e);t.set(e,r)}return t.get(e)}},T8=class{constructor(e){this.id=E8++,this.code=e,this.usedTimes=0}};function D8(e,t,r,i,n,s,a){let o=new Pw,l=new C8,h=[],u=n.isWebGL2,c=n.logarithmicDepthBuffer,d=n.vertexTextures,f=n.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(M,B,R,H,Q){let z=H.fog,y=Q.geometry,A=M.isMeshStandardMaterial?H.environment:null,D=(M.isMeshStandardMaterial?r:t).get(M.envMap||A),O=!!D&&D.mapping===Xd?D.image.height:null,C=p[M.type];M.precision!==null&&(f=n.getMaxPrecision(M.precision),f!==M.precision&&console.warn("THREE.WebGLProgram.getParameters:",M.precision,"not supported, using",f,"instead."));let I=y.morphAttributes.position||y.morphAttributes.normal||y.morphAttributes.color,k=I!==void 0?I.length:0,L=0;y.morphAttributes.position!==void 0&&(L=1),y.morphAttributes.normal!==void 0&&(L=2),y.morphAttributes.color!==void 0&&(L=3);let w,N,X,T;if(C){let K=Bs[C];w=K.vertexShader,N=K.fragmentShader}else w=M.vertexShader,N=M.fragmentShader,l.update(M),X=l.getVertexShaderID(M),T=l.getFragmentShaderID(M);let U=e.getRenderTarget(),q=M.alphaTest>0,W=M.clearcoat>0,J=M.iridescence>0;return{isWebGL2:u,shaderID:C,shaderName:M.type,vertexShader:w,fragmentShader:N,defines:M.defines,customVertexShaderID:X,customFragmentShaderID:T,isRawShaderMaterial:M.isRawShaderMaterial===!0,glslVersion:M.glslVersion,precision:f,instancing:Q.isInstancedMesh===!0,instancingColor:Q.isInstancedMesh===!0&&Q.instanceColor!==null,supportsVertexTextures:d,outputEncoding:U===null?e.outputEncoding:U.isXRRenderTarget===!0?U.texture.encoding:la,map:!!M.map,matcap:!!M.matcap,envMap:!!D,envMapMode:D&&D.mapping,envMapCubeUVHeight:O,lightMap:!!M.lightMap,aoMap:!!M.aoMap,emissiveMap:!!M.emissiveMap,bumpMap:!!M.bumpMap,normalMap:!!M.normalMap,objectSpaceNormalMap:M.normalMapType===HO,tangentSpaceNormalMap:M.normalMapType===Iu,decodeVideoTexture:!!M.map&&M.map.isVideoTexture===!0&&M.map.encoding===St,clearcoat:W,clearcoatMap:W&&!!M.clearcoatMap,clearcoatRoughnessMap:W&&!!M.clearcoatRoughnessMap,clearcoatNormalMap:W&&!!M.clearcoatNormalMap,iridescence:J,iridescenceMap:J&&!!M.iridescenceMap,iridescenceThicknessMap:J&&!!M.iridescenceThicknessMap,displacementMap:!!M.displacementMap,roughnessMap:!!M.roughnessMap,metalnessMap:!!M.metalnessMap,specularMap:!!M.specularMap,specularIntensityMap:!!M.specularIntensityMap,specularColorMap:!!M.specularColorMap,opaque:M.transparent===!1&&M.blending===El,alphaMap:!!M.alphaMap,alphaTest:q,gradientMap:!!M.gradientMap,sheen:M.sheen>0,sheenColorMap:!!M.sheenColorMap,sheenRoughnessMap:!!M.sheenRoughnessMap,transmission:M.transmission>0,transmissionMap:!!M.transmissionMap,thicknessMap:!!M.thicknessMap,combine:M.combine,vertexTangents:!!M.normalMap&&!!y.attributes.tangent,vertexColors:M.vertexColors,vertexAlphas:M.vertexColors===!0&&!!y.attributes.color&&y.attributes.color.itemSize===4,vertexUvs:!!M.map||!!M.bumpMap||!!M.normalMap||!!M.specularMap||!!M.alphaMap||!!M.emissiveMap||!!M.roughnessMap||!!M.metalnessMap||!!M.clearcoatMap||!!M.clearcoatRoughnessMap||!!M.clearcoatNormalMap||!!M.iridescenceMap||!!M.iridescenceThicknessMap||!!M.displacementMap||!!M.transmissionMap||!!M.thicknessMap||!!M.specularIntensityMap||!!M.specularColorMap||!!M.sheenColorMap||!!M.sheenRoughnessMap,uvsVertexOnly:!(!!M.map||!!M.bumpMap||!!M.normalMap||!!M.specularMap||!!M.alphaMap||!!M.emissiveMap||!!M.roughnessMap||!!M.metalnessMap||!!M.clearcoatNormalMap||!!M.iridescenceMap||!!M.iridescenceThicknessMap||M.transmission>0||!!M.transmissionMap||!!M.thicknessMap||!!M.specularIntensityMap||!!M.specularColorMap||M.sheen>0||!!M.sheenColorMap||!!M.sheenRoughnessMap)&&!!M.displacementMap,fog:!!z,useFog:M.fog===!0,fogExp2:z&&z.isFogExp2,flatShading:!!M.flatShading,sizeAttenuation:M.sizeAttenuation,logarithmicDepthBuffer:c,skinning:Q.isSkinnedMesh===!0,morphTargets:y.morphAttributes.position!==void 0,morphNormals:y.morphAttributes.normal!==void 0,morphColors:y.morphAttributes.color!==void 0,morphTargetsCount:k,morphTextureStride:L,numDirLights:B.directional.length,numPointLights:B.point.length,numSpotLights:B.spot.length,numRectAreaLights:B.rectArea.length,numHemiLights:B.hemi.length,numDirLightShadows:B.directionalShadowMap.length,numPointLightShadows:B.pointShadowMap.length,numSpotLightShadows:B.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:M.dithering,shadowMapEnabled:e.shadowMap.enabled&&R.length>0,shadowMapType:e.shadowMap.type,toneMapping:M.toneMapped?e.toneMapping:Ga,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:M.premultipliedAlpha,doubleSided:M.side===ti,flipSided:M.side===yi,useDepthPacking:!!M.depthPacking,depthPacking:M.depthPacking||0,index0AttributeName:M.index0AttributeName,extensionDerivatives:M.extensions&&M.extensions.derivatives,extensionFragDepth:M.extensions&&M.extensions.fragDepth,extensionDrawBuffers:M.extensions&&M.extensions.drawBuffers,extensionShaderTextureLOD:M.extensions&&M.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||i.has("EXT_shader_texture_lod"),customProgramCacheKey:M.customProgramCacheKey()}}function g(M){let B=[];if(M.shaderID?B.push(M.shaderID):(B.push(M.customVertexShaderID),B.push(M.customFragmentShaderID)),M.defines!==void 0)for(let R in M.defines)B.push(R),B.push(M.defines[R]);return M.isRawShaderMaterial===!1&&(v(B,M),x(B,M),B.push(e.outputEncoding)),B.push(M.customProgramCacheKey),B.join()}function v(M,B){M.push(B.precision),M.push(B.outputEncoding),M.push(B.envMapMode),M.push(B.envMapCubeUVHeight),M.push(B.combine),M.push(B.vertexUvs),M.push(B.fogExp2),M.push(B.sizeAttenuation),M.push(B.morphTargetsCount),M.push(B.morphAttributeCount),M.push(B.numDirLights),M.push(B.numPointLights),M.push(B.numSpotLights),M.push(B.numHemiLights),M.push(B.numRectAreaLights),M.push(B.numDirLightShadows),M.push(B.numPointLightShadows),M.push(B.numSpotLightShadows),M.push(B.shadowMapType),M.push(B.toneMapping),M.push(B.numClippingPlanes),M.push(B.numClipIntersection),M.push(B.depthPacking)}function x(M,B){o.disableAll(),B.isWebGL2&&o.enable(0),B.supportsVertexTextures&&o.enable(1),B.instancing&&o.enable(2),B.instancingColor&&o.enable(3),B.map&&o.enable(4),B.matcap&&o.enable(5),B.envMap&&o.enable(6),B.lightMap&&o.enable(7),B.aoMap&&o.enable(8),B.emissiveMap&&o.enable(9),B.bumpMap&&o.enable(10),B.normalMap&&o.enable(11),B.objectSpaceNormalMap&&o.enable(12),B.tangentSpaceNormalMap&&o.enable(13),B.clearcoat&&o.enable(14),B.clearcoatMap&&o.enable(15),B.clearcoatRoughnessMap&&o.enable(16),B.clearcoatNormalMap&&o.enable(17),B.iridescence&&o.enable(18),B.iridescenceMap&&o.enable(19),B.iridescenceThicknessMap&&o.enable(20),B.displacementMap&&o.enable(21),B.specularMap&&o.enable(22),B.roughnessMap&&o.enable(23),B.metalnessMap&&o.enable(24),B.gradientMap&&o.enable(25),B.alphaMap&&o.enable(26),B.alphaTest&&o.enable(27),B.vertexColors&&o.enable(28),B.vertexAlphas&&o.enable(29),B.vertexUvs&&o.enable(30),B.vertexTangents&&o.enable(31),B.uvsVertexOnly&&o.enable(32),B.fog&&o.enable(33),M.push(o.mask),o.disableAll(),B.useFog&&o.enable(0),B.flatShading&&o.enable(1),B.logarithmicDepthBuffer&&o.enable(2),B.skinning&&o.enable(3),B.morphTargets&&o.enable(4),B.morphNormals&&o.enable(5),B.morphColors&&o.enable(6),B.premultipliedAlpha&&o.enable(7),B.shadowMapEnabled&&o.enable(8),B.physicallyCorrectLights&&o.enable(9),B.doubleSided&&o.enable(10),B.flipSided&&o.enable(11),B.useDepthPacking&&o.enable(12),B.dithering&&o.enable(13),B.specularIntensityMap&&o.enable(14),B.specularColorMap&&o.enable(15),B.transmission&&o.enable(16),B.transmissionMap&&o.enable(17),B.thicknessMap&&o.enable(18),B.sheen&&o.enable(19),B.sheenColorMap&&o.enable(20),B.sheenRoughnessMap&&o.enable(21),B.decodeVideoTexture&&o.enable(22),B.opaque&&o.enable(23),M.push(o.mask)}function b(M){let B=p[M.type],R;if(B){let H=Bs[B];R=Nu.clone(H.uniforms)}else R=M.uniforms;return R}function _(M,B){let R;for(let H=0,Q=h.length;H<Q;H++){let z=h[H];if(z.cacheKey===B){R=z,++R.usedTimes;break}}return R===void 0&&(R=new A8(e,B,M,s),h.push(R)),R}function E(M){if(--M.usedTimes===0){let B=h.indexOf(M);h[B]=h[h.length-1],h.pop(),M.destroy()}}function S(M){l.remove(M)}function P(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:b,acquireProgram:_,releaseProgram:E,releaseShaderCache:S,programs:h,dispose:P}}function P8(){let e=new WeakMap;function t(s){let a=e.get(s);return a===void 0&&(a={},e.set(s,a)),a}function r(s){e.delete(s)}function i(s,a,o){e.get(s)[a]=o}function n(){e=new WeakMap}return{get:t,remove:r,update:i,dispose:n}}function L8(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function bS(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function _S(){let e=[],t=0,r=[],i=[],n=[];function s(){t=0,r.length=0,i.length=0,n.length=0}function a(c,d,f,p,m,g){let v=e[t];return v===void 0?(v={id:c.id,object:c,geometry:d,material:f,groupOrder:p,renderOrder:c.renderOrder,z:m,group:g},e[t]=v):(v.id=c.id,v.object=c,v.geometry=d,v.material=f,v.groupOrder=p,v.renderOrder=c.renderOrder,v.z=m,v.group=g),t++,v}function o(c,d,f,p,m,g){let v=a(c,d,f,p,m,g);f.transmission>0?i.push(v):f.transparent===!0?n.push(v):r.push(v)}function l(c,d,f,p,m,g){let v=a(c,d,f,p,m,g);f.transmission>0?i.unshift(v):f.transparent===!0?n.unshift(v):r.unshift(v)}function h(c,d){r.length>1&&r.sort(c||L8),i.length>1&&i.sort(d||bS),n.length>1&&n.sort(d||bS)}function u(){for(let c=t,d=e.length;c<d;c++){let f=e[c];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:r,transmissive:i,transparent:n,init:s,push:o,unshift:l,finish:u,sort:h}}function R8(){let e=new WeakMap;function t(i,n){let s;return e.has(i)===!1?(s=new _S,e.set(i,[s])):n>=e.get(i).length?(s=new _S,e.get(i).push(s)):s=e.get(i)[n],s}function r(){e=new WeakMap}return{get:t,dispose:r}}function O8(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new F,color:new Ue};break;case"SpotLight":r={position:new F,direction:new F,color:new Ue,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new F,color:new Ue,distance:0,decay:0};break;case"HemisphereLight":r={direction:new F,skyColor:new Ue,groundColor:new Ue};break;case"RectAreaLight":r={color:new Ue,position:new F,halfWidth:new F,halfHeight:new F};break}return e[t.id]=r,r}}}function I8(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new $};break;case"SpotLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new $};break;case"PointLight":r={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new $,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=r,r}}}var N8=0;function B8(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function k8(e,t){let r=new O8,i=I8(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let u=0;u<9;u++)n.probe.push(new F);let s=new F,a=new wt,o=new wt;function l(u,c){let d=0,f=0,p=0;for(let B=0;B<9;B++)n.probe[B].set(0,0,0);let m=0,g=0,v=0,x=0,b=0,_=0,E=0,S=0;u.sort(B8);let P=c!==!0?Math.PI:1;for(let B=0,R=u.length;B<R;B++){let H=u[B],Q=H.color,z=H.intensity,y=H.distance,A=H.shadow&&H.shadow.map?H.shadow.map.texture:null;if(H.isAmbientLight)d+=Q.r*z*P,f+=Q.g*z*P,p+=Q.b*z*P;else if(H.isLightProbe)for(let D=0;D<9;D++)n.probe[D].addScaledVector(H.sh.coefficients[D],z);else if(H.isDirectionalLight){let D=r.get(H);if(D.color.copy(H.color).multiplyScalar(H.intensity*P),H.castShadow){let O=H.shadow,C=i.get(H);C.shadowBias=O.bias,C.shadowNormalBias=O.normalBias,C.shadowRadius=O.radius,C.shadowMapSize=O.mapSize,n.directionalShadow[m]=C,n.directionalShadowMap[m]=A,n.directionalShadowMatrix[m]=H.shadow.matrix,_++}n.directional[m]=D,m++}else if(H.isSpotLight){let D=r.get(H);if(D.position.setFromMatrixPosition(H.matrixWorld),D.color.copy(Q).multiplyScalar(z*P),D.distance=y,D.coneCos=Math.cos(H.angle),D.penumbraCos=Math.cos(H.angle*(1-H.penumbra)),D.decay=H.decay,H.castShadow){let O=H.shadow,C=i.get(H);C.shadowBias=O.bias,C.shadowNormalBias=O.normalBias,C.shadowRadius=O.radius,C.shadowMapSize=O.mapSize,n.spotShadow[v]=C,n.spotShadowMap[v]=A,n.spotShadowMatrix[v]=H.shadow.matrix,S++}n.spot[v]=D,v++}else if(H.isRectAreaLight){let D=r.get(H);D.color.copy(Q).multiplyScalar(z),D.halfWidth.set(H.width*.5,0,0),D.halfHeight.set(0,H.height*.5,0),n.rectArea[x]=D,x++}else if(H.isPointLight){let D=r.get(H);if(D.color.copy(H.color).multiplyScalar(H.intensity*P),D.distance=H.distance,D.decay=H.decay,H.castShadow){let O=H.shadow,C=i.get(H);C.shadowBias=O.bias,C.shadowNormalBias=O.normalBias,C.shadowRadius=O.radius,C.shadowMapSize=O.mapSize,C.shadowCameraNear=O.camera.near,C.shadowCameraFar=O.camera.far,n.pointShadow[g]=C,n.pointShadowMap[g]=A,n.pointShadowMatrix[g]=H.shadow.matrix,E++}n.point[g]=D,g++}else if(H.isHemisphereLight){let D=r.get(H);D.skyColor.copy(H.color).multiplyScalar(z*P),D.groundColor.copy(H.groundColor).multiplyScalar(z*P),n.hemi[b]=D,b++}}x>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Pe.LTC_FLOAT_1,n.rectAreaLTC2=Pe.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=Pe.LTC_HALF_1,n.rectAreaLTC2=Pe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=d,n.ambient[1]=f,n.ambient[2]=p;let M=n.hash;(M.directionalLength!==m||M.pointLength!==g||M.spotLength!==v||M.rectAreaLength!==x||M.hemiLength!==b||M.numDirectionalShadows!==_||M.numPointShadows!==E||M.numSpotShadows!==S)&&(n.directional.length=m,n.spot.length=v,n.rectArea.length=x,n.point.length=g,n.hemi.length=b,n.directionalShadow.length=_,n.directionalShadowMap.length=_,n.pointShadow.length=E,n.pointShadowMap.length=E,n.spotShadow.length=S,n.spotShadowMap.length=S,n.directionalShadowMatrix.length=_,n.pointShadowMatrix.length=E,n.spotShadowMatrix.length=S,M.directionalLength=m,M.pointLength=g,M.spotLength=v,M.rectAreaLength=x,M.hemiLength=b,M.numDirectionalShadows=_,M.numPointShadows=E,M.numSpotShadows=S,n.version=N8++)}function h(u,c){let d=0,f=0,p=0,m=0,g=0,v=c.matrixWorldInverse;for(let x=0,b=u.length;x<b;x++){let _=u[x];if(_.isDirectionalLight){let E=n.directional[d];E.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(v),d++}else if(_.isSpotLight){let E=n.spot[p];E.position.setFromMatrixPosition(_.matrixWorld),E.position.applyMatrix4(v),E.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),E.direction.sub(s),E.direction.transformDirection(v),p++}else if(_.isRectAreaLight){let E=n.rectArea[m];E.position.setFromMatrixPosition(_.matrixWorld),E.position.applyMatrix4(v),o.identity(),a.copy(_.matrixWorld),a.premultiply(v),o.extractRotation(a),E.halfWidth.set(_.width*.5,0,0),E.halfHeight.set(0,_.height*.5,0),E.halfWidth.applyMatrix4(o),E.halfHeight.applyMatrix4(o),m++}else if(_.isPointLight){let E=n.point[f];E.position.setFromMatrixPosition(_.matrixWorld),E.position.applyMatrix4(v),f++}else if(_.isHemisphereLight){let E=n.hemi[g];E.direction.setFromMatrixPosition(_.matrixWorld),E.direction.transformDirection(v),g++}}}return{setup:l,setupView:h,state:n}}function SS(e,t){let r=new k8(e,t),i=[],n=[];function s(){i.length=0,n.length=0}function a(u){i.push(u)}function o(u){n.push(u)}function l(u){r.setup(i,u)}function h(u){r.setupView(i,u)}return{init:s,state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:l,setupLightsView:h,pushLight:a,pushShadow:o}}function z8(e,t){let r=new WeakMap;function i(s,a=0){let o;return r.has(s)===!1?(o=new SS(e,t),r.set(s,[o])):a>=r.get(s).length?(o=new SS(e,t),r.get(s).push(o)):o=r.get(s)[a],o}function n(){r=new WeakMap}return{get:i,dispose:n}}var IT=class extends ai{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=io,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},NT=class extends ai{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new F,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},F8=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,U8=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function H8(e,t,r){let i=new Rw,n=new $,s=new $,a=new Tt,o=new IT({depthPacking:UO}),l=new NT,h={},u=r.maxTextureSize,c={0:yi,1:Zo,2:ti},d=new Gr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new $},radius:{value:4}},vertexShader:F8,fragmentShader:U8}),f=d.clone();f.defines.HORIZONTAL_PASS=1;let p=new vt;p.setAttribute("position",new Ct(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new Ji(p,d),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Tw,this.render=function(_,E,S){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||_.length===0)return;let P=e.getRenderTarget(),M=e.getActiveCubeFace(),B=e.getActiveMipmapLevel(),R=e.state;R.setBlending(ii),R.buffers.color.setClear(1,1,1,1),R.buffers.depth.setTest(!0),R.setScissorTest(!1);for(let H=0,Q=_.length;H<Q;H++){let z=_[H],y=z.shadow;if(y===void 0){console.warn("THREE.WebGLShadowMap:",z,"has no shadow.");continue}if(y.autoUpdate===!1&&y.needsUpdate===!1)continue;n.copy(y.mapSize);let A=y.getFrameExtents();if(n.multiply(A),s.copy(y.mapSize),(n.x>u||n.y>u)&&(n.x>u&&(s.x=Math.floor(u/A.x),n.x=s.x*A.x,y.mapSize.x=s.x),n.y>u&&(s.y=Math.floor(u/A.y),n.y=s.y*A.y,y.mapSize.y=s.y)),y.map===null&&!y.isPointLightShadow&&this.type===Tc&&(y.map=new Or(n.x,n.y),y.map.texture.name=z.name+".shadowMap",y.mapPass=new Or(n.x,n.y),y.camera.updateProjectionMatrix()),y.map===null){let O={minFilter:mi,magFilter:mi,format:hs};y.map=new Or(n.x,n.y,O),y.map.texture.name=z.name+".shadowMap",y.camera.updateProjectionMatrix()}e.setRenderTarget(y.map),e.clear();let D=y.getViewportCount();for(let O=0;O<D;O++){let C=y.getViewport(O);a.set(s.x*C.x,s.y*C.y,s.x*C.z,s.y*C.w),R.viewport(a),y.updateMatrices(z,O),i=y.getFrustum(),b(E,S,y.camera,z,this.type)}!y.isPointLightShadow&&this.type===Tc&&v(y,S),y.needsUpdate=!1}g.needsUpdate=!1,e.setRenderTarget(P,M,B)};function v(_,E){let S=t.update(m);d.defines.VSM_SAMPLES!==_.blurSamples&&(d.defines.VSM_SAMPLES=_.blurSamples,f.defines.VSM_SAMPLES=_.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),d.uniforms.shadow_pass.value=_.map.texture,d.uniforms.resolution.value=_.mapSize,d.uniforms.radius.value=_.radius,e.setRenderTarget(_.mapPass),e.clear(),e.renderBufferDirect(E,null,S,d,m,null),f.uniforms.shadow_pass.value=_.mapPass.texture,f.uniforms.resolution.value=_.mapSize,f.uniforms.radius.value=_.radius,e.setRenderTarget(_.map),e.clear(),e.renderBufferDirect(E,null,S,f,m,null)}function x(_,E,S,P,M,B){let R=null,H=S.isPointLight===!0?_.customDistanceMaterial:_.customDepthMaterial;if(H!==void 0?R=H:R=S.isPointLight===!0?l:o,e.localClippingEnabled&&E.clipShadows===!0&&E.clippingPlanes.length!==0||E.displacementMap&&E.displacementScale!==0||E.alphaMap&&E.alphaTest>0){let Q=R.uuid,z=E.uuid,y=h[Q];y===void 0&&(y={},h[Q]=y);let A=y[z];A===void 0&&(A=R.clone(),y[z]=A),R=A}return R.visible=E.visible,R.wireframe=E.wireframe,B===Tc?R.side=E.shadowSide!==null?E.shadowSide:E.side:R.side=E.shadowSide!==null?E.shadowSide:c[E.side],R.alphaMap=E.alphaMap,R.alphaTest=E.alphaTest,R.clipShadows=E.clipShadows,R.clippingPlanes=E.clippingPlanes,R.clipIntersection=E.clipIntersection,R.displacementMap=E.displacementMap,R.displacementScale=E.displacementScale,R.displacementBias=E.displacementBias,R.wireframeLinewidth=E.wireframeLinewidth,R.linewidth=E.linewidth,S.isPointLight===!0&&R.isMeshDistanceMaterial===!0&&(R.referencePosition.setFromMatrixPosition(S.matrixWorld),R.nearDistance=P,R.farDistance=M),R}function b(_,E,S,P,M){if(_.visible===!1)return;if(_.layers.test(E.layers)&&(_.isMesh||_.isLine||_.isPoints)&&(_.castShadow||_.receiveShadow&&M===Tc)&&(!_.frustumCulled||i.intersectsObject(_))){_.modelViewMatrix.multiplyMatrices(S.matrixWorldInverse,_.matrixWorld);let R=t.update(_),H=_.material;if(Array.isArray(H)){let Q=R.groups;for(let z=0,y=Q.length;z<y;z++){let A=Q[z],D=H[A.materialIndex];if(D&&D.visible){let O=x(_,D,P,S.near,S.far,M);e.renderBufferDirect(S,null,R,O,_,A)}}}else if(H.visible){let Q=x(_,H,P,S.near,S.far,M);e.renderBufferDirect(S,null,R,Q,_,null)}}let B=_.children;for(let R=0,H=B.length;R<H;R++)b(B[R],E,S,P,M)}}function G8(e,t,r){let i=r.isWebGL2;function n(){let Y=!1,Ee=new Tt,ve=null,Le=new Tt(0,0,0,0);return{setMask:function(Oe){ve!==Oe&&!Y&&(e.colorMask(Oe,Oe,Oe,Oe),ve=Oe)},setLocked:function(Oe){Y=Oe},setClear:function(Oe,Ie,pe,Xe,He){He===!0&&(Oe*=Xe,Ie*=Xe,pe*=Xe),Ee.set(Oe,Ie,pe,Xe),Le.equals(Ee)===!1&&(e.clearColor(Oe,Ie,pe,Xe),Le.copy(Ee))},reset:function(){Y=!1,ve=null,Le.set(-1,0,0,0)}}}function s(){let Y=!1,Ee=null,ve=null,Le=null;return{setTest:function(Oe){Oe?T(2929):U(2929)},setMask:function(Oe){Ee!==Oe&&!Y&&(e.depthMask(Oe),Ee=Oe)},setFunc:function(Oe){if(ve!==Oe){if(Oe)switch(Oe){case uO:e.depthFunc(512);break;case cO:e.depthFunc(519);break;case dO:e.depthFunc(513);break;case oy:e.depthFunc(515);break;case fO:e.depthFunc(514);break;case pO:e.depthFunc(518);break;case mO:e.depthFunc(516);break;case gO:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);ve=Oe}},setLocked:function(Oe){Y=Oe},setClear:function(Oe){Le!==Oe&&(e.clearDepth(Oe),Le=Oe)},reset:function(){Y=!1,Ee=null,ve=null,Le=null}}}function a(){let Y=!1,Ee=null,ve=null,Le=null,Oe=null,Ie=null,pe=null,Xe=null,He=null;return{setTest:function(je){Y||(je?T(2960):U(2960))},setMask:function(je){Ee!==je&&!Y&&(e.stencilMask(je),Ee=je)},setFunc:function(je,qt,Mt){(ve!==je||Le!==qt||Oe!==Mt)&&(e.stencilFunc(je,qt,Mt),ve=je,Le=qt,Oe=Mt)},setOp:function(je,qt,Mt){(Ie!==je||pe!==qt||Xe!==Mt)&&(e.stencilOp(je,qt,Mt),Ie=je,pe=qt,Xe=Mt)},setLocked:function(je){Y=je},setClear:function(je){He!==je&&(e.clearStencil(je),He=je)},reset:function(){Y=!1,Ee=null,ve=null,Le=null,Oe=null,Ie=null,pe=null,Xe=null,He=null}}}let o=new n,l=new s,h=new a,u={},c={},d=new WeakMap,f=[],p=null,m=!1,g=null,v=null,x=null,b=null,_=null,E=null,S=null,P=!1,M=null,B=null,R=null,H=null,Q=null,z=e.getParameter(35661),y=!1,A=0,D=e.getParameter(7938);D.indexOf("WebGL")!==-1?(A=parseFloat(/^WebGL (\d)/.exec(D)[1]),y=A>=1):D.indexOf("OpenGL ES")!==-1&&(A=parseFloat(/^OpenGL ES (\d)/.exec(D)[1]),y=A>=2);let O=null,C={},I=e.getParameter(3088),k=e.getParameter(2978),L=new Tt().fromArray(I),w=new Tt().fromArray(k);function N(Y,Ee,ve){let Le=new Uint8Array(4),Oe=e.createTexture();e.bindTexture(Y,Oe),e.texParameteri(Y,10241,9728),e.texParameteri(Y,10240,9728);for(let Ie=0;Ie<ve;Ie++)e.texImage2D(Ee+Ie,0,6408,1,1,0,6408,5121,Le);return Oe}let X={};X[3553]=N(3553,3553,1),X[34067]=N(34067,34069,6),o.setClear(0,0,0,1),l.setClear(1),h.setClear(0),T(2929),l.setFunc(oy),le(!1),ce(p_),T(2884),Z(ii);function T(Y){u[Y]!==!0&&(e.enable(Y),u[Y]=!0)}function U(Y){u[Y]!==!1&&(e.disable(Y),u[Y]=!1)}function q(Y,Ee){return c[Y]!==Ee?(e.bindFramebuffer(Y,Ee),c[Y]=Ee,i&&(Y===36009&&(c[36160]=Ee),Y===36160&&(c[36009]=Ee)),!0):!1}function W(Y,Ee){let ve=f,Le=!1;if(Y)if(ve=d.get(Ee),ve===void 0&&(ve=[],d.set(Ee,ve)),Y.isWebGLMultipleRenderTargets){let Oe=Y.texture;if(ve.length!==Oe.length||ve[0]!==36064){for(let Ie=0,pe=Oe.length;Ie<pe;Ie++)ve[Ie]=36064+Ie;ve.length=Oe.length,Le=!0}}else ve[0]!==36064&&(ve[0]=36064,Le=!0);else ve[0]!==1029&&(ve[0]=1029,Le=!0);Le&&(r.isWebGL2?e.drawBuffers(ve):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(ve))}function J(Y){return p!==Y?(e.useProgram(Y),p=Y,!0):!1}let K={[Ah]:32774,[$R]:32778,[eO]:32779};if(i)K[y_]=32775,K[x_]=32776;else{let Y=t.get("EXT_blend_minmax");Y!==null&&(K[y_]=Y.MIN_EXT,K[x_]=Y.MAX_EXT)}let ie={[tO]:0,[rO]:1,[iO]:768,[yT]:770,[hO]:776,[oO]:774,[sO]:772,[nO]:769,[xT]:771,[lO]:775,[aO]:773};function Z(Y,Ee,ve,Le,Oe,Ie,pe,Xe){if(Y===ii){m===!0&&(U(3042),m=!1);return}if(m===!1&&(T(3042),m=!0),Y!==ZR){if(Y!==g||Xe!==P){if((v!==Ah||_!==Ah)&&(e.blendEquation(32774),v=Ah,_=Ah),Xe)switch(Y){case El:e.blendFuncSeparate(1,771,1,771);break;case m_:e.blendFunc(1,1);break;case g_:e.blendFuncSeparate(0,769,0,1);break;case v_:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Y);break}else switch(Y){case El:e.blendFuncSeparate(770,771,1,771);break;case m_:e.blendFunc(770,1);break;case g_:e.blendFuncSeparate(0,769,0,1);break;case v_:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Y);break}x=null,b=null,E=null,S=null,g=Y,P=Xe}return}Oe=Oe||Ee,Ie=Ie||ve,pe=pe||Le,(Ee!==v||Oe!==_)&&(e.blendEquationSeparate(K[Ee],K[Oe]),v=Ee,_=Oe),(ve!==x||Le!==b||Ie!==E||pe!==S)&&(e.blendFuncSeparate(ie[ve],ie[Le],ie[Ie],ie[pe]),x=ve,b=Le,E=Ie,S=pe),g=Y,P=null}function ue(Y,Ee){Y.side===ti?U(2884):T(2884);let ve=Y.side===yi;Ee&&(ve=!ve),le(ve),Y.blending===El&&Y.transparent===!1?Z(ii):Z(Y.blending,Y.blendEquation,Y.blendSrc,Y.blendDst,Y.blendEquationAlpha,Y.blendSrcAlpha,Y.blendDstAlpha,Y.premultipliedAlpha),l.setFunc(Y.depthFunc),l.setTest(Y.depthTest),l.setMask(Y.depthWrite),o.setMask(Y.colorWrite);let Le=Y.stencilWrite;h.setTest(Le),Le&&(h.setMask(Y.stencilWriteMask),h.setFunc(Y.stencilFunc,Y.stencilRef,Y.stencilFuncMask),h.setOp(Y.stencilFail,Y.stencilZFail,Y.stencilZPass)),be(Y.polygonOffset,Y.polygonOffsetFactor,Y.polygonOffsetUnits),Y.alphaToCoverage===!0?T(32926):U(32926)}function le(Y){M!==Y&&(Y?e.frontFace(2304):e.frontFace(2305),M=Y)}function ce(Y){Y!==QR?(T(2884),Y!==B&&(Y===p_?e.cullFace(1029):Y===JR?e.cullFace(1028):e.cullFace(1032))):U(2884),B=Y}function ke(Y){Y!==R&&(y&&e.lineWidth(Y),R=Y)}function be(Y,Ee,ve){Y?(T(32823),(H!==Ee||Q!==ve)&&(e.polygonOffset(Ee,ve),H=Ee,Q=ve)):U(32823)}function _e(Y){Y?T(3089):U(3089)}function ze(Y){Y===void 0&&(Y=33984+z-1),O!==Y&&(e.activeTexture(Y),O=Y)}function Be(Y,Ee){O===null&&ze();let ve=C[O];ve===void 0&&(ve={type:void 0,texture:void 0},C[O]=ve),(ve.type!==Y||ve.texture!==Ee)&&(e.bindTexture(Y,Ee||X[Y]),ve.type=Y,ve.texture=Ee)}function Ve(){let Y=C[O];Y!==void 0&&Y.type!==void 0&&(e.bindTexture(Y.type,null),Y.type=void 0,Y.texture=void 0)}function j(){try{e.compressedTexImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function G(){try{e.texSubImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function se(){try{e.texSubImage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function ye(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function ge(){try{e.texStorage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function we(){try{e.texStorage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function et(){try{e.texImage2D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function oe(){try{e.texImage3D.apply(e,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function De(Y){L.equals(Y)===!1&&(e.scissor(Y.x,Y.y,Y.z,Y.w),L.copy(Y))}function Me(Y){w.equals(Y)===!1&&(e.viewport(Y.x,Y.y,Y.z,Y.w),w.copy(Y))}function xe(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),i===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),u={},O=null,C={},c={},d=new WeakMap,f=[],p=null,m=!1,g=null,v=null,x=null,b=null,_=null,E=null,S=null,P=!1,M=null,B=null,R=null,H=null,Q=null,L.set(0,0,e.canvas.width,e.canvas.height),w.set(0,0,e.canvas.width,e.canvas.height),o.reset(),l.reset(),h.reset()}return{buffers:{color:o,depth:l,stencil:h},enable:T,disable:U,bindFramebuffer:q,drawBuffers:W,useProgram:J,setBlending:Z,setMaterial:ue,setFlipSided:le,setCullFace:ce,setLineWidth:ke,setPolygonOffset:be,setScissorTest:_e,activeTexture:ze,bindTexture:Be,unbindTexture:Ve,compressedTexImage2D:j,texImage2D:et,texImage3D:oe,texStorage2D:ge,texStorage3D:we,texSubImage2D:G,texSubImage3D:se,compressedTexSubImage2D:ye,scissor:De,viewport:Me,reset:xe}}function V8(e,t,r,i,n,s,a){let o=n.isWebGL2,l=n.maxTextures,h=n.maxCubemapSize,u=n.maxTextureSize,c=n.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=/OculusBrowser/g.test(navigator.userAgent),p=new WeakMap,m,g=new WeakMap,v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function x(j,G){return v?new OffscreenCanvas(j,G):T0("canvas")}function b(j,G,se,ye){let ge=1;if((j.width>ye||j.height>ye)&&(ge=ye/Math.max(j.width,j.height)),ge<1||G===!0)if(typeof HTMLImageElement<"u"&&j instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&j instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&j instanceof ImageBitmap){let we=G?C0:Math.floor,et=we(ge*j.width),oe=we(ge*j.height);m===void 0&&(m=x(et,oe));let De=se?x(et,oe):m;return De.width=et,De.height=oe,De.getContext("2d").drawImage(j,0,0,et,oe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+j.width+"x"+j.height+") to ("+et+"x"+oe+")."),De}else return"data"in j&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+j.width+"x"+j.height+")."),j;return j}function _(j){return fy(j.width)&&fy(j.height)}function E(j){return o?!1:j.wrapS!==Ti||j.wrapT!==Ti||j.minFilter!==mi&&j.minFilter!==Wt}function S(j,G){return j.generateMipmaps&&G&&j.minFilter!==mi&&j.minFilter!==Wt}function P(j){e.generateMipmap(j)}function M(j,G,se,ye,ge=!1){if(o===!1)return G;if(j!==null){if(e[j]!==void 0)return e[j];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+j+"'")}let we=G;return G===6403&&(se===5126&&(we=33326),se===5131&&(we=33325),se===5121&&(we=33321)),G===33319&&(se===5126&&(we=33328),se===5131&&(we=33327),se===5121&&(we=33323)),G===6408&&(se===5126&&(we=34836),se===5131&&(we=34842),se===5121&&(we=ye===St&&ge===!1?35907:32856),se===32819&&(we=32854),se===32820&&(we=32855)),(we===33325||we===33326||we===33327||we===33328||we===34842||we===34836)&&t.get("EXT_color_buffer_float"),we}function B(j,G,se){return S(j,se)===!0||j.isFramebufferTexture&&j.minFilter!==mi&&j.minFilter!==Wt?Math.log2(Math.max(G.width,G.height))+1:j.mipmaps!==void 0&&j.mipmaps.length>0?j.mipmaps.length:j.isCompressedTexture&&Array.isArray(j.image)?G.mipmaps.length:1}function R(j){return j===mi||j===w_||j===b_?9728:9729}function H(j){let G=j.target;G.removeEventListener("dispose",H),z(G),G.isVideoTexture&&p.delete(G)}function Q(j){let G=j.target;G.removeEventListener("dispose",Q),A(G)}function z(j){let G=i.get(j);if(G.__webglInit===void 0)return;let se=j.source,ye=g.get(se);if(ye){let ge=ye[G.__cacheKey];ge.usedTimes--,ge.usedTimes===0&&y(j),Object.keys(ye).length===0&&g.delete(se)}i.remove(j)}function y(j){let G=i.get(j);e.deleteTexture(G.__webglTexture);let se=j.source,ye=g.get(se);delete ye[G.__cacheKey],a.memory.textures--}function A(j){let G=j.texture,se=i.get(j),ye=i.get(G);if(ye.__webglTexture!==void 0&&(e.deleteTexture(ye.__webglTexture),a.memory.textures--),j.depthTexture&&j.depthTexture.dispose(),j.isWebGLCubeRenderTarget)for(let ge=0;ge<6;ge++)e.deleteFramebuffer(se.__webglFramebuffer[ge]),se.__webglDepthbuffer&&e.deleteRenderbuffer(se.__webglDepthbuffer[ge]);else{if(e.deleteFramebuffer(se.__webglFramebuffer),se.__webglDepthbuffer&&e.deleteRenderbuffer(se.__webglDepthbuffer),se.__webglMultisampledFramebuffer&&e.deleteFramebuffer(se.__webglMultisampledFramebuffer),se.__webglColorRenderbuffer)for(let ge=0;ge<se.__webglColorRenderbuffer.length;ge++)se.__webglColorRenderbuffer[ge]&&e.deleteRenderbuffer(se.__webglColorRenderbuffer[ge]);se.__webglDepthRenderbuffer&&e.deleteRenderbuffer(se.__webglDepthRenderbuffer)}if(j.isWebGLMultipleRenderTargets)for(let ge=0,we=G.length;ge<we;ge++){let et=i.get(G[ge]);et.__webglTexture&&(e.deleteTexture(et.__webglTexture),a.memory.textures--),i.remove(G[ge])}i.remove(G),i.remove(j)}let D=0;function O(){D=0}function C(){let j=D;return j>=l&&console.warn("THREE.WebGLTextures: Trying to use "+j+" texture units while this GPU supports only "+l),D+=1,j}function I(j){let G=[];return G.push(j.wrapS),G.push(j.wrapT),G.push(j.magFilter),G.push(j.minFilter),G.push(j.anisotropy),G.push(j.internalFormat),G.push(j.format),G.push(j.type),G.push(j.generateMipmaps),G.push(j.premultiplyAlpha),G.push(j.flipY),G.push(j.unpackAlignment),G.push(j.encoding),G.join()}function k(j,G){let se=i.get(j);if(j.isVideoTexture&&Be(j),j.isRenderTargetTexture===!1&&j.version>0&&se.__version!==j.version){let ye=j.image;if(ye===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ye.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{W(se,j,G);return}}r.activeTexture(33984+G),r.bindTexture(3553,se.__webglTexture)}function L(j,G){let se=i.get(j);if(j.version>0&&se.__version!==j.version){W(se,j,G);return}r.activeTexture(33984+G),r.bindTexture(35866,se.__webglTexture)}function w(j,G){let se=i.get(j);if(j.version>0&&se.__version!==j.version){W(se,j,G);return}r.activeTexture(33984+G),r.bindTexture(32879,se.__webglTexture)}function N(j,G){let se=i.get(j);if(j.version>0&&se.__version!==j.version){J(se,j,G);return}r.activeTexture(33984+G),r.bindTexture(34067,se.__webglTexture)}let X={[Md]:10497,[Ti]:33071,[uy]:33648},T={[mi]:9728,[w_]:9984,[b_]:9986,[Wt]:9729,[MO]:9985,[Ou]:9987};function U(j,G,se){if(se?(e.texParameteri(j,10242,X[G.wrapS]),e.texParameteri(j,10243,X[G.wrapT]),(j===32879||j===35866)&&e.texParameteri(j,32882,X[G.wrapR]),e.texParameteri(j,10240,T[G.magFilter]),e.texParameteri(j,10241,T[G.minFilter])):(e.texParameteri(j,10242,33071),e.texParameteri(j,10243,33071),(j===32879||j===35866)&&e.texParameteri(j,32882,33071),(G.wrapS!==Ti||G.wrapT!==Ti)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(j,10240,R(G.magFilter)),e.texParameteri(j,10241,R(G.minFilter)),G.minFilter!==mi&&G.minFilter!==Wt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let ye=t.get("EXT_texture_filter_anisotropic");if(G.type===bl&&t.has("OES_texture_float_linear")===!1||o===!1&&G.type===Ad&&t.has("OES_texture_half_float_linear")===!1)return;(G.anisotropy>1||i.get(G).__currentAnisotropy)&&(e.texParameterf(j,ye.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(G.anisotropy,n.getMaxAnisotropy())),i.get(G).__currentAnisotropy=G.anisotropy)}}function q(j,G){let se=!1;j.__webglInit===void 0&&(j.__webglInit=!0,G.addEventListener("dispose",H));let ye=G.source,ge=g.get(ye);ge===void 0&&(ge={},g.set(ye,ge));let we=I(G);if(we!==j.__cacheKey){ge[we]===void 0&&(ge[we]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,se=!0),ge[we].usedTimes++;let et=ge[j.__cacheKey];et!==void 0&&(ge[j.__cacheKey].usedTimes--,et.usedTimes===0&&y(G)),j.__cacheKey=we,j.__webglTexture=ge[we].texture}return se}function W(j,G,se){let ye=3553;G.isDataArrayTexture&&(ye=35866),G.isData3DTexture&&(ye=32879);let ge=q(j,G),we=G.source;if(r.activeTexture(33984+se),r.bindTexture(ye,j.__webglTexture),we.version!==we.__currentVersion||ge===!0){e.pixelStorei(37440,G.flipY),e.pixelStorei(37441,G.premultiplyAlpha),e.pixelStorei(3317,G.unpackAlignment),e.pixelStorei(37443,0);let et=E(G)&&_(G.image)===!1,oe=b(G.image,et,!1,u);oe=Ve(G,oe);let De=_(oe)||o,Me=s.convert(G.format,G.encoding),xe=s.convert(G.type),Y=M(G.internalFormat,Me,xe,G.encoding,G.isVideoTexture);U(ye,G,De);let Ee,ve=G.mipmaps,Le=o&&G.isVideoTexture!==!0,Oe=we.__currentVersion===void 0||ge===!0,Ie=B(G,oe,De);if(G.isDepthTexture)Y=6402,o?G.type===bl?Y=36012:G.type===Io?Y=33190:G.type===Cl?Y=35056:Y=33189:G.type===bl&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),G.format===Tl&&Y===6402&&G.type!==bT&&G.type!==Io&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),G.type=Io,xe=s.convert(G.type)),G.format===Ul&&Y===6402&&(Y=34041,G.type!==Cl&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),G.type=Cl,xe=s.convert(G.type))),Oe&&(Le?r.texStorage2D(3553,1,Y,oe.width,oe.height):r.texImage2D(3553,0,Y,oe.width,oe.height,0,Me,xe,null));else if(G.isDataTexture)if(ve.length>0&&De){Le&&Oe&&r.texStorage2D(3553,Ie,Y,ve[0].width,ve[0].height);for(let pe=0,Xe=ve.length;pe<Xe;pe++)Ee=ve[pe],Le?r.texSubImage2D(3553,pe,0,0,Ee.width,Ee.height,Me,xe,Ee.data):r.texImage2D(3553,pe,Y,Ee.width,Ee.height,0,Me,xe,Ee.data);G.generateMipmaps=!1}else Le?(Oe&&r.texStorage2D(3553,Ie,Y,oe.width,oe.height),r.texSubImage2D(3553,0,0,0,oe.width,oe.height,Me,xe,oe.data)):r.texImage2D(3553,0,Y,oe.width,oe.height,0,Me,xe,oe.data);else if(G.isCompressedTexture){Le&&Oe&&r.texStorage2D(3553,Ie,Y,ve[0].width,ve[0].height);for(let pe=0,Xe=ve.length;pe<Xe;pe++)Ee=ve[pe],G.format!==hs?Me!==null?Le?r.compressedTexSubImage2D(3553,pe,0,0,Ee.width,Ee.height,Me,Ee.data):r.compressedTexImage2D(3553,pe,Y,Ee.width,Ee.height,0,Ee.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Le?r.texSubImage2D(3553,pe,0,0,Ee.width,Ee.height,Me,xe,Ee.data):r.texImage2D(3553,pe,Y,Ee.width,Ee.height,0,Me,xe,Ee.data)}else if(G.isDataArrayTexture)Le?(Oe&&r.texStorage3D(35866,Ie,Y,oe.width,oe.height,oe.depth),r.texSubImage3D(35866,0,0,0,0,oe.width,oe.height,oe.depth,Me,xe,oe.data)):r.texImage3D(35866,0,Y,oe.width,oe.height,oe.depth,0,Me,xe,oe.data);else if(G.isData3DTexture)Le?(Oe&&r.texStorage3D(32879,Ie,Y,oe.width,oe.height,oe.depth),r.texSubImage3D(32879,0,0,0,0,oe.width,oe.height,oe.depth,Me,xe,oe.data)):r.texImage3D(32879,0,Y,oe.width,oe.height,oe.depth,0,Me,xe,oe.data);else if(G.isFramebufferTexture){if(Oe)if(Le)r.texStorage2D(3553,Ie,Y,oe.width,oe.height);else{let pe=oe.width,Xe=oe.height;for(let He=0;He<Ie;He++)r.texImage2D(3553,He,Y,pe,Xe,0,Me,xe,null),pe>>=1,Xe>>=1}}else if(ve.length>0&&De){Le&&Oe&&r.texStorage2D(3553,Ie,Y,ve[0].width,ve[0].height);for(let pe=0,Xe=ve.length;pe<Xe;pe++)Ee=ve[pe],Le?r.texSubImage2D(3553,pe,0,0,Me,xe,Ee):r.texImage2D(3553,pe,Y,Me,xe,Ee);G.generateMipmaps=!1}else Le?(Oe&&r.texStorage2D(3553,Ie,Y,oe.width,oe.height),r.texSubImage2D(3553,0,0,0,Me,xe,oe)):r.texImage2D(3553,0,Y,Me,xe,oe);S(G,De)&&P(ye),we.__currentVersion=we.version,G.onUpdate&&G.onUpdate(G)}j.__version=G.version}function J(j,G,se){if(G.image.length!==6)return;let ye=q(j,G),ge=G.source;if(r.activeTexture(33984+se),r.bindTexture(34067,j.__webglTexture),ge.version!==ge.__currentVersion||ye===!0){e.pixelStorei(37440,G.flipY),e.pixelStorei(37441,G.premultiplyAlpha),e.pixelStorei(3317,G.unpackAlignment),e.pixelStorei(37443,0);let we=G.isCompressedTexture||G.image[0].isCompressedTexture,et=G.image[0]&&G.image[0].isDataTexture,oe=[];for(let pe=0;pe<6;pe++)!we&&!et?oe[pe]=b(G.image[pe],!1,!0,h):oe[pe]=et?G.image[pe].image:G.image[pe],oe[pe]=Ve(G,oe[pe]);let De=oe[0],Me=_(De)||o,xe=s.convert(G.format,G.encoding),Y=s.convert(G.type),Ee=M(G.internalFormat,xe,Y,G.encoding),ve=o&&G.isVideoTexture!==!0,Le=ge.__currentVersion===void 0||ye===!0,Oe=B(G,De,Me);U(34067,G,Me);let Ie;if(we){ve&&Le&&r.texStorage2D(34067,Oe,Ee,De.width,De.height);for(let pe=0;pe<6;pe++){Ie=oe[pe].mipmaps;for(let Xe=0;Xe<Ie.length;Xe++){let He=Ie[Xe];G.format!==hs?xe!==null?ve?r.compressedTexSubImage2D(34069+pe,Xe,0,0,He.width,He.height,xe,He.data):r.compressedTexImage2D(34069+pe,Xe,Ee,He.width,He.height,0,He.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ve?r.texSubImage2D(34069+pe,Xe,0,0,He.width,He.height,xe,Y,He.data):r.texImage2D(34069+pe,Xe,Ee,He.width,He.height,0,xe,Y,He.data)}}}else{Ie=G.mipmaps,ve&&Le&&(Ie.length>0&&Oe++,r.texStorage2D(34067,Oe,Ee,oe[0].width,oe[0].height));for(let pe=0;pe<6;pe++)if(et){ve?r.texSubImage2D(34069+pe,0,0,0,oe[pe].width,oe[pe].height,xe,Y,oe[pe].data):r.texImage2D(34069+pe,0,Ee,oe[pe].width,oe[pe].height,0,xe,Y,oe[pe].data);for(let Xe=0;Xe<Ie.length;Xe++){let He=Ie[Xe].image[pe].image;ve?r.texSubImage2D(34069+pe,Xe+1,0,0,He.width,He.height,xe,Y,He.data):r.texImage2D(34069+pe,Xe+1,Ee,He.width,He.height,0,xe,Y,He.data)}}else{ve?r.texSubImage2D(34069+pe,0,0,0,xe,Y,oe[pe]):r.texImage2D(34069+pe,0,Ee,xe,Y,oe[pe]);for(let Xe=0;Xe<Ie.length;Xe++){let He=Ie[Xe];ve?r.texSubImage2D(34069+pe,Xe+1,0,0,xe,Y,He.image[pe]):r.texImage2D(34069+pe,Xe+1,Ee,xe,Y,He.image[pe])}}}S(G,Me)&&P(34067),ge.__currentVersion=ge.version,G.onUpdate&&G.onUpdate(G)}j.__version=G.version}function K(j,G,se,ye,ge){let we=s.convert(se.format,se.encoding),et=s.convert(se.type),oe=M(se.internalFormat,we,et,se.encoding);i.get(G).__hasExternalTextures||(ge===32879||ge===35866?r.texImage3D(ge,0,oe,G.width,G.height,G.depth,0,we,et,null):r.texImage2D(ge,0,oe,G.width,G.height,0,we,et,null)),r.bindFramebuffer(36160,j),ze(G)?d.framebufferTexture2DMultisampleEXT(36160,ye,ge,i.get(se).__webglTexture,0,_e(G)):e.framebufferTexture2D(36160,ye,ge,i.get(se).__webglTexture,0),r.bindFramebuffer(36160,null)}function ie(j,G,se){if(e.bindRenderbuffer(36161,j),G.depthBuffer&&!G.stencilBuffer){let ye=33189;if(se||ze(G)){let ge=G.depthTexture;ge&&ge.isDepthTexture&&(ge.type===bl?ye=36012:ge.type===Io&&(ye=33190));let we=_e(G);ze(G)?d.renderbufferStorageMultisampleEXT(36161,we,ye,G.width,G.height):e.renderbufferStorageMultisample(36161,we,ye,G.width,G.height)}else e.renderbufferStorage(36161,ye,G.width,G.height);e.framebufferRenderbuffer(36160,36096,36161,j)}else if(G.depthBuffer&&G.stencilBuffer){let ye=_e(G);se&&ze(G)===!1?e.renderbufferStorageMultisample(36161,ye,35056,G.width,G.height):ze(G)?d.renderbufferStorageMultisampleEXT(36161,ye,35056,G.width,G.height):e.renderbufferStorage(36161,34041,G.width,G.height),e.framebufferRenderbuffer(36160,33306,36161,j)}else{let ye=G.isWebGLMultipleRenderTargets===!0?G.texture:[G.texture];for(let ge=0;ge<ye.length;ge++){let we=ye[ge],et=s.convert(we.format,we.encoding),oe=s.convert(we.type),De=M(we.internalFormat,et,oe,we.encoding),Me=_e(G);se&&ze(G)===!1?e.renderbufferStorageMultisample(36161,Me,De,G.width,G.height):ze(G)?d.renderbufferStorageMultisampleEXT(36161,Me,De,G.width,G.height):e.renderbufferStorage(36161,De,G.width,G.height)}}e.bindRenderbuffer(36161,null)}function Z(j,G){if(G&&G.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,j),!(G.depthTexture&&G.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(G.depthTexture).__webglTexture||G.depthTexture.image.width!==G.width||G.depthTexture.image.height!==G.height)&&(G.depthTexture.image.width=G.width,G.depthTexture.image.height=G.height,G.depthTexture.needsUpdate=!0),k(G.depthTexture,0);let se=i.get(G.depthTexture).__webglTexture,ye=_e(G);if(G.depthTexture.format===Tl)ze(G)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,se,0,ye):e.framebufferTexture2D(36160,36096,3553,se,0);else if(G.depthTexture.format===Ul)ze(G)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,se,0,ye):e.framebufferTexture2D(36160,33306,3553,se,0);else throw new Error("Unknown depthTexture format")}function ue(j){let G=i.get(j),se=j.isWebGLCubeRenderTarget===!0;if(j.depthTexture&&!G.__autoAllocateDepthBuffer){if(se)throw new Error("target.depthTexture not supported in Cube render targets");Z(G.__webglFramebuffer,j)}else if(se){G.__webglDepthbuffer=[];for(let ye=0;ye<6;ye++)r.bindFramebuffer(36160,G.__webglFramebuffer[ye]),G.__webglDepthbuffer[ye]=e.createRenderbuffer(),ie(G.__webglDepthbuffer[ye],j,!1)}else r.bindFramebuffer(36160,G.__webglFramebuffer),G.__webglDepthbuffer=e.createRenderbuffer(),ie(G.__webglDepthbuffer,j,!1);r.bindFramebuffer(36160,null)}function le(j,G,se){let ye=i.get(j);G!==void 0&&K(ye.__webglFramebuffer,j,j.texture,36064,3553),se!==void 0&&ue(j)}function ce(j){let G=j.texture,se=i.get(j),ye=i.get(G);j.addEventListener("dispose",Q),j.isWebGLMultipleRenderTargets!==!0&&(ye.__webglTexture===void 0&&(ye.__webglTexture=e.createTexture()),ye.__version=G.version,a.memory.textures++);let ge=j.isWebGLCubeRenderTarget===!0,we=j.isWebGLMultipleRenderTargets===!0,et=_(j)||o;if(ge){se.__webglFramebuffer=[];for(let oe=0;oe<6;oe++)se.__webglFramebuffer[oe]=e.createFramebuffer()}else{if(se.__webglFramebuffer=e.createFramebuffer(),we)if(n.drawBuffers){let oe=j.texture;for(let De=0,Me=oe.length;De<Me;De++){let xe=i.get(oe[De]);xe.__webglTexture===void 0&&(xe.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&j.samples>0&&ze(j)===!1){let oe=we?G:[G];se.__webglMultisampledFramebuffer=e.createFramebuffer(),se.__webglColorRenderbuffer=[],r.bindFramebuffer(36160,se.__webglMultisampledFramebuffer);for(let De=0;De<oe.length;De++){let Me=oe[De];se.__webglColorRenderbuffer[De]=e.createRenderbuffer(),e.bindRenderbuffer(36161,se.__webglColorRenderbuffer[De]);let xe=s.convert(Me.format,Me.encoding),Y=s.convert(Me.type),Ee=M(Me.internalFormat,xe,Y,Me.encoding),ve=_e(j);e.renderbufferStorageMultisample(36161,ve,Ee,j.width,j.height),e.framebufferRenderbuffer(36160,36064+De,36161,se.__webglColorRenderbuffer[De])}e.bindRenderbuffer(36161,null),j.depthBuffer&&(se.__webglDepthRenderbuffer=e.createRenderbuffer(),ie(se.__webglDepthRenderbuffer,j,!0)),r.bindFramebuffer(36160,null)}}if(ge){r.bindTexture(34067,ye.__webglTexture),U(34067,G,et);for(let oe=0;oe<6;oe++)K(se.__webglFramebuffer[oe],j,G,36064,34069+oe);S(G,et)&&P(34067),r.unbindTexture()}else if(we){let oe=j.texture;for(let De=0,Me=oe.length;De<Me;De++){let xe=oe[De],Y=i.get(xe);r.bindTexture(3553,Y.__webglTexture),U(3553,xe,et),K(se.__webglFramebuffer,j,xe,36064+De,3553),S(xe,et)&&P(3553)}r.unbindTexture()}else{let oe=3553;(j.isWebGL3DRenderTarget||j.isWebGLArrayRenderTarget)&&(o?oe=j.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),r.bindTexture(oe,ye.__webglTexture),U(oe,G,et),K(se.__webglFramebuffer,j,G,36064,oe),S(G,et)&&P(oe),r.unbindTexture()}j.depthBuffer&&ue(j)}function ke(j){let G=_(j)||o,se=j.isWebGLMultipleRenderTargets===!0?j.texture:[j.texture];for(let ye=0,ge=se.length;ye<ge;ye++){let we=se[ye];if(S(we,G)){let et=j.isWebGLCubeRenderTarget?34067:3553,oe=i.get(we).__webglTexture;r.bindTexture(et,oe),P(et),r.unbindTexture()}}}function be(j){if(o&&j.samples>0&&ze(j)===!1){let G=j.isWebGLMultipleRenderTargets?j.texture:[j.texture],se=j.width,ye=j.height,ge=16384,we=[],et=j.stencilBuffer?33306:36096,oe=i.get(j),De=j.isWebGLMultipleRenderTargets===!0;if(De)for(let Me=0;Me<G.length;Me++)r.bindFramebuffer(36160,oe.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Me,36161,null),r.bindFramebuffer(36160,oe.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Me,3553,null,0);r.bindFramebuffer(36008,oe.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,oe.__webglFramebuffer);for(let Me=0;Me<G.length;Me++){we.push(36064+Me),j.depthBuffer&&we.push(et);let xe=oe.__ignoreDepthValues!==void 0?oe.__ignoreDepthValues:!1;if(xe===!1&&(j.depthBuffer&&(ge|=256),j.stencilBuffer&&(ge|=1024)),De&&e.framebufferRenderbuffer(36008,36064,36161,oe.__webglColorRenderbuffer[Me]),xe===!0&&(e.invalidateFramebuffer(36008,[et]),e.invalidateFramebuffer(36009,[et])),De){let Y=i.get(G[Me]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,Y,0)}e.blitFramebuffer(0,0,se,ye,0,0,se,ye,ge,9728),f&&e.invalidateFramebuffer(36008,we)}if(r.bindFramebuffer(36008,null),r.bindFramebuffer(36009,null),De)for(let Me=0;Me<G.length;Me++){r.bindFramebuffer(36160,oe.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+Me,36161,oe.__webglColorRenderbuffer[Me]);let xe=i.get(G[Me]).__webglTexture;r.bindFramebuffer(36160,oe.__webglFramebuffer),e.framebufferTexture2D(36009,36064+Me,3553,xe,0)}r.bindFramebuffer(36009,oe.__webglMultisampledFramebuffer)}}function _e(j){return Math.min(c,j.samples)}function ze(j){let G=i.get(j);return o&&j.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&G.__useRenderToTexture!==!1}function Be(j){let G=a.render.frame;p.get(j)!==G&&(p.set(j,G),j.update())}function Ve(j,G){let se=j.encoding,ye=j.format,ge=j.type;return j.isCompressedTexture===!0||j.isVideoTexture===!0||j.format===dy||se!==la&&(se===St?o===!1?t.has("EXT_sRGB")===!0&&ye===hs?(j.format=dy,j.minFilter=Wt,j.generateMipmaps=!1):G=MT.sRGBToLinear(G):(ye!==hs||ge!==Si)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",se)),G}this.allocateTextureUnit=C,this.resetTextureUnits=O,this.setTexture2D=k,this.setTexture2DArray=L,this.setTexture3D=w,this.setTextureCube=N,this.rebindTextures=le,this.setupRenderTarget=ce,this.updateRenderTargetMipmap=ke,this.updateMultisampleRenderTarget=be,this.setupDepthRenderbuffer=ue,this.setupFrameBufferTexture=K,this.useMultisampledRTT=ze}function j8(e,t,r){let i=r.isWebGL2;function n(s,a=null){let o;if(s===Si)return 5121;if(s===TO)return 32819;if(s===DO)return 32820;if(s===AO)return 5120;if(s===EO)return 5122;if(s===bT)return 5123;if(s===CO)return 5124;if(s===Io)return 5125;if(s===bl)return 5126;if(s===Ad)return i?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===PO)return 6406;if(s===hs)return 6408;if(s===RO)return 6409;if(s===OO)return 6410;if(s===Tl)return 6402;if(s===Ul)return 34041;if(s===IO)return 6403;if(s===LO)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===dy)return o=t.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===NO)return 36244;if(s===BO)return 33319;if(s===kO)return 33320;if(s===zO)return 36249;if(s===Pg||s===Lg||s===Rg||s===Og)if(a===St)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===Pg)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Lg)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===Rg)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Og)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===Pg)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Lg)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===Rg)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Og)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===__||s===S_||s===M_||s===A_)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===__)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===S_)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===M_)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===A_)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===FO)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===E_||s===C_)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(s===E_)return a===St?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===C_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===T_||s===D_||s===P_||s===L_||s===R_||s===O_||s===I_||s===N_||s===B_||s===k_||s===z_||s===F_||s===U_||s===H_)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(s===T_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===D_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===P_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===L_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===R_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===O_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===I_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===N_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===B_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===k_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===z_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===F_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===U_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===H_)return a===St?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===G_)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(s===G_)return a===St?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return s===Cl?i?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):e[s]!==void 0?e[s]:null}return{convert:n}}var W8=class extends gi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},Pc=class extends er{constructor(){super(),this.isGroup=!0,this.type="Group"}},q8={type:"move"},av=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Pc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Pc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new F,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new F),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Pc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new F,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new F),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,n=null,s=null,a=this._targetRay,o=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred")if(a!==null&&(i=t.getPose(e.targetRaySpace,r),i!==null&&(a.matrix.fromArray(i.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),i.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(i.linearVelocity)):a.hasLinearVelocity=!1,i.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(i.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(q8))),l&&e.hand){s=!0;for(let p of e.hand.values()){let m=t.getJointPose(p,r);if(l.joints[p.jointName]===void 0){let v=new Pc;v.matrixAutoUpdate=!1,v.visible=!1,l.joints[p.jointName]=v,l.add(v)}let g=l.joints[p.jointName];m!==null&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.jointRadius=m.radius),g.visible=m!==null}let h=l.joints["index-finger-tip"],u=l.joints["thumb-tip"],c=h.position.distanceTo(u.position),d=.02,f=.005;l.inputState.pinching&&c>d+f?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&c<=d-f&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else o!==null&&e.gripSpace&&(n=t.getPose(e.gripSpace,r),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1));return a!==null&&(a.visible=i!==null),o!==null&&(o.visible=n!==null),l!==null&&(l.visible=s!==null),this}},Em=class extends Qr{constructor(e,t,r,i,n,s,a,o,l,h){if(h=h!==void 0?h:Tl,h!==Tl&&h!==Ul)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&h===Tl&&(r=Io),r===void 0&&h===Ul&&(r=Cl),super(null,i,n,s,a,o,h,r,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:mi,this.minFilter=o!==void 0?o:mi,this.flipY=!1,this.generateMipmaps=!1}},Y8=class extends nn{constructor(e,t){super();let r=this,i=null,n=1,s=null,a="local-floor",o=null,l=null,h=null,u=null,c=null,d=null,f=t.getContextAttributes(),p=null,m=null,g=[],v=new Map,x=new gi;x.layers.enable(1),x.viewport=new Tt;let b=new gi;b.layers.enable(2),b.viewport=new Tt;let _=[x,b],E=new W8;E.layers.enable(1),E.layers.enable(2);let S=null,P=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(C){let I=g[C];return I===void 0&&(I=new av,g[C]=I),I.getTargetRaySpace()},this.getControllerGrip=function(C){let I=g[C];return I===void 0&&(I=new av,g[C]=I),I.getGripSpace()},this.getHand=function(C){let I=g[C];return I===void 0&&(I=new av,g[C]=I),I.getHandSpace()};function M(C){let I=v.get(C.inputSource);I!==void 0&&I.dispatchEvent({type:C.type,data:C.inputSource})}function B(){i.removeEventListener("select",M),i.removeEventListener("selectstart",M),i.removeEventListener("selectend",M),i.removeEventListener("squeeze",M),i.removeEventListener("squeezestart",M),i.removeEventListener("squeezeend",M),i.removeEventListener("end",B),i.removeEventListener("inputsourceschange",R),v.forEach(function(C,I){C!==void 0&&C.disconnect(I)}),v.clear(),S=null,P=null,e.setRenderTarget(p),c=null,u=null,h=null,i=null,m=null,O.stop(),r.isPresenting=!1,r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(C){n=C,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(C){a=C,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return o||s},this.setReferenceSpace=function(C){o=C},this.getBaseLayer=function(){return u!==null?u:c},this.getBinding=function(){return h},this.getFrame=function(){return d},this.getSession=function(){return i},this.setSession=async function(C){if(i=C,i!==null){if(p=e.getRenderTarget(),i.addEventListener("select",M),i.addEventListener("selectstart",M),i.addEventListener("selectend",M),i.addEventListener("squeeze",M),i.addEventListener("squeezestart",M),i.addEventListener("squeezeend",M),i.addEventListener("end",B),i.addEventListener("inputsourceschange",R),f.xrCompatible!==!0&&await t.makeXRCompatible(),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let I={antialias:i.renderState.layers===void 0?f.antialias:!0,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:n};c=new XRWebGLLayer(i,t,I),i.updateRenderState({baseLayer:c}),m=new Or(c.framebufferWidth,c.framebufferHeight,{format:hs,type:Si,encoding:e.outputEncoding})}else{let I=null,k=null,L=null;f.depth&&(L=f.stencil?35056:33190,I=f.stencil?Ul:Tl,k=f.stencil?Cl:Io);let w={colorFormat:e.outputEncoding===St?35907:32856,depthFormat:L,scaleFactor:n};h=new XRWebGLBinding(i,t),u=h.createProjectionLayer(w),i.updateRenderState({layers:[u]}),m=new Or(u.textureWidth,u.textureHeight,{format:hs,type:Si,depthTexture:new Em(u.textureWidth,u.textureHeight,k,void 0,void 0,void 0,void 0,void 0,void 0,I),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0});let N=e.properties.get(m);N.__ignoreDepthValues=u.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(1),o=null,s=await i.requestReferenceSpace(a),O.setContext(i),O.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}};function R(C){let I=i.inputSources;for(let k=0;k<I.length;k++){let L=I[k].handedness==="right"?1:0;v.set(I[k],g[L])}for(let k=0;k<C.removed.length;k++){let L=C.removed[k],w=v.get(L);w&&(w.dispatchEvent({type:"disconnected",data:L}),v.delete(L))}for(let k=0;k<C.added.length;k++){let L=C.added[k],w=v.get(L);w&&w.dispatchEvent({type:"connected",data:L})}}let H=new F,Q=new F;function z(C,I,k){H.setFromMatrixPosition(I.matrixWorld),Q.setFromMatrixPosition(k.matrixWorld);let L=H.distanceTo(Q),w=I.projectionMatrix.elements,N=k.projectionMatrix.elements,X=w[14]/(w[10]-1),T=w[14]/(w[10]+1),U=(w[9]+1)/w[5],q=(w[9]-1)/w[5],W=(w[8]-1)/w[0],J=(N[8]+1)/N[0],K=X*W,ie=X*J,Z=L/(-W+J),ue=Z*-W;I.matrixWorld.decompose(C.position,C.quaternion,C.scale),C.translateX(ue),C.translateZ(Z),C.matrixWorld.compose(C.position,C.quaternion,C.scale),C.matrixWorldInverse.copy(C.matrixWorld).invert();let le=X+Z,ce=T+Z,ke=K-ue,be=ie+(L-ue),_e=U*T/ce*le,ze=q*T/ce*le;C.projectionMatrix.makePerspective(ke,be,_e,ze,le,ce)}function y(C,I){I===null?C.matrixWorld.copy(C.matrix):C.matrixWorld.multiplyMatrices(I.matrixWorld,C.matrix),C.matrixWorldInverse.copy(C.matrixWorld).invert()}this.updateCamera=function(C){if(i===null)return;E.near=b.near=x.near=C.near,E.far=b.far=x.far=C.far,(S!==E.near||P!==E.far)&&(i.updateRenderState({depthNear:E.near,depthFar:E.far}),S=E.near,P=E.far);let I=C.parent,k=E.cameras;y(E,I);for(let w=0;w<k.length;w++)y(k[w],I);E.matrixWorld.decompose(E.position,E.quaternion,E.scale),C.position.copy(E.position),C.quaternion.copy(E.quaternion),C.scale.copy(E.scale),C.matrix.copy(E.matrix),C.matrixWorld.copy(E.matrixWorld);let L=C.children;for(let w=0,N=L.length;w<N;w++)L[w].updateMatrixWorld(!0);k.length===2?z(E,x,b):E.projectionMatrix.copy(x.projectionMatrix)},this.getCamera=function(){return E},this.getFoveation=function(){if(u!==null)return u.fixedFoveation;if(c!==null)return c.fixedFoveation},this.setFoveation=function(C){u!==null&&(u.fixedFoveation=C),c!==null&&c.fixedFoveation!==void 0&&(c.fixedFoveation=C)};let A=null;function D(C,I){if(l=I.getViewerPose(o||s),d=I,l!==null){let L=l.views;c!==null&&(e.setRenderTargetFramebuffer(m,c.framebuffer),e.setRenderTarget(m));let w=!1;L.length!==E.cameras.length&&(E.cameras.length=0,w=!0);for(let N=0;N<L.length;N++){let X=L[N],T=null;if(c!==null)T=c.getViewport(X);else{let q=h.getViewSubImage(u,X);T=q.viewport,N===0&&(e.setRenderTargetTextures(m,q.colorTexture,u.ignoreDepthValues?void 0:q.depthStencilTexture),e.setRenderTarget(m))}let U=_[N];U===void 0&&(U=new gi,U.layers.enable(N),U.viewport=new Tt,_[N]=U),U.matrix.fromArray(X.transform.matrix),U.projectionMatrix.fromArray(X.projectionMatrix),U.viewport.set(T.x,T.y,T.width,T.height),N===0&&E.matrix.copy(U.matrix),w===!0&&E.cameras.push(U)}}let k=i.inputSources;for(let L=0;L<g.length;L++){let w=k[L],N=v.get(w);N!==void 0&&N.update(w,I,o||s)}A&&A(C,I),d=null}let O=new TT;O.setAnimationLoop(D),this.setAnimationLoop=function(C){A=C},this.dispose=function(){}}};function X8(e,t){function r(m,g){m.fogColor.value.copy(g.color),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function i(m,g,v,x,b){g.isMeshBasicMaterial||g.isMeshLambertMaterial?n(m,g):g.isMeshToonMaterial?(n(m,g),u(m,g)):g.isMeshPhongMaterial?(n(m,g),h(m,g)):g.isMeshStandardMaterial?(n(m,g),c(m,g),g.isMeshPhysicalMaterial&&d(m,g,b)):g.isMeshMatcapMaterial?(n(m,g),f(m,g)):g.isMeshDepthMaterial?n(m,g):g.isMeshDistanceMaterial?(n(m,g),p(m,g)):g.isMeshNormalMaterial?n(m,g):g.isLineBasicMaterial?(s(m,g),g.isLineDashedMaterial&&a(m,g)):g.isPointsMaterial?o(m,g,v,x):g.isSpriteMaterial?l(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function n(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.bumpMap&&(m.bumpMap.value=g.bumpMap,m.bumpScale.value=g.bumpScale,g.side===yi&&(m.bumpScale.value*=-1)),g.displacementMap&&(m.displacementMap.value=g.displacementMap,m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap),g.normalMap&&(m.normalMap.value=g.normalMap,m.normalScale.value.copy(g.normalScale),g.side===yi&&m.normalScale.value.negate()),g.specularMap&&(m.specularMap.value=g.specularMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v=t.get(g).envMap;if(v&&(m.envMap.value=v,m.flipEnvMap.value=v.isCubeTexture&&v.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;let _=e.physicallyCorrectLights!==!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*_}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity);let x;g.map?x=g.map:g.specularMap?x=g.specularMap:g.displacementMap?x=g.displacementMap:g.normalMap?x=g.normalMap:g.bumpMap?x=g.bumpMap:g.roughnessMap?x=g.roughnessMap:g.metalnessMap?x=g.metalnessMap:g.alphaMap?x=g.alphaMap:g.emissiveMap?x=g.emissiveMap:g.clearcoatMap?x=g.clearcoatMap:g.clearcoatNormalMap?x=g.clearcoatNormalMap:g.clearcoatRoughnessMap?x=g.clearcoatRoughnessMap:g.iridescenceMap?x=g.iridescenceMap:g.iridescenceThicknessMap?x=g.iridescenceThicknessMap:g.specularIntensityMap?x=g.specularIntensityMap:g.specularColorMap?x=g.specularColorMap:g.transmissionMap?x=g.transmissionMap:g.thicknessMap?x=g.thicknessMap:g.sheenColorMap?x=g.sheenColorMap:g.sheenRoughnessMap&&(x=g.sheenRoughnessMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),m.uvTransform.value.copy(x.matrix));let b;g.aoMap?b=g.aoMap:g.lightMap&&(b=g.lightMap),b!==void 0&&(b.isWebGLRenderTarget&&(b=b.texture),b.matrixAutoUpdate===!0&&b.updateMatrix(),m.uv2Transform.value.copy(b.matrix))}function s(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity}function a(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function o(m,g,v,x){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*v,m.scale.value=x*.5,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let b;g.map?b=g.map:g.alphaMap&&(b=g.alphaMap),b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),m.uvTransform.value.copy(b.matrix))}function l(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map),g.alphaMap&&(m.alphaMap.value=g.alphaMap),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);let v;g.map?v=g.map:g.alphaMap&&(v=g.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),m.uvTransform.value.copy(v.matrix))}function h(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function u(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function c(m,g){m.roughness.value=g.roughness,m.metalness.value=g.metalness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap),g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap),t.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function d(m,g,v){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap)),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap),g.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),m.clearcoatNormalMap.value=g.clearcoatNormalMap,g.side===yi&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap)),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=v.texture,m.transmissionSamplerSize.value.set(v.width,v.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap)}function f(m,g){g.matcap&&(m.matcap.value=g.matcap)}function p(m,g){m.referencePosition.value.copy(g.referencePosition),m.nearDistance.value=g.nearDistance,m.farDistance.value=g.farDistance}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function Q8(){let e=T0("canvas");return e.style.display="block",e}function my(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:Q8(),r=e.context!==void 0?e.context:null,i=e.depth!==void 0?e.depth:!0,n=e.stencil!==void 0?e.stencil:!0,s=e.antialias!==void 0?e.antialias:!1,a=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,o=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",h=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,u;r!==null?u=r.getContextAttributes().alpha:u=e.alpha!==void 0?e.alpha:!1;let c=null,d=null,f=[],p=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=la,this.physicallyCorrectLights=!1,this.toneMapping=Ga,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});let m=this,g=!1,v=0,x=0,b=null,_=-1,E=null,S=new Tt,P=new Tt,M=null,B=t.width,R=t.height,H=1,Q=null,z=null,y=new Tt(0,0,B,R),A=new Tt(0,0,B,R),D=!1,O=new Rw,C=!1,I=!1,k=null,L=new wt,w=new $,N=new F,X={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function T(){return b===null?H:1}let U=r;function q(V,ee){for(let re=0;re<V.length;re++){let te=V[re],de=t.getContext(te,ee);if(de!==null)return de}return null}try{let V={alpha:!0,depth:i,stencil:n,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:l,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Yd}`),t.addEventListener("webglcontextlost",Y,!1),t.addEventListener("webglcontextrestored",Ee,!1),t.addEventListener("webglcontextcreationerror",ve,!1),U===null){let ee=["webgl2","webgl","experimental-webgl"];if(m.isWebGL1Renderer===!0&&ee.shift(),U=q(ee,V),U===null)throw q(ee)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}U.getShaderPrecisionFormat===void 0&&(U.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(V){throw console.error("THREE.WebGLRenderer: "+V.message),V}let W,J,K,ie,Z,ue,le,ce,ke,be,_e,ze,Be,Ve,j,G,se,ye,ge,we,et,oe,De;function Me(){W=new hk(U),J=new ik(U,W,e),W.init(J),oe=new j8(U,W,J),K=new G8(U,W,J),ie=new dk,Z=new P8,ue=new V8(U,W,K,Z,J,oe,ie),le=new sk(m),ce=new lk(m),ke=new MI(U,J),De=new tk(U,W,ke,J),be=new uk(U,ke,ie,De),_e=new gk(U,be,ke,ie),ge=new mk(U,J,ue),G=new nk(Z),ze=new D8(m,le,ce,W,J,De,G),Be=new X8(m,Z),Ve=new R8,j=new z8(W,J),ye=new ek(m,le,K,_e,u,a),se=new H8(m,_e,J),we=new rk(U,W,ie,J),et=new ck(U,W,ie,J),ie.programs=ze.programs,m.capabilities=J,m.extensions=W,m.properties=Z,m.renderLists=Ve,m.shadowMap=se,m.state=K,m.info=ie}Me();let xe=new Y8(m,U);this.xr=xe,this.getContext=function(){return U},this.getContextAttributes=function(){return U.getContextAttributes()},this.forceContextLoss=function(){let V=W.get("WEBGL_lose_context");V&&V.loseContext()},this.forceContextRestore=function(){let V=W.get("WEBGL_lose_context");V&&V.restoreContext()},this.getPixelRatio=function(){return H},this.setPixelRatio=function(V){V!==void 0&&(H=V,this.setSize(B,R,!1))},this.getSize=function(V){return V.set(B,R)},this.setSize=function(V,ee,re){if(xe.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}B=V,R=ee,t.width=Math.floor(V*H),t.height=Math.floor(ee*H),re!==!1&&(t.style.width=V+"px",t.style.height=ee+"px"),this.setViewport(0,0,V,ee)},this.getDrawingBufferSize=function(V){return V.set(B*H,R*H).floor()},this.setDrawingBufferSize=function(V,ee,re){B=V,R=ee,H=re,t.width=Math.floor(V*re),t.height=Math.floor(ee*re),this.setViewport(0,0,V,ee)},this.getCurrentViewport=function(V){return V.copy(S)},this.getViewport=function(V){return V.copy(y)},this.setViewport=function(V,ee,re,te){V.isVector4?y.set(V.x,V.y,V.z,V.w):y.set(V,ee,re,te),K.viewport(S.copy(y).multiplyScalar(H).floor())},this.getScissor=function(V){return V.copy(A)},this.setScissor=function(V,ee,re,te){V.isVector4?A.set(V.x,V.y,V.z,V.w):A.set(V,ee,re,te),K.scissor(P.copy(A).multiplyScalar(H).floor())},this.getScissorTest=function(){return D},this.setScissorTest=function(V){K.setScissorTest(D=V)},this.setOpaqueSort=function(V){Q=V},this.setTransparentSort=function(V){z=V},this.getClearColor=function(V){return V.copy(ye.getClearColor())},this.setClearColor=function(){ye.setClearColor.apply(ye,arguments)},this.getClearAlpha=function(){return ye.getClearAlpha()},this.setClearAlpha=function(){ye.setClearAlpha.apply(ye,arguments)},this.clear=function(V=!0,ee=!0,re=!0){let te=0;V&&(te|=16384),ee&&(te|=256),re&&(te|=1024),U.clear(te)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Y,!1),t.removeEventListener("webglcontextrestored",Ee,!1),t.removeEventListener("webglcontextcreationerror",ve,!1),Ve.dispose(),j.dispose(),Z.dispose(),le.dispose(),ce.dispose(),_e.dispose(),De.dispose(),ze.dispose(),xe.dispose(),xe.removeEventListener("sessionstart",He),xe.removeEventListener("sessionend",je),k&&(k.dispose(),k=null),qt.stop()};function Y(V){V.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),g=!0}function Ee(){console.log("THREE.WebGLRenderer: Context Restored."),g=!1;let V=ie.autoReset,ee=se.enabled,re=se.autoUpdate,te=se.needsUpdate,de=se.type;Me(),ie.autoReset=V,se.enabled=ee,se.autoUpdate=re,se.needsUpdate=te,se.type=de}function ve(V){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",V.statusMessage)}function Le(V){let ee=V.target;ee.removeEventListener("dispose",Le),Oe(ee)}function Oe(V){Ie(V),Z.remove(V)}function Ie(V){let ee=Z.get(V).programs;ee!==void 0&&(ee.forEach(function(re){ze.releaseProgram(re)}),V.isShaderMaterial&&ze.releaseShaderCache(V))}this.renderBufferDirect=function(V,ee,re,te,de,Ce){ee===null&&(ee=X);let Re=de.isMesh&&de.matrixWorld.determinant()<0,ft=it(V,ee,re,te,de);K.setMaterial(te,Re);let Ke=re.index,pt=re.attributes.position;if(Ke===null){if(pt===void 0||pt.count===0)return}else if(Ke.count===0)return;let yt=1;te.wireframe===!0&&(Ke=be.getWireframeAttribute(re),yt=2),De.setup(de,te,ft,re,Ke);let bt,Kt=we;Ke!==null&&(bt=ke.get(Ke),Kt=et,Kt.setIndex(bt));let li=Ke!==null?Ke.count:pt.count,Ai=re.drawRange.start*yt,xs=re.drawRange.count*yt,Fi=Ce!==null?Ce.start*yt:0,Bt=Ce!==null?Ce.count*yt:1/0,ws=Math.max(Ai,Fi),xa=Math.min(li,Ai+xs,Fi+Bt)-1,Ui=Math.max(0,xa-ws+1);if(Ui!==0){if(de.isMesh)te.wireframe===!0?(K.setLineWidth(te.wireframeLinewidth*T()),Kt.setMode(1)):Kt.setMode(4);else if(de.isLine){let _n=te.linewidth;_n===void 0&&(_n=1),K.setLineWidth(_n*T()),de.isLineSegments?Kt.setMode(1):de.isLineLoop?Kt.setMode(2):Kt.setMode(3)}else de.isPoints?Kt.setMode(0):de.isSprite&&Kt.setMode(4);if(de.isInstancedMesh)Kt.renderInstances(ws,Ui,de.count);else if(re.isInstancedBufferGeometry){let _n=Math.min(re.instanceCount,re._maxInstanceCount);Kt.renderInstances(ws,Ui,_n)}else Kt.render(ws,Ui)}},this.compile=function(V,ee){d=j.get(V),d.init(),p.push(d),V.traverseVisible(function(re){re.isLight&&re.layers.test(ee.layers)&&(d.pushLight(re),re.castShadow&&d.pushShadow(re))}),d.setupLights(m.physicallyCorrectLights),V.traverse(function(re){let te=re.material;if(te)if(Array.isArray(te))for(let de=0;de<te.length;de++){let Ce=te[de];dt(Ce,V,re)}else dt(te,V,re)}),p.pop(),d=null};let pe=null;function Xe(V){pe&&pe(V)}function He(){qt.stop()}function je(){qt.start()}let qt=new TT;qt.setAnimationLoop(Xe),typeof self<"u"&&qt.setContext(self),this.setAnimationLoop=function(V){pe=V,xe.setAnimationLoop(V),V===null?qt.stop():qt.start()},xe.addEventListener("sessionstart",He),xe.addEventListener("sessionend",je),this.render=function(V,ee){if(ee!==void 0&&ee.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(g===!0)return;V.autoUpdate===!0&&V.updateMatrixWorld(),ee.parent===null&&ee.updateMatrixWorld(),xe.enabled===!0&&xe.isPresenting===!0&&(xe.cameraAutoUpdate===!0&&xe.updateCamera(ee),ee=xe.getCamera()),V.isScene===!0&&V.onBeforeRender(m,V,ee,b),d=j.get(V,p.length),d.init(),p.push(d),L.multiplyMatrices(ee.projectionMatrix,ee.matrixWorldInverse),O.setFromProjectionMatrix(L),I=this.localClippingEnabled,C=G.init(this.clippingPlanes,I,ee),c=Ve.get(V,f.length),c.init(),f.push(c),Mt(V,ee,0,m.sortObjects),c.finish(),m.sortObjects===!0&&c.sort(Q,z),C===!0&&G.beginShadows();let re=d.state.shadowsArray;if(se.render(re,V,ee),C===!0&&G.endShadows(),this.info.autoReset===!0&&this.info.reset(),ye.render(c,V),d.setupLights(m.physicallyCorrectLights),ee.isArrayCamera){let te=ee.cameras;for(let de=0,Ce=te.length;de<Ce;de++){let Re=te[de];Dt(c,V,Re,Re.viewport)}}else Dt(c,V,ee);b!==null&&(ue.updateMultisampleRenderTarget(b),ue.updateRenderTargetMipmap(b)),V.isScene===!0&&V.onAfterRender(m,V,ee),De.resetDefaultState(),_=-1,E=null,p.pop(),p.length>0?d=p[p.length-1]:d=null,f.pop(),f.length>0?c=f[f.length-1]:c=null};function Mt(V,ee,re,te){if(V.visible===!1)return;if(V.layers.test(ee.layers)){if(V.isGroup)re=V.renderOrder;else if(V.isLOD)V.autoUpdate===!0&&V.update(ee);else if(V.isLight)d.pushLight(V),V.castShadow&&d.pushShadow(V);else if(V.isSprite){if(!V.frustumCulled||O.intersectsSprite(V)){te&&N.setFromMatrixPosition(V.matrixWorld).applyMatrix4(L);let Ce=_e.update(V),Re=V.material;Re.visible&&c.push(V,Ce,Re,re,N.z,null)}}else if((V.isMesh||V.isLine||V.isPoints)&&(V.isSkinnedMesh&&V.skeleton.frame!==ie.render.frame&&(V.skeleton.update(),V.skeleton.frame=ie.render.frame),!V.frustumCulled||O.intersectsObject(V))){te&&N.setFromMatrixPosition(V.matrixWorld).applyMatrix4(L);let Ce=_e.update(V),Re=V.material;if(Array.isArray(Re)){let ft=Ce.groups;for(let Ke=0,pt=ft.length;Ke<pt;Ke++){let yt=ft[Ke],bt=Re[yt.materialIndex];bt&&bt.visible&&c.push(V,Ce,bt,re,N.z,yt)}}else Re.visible&&c.push(V,Ce,Re,re,N.z,null)}}let de=V.children;for(let Ce=0,Re=de.length;Ce<Re;Ce++)Mt(de[Ce],ee,re,te)}function Dt(V,ee,re,te){let de=V.opaque,Ce=V.transmissive,Re=V.transparent;d.setupLightsView(re),Ce.length>0&&at(de,ee,re),te&&K.viewport(S.copy(te)),de.length>0&&Fe(de,ee,re),Ce.length>0&&Fe(Ce,ee,re),Re.length>0&&Fe(Re,ee,re),K.buffers.depth.setTest(!0),K.buffers.depth.setMask(!0),K.buffers.color.setMask(!0),K.setPolygonOffset(!1)}function at(V,ee,re){let te=J.isWebGL2;k===null&&(k=new Or(1,1,{generateMipmaps:!0,type:W.has("EXT_color_buffer_half_float")?Ad:Si,minFilter:Ou,samples:te&&s===!0?4:0})),m.getDrawingBufferSize(w),te?k.setSize(w.x,w.y):k.setSize(C0(w.x),C0(w.y));let de=m.getRenderTarget();m.setRenderTarget(k),m.clear();let Ce=m.toneMapping;m.toneMapping=Ga,Fe(V,ee,re),m.toneMapping=Ce,ue.updateMultisampleRenderTarget(k),ue.updateRenderTargetMipmap(k),m.setRenderTarget(de)}function Fe(V,ee,re){let te=ee.isScene===!0?ee.overrideMaterial:null;for(let de=0,Ce=V.length;de<Ce;de++){let Re=V[de],ft=Re.object,Ke=Re.geometry,pt=te===null?Re.material:te,yt=Re.group;ft.layers.test(re.layers)&&We(ft,ee,re,Ke,pt,yt)}}function We(V,ee,re,te,de,Ce){V.onBeforeRender(m,ee,re,te,de,Ce),V.modelViewMatrix.multiplyMatrices(re.matrixWorldInverse,V.matrixWorld),V.normalMatrix.getNormalMatrix(V.modelViewMatrix),de.onBeforeRender(m,ee,re,te,V,Ce),de.transparent===!0&&de.side===ti?(de.side=yi,de.needsUpdate=!0,m.renderBufferDirect(re,ee,te,de,V,Ce),de.side=Zo,de.needsUpdate=!0,m.renderBufferDirect(re,ee,te,de,V,Ce),de.side=ti):m.renderBufferDirect(re,ee,te,de,V,Ce),V.onAfterRender(m,ee,re,te,de,Ce)}function dt(V,ee,re){ee.isScene!==!0&&(ee=X);let te=Z.get(V),de=d.state.lights,Ce=d.state.shadowsArray,Re=de.state.version,ft=ze.getParameters(V,de.state,Ce,ee,re),Ke=ze.getProgramCacheKey(ft),pt=te.programs;te.environment=V.isMeshStandardMaterial?ee.environment:null,te.fog=ee.fog,te.envMap=(V.isMeshStandardMaterial?ce:le).get(V.envMap||te.environment),pt===void 0&&(V.addEventListener("dispose",Le),pt=new Map,te.programs=pt);let yt=pt.get(Ke);if(yt!==void 0){if(te.currentProgram===yt&&te.lightsStateVersion===Re)return Je(V,ft),yt}else ft.uniforms=ze.getUniforms(V),V.onBuild(re,ft,m),V.onBeforeCompile(ft,m),yt=ze.acquireProgram(ft,Ke),pt.set(Ke,yt),te.uniforms=ft.uniforms;let bt=te.uniforms;(!V.isShaderMaterial&&!V.isRawShaderMaterial||V.clipping===!0)&&(bt.clippingPlanes=G.uniform),Je(V,ft),te.needsLights=st(V),te.lightsStateVersion=Re,te.needsLights&&(bt.ambientLightColor.value=de.state.ambient,bt.lightProbe.value=de.state.probe,bt.directionalLights.value=de.state.directional,bt.directionalLightShadows.value=de.state.directionalShadow,bt.spotLights.value=de.state.spot,bt.spotLightShadows.value=de.state.spotShadow,bt.rectAreaLights.value=de.state.rectArea,bt.ltc_1.value=de.state.rectAreaLTC1,bt.ltc_2.value=de.state.rectAreaLTC2,bt.pointLights.value=de.state.point,bt.pointLightShadows.value=de.state.pointShadow,bt.hemisphereLights.value=de.state.hemi,bt.directionalShadowMap.value=de.state.directionalShadowMap,bt.directionalShadowMatrix.value=de.state.directionalShadowMatrix,bt.spotShadowMap.value=de.state.spotShadowMap,bt.spotShadowMatrix.value=de.state.spotShadowMatrix,bt.pointShadowMap.value=de.state.pointShadowMap,bt.pointShadowMatrix.value=de.state.pointShadowMatrix);let Kt=yt.getUniforms(),li=Up.seqWithValue(Kt.seq,bt);return te.currentProgram=yt,te.uniformsList=li,yt}function Je(V,ee){let re=Z.get(V);re.outputEncoding=ee.outputEncoding,re.instancing=ee.instancing,re.skinning=ee.skinning,re.morphTargets=ee.morphTargets,re.morphNormals=ee.morphNormals,re.morphColors=ee.morphColors,re.morphTargetsCount=ee.morphTargetsCount,re.numClippingPlanes=ee.numClippingPlanes,re.numIntersection=ee.numClipIntersection,re.vertexAlphas=ee.vertexAlphas,re.vertexTangents=ee.vertexTangents,re.toneMapping=ee.toneMapping}function it(V,ee,re,te,de){ee.isScene!==!0&&(ee=X),ue.resetTextureUnits();let Ce=ee.fog,Re=te.isMeshStandardMaterial?ee.environment:null,ft=b===null?m.outputEncoding:b.isXRRenderTarget===!0?b.texture.encoding:la,Ke=(te.isMeshStandardMaterial?ce:le).get(te.envMap||Re),pt=te.vertexColors===!0&&!!re.attributes.color&&re.attributes.color.itemSize===4,yt=!!te.normalMap&&!!re.attributes.tangent,bt=!!re.morphAttributes.position,Kt=!!re.morphAttributes.normal,li=!!re.morphAttributes.color,Ai=te.toneMapped?m.toneMapping:Ga,xs=re.morphAttributes.position||re.morphAttributes.normal||re.morphAttributes.color,Fi=xs!==void 0?xs.length:0,Bt=Z.get(te),ws=d.state.lights;if(C===!0&&(I===!0||V!==E)){let Hi=V===E&&te.id===_;G.setState(te,V,Hi)}let xa=!1;te.version===Bt.__version?(Bt.needsLights&&Bt.lightsStateVersion!==ws.state.version||Bt.outputEncoding!==ft||de.isInstancedMesh&&Bt.instancing===!1||!de.isInstancedMesh&&Bt.instancing===!0||de.isSkinnedMesh&&Bt.skinning===!1||!de.isSkinnedMesh&&Bt.skinning===!0||Bt.envMap!==Ke||te.fog===!0&&Bt.fog!==Ce||Bt.numClippingPlanes!==void 0&&(Bt.numClippingPlanes!==G.numPlanes||Bt.numIntersection!==G.numIntersection)||Bt.vertexAlphas!==pt||Bt.vertexTangents!==yt||Bt.morphTargets!==bt||Bt.morphNormals!==Kt||Bt.morphColors!==li||Bt.toneMapping!==Ai||J.isWebGL2===!0&&Bt.morphTargetsCount!==Fi)&&(xa=!0):(xa=!0,Bt.__version=te.version);let Ui=Bt.currentProgram;xa===!0&&(Ui=dt(te,ee,de));let _n=!1,wa=!1,ll=!1,Nr=Ui.getUniforms(),ba=Bt.uniforms;if(K.useProgram(Ui.program)&&(_n=!0,wa=!0,ll=!0),te.id!==_&&(_=te.id,wa=!0),_n||E!==V){if(Nr.setValue(U,"projectionMatrix",V.projectionMatrix),J.logarithmicDepthBuffer&&Nr.setValue(U,"logDepthBufFC",2/(Math.log(V.far+1)/Math.LN2)),E!==V&&(E=V,wa=!0,ll=!0),te.isShaderMaterial||te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshStandardMaterial||te.envMap){let Hi=Nr.map.cameraPosition;Hi!==void 0&&Hi.setValue(U,N.setFromMatrixPosition(V.matrixWorld))}(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial)&&Nr.setValue(U,"isOrthographic",V.isOrthographicCamera===!0),(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial||te.isShadowMaterial||de.isSkinnedMesh)&&Nr.setValue(U,"viewMatrix",V.matrixWorldInverse)}if(de.isSkinnedMesh){Nr.setOptional(U,de,"bindMatrix"),Nr.setOptional(U,de,"bindMatrixInverse");let Hi=de.skeleton;Hi&&(J.floatVertexTextures?(Hi.boneTexture===null&&Hi.computeBoneTexture(),Nr.setValue(U,"boneTexture",Hi.boneTexture,ue),Nr.setValue(U,"boneTextureSize",Hi.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let hl=re.morphAttributes;return(hl.position!==void 0||hl.normal!==void 0||hl.color!==void 0&&J.isWebGL2===!0)&&ge.update(de,re,te,Ui),(wa||Bt.receiveShadow!==de.receiveShadow)&&(Bt.receiveShadow=de.receiveShadow,Nr.setValue(U,"receiveShadow",de.receiveShadow)),wa&&(Nr.setValue(U,"toneMappingExposure",m.toneMappingExposure),Bt.needsLights&&It(ba,ll),Ce&&te.fog===!0&&Be.refreshFogUniforms(ba,Ce),Be.refreshMaterialUniforms(ba,te,H,R,k),Up.upload(U,Bt.uniformsList,ba,ue)),te.isShaderMaterial&&te.uniformsNeedUpdate===!0&&(Up.upload(U,Bt.uniformsList,ba,ue),te.uniformsNeedUpdate=!1),te.isSpriteMaterial&&Nr.setValue(U,"center",de.center),Nr.setValue(U,"modelViewMatrix",de.modelViewMatrix),Nr.setValue(U,"normalMatrix",de.normalMatrix),Nr.setValue(U,"modelMatrix",de.matrixWorld),Ui}function It(V,ee){V.ambientLightColor.needsUpdate=ee,V.lightProbe.needsUpdate=ee,V.directionalLights.needsUpdate=ee,V.directionalLightShadows.needsUpdate=ee,V.pointLights.needsUpdate=ee,V.pointLightShadows.needsUpdate=ee,V.spotLights.needsUpdate=ee,V.spotLightShadows.needsUpdate=ee,V.rectAreaLights.needsUpdate=ee,V.hemisphereLights.needsUpdate=ee}function st(V){return V.isMeshLambertMaterial||V.isMeshToonMaterial||V.isMeshPhongMaterial||V.isMeshStandardMaterial||V.isShadowMaterial||V.isShaderMaterial&&V.lights===!0}this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return x},this.getRenderTarget=function(){return b},this.setRenderTargetTextures=function(V,ee,re){Z.get(V.texture).__webglTexture=ee,Z.get(V.depthTexture).__webglTexture=re;let te=Z.get(V);te.__hasExternalTextures=!0,te.__hasExternalTextures&&(te.__autoAllocateDepthBuffer=re===void 0,te.__autoAllocateDepthBuffer||W.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),te.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(V,ee){let re=Z.get(V);re.__webglFramebuffer=ee,re.__useDefaultFramebuffer=ee===void 0},this.setRenderTarget=function(V,ee=0,re=0){b=V,v=ee,x=re;let te=!0;if(V){let ft=Z.get(V);ft.__useDefaultFramebuffer!==void 0?(K.bindFramebuffer(36160,null),te=!1):ft.__webglFramebuffer===void 0?ue.setupRenderTarget(V):ft.__hasExternalTextures&&ue.rebindTextures(V,Z.get(V.texture).__webglTexture,Z.get(V.depthTexture).__webglTexture)}let de=null,Ce=!1,Re=!1;if(V){let ft=V.texture;(ft.isData3DTexture||ft.isDataArrayTexture)&&(Re=!0);let Ke=Z.get(V).__webglFramebuffer;V.isWebGLCubeRenderTarget?(de=Ke[ee],Ce=!0):J.isWebGL2&&V.samples>0&&ue.useMultisampledRTT(V)===!1?de=Z.get(V).__webglMultisampledFramebuffer:de=Ke,S.copy(V.viewport),P.copy(V.scissor),M=V.scissorTest}else S.copy(y).multiplyScalar(H).floor(),P.copy(A).multiplyScalar(H).floor(),M=D;if(K.bindFramebuffer(36160,de)&&J.drawBuffers&&te&&K.drawBuffers(V,de),K.viewport(S),K.scissor(P),K.setScissorTest(M),Ce){let ft=Z.get(V.texture);U.framebufferTexture2D(36160,36064,34069+ee,ft.__webglTexture,re)}else if(Re){let ft=Z.get(V.texture),Ke=ee||0;U.framebufferTextureLayer(36160,36064,ft.__webglTexture,re||0,Ke)}_=-1},this.readRenderTargetPixels=function(V,ee,re,te,de,Ce,Re){if(!(V&&V.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ft=Z.get(V).__webglFramebuffer;if(V.isWebGLCubeRenderTarget&&Re!==void 0&&(ft=ft[Re]),ft){K.bindFramebuffer(36160,ft);try{let Ke=V.texture,pt=Ke.format,yt=Ke.type;if(pt!==hs&&oe.convert(pt)!==U.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let bt=yt===Ad&&(W.has("EXT_color_buffer_half_float")||J.isWebGL2&&W.has("EXT_color_buffer_float"));if(yt!==Si&&oe.convert(yt)!==U.getParameter(35738)&&!(yt===bl&&(J.isWebGL2||W.has("OES_texture_float")||W.has("WEBGL_color_buffer_float")))&&!bt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ee>=0&&ee<=V.width-te&&re>=0&&re<=V.height-de&&U.readPixels(ee,re,te,de,oe.convert(pt),oe.convert(yt),Ce)}finally{let Ke=b!==null?Z.get(b).__webglFramebuffer:null;K.bindFramebuffer(36160,Ke)}}},this.copyFramebufferToTexture=function(V,ee,re=0){let te=Math.pow(2,-re),de=Math.floor(ee.image.width*te),Ce=Math.floor(ee.image.height*te);ue.setTexture2D(ee,0),U.copyTexSubImage2D(3553,re,0,0,V.x,V.y,de,Ce),K.unbindTexture()},this.copyTextureToTexture=function(V,ee,re,te=0){let de=ee.image.width,Ce=ee.image.height,Re=oe.convert(re.format),ft=oe.convert(re.type);ue.setTexture2D(re,0),U.pixelStorei(37440,re.flipY),U.pixelStorei(37441,re.premultiplyAlpha),U.pixelStorei(3317,re.unpackAlignment),ee.isDataTexture?U.texSubImage2D(3553,te,V.x,V.y,de,Ce,Re,ft,ee.image.data):ee.isCompressedTexture?U.compressedTexSubImage2D(3553,te,V.x,V.y,ee.mipmaps[0].width,ee.mipmaps[0].height,Re,ee.mipmaps[0].data):U.texSubImage2D(3553,te,V.x,V.y,Re,ft,ee.image),te===0&&re.generateMipmaps&&U.generateMipmap(3553),K.unbindTexture()},this.copyTextureToTexture3D=function(V,ee,re,te,de=0){if(m.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let Ce=V.max.x-V.min.x+1,Re=V.max.y-V.min.y+1,ft=V.max.z-V.min.z+1,Ke=oe.convert(te.format),pt=oe.convert(te.type),yt;if(te.isData3DTexture)ue.setTexture3D(te,0),yt=32879;else if(te.isDataArrayTexture)ue.setTexture2DArray(te,0),yt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}U.pixelStorei(37440,te.flipY),U.pixelStorei(37441,te.premultiplyAlpha),U.pixelStorei(3317,te.unpackAlignment);let bt=U.getParameter(3314),Kt=U.getParameter(32878),li=U.getParameter(3316),Ai=U.getParameter(3315),xs=U.getParameter(32877),Fi=re.isCompressedTexture?re.mipmaps[0]:re.image;U.pixelStorei(3314,Fi.width),U.pixelStorei(32878,Fi.height),U.pixelStorei(3316,V.min.x),U.pixelStorei(3315,V.min.y),U.pixelStorei(32877,V.min.z),re.isDataTexture||re.isData3DTexture?U.texSubImage3D(yt,de,ee.x,ee.y,ee.z,Ce,Re,ft,Ke,pt,Fi.data):re.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),U.compressedTexSubImage3D(yt,de,ee.x,ee.y,ee.z,Ce,Re,ft,Ke,Fi.data)):U.texSubImage3D(yt,de,ee.x,ee.y,ee.z,Ce,Re,ft,Ke,pt,Fi),U.pixelStorei(3314,bt),U.pixelStorei(32878,Kt),U.pixelStorei(3316,li),U.pixelStorei(3315,Ai),U.pixelStorei(32877,xs),de===0&&te.generateMipmaps&&U.generateMipmap(yt),K.unbindTexture()},this.initTexture=function(V){ue.setTexture2D(V,0),K.unbindTexture()},this.resetState=function(){v=0,x=0,b=null,K.reset(),De.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var J8=class extends my{};J8.prototype.isWebGL1Renderer=!0;var BT=class{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new Ue(e),this.near=t,this.far=r}clone(){return new BT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},su=class extends er{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}},K8=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=cy,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ta()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,n=this.stride;i<n;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ta()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ta()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Ei=new F,gy=class{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Ei.fromBufferAttribute(this,t),Ei.applyMatrix4(e),this.setXYZ(t,Ei.x,Ei.y,Ei.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Ei.fromBufferAttribute(this,t),Ei.applyNormalMatrix(e),this.setXYZ(t,Ei.x,Ei.y,Ei.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Ei.fromBufferAttribute(this,t),Ei.transformDirection(e),this.setXYZ(t,Ei.x,Ei.y,Ei.z);return this}setX(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=n,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return new Ct(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new gy(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");let t=[];for(let r=0;r<this.count;r++){let i=r*this.data.stride+this.offset;for(let n=0;n<this.itemSize;n++)t.push(this.data.array[i+n])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},Z8=class extends ai{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Ue(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},$8=class extends Ct{constructor(e,t,r,i=1){typeof r=="number"&&(i=r,r=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},ma=class extends ai{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ue(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},MS=new F,AS=new F,ES=new wt,ov=new Sm,Kf=new ha,D0=class extends er{constructor(e=new vt,t=new ma){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[0];for(let i=1,n=t.count;i<n;i++)MS.fromBufferAttribute(t,i-1),AS.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=MS.distanceTo(AS);e.setAttribute("lineDistance",new Ge(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let r=this.geometry,i=this.matrixWorld,n=e.params.Line.threshold,s=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),Kf.copy(r.boundingSphere),Kf.applyMatrix4(i),Kf.radius+=n,e.ray.intersectsSphere(Kf)===!1)return;ES.copy(i).invert(),ov.copy(e.ray).applyMatrix4(ES);let a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=new F,h=new F,u=new F,c=new F,d=this.isLineSegments?2:1,f=r.index,p=r.attributes.position;if(f!==null){let m=Math.max(0,s.start),g=Math.min(f.count,s.start+s.count);for(let v=m,x=g-1;v<x;v+=d){let b=f.getX(v),_=f.getX(v+1);if(l.fromBufferAttribute(p,b),h.fromBufferAttribute(p,_),ov.distanceSqToSegment(l,h,c,u)>o)continue;c.applyMatrix4(this.matrixWorld);let E=e.ray.origin.distanceTo(c);E<e.near||E>e.far||t.push({distance:E,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else{let m=Math.max(0,s.start),g=Math.min(p.count,s.start+s.count);for(let v=m,x=g-1;v<x;v+=d){if(l.fromBufferAttribute(p,v),h.fromBufferAttribute(p,v+1),ov.distanceSqToSegment(l,h,c,u)>o)continue;c.applyMatrix4(this.matrixWorld);let b=e.ray.origin.distanceTo(c);b<e.near||b>e.far||t.push({distance:b,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let r=e[t[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++){let s=r[i].name||String(i);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=i}}}}},CS=new F,TS=new F,Qd=class extends D0{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,r=[];for(let i=0,n=t.count;i<n;i+=2)CS.fromBufferAttribute(t,i),TS.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+CS.distanceTo(TS);e.setAttribute("lineDistance",new Ge(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},ez=class extends ai{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Ue(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},tz=class extends Qr{constructor(e,t,r,i,n,s,a,o,l){super(e,t,r,i,n,s,a,o,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:Wt,this.magFilter=n!==void 0?n:Wt,this.generateMipmaps=!1;let h=this;function u(){h.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},ga=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){let t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],r,i=this.getPoint(0),n=0;t.push(0);for(let s=1;s<=e;s++)r=this.getPoint(s/e),n+=r.distanceTo(i),t.push(n),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let r=this.getLengths(),i=0,n=r.length,s;t?s=t:s=e*r[n-1];let a=0,o=n-1,l;for(;a<=o;)if(i=Math.floor(a+(o-a)/2),l=r[i]-s,l<0)a=i+1;else if(l>0)o=i-1;else{o=i;break}if(i=o,r[i]===s)return i/(n-1);let h=r[i],u=r[i+1]-h,c=(s-h)/u;return(i+c)/(n-1)}getTangent(e,t){let r=e-1e-4,i=e+1e-4;r<0&&(r=0),i>1&&(i=1);let n=this.getPoint(r),s=this.getPoint(i),a=t||(n.isVector2?new $:new F);return a.copy(s).sub(n).normalize(),a}getTangentAt(e,t){let r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t){let r=new F,i=[],n=[],s=[],a=new F,o=new wt;for(let d=0;d<=e;d++){let f=d/e;i[d]=this.getTangentAt(f,new F)}n[0]=new F,s[0]=new F;let l=Number.MAX_VALUE,h=Math.abs(i[0].x),u=Math.abs(i[0].y),c=Math.abs(i[0].z);h<=l&&(l=h,r.set(1,0,0)),u<=l&&(l=u,r.set(0,1,0)),c<=l&&r.set(0,0,1),a.crossVectors(i[0],r).normalize(),n[0].crossVectors(i[0],a),s[0].crossVectors(i[0],n[0]);for(let d=1;d<=e;d++){if(n[d]=n[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(i[d-1],i[d]),a.length()>Number.EPSILON){a.normalize();let f=Math.acos(Pr(i[d-1].dot(i[d]),-1,1));n[d].applyMatrix4(o.makeRotationAxis(a,f))}s[d].crossVectors(i[d],n[d])}if(t===!0){let d=Math.acos(Pr(n[0].dot(n[e]),-1,1));d/=e,i[0].dot(a.crossVectors(n[0],n[e]))>0&&(d=-d);for(let f=1;f<=e;f++)n[f].applyMatrix4(o.makeRotationAxis(i[f],d*f)),s[f].crossVectors(i[f],n[f])}return{tangents:i,normals:n,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},Cm=class extends ga{constructor(e=0,t=0,r=1,i=1,n=0,s=Math.PI*2,a=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=n,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){let r=t||new $,i=Math.PI*2,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=i;for(;n>i;)n-=i;n<Number.EPSILON&&(s?n=0:n=i),this.aClockwise===!0&&!s&&(n===i?n=-i:n=n-i);let a=this.aStartAngle+e*n,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let h=Math.cos(this.aRotation),u=Math.sin(this.aRotation),c=o-this.aX,d=l-this.aY;o=c*h-d*u+this.aX,l=c*u+d*h+this.aY}return r.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},rz=class extends Cm{constructor(e,t,r,i,n,s){super(e,t,r,r,i,n,s),this.isArcCurve=!0,this.type="ArcCurve"}};function Nw(){let e=0,t=0,r=0,i=0;function n(s,a,o,l){e=s,t=o,r=-3*s+3*a-2*o-l,i=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,h){n(a,o,h*(o-s),h*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,h,u,c){let d=(a-s)/h-(o-s)/(h+u)+(o-a)/u,f=(o-a)/u-(l-a)/(u+c)+(l-o)/c;d*=u,f*=u,n(a,o,d,f)},calc:function(s){let a=s*s,o=a*s;return e+t*s+r*a+i*o}}}var Zf=new F,lv=new Nw,hv=new Nw,uv=new Nw,iz=class extends ga{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new F){let r=t,i=this.points,n=i.length,s=(n-(this.closed?0:1))*e,a=Math.floor(s),o=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/n)+1)*n:o===0&&a===n-1&&(a=n-2,o=1);let l,h;this.closed||a>0?l=i[(a-1)%n]:(Zf.subVectors(i[0],i[1]).add(i[0]),l=Zf);let u=i[a%n],c=i[(a+1)%n];if(this.closed||a+2<n?h=i[(a+2)%n]:(Zf.subVectors(i[n-1],i[n-2]).add(i[n-1]),h=Zf),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,f=Math.pow(l.distanceToSquared(u),d),p=Math.pow(u.distanceToSquared(c),d),m=Math.pow(c.distanceToSquared(h),d);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),lv.initNonuniformCatmullRom(l.x,u.x,c.x,h.x,f,p,m),hv.initNonuniformCatmullRom(l.y,u.y,c.y,h.y,f,p,m),uv.initNonuniformCatmullRom(l.z,u.z,c.z,h.z,f,p,m)}else this.curveType==="catmullrom"&&(lv.initCatmullRom(l.x,u.x,c.x,h.x,this.tension),hv.initCatmullRom(l.y,u.y,c.y,h.y,this.tension),uv.initCatmullRom(l.z,u.z,c.z,h.z,this.tension));return r.set(lv.calc(o),hv.calc(o),uv.calc(o)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new F().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function DS(e,t,r,i,n){let s=(i-t)*.5,a=(n-r)*.5,o=e*e,l=e*o;return(2*r-2*i+s+a)*l+(-3*r+3*i-2*s-a)*o+s*e+r}function nz(e,t){let r=1-e;return r*r*t}function sz(e,t){return 2*(1-e)*e*t}function az(e,t){return e*e*t}function Jc(e,t,r,i){return nz(e,t)+sz(e,r)+az(e,i)}function oz(e,t){let r=1-e;return r*r*r*t}function lz(e,t){let r=1-e;return 3*r*r*e*t}function hz(e,t){return 3*(1-e)*e*e*t}function uz(e,t){return e*e*e*t}function Kc(e,t,r,i,n){return oz(e,t)+lz(e,r)+hz(e,i)+uz(e,n)}var qs=class extends ga{constructor(e=new $,t=new $,r=new $,i=new $){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new $){let r=t,i=this.v0,n=this.v1,s=this.v2,a=this.v3;return r.set(Kc(e,i.x,n.x,s.x,a.x),Kc(e,i.y,n.y,s.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},cz=class extends ga{constructor(e=new F,t=new F,r=new F,i=new F){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new F){let r=t,i=this.v0,n=this.v1,s=this.v2,a=this.v3;return r.set(Kc(e,i.x,n.x,s.x,a.x),Kc(e,i.y,n.y,s.y,a.y),Kc(e,i.z,n.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},ra=class extends ga{constructor(e=new $,t=new $){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new $){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){let r=t||new $;return r.copy(this.v2).sub(this.v1).normalize(),r}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},kT=class extends ga{constructor(e=new F,t=new F){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new F){let r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Vl=class extends ga{constructor(e=new $,t=new $,r=new $){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new $){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Jc(e,i.x,n.x,s.x),Jc(e,i.y,n.y,s.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},dz=class extends ga{constructor(e=new F,t=new F,r=new F){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new F){let r=t,i=this.v0,n=this.v1,s=this.v2;return r.set(Jc(e,i.x,n.x,s.x),Jc(e,i.y,n.y,s.y),Jc(e,i.z,n.z,s.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Bw=class extends ga{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new $){let r=t,i=this.points,n=(i.length-1)*e,s=Math.floor(n),a=n-s,o=i[s===0?s:s-1],l=i[s],h=i[s>i.length-2?i.length-1:s+1],u=i[s>i.length-3?i.length-1:s+2];return r.set(DS(a,o.x,l.x,h.x,u.x),DS(a,o.y,l.y,h.y,u.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){let i=e.points[t];this.points.push(new $().fromArray(i))}return this}},fz=Object.freeze({__proto__:null,ArcCurve:rz,CatmullRomCurve3:iz,CubicBezierCurve:qs,CubicBezierCurve3:cz,EllipseCurve:Cm,LineCurve:ra,LineCurve3:kT,QuadraticBezierCurve:Vl,QuadraticBezierCurve3:dz,SplineCurve:Bw}),pz=class extends ga{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new ra(t,e))}getPoint(e,t){let r=e*this.getLength(),i=this.getCurveLengths(),n=0;for(;n<i.length;){if(i[n]>=r){let s=i[n]-r,a=this.curves[n],o=a.getLength(),l=o===0?0:1-s/o;return a.getPointAt(l,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],r;for(let i=0,n=this.curves;i<n.length;i++){let s=n[i],a=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,o=s.getPoints(a);for(let l=0;l<o.length;l++){let h=o[l];r&&r.equals(h)||(t.push(h),r=h)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){let i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){let i=e.curves[t];this.curves.push(new fz[i.type]().fromJSON(i))}return this}},vy=class extends pz{constructor(e){super(),this.type="Path",this.currentPoint=new $,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let r=new ra(this.currentPoint.clone(),new $(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){let n=new Vl(this.currentPoint.clone(),new $(e,t),new $(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,n,s){let a=new qs(this.currentPoint.clone(),new $(e,t),new $(r,i),new $(n,s));return this.curves.push(a),this.currentPoint.set(n,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),r=new Bw(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,n,s){let a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,r,i,n,s),this}absarc(e,t,r,i,n,s){return this.absellipse(e,t,r,r,i,n,s),this}ellipse(e,t,r,i,n,s,a,o){let l=this.currentPoint.x,h=this.currentPoint.y;return this.absellipse(e+l,t+h,r,i,n,s,a,o),this}absellipse(e,t,r,i,n,s,a,o){let l=new Cm(e,t,r,i,n,s,a,o);if(this.curves.length>0){let u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);let h=l.getPoint(1);return this.currentPoint.copy(h),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},zT=class extends vt{constructor(e=[new $(0,.5),new $(.5,0),new $(0,-.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=Pr(i,0,Math.PI*2);let n=[],s=[],a=[],o=[],l=[],h=1/t,u=new F,c=new $,d=new F,f=new F,p=new F,m=0,g=0;for(let v=0;v<=e.length-1;v++)switch(v){case 0:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=g*1,d.y=-m,d.z=g*0,p.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(p.x,p.y,p.z);break;default:m=e[v+1].x-e[v].x,g=e[v+1].y-e[v].y,d.x=g*1,d.y=-m,d.z=g*0,f.copy(d),d.x+=p.x,d.y+=p.y,d.z+=p.z,d.normalize(),o.push(d.x,d.y,d.z),p.copy(f)}for(let v=0;v<=t;v++){let x=r+v*h*i,b=Math.sin(x),_=Math.cos(x);for(let E=0;E<=e.length-1;E++){u.x=e[E].x*b,u.y=e[E].y,u.z=e[E].x*_,s.push(u.x,u.y,u.z),c.x=v/t,c.y=E/(e.length-1),a.push(c.x,c.y);let S=o[3*E+0]*b,P=o[3*E+1],M=o[3*E+0]*_;l.push(S,P,M)}}for(let v=0;v<t;v++)for(let x=0;x<e.length-1;x++){let b=x+v*e.length,_=b,E=b+e.length,S=b+e.length+1,P=b+1;n.push(_,E,P),n.push(S,P,E)}this.setIndex(n),this.setAttribute("position",new Ge(s,3)),this.setAttribute("uv",new Ge(a,2)),this.setAttribute("normal",new Ge(l,3))}static fromJSON(e){return new zT(e.points,e.segments,e.phiStart,e.phiLength)}},kw=class extends vt{constructor(e=1,t=1,r=1,i=8,n=1,s=!1,a=0,o=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:n,openEnded:s,thetaStart:a,thetaLength:o};let l=this;i=Math.floor(i),n=Math.floor(n);let h=[],u=[],c=[],d=[],f=0,p=[],m=r/2,g=0;v(),s===!1&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex(h),this.setAttribute("position",new Ge(u,3)),this.setAttribute("normal",new Ge(c,3)),this.setAttribute("uv",new Ge(d,2));function v(){let b=new F,_=new F,E=0,S=(t-e)/r;for(let P=0;P<=n;P++){let M=[],B=P/n,R=B*(t-e)+e;for(let H=0;H<=i;H++){let Q=H/i,z=Q*o+a,y=Math.sin(z),A=Math.cos(z);_.x=R*y,_.y=-B*r+m,_.z=R*A,u.push(_.x,_.y,_.z),b.set(y,S,A).normalize(),c.push(b.x,b.y,b.z),d.push(Q,1-B),M.push(f++)}p.push(M)}for(let P=0;P<i;P++)for(let M=0;M<n;M++){let B=p[M][P],R=p[M+1][P],H=p[M+1][P+1],Q=p[M][P+1];h.push(B,R,Q),h.push(R,H,Q),E+=6}l.addGroup(g,E,0),g+=E}function x(b){let _=f,E=new $,S=new F,P=0,M=b===!0?e:t,B=b===!0?1:-1;for(let H=1;H<=i;H++)u.push(0,m*B,0),c.push(0,B,0),d.push(.5,.5),f++;let R=f;for(let H=0;H<=i;H++){let Q=H/i*o+a,z=Math.cos(Q),y=Math.sin(Q);S.x=M*y,S.y=m*B,S.z=M*z,u.push(S.x,S.y,S.z),c.push(0,B,0),E.x=z*.5+.5,E.y=y*.5*B+.5,d.push(E.x,E.y),f++}for(let H=0;H<i;H++){let Q=_+H,z=R+H;b===!0?h.push(z,z+1,Q):h.push(z+1,z,Q),P+=3}l.addGroup(g,P,b===!0?1:2),g+=P}}static fromJSON(e){return new kw(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},FT=class extends kw{constructor(e=1,t=1,r=8,i=1,n=!1,s=0,a=Math.PI*2){super(0,e,t,r,i,n,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:n,thetaStart:s,thetaLength:a}}static fromJSON(e){return new FT(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},zw=class extends vt{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};let n=[],s=[];a(i),l(r),h(),this.setAttribute("position",new Ge(n,3)),this.setAttribute("normal",new Ge(n.slice(),3)),this.setAttribute("uv",new Ge(s,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function a(v){let x=new F,b=new F,_=new F;for(let E=0;E<t.length;E+=3)d(t[E+0],x),d(t[E+1],b),d(t[E+2],_),o(x,b,_,v)}function o(v,x,b,_){let E=_+1,S=[];for(let P=0;P<=E;P++){S[P]=[];let M=v.clone().lerp(b,P/E),B=x.clone().lerp(b,P/E),R=E-P;for(let H=0;H<=R;H++)H===0&&P===E?S[P][H]=M:S[P][H]=M.clone().lerp(B,H/R)}for(let P=0;P<E;P++)for(let M=0;M<2*(E-P)-1;M++){let B=Math.floor(M/2);M%2===0?(c(S[P][B+1]),c(S[P+1][B]),c(S[P][B])):(c(S[P][B+1]),c(S[P+1][B+1]),c(S[P+1][B]))}}function l(v){let x=new F;for(let b=0;b<n.length;b+=3)x.x=n[b+0],x.y=n[b+1],x.z=n[b+2],x.normalize().multiplyScalar(v),n[b+0]=x.x,n[b+1]=x.y,n[b+2]=x.z}function h(){let v=new F;for(let x=0;x<n.length;x+=3){v.x=n[x+0],v.y=n[x+1],v.z=n[x+2];let b=m(v)/2/Math.PI+.5,_=g(v)/Math.PI+.5;s.push(b,1-_)}f(),u()}function u(){for(let v=0;v<s.length;v+=6){let x=s[v+0],b=s[v+2],_=s[v+4],E=Math.max(x,b,_),S=Math.min(x,b,_);E>.9&&S<.1&&(x<.2&&(s[v+0]+=1),b<.2&&(s[v+2]+=1),_<.2&&(s[v+4]+=1))}}function c(v){n.push(v.x,v.y,v.z)}function d(v,x){let b=v*3;x.x=e[b+0],x.y=e[b+1],x.z=e[b+2]}function f(){let v=new F,x=new F,b=new F,_=new F,E=new $,S=new $,P=new $;for(let M=0,B=0;M<n.length;M+=9,B+=6){v.set(n[M+0],n[M+1],n[M+2]),x.set(n[M+3],n[M+4],n[M+5]),b.set(n[M+6],n[M+7],n[M+8]),E.set(s[B+0],s[B+1]),S.set(s[B+2],s[B+3]),P.set(s[B+4],s[B+5]),_.copy(v).add(x).add(b).divideScalar(3);let R=m(_);p(E,B+0,v,R),p(S,B+2,x,R),p(P,B+4,b,R)}}function p(v,x,b,_){_<0&&v.x===1&&(s[x]=v.x-1),b.x===0&&b.z===0&&(s[x]=_/2/Math.PI+.5)}function m(v){return Math.atan2(v.z,-v.x)}function g(v){return Math.atan2(-v.y,Math.sqrt(v.x*v.x+v.z*v.z))}}static fromJSON(e){return new zw(e.vertices,e.indices,e.radius,e.details)}},UT=class extends zw{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=1/r,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(n,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new UT(e.radius,e.detail)}};new F;new F;new F;new Us;var Pl=class extends vy{constructor(e){super(e),this.uuid=ta(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){let i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){let i=e.holes[t];this.holes.push(new vy().fromJSON(i))}return this}},mz={triangulate:function(e,t,r=2){let i=t&&t.length,n=i?t[0]*r:e.length,s=HT(e,0,n,r,!0),a=[];if(!s||s.next===s.prev)return a;let o,l,h,u,c,d,f;if(i&&(s=wz(e,t,s,r)),e.length>80*r){o=h=e[0],l=u=e[1];for(let p=r;p<n;p+=r)c=e[p],d=e[p+1],c<o&&(o=c),d<l&&(l=d),c>h&&(h=c),d>u&&(u=d);f=Math.max(h-o,u-l),f=f!==0?1/f:0}return Cd(s,a,r,o,l,f),a}};function HT(e,t,r,i,n){let s,a;if(n===Lz(e,t,r,i)>0)for(s=t;s<r;s+=i)a=PS(s,e[s],e[s+1],a);else for(s=r-i;s>=t;s-=i)a=PS(s,e[s],e[s+1],a);return a&&Tm(a,a.next)&&(Dd(a),a=a.next),a}function el(e,t){if(!e)return e;t||(t=e);let r=e,i;do if(i=!1,!r.steiner&&(Tm(r,r.next)||ur(r.prev,r,r.next)===0)){if(Dd(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function Cd(e,t,r,i,n,s,a){if(!e)return;!a&&s&&Az(e,i,n,s);let o=e,l,h;for(;e.prev!==e.next;){if(l=e.prev,h=e.next,s?vz(e,i,n,s):gz(e)){t.push(l.i/r),t.push(e.i/r),t.push(h.i/r),Dd(e),e=h.next,o=h.next;continue}if(e=h,e===o){a?a===1?(e=yz(el(e),t,r),Cd(e,t,r,i,n,s,2)):a===2&&xz(e,t,r,i,n,s):Cd(el(e),t,r,i,n,s,1);break}}}function gz(e){let t=e.prev,r=e,i=e.next;if(ur(t,r,i)>=0)return!1;let n=e.next.next;for(;n!==e.prev;){if(qh(t.x,t.y,r.x,r.y,i.x,i.y,n.x,n.y)&&ur(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function vz(e,t,r,i){let n=e.prev,s=e,a=e.next;if(ur(n,s,a)>=0)return!1;let o=n.x<s.x?n.x<a.x?n.x:a.x:s.x<a.x?s.x:a.x,l=n.y<s.y?n.y<a.y?n.y:a.y:s.y<a.y?s.y:a.y,h=n.x>s.x?n.x>a.x?n.x:a.x:s.x>a.x?s.x:a.x,u=n.y>s.y?n.y>a.y?n.y:a.y:s.y>a.y?s.y:a.y,c=yy(o,l,t,r,i),d=yy(h,u,t,r,i),f=e.prevZ,p=e.nextZ;for(;f&&f.z>=c&&p&&p.z<=d;){if(f!==e.prev&&f!==e.next&&qh(n.x,n.y,s.x,s.y,a.x,a.y,f.x,f.y)&&ur(f.prev,f,f.next)>=0||(f=f.prevZ,p!==e.prev&&p!==e.next&&qh(n.x,n.y,s.x,s.y,a.x,a.y,p.x,p.y)&&ur(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;f&&f.z>=c;){if(f!==e.prev&&f!==e.next&&qh(n.x,n.y,s.x,s.y,a.x,a.y,f.x,f.y)&&ur(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&qh(n.x,n.y,s.x,s.y,a.x,a.y,p.x,p.y)&&ur(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function yz(e,t,r){let i=e;do{let n=i.prev,s=i.next.next;!Tm(n,s)&&GT(n,i,i.next,s)&&Td(n,s)&&Td(s,n)&&(t.push(n.i/r),t.push(i.i/r),t.push(s.i/r),Dd(i),Dd(i.next),i=e=s),i=i.next}while(i!==e);return el(i)}function xz(e,t,r,i,n,s){let a=e;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&Tz(a,o)){let l=VT(a,o);a=el(a,a.next),l=el(l,l.next),Cd(a,t,r,i,n,s),Cd(l,t,r,i,n,s);return}o=o.next}a=a.next}while(a!==e)}function wz(e,t,r,i){let n=[],s,a,o,l,h;for(s=0,a=t.length;s<a;s++)o=t[s]*i,l=s<a-1?t[s+1]*i:e.length,h=HT(e,o,l,i,!1),h===h.next&&(h.steiner=!0),n.push(Cz(h));for(n.sort(bz),s=0;s<n.length;s++)_z(n[s],r),r=el(r,r.next);return r}function bz(e,t){return e.x-t.x}function _z(e,t){if(t=Sz(e,t),t){let r=VT(t,e);el(t,t.next),el(r,r.next)}}function Sz(e,t){let r=t,i=e.x,n=e.y,s=-1/0,a;do{if(n<=r.y&&n>=r.next.y&&r.next.y!==r.y){let d=r.x+(n-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(d<=i&&d>s){if(s=d,d===i){if(n===r.y)return r;if(n===r.next.y)return r.next}a=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!a)return null;if(i===s)return a;let o=a,l=a.x,h=a.y,u=1/0,c;r=a;do i>=r.x&&r.x>=l&&i!==r.x&&qh(n<h?i:s,n,l,h,n<h?s:i,n,r.x,r.y)&&(c=Math.abs(n-r.y)/(i-r.x),Td(r,e)&&(c<u||c===u&&(r.x>a.x||r.x===a.x&&Mz(a,r)))&&(a=r,u=c)),r=r.next;while(r!==o);return a}function Mz(e,t){return ur(e.prev,e,t.prev)<0&&ur(t.next,e,e.next)<0}function Az(e,t,r,i){let n=e;do n.z===null&&(n.z=yy(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,Ez(n)}function Ez(e){let t,r,i,n,s,a,o,l,h=1;do{for(r=e,e=null,s=null,a=0;r;){for(a++,i=r,o=0,t=0;t<h&&(o++,i=i.nextZ,!!i);t++);for(l=h;o>0||l>0&&i;)o!==0&&(l===0||!i||r.z<=i.z)?(n=r,r=r.nextZ,o--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,h*=2}while(a>1);return e}function yy(e,t,r,i,n){return e=32767*(e-r)*n,t=32767*(t-i)*n,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Cz(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function qh(e,t,r,i,n,s,a,o){return(n-a)*(t-o)-(e-a)*(s-o)>=0&&(e-a)*(i-o)-(r-a)*(t-o)>=0&&(r-a)*(s-o)-(n-a)*(i-o)>=0}function Tz(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Dz(e,t)&&(Td(e,t)&&Td(t,e)&&Pz(e,t)&&(ur(e.prev,e,t.prev)||ur(e,t.prev,t))||Tm(e,t)&&ur(e.prev,e,e.next)>0&&ur(t.prev,t,t.next)>0)}function ur(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function Tm(e,t){return e.x===t.x&&e.y===t.y}function GT(e,t,r,i){let n=ep(ur(e,t,r)),s=ep(ur(e,t,i)),a=ep(ur(r,i,e)),o=ep(ur(r,i,t));return!!(n!==s&&a!==o||n===0&&$f(e,r,t)||s===0&&$f(e,i,t)||a===0&&$f(r,e,i)||o===0&&$f(r,t,i))}function $f(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function ep(e){return e>0?1:e<0?-1:0}function Dz(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&GT(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Td(e,t){return ur(e.prev,e,e.next)<0?ur(e,t,e.next)>=0&&ur(e,e.prev,t)>=0:ur(e,t,e.prev)<0||ur(e,e.next,t)<0}function Pz(e,t){let r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function VT(e,t){let r=new xy(e.i,e.x,e.y),i=new xy(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function PS(e,t,r,i){let n=new xy(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function Dd(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function xy(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Lz(e,t,r,i){let n=0;for(let s=t,a=r-i;s<r;s+=i)n+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return n}var Zc=class{static area(e){let t=e.length,r=0;for(let i=t-1,n=0;n<t;i=n++)r+=e[i].x*e[n].y-e[n].x*e[i].y;return r*.5}static isClockWise(e){return Zc.area(e)<0}static triangulateShape(e,t){let r=[],i=[],n=[];LS(e),RS(r,e);let s=e.length;t.forEach(LS);for(let o=0;o<t.length;o++)i.push(s),s+=t[o].length,RS(r,t[o]);let a=mz.triangulate(r,i);for(let o=0;o<a.length;o+=3)n.push(a.slice(o,o+3));return n}};function LS(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function RS(e,t){for(let r=0;r<t.length;r++)e.push(t[r].x),e.push(t[r].y)}var jT=class extends zw{constructor(e=1,t=0){let r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],n=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,n,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new jT(e.radius,e.detail)}},WT=class extends vt{constructor(e=new Pl([new $(0,.5),new $(-.5,-.5),new $(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let r=[],i=[],n=[],s=[],a=0,o=0;if(Array.isArray(e)===!1)l(e);else for(let h=0;h<e.length;h++)l(e[h]),this.addGroup(a,o,h),a+=o,o=0;this.setIndex(r),this.setAttribute("position",new Ge(i,3)),this.setAttribute("normal",new Ge(n,3)),this.setAttribute("uv",new Ge(s,2));function l(h){let u=i.length/3,c=h.extractPoints(t),d=c.shape,f=c.holes;Zc.isClockWise(d)===!1&&(d=d.reverse());for(let m=0,g=f.length;m<g;m++){let v=f[m];Zc.isClockWise(v)===!0&&(f[m]=v.reverse())}let p=Zc.triangulateShape(d,f);for(let m=0,g=f.length;m<g;m++){let v=f[m];d=d.concat(v)}for(let m=0,g=d.length;m<g;m++){let v=d[m];i.push(v.x,v.y,0),n.push(0,0,1),s.push(v.x,v.y)}for(let m=0,g=p.length;m<g;m++){let v=p[m],x=v[0]+u,b=v[1]+u,_=v[2]+u;r.push(x,b,_),o+=3}}}toJSON(){let e=super.toJSON(),t=this.parameters.shapes;return Rz(t,e)}static fromJSON(e,t){let r=[];for(let i=0,n=e.shapes.length;i<n;i++){let s=t[e.shapes[i]];r.push(s)}return new WT(r,e.curveSegments)}};function Rz(e,t){if(t.shapes=[],Array.isArray(e))for(let r=0,i=e.length;r<i;r++){let n=e[r];t.shapes.push(n.uuid)}else t.shapes.push(e.uuid);return t}var Fw=class extends vt{constructor(e=1,t=32,r=16,i=0,n=Math.PI*2,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:n,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));let o=Math.min(s+a,Math.PI),l=0,h=[],u=new F,c=new F,d=[],f=[],p=[],m=[];for(let g=0;g<=r;g++){let v=[],x=g/r,b=0;g==0&&s==0?b=.5/t:g==r&&o==Math.PI&&(b=-.5/t);for(let _=0;_<=t;_++){let E=_/t;u.x=-e*Math.cos(i+E*n)*Math.sin(s+x*a),u.y=e*Math.cos(s+x*a),u.z=e*Math.sin(i+E*n)*Math.sin(s+x*a),f.push(u.x,u.y,u.z),c.copy(u).normalize(),p.push(c.x,c.y,c.z),m.push(E+b,1-x),v.push(l++)}h.push(v)}for(let g=0;g<r;g++)for(let v=0;v<t;v++){let x=h[g][v+1],b=h[g][v],_=h[g+1][v],E=h[g+1][v+1];(g!==0||s>0)&&d.push(x,b,E),(g!==r-1||o<Math.PI)&&d.push(b,_,E)}this.setIndex(d),this.setAttribute("position",new Ge(f,3)),this.setAttribute("normal",new Ge(p,3)),this.setAttribute("uv",new Ge(m,2))}static fromJSON(e){return new Fw(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},qT=class extends vt{constructor(e=1,t=.4,r=64,i=8,n=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:n,q:s},r=Math.floor(r),i=Math.floor(i);let a=[],o=[],l=[],h=[],u=new F,c=new F,d=new F,f=new F,p=new F,m=new F,g=new F;for(let x=0;x<=r;++x){let b=x/r*n*Math.PI*2;v(b,n,s,e,d),v(b+.01,n,s,e,f),m.subVectors(f,d),g.addVectors(f,d),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let _=0;_<=i;++_){let E=_/i*Math.PI*2,S=-t*Math.cos(E),P=t*Math.sin(E);u.x=d.x+(S*g.x+P*p.x),u.y=d.y+(S*g.y+P*p.y),u.z=d.z+(S*g.z+P*p.z),o.push(u.x,u.y,u.z),c.subVectors(u,d).normalize(),l.push(c.x,c.y,c.z),h.push(x/r),h.push(_/i)}}for(let x=1;x<=r;x++)for(let b=1;b<=i;b++){let _=(i+1)*(x-1)+(b-1),E=(i+1)*x+(b-1),S=(i+1)*x+b,P=(i+1)*(x-1)+b;a.push(_,E,P),a.push(E,S,P)}this.setIndex(a),this.setAttribute("position",new Ge(o,3)),this.setAttribute("normal",new Ge(l,3)),this.setAttribute("uv",new Ge(h,2));function v(x,b,_,E,S){let P=Math.cos(x),M=Math.sin(x),B=_/b*x,R=Math.cos(B);S.x=E*(2+R)*.5*P,S.y=E*(2+R)*M*.5,S.z=E*Math.sin(B)*.5}}static fromJSON(e){return new qT(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}},Oz=class extends ai{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Ue(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}},Iz=class extends Gr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}},YT=class extends ai{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Ue(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Iu,this.normalScale=new $(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},Nz=class extends YT{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new $(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Pr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Ue(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Ue(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Ue(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}},Bz=class extends ai{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Ue(16777215),this.specular=new Ue(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Iu,this.normalScale=new $(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=_m,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},kz=class extends ai{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Ue(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Iu,this.normalScale=new $(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},zz=class extends ai{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Iu,this.normalScale=new $(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}},Fz=class extends ai{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ue(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ue(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=_m,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},Uz=class extends ai{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Ue(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Iu,this.normalScale=new $(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}},Hz=class extends ma{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}},Gz={ShadowMaterial:Oz,SpriteMaterial:Z8,RawShaderMaterial:Iz,ShaderMaterial:Gr,PointsMaterial:ez,MeshPhysicalMaterial:Nz,MeshStandardMaterial:YT,MeshPhongMaterial:Bz,MeshToonMaterial:kz,MeshNormalMaterial:zz,MeshLambertMaterial:Fz,MeshDepthMaterial:IT,MeshDistanceMaterial:NT,MeshBasicMaterial:Gl,MeshMatcapMaterial:Uz,LineDashedMaterial:Hz,LineBasicMaterial:ma,Material:ai};ai.fromType=function(e){return new Gz[e]};var OS={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},Uw=class{constructor(e,t,r){let i=this,n=!1,s=0,a=0,o,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(h){a++,n===!1&&i.onStart!==void 0&&i.onStart(h,s,a),n=!0},this.itemEnd=function(h){s++,i.onProgress!==void 0&&i.onProgress(h,s,a),s===a&&(n=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(h){i.onError!==void 0&&i.onError(h)},this.resolveURL=function(h){return o?o(h):h},this.setURLModifier=function(h){return o=h,this},this.addHandler=function(h,u){return l.push(h,u),this},this.removeHandler=function(h){let u=l.indexOf(h);return u!==-1&&l.splice(u,2),this},this.getHandler=function(h){for(let u=0,c=l.length;u<c;u+=2){let d=l[u],f=l[u+1];if(d.global&&(d.lastIndex=0),d.test(h))return f}return null}}},Vz=new Uw,Dm=class{constructor(e){this.manager=e!==void 0?e:Vz,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let r=this;return new Promise(function(i,n){r.load(e,i,t,n)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},Ca={},P0=class extends Dm{constructor(e){super(e)}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let n=OS.get(e);if(n!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(n),this.manager.itemEnd(e)},0),n;if(Ca[e]!==void 0){Ca[e].push({onLoad:t,onProgress:r,onError:i});return}Ca[e]=[],Ca[e].push({onLoad:t,onProgress:r,onError:i});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let h=Ca[e],u=l.body.getReader(),c=l.headers.get("Content-Length"),d=c?parseInt(c):0,f=d!==0,p=0,m=new ReadableStream({start(g){v();function v(){u.read().then(({done:x,value:b})=>{if(x)g.close();else{p+=b.byteLength;let _=new ProgressEvent("progress",{lengthComputable:f,loaded:p,total:d});for(let E=0,S=h.length;E<S;E++){let P=h[E];P.onProgress&&P.onProgress(_)}g.enqueue(b),v()}})}}});return new Response(m)}else throw Error(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`)}).then(l=>{switch(o){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(h=>new DOMParser().parseFromString(h,a));case"json":return l.json();default:if(a===void 0)return l.text();{let h=/charset="?([^;"\s]*)"?/i.exec(a),u=h&&h[1]?h[1].toLowerCase():void 0,c=new TextDecoder(u);return l.arrayBuffer().then(d=>c.decode(d))}}}).then(l=>{OS.add(e,l);let h=Ca[e];delete Ca[e];for(let u=0,c=h.length;u<c;u++){let d=h[u];d.onLoad&&d.onLoad(l)}}).catch(l=>{let h=Ca[e];if(h===void 0)throw this.manager.itemError(e),l;delete Ca[e];for(let u=0,c=h.length;u<c;u++){let d=h[u];d.onError&&d.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},Jd=class extends er{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ue(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},wy=class extends Jd{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(er.DefaultUp),this.updateMatrix(),this.groundColor=new Ue(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},IS=new wt,NS=new F,BS=new F,Hw=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new $(512,512),this.map=null,this.mapPass=null,this.matrix=new wt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Rw,this._frameExtents=new $(1,1),this._viewportCount=1,this._viewports=[new Tt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,r=this.matrix;NS.setFromMatrixPosition(e.matrixWorld),t.position.copy(NS),BS.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(BS),t.updateMatrixWorld(),IS.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(IS),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(t.projectionMatrix),r.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},jz=class extends Hw{constructor(){super(new gi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,r=Ed*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;(r!==t.fov||i!==t.aspect||n!==t.far)&&(t.fov=r,t.aspect=i,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},Wz=class extends Jd{constructor(e,t,r=0,i=Math.PI/3,n=0,s=1){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(er.DefaultUp),this.updateMatrix(),this.target=new er,this.distance=r,this.angle=i,this.penumbra=n,this.decay=s,this.shadow=new jz}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},kS=new wt,uc=new F,cv=new F,qz=class extends Hw{constructor(){super(new gi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new $(4,2),this._viewportCount=6,this._viewports=[new Tt(2,1,1,1),new Tt(0,1,1,1),new Tt(3,1,1,1),new Tt(1,1,1,1),new Tt(3,0,1,1),new Tt(1,0,1,1)],this._cubeDirections=[new F(1,0,0),new F(-1,0,0),new F(0,0,1),new F(0,0,-1),new F(0,1,0),new F(0,-1,0)],this._cubeUps=[new F(0,1,0),new F(0,1,0),new F(0,1,0),new F(0,1,0),new F(0,0,1),new F(0,0,-1)]}updateMatrices(e,t=0){let r=this.camera,i=this.matrix,n=e.distance||r.far;n!==r.far&&(r.far=n,r.updateProjectionMatrix()),uc.setFromMatrixPosition(e.matrixWorld),r.position.copy(uc),cv.copy(r.position),cv.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(cv),r.updateMatrixWorld(),i.makeTranslation(-uc.x,-uc.y,-uc.z),kS.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(kS)}},Yz=class extends Jd{constructor(e,t,r=0,i=1){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new qz}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},Xz=class extends Hw{constructor(){super(new Ow(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},Qz=class extends Jd{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(er.DefaultUp),this.updateMatrix(),this.target=new er,this.shadow=new Xz}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},Jz=class extends vt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){let e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},Gw=class extends Dm{constructor(e){super(e)}load(e,t,r,i){let n=this,s=new P0(n.manager);s.setPath(n.path),s.setRequestHeader(n.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,function(a){try{t(n.parse(JSON.parse(a)))}catch(o){i?i(o):console.error(o),n.manager.itemError(e)}},r,i)}parse(e){let t={},r={};function i(c,d){if(t[d]!==void 0)return t[d];let f=c.interleavedBuffers[d],p=n(c,f.buffer),m=Pf(f.type,p),g=new K8(m,f.stride);return g.uuid=f.uuid,t[d]=g,g}function n(c,d){if(r[d]!==void 0)return r[d];let f=c.arrayBuffers[d],p=new Uint32Array(f).buffer;return r[d]=p,p}let s=e.isInstancedBufferGeometry?new Jz:new vt,a=e.data.index;if(a!==void 0){let c=Pf(a.type,a.array);s.setIndex(new Ct(c,1))}let o=e.data.attributes;for(let c in o){let d=o[c],f;if(d.isInterleavedBufferAttribute){let p=i(e.data,d.data);f=new gy(p,d.itemSize,d.offset,d.normalized)}else{let p=Pf(d.type,d.array),m=d.isInstancedBufferAttribute?$8:Ct;f=new m(p,d.itemSize,d.normalized)}d.name!==void 0&&(f.name=d.name),d.usage!==void 0&&f.setUsage(d.usage),d.updateRange!==void 0&&(f.updateRange.offset=d.updateRange.offset,f.updateRange.count=d.updateRange.count),s.setAttribute(c,f)}let l=e.data.morphAttributes;if(l)for(let c in l){let d=l[c],f=[];for(let p=0,m=d.length;p<m;p++){let g=d[p],v;if(g.isInterleavedBufferAttribute){let x=i(e.data,g.data);v=new gy(x,g.itemSize,g.offset,g.normalized)}else{let x=Pf(g.type,g.array);v=new Ct(x,g.itemSize,g.normalized)}g.name!==void 0&&(v.name=g.name),f.push(v)}s.morphAttributes[c]=f}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let c=0,d=h.length;c!==d;++c){let f=h[c];s.addGroup(f.start,f.count,f.materialIndex)}let u=e.data.boundingSphere;if(u!==void 0){let c=new F;u.center!==void 0&&c.fromArray(u.center),s.boundingSphere=new ha(c,u.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}},Kz=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=zS(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=zS();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function zS(){return(typeof performance>"u"?Date:performance).now()}var XT="\\[\\]\\.:\\/",Vw="[^"+XT+"]",Zz="[^"+XT.replace("\\.","")+"]";/((?:WC+[\/:])*)/.source.replace("WC",Vw);/(WCOD+)?/.source.replace("WCOD",Zz);/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Vw);/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Vw);var Ze=class{constructor(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Ze(this.value.clone===void 0?this.value:this.value.clone())}},$z=class{constructor(e,t,r=0,i=1/0){this.ray=new Sm(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new Pw,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,r=[]){return by(e,this,r,t),r.sort(FS),r}intersectObjects(e,t=!0,r=[]){for(let i=0,n=e.length;i<n;i++)by(e[i],this,r,t);return r.sort(FS),r}};function FS(e,t){return e.distance-t.distance}function by(e,t,r,i){if(e.layers.test(t.layers)&&e.raycast(t,r),i===!0){let n=e.children;for(let s=0,a=n.length;s<a;s++)by(n[s],t,r,!0)}}var US=class{constructor(e=1,t=0,r=0){return this.radius=e,this.phi=t,this.theta=r,this}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Pr(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},HS=new F,tp=new F,eF=class{constructor(e=new F,t=new F){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){HS.subVectors(e,this.start),tp.subVectors(this.end,this.start);let r=tp.dot(tp),i=tp.dot(HS)/r;return t&&(i=Pr(i,0,1)),i}closestPointToPoint(e,t,r){let i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},GS=new F,tF=class extends er{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;let r=new vt,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){let l=s/o*Math.PI*2,h=a/o*Math.PI*2;i.push(Math.cos(l),Math.sin(l),1,Math.cos(h),Math.sin(h),1)}r.setAttribute("position",new Ge(i,3));let n=new ma({fog:!1,toneMapped:!1});this.cone=new Qd(r,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),GS.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(GS),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},rF=class extends Ji{constructor(e,t,r){let i=new Fw(t,4,2),n=new Gl({wireframe:!0,fog:!1,toneMapped:!1});super(i,n),this.light=e,this.light.updateMatrixWorld(),this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},VS=new F,rp=new F,jS=new F,iF=class extends er{constructor(e,t,r){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,t===void 0&&(t=1);let i=new vt;i.setAttribute("position",new Ge([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let n=new ma({fog:!1,toneMapped:!1});this.lightPlane=new D0(i,n),this.add(this.lightPlane),i=new vt,i.setAttribute("position",new Ge([0,0,0,0,0,1],3)),this.targetLine=new D0(i,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){VS.setFromMatrixPosition(this.light.matrixWorld),rp.setFromMatrixPosition(this.light.target.matrixWorld),jS.subVectors(rp,VS),this.lightPlane.lookAt(rp),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(rp),this.targetLine.scale.z=jS.length()}},ip=new F,fr=new Bu,No=class extends Qd{constructor(e){let t=new vt,r=new ma({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={},a=new Ue(16755200),o=new Ue(16711680),l=new Ue(43775),h=new Ue(16777215),u=new Ue(3355443);c("n1","n2",a),c("n2","n4",a),c("n4","n3",a),c("n3","n1",a),c("f1","f2",a),c("f2","f4",a),c("f4","f3",a),c("f3","f1",a),c("n1","f1",a),c("n2","f2",a),c("n3","f3",a),c("n4","f4",a),c("p","n1",o),c("p","n2",o),c("p","n3",o),c("p","n4",o),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l),c("c","t",h),c("p","c",u),c("cn1","cn2",u),c("cn3","cn4",u),c("cf1","cf2",u),c("cf3","cf4",u);function c(f,p,m){d(f,m),d(p,m)}function d(f,p){i.push(0,0,0),n.push(p.r,p.g,p.b),s[f]===void 0&&(s[f]=[]),s[f].push(i.length/3-1)}t.setAttribute("position",new Ge(i,3)),t.setAttribute("color",new Ge(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap,r=1,i=1;fr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),wr("c",t,e,fr,0,0,-1),wr("t",t,e,fr,0,0,1),wr("n1",t,e,fr,-r,-i,-1),wr("n2",t,e,fr,r,-i,-1),wr("n3",t,e,fr,-r,i,-1),wr("n4",t,e,fr,r,i,-1),wr("f1",t,e,fr,-r,-i,1),wr("f2",t,e,fr,r,-i,1),wr("f3",t,e,fr,-r,i,1),wr("f4",t,e,fr,r,i,1),wr("u1",t,e,fr,r*.7,i*1.1,-1),wr("u2",t,e,fr,-r*.7,i*1.1,-1),wr("u3",t,e,fr,0,i*2,-1),wr("cf1",t,e,fr,-r,0,1),wr("cf2",t,e,fr,r,0,1),wr("cf3",t,e,fr,0,-i,1),wr("cf4",t,e,fr,0,i,1),wr("cn1",t,e,fr,-r,0,-1),wr("cn2",t,e,fr,r,0,-1),wr("cn3",t,e,fr,0,-i,-1),wr("cn4",t,e,fr,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function wr(e,t,r,i,n,s,a){ip.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let h=0,u=o.length;h<u;h++)l.setXYZ(o[h],ip.x,ip.y,ip.z)}}var np=class extends Qd{constructor(e,t=16776960){let r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],n=new vt;n.setIndex(new Ct(r,1)),n.setAttribute("position",new Ge(i,3)),super(n,new ma({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}},nF=class extends Qd{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new vt;i.setAttribute("position",new Ge(t,3)),i.setAttribute("color",new Ge(r,3));let n=new ma({vertexColors:!0,toneMapped:!1});super(i,n),this.type="AxesHelper"}setColors(e,t,r){let i=new Ue,n=this.geometry.attributes.color.array;return i.set(e),i.toArray(n,0),i.toArray(n,3),i.set(t),i.toArray(n,6),i.toArray(n,9),i.set(r),i.toArray(n,12),i.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}},sF=class{constructor(){this.type="ShapePath",this.color=new Ue,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new vy,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,n,s){return this.currentPath.bezierCurveTo(e,t,r,i,n,s),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function r(v){let x=[];for(let b=0,_=v.length;b<_;b++){let E=v[b],S=new Pl;S.curves=E.curves,x.push(S)}return x}function i(v,x){let b=x.length,_=!1;for(let E=b-1,S=0;S<b;E=S++){let P=x[E],M=x[S],B=M.x-P.x,R=M.y-P.y;if(Math.abs(R)>Number.EPSILON){if(R<0&&(P=x[S],B=-B,M=x[E],R=-R),v.y<P.y||v.y>M.y)continue;if(v.y===P.y){if(v.x===P.x)return!0}else{let H=R*(v.x-P.x)-B*(v.y-P.y);if(H===0)return!0;if(H<0)continue;_=!_}}else{if(v.y!==P.y)continue;if(M.x<=v.x&&v.x<=P.x||P.x<=v.x&&v.x<=M.x)return!0}}return _}let n=Zc.isClockWise,s=this.subPaths;if(s.length===0)return[];if(t===!0)return r(s);let a,o,l,h=[];if(s.length===1)return o=s[0],l=new Pl,l.curves=o.curves,h.push(l),h;let u=!n(s[0].getPoints());u=e?!u:u;let c=[],d=[],f=[],p=0,m;d[p]=void 0,f[p]=[];for(let v=0,x=s.length;v<x;v++)o=s[v],m=o.getPoints(),a=n(m),a=e?!a:a,a?(!u&&d[p]&&p++,d[p]={s:new Pl,p:m},d[p].s.curves=o.curves,u&&p++,f[p]=[]):f[p].push({h:o,p:m[0]});if(!d[0])return r(s);if(d.length>1){let v=!1,x=0;for(let b=0,_=d.length;b<_;b++)c[b]=[];for(let b=0,_=d.length;b<_;b++){let E=f[b];for(let S=0;S<E.length;S++){let P=E[S],M=!0;for(let B=0;B<d.length;B++)i(P.p,d[B].p)&&(b!==B&&x++,M?(M=!1,c[B].push(P)):v=!0);M&&c[b].push(P)}}x>0&&v===!1&&(f=c)}let g;for(let v=0,x=d.length;v<x;v++){l=d[v].s,h.push(l),g=f[v];for(let b=0,_=g.length;b<_;b++)l.holes.push(g[b].h)}return h}},_s=new Uint32Array(512),Ss=new Uint32Array(512);for(let e=0;e<256;++e){let t=e-127;t<-27?(_s[e]=0,_s[e|256]=32768,Ss[e]=24,Ss[e|256]=24):t<-14?(_s[e]=1024>>-t-14,_s[e|256]=1024>>-t-14|32768,Ss[e]=-t-1,Ss[e|256]=-t-1):t<=15?(_s[e]=t+15<<10,_s[e|256]=t+15<<10|32768,Ss[e]=13,Ss[e|256]=13):t<128?(_s[e]=31744,_s[e|256]=64512,Ss[e]=24,Ss[e|256]=24):(_s[e]=31744,_s[e|256]=64512,Ss[e]=13,Ss[e|256]=13)}var QT=new Uint32Array(2048),Kd=new Uint32Array(64),aF=new Uint32Array(64);for(let e=1;e<1024;++e){let t=e<<13,r=0;for(;(t&8388608)===0;)t<<=1,r-=8388608;t&=-8388609,r+=947912704,QT[e]=t|r}for(let e=1024;e<2048;++e)QT[e]=939524096+(e-1024<<13);for(let e=1;e<31;++e)Kd[e]=e<<23;Kd[31]=1199570944;Kd[32]=2147483648;for(let e=33;e<63;++e)Kd[e]=2147483648+(e-32<<23);Kd[63]=3347054592;for(let e=1;e<64;++e)e!==32&&(aF[e]=1024);var oF=class extends Or{constructor(e,t,r){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(e,t,r),this.samples=4}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Yd}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Yd);var cc=".",jw=Symbol("target"),JT=Symbol("unsubscribe");function _y(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function lF(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var Hs=Array.isArray;function Ww(e){return typeof e=="symbol"}var hF={after:(e,t)=>Hs(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>Hs(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=cc),Ww(t)?e+t.toString():e+t):e,initial:e=>{if(Hs(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(cc);return t===-1?"":e.slice(0,t)},last:e=>{if(Hs(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(cc);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(Hs(e))for(let r of e)t(r);else if(e!==""){let r=0,i=e.indexOf(cc);if(i===-1)t(e);else for(;r<e.length;)i===-1&&(i=e.length),t(e.slice(r,i)),r=i+1,i=e.indexOf(cc,r)}},get(e,t){return this.walk(t,r=>{e&&(e=e[r])}),e}},Ln=hF;function uF(e){return typeof e=="object"&&typeof e.next=="function"}function cF(e,t,r,i,n){let s=e.next;if(t.name==="entries")e.next=function(){let a=s.call(this);return a.done===!1&&(a.value[0]=n(a.value[0],t,a.value[0],i),a.value[1]=n(a.value[1],t,a.value[0],i)),a};else if(t.name==="values"){let a=r[jw].keys();e.next=function(){let o=s.call(this);return o.done===!1&&(o.value=n(o.value,t,a.next().value,i)),o}}else e.next=function(){let a=s.call(this);return a.done===!1&&(a.value=n(a.value,t,a.value,i)),a};return e}function WS(e,t,r){return e.isUnsubscribed||t.ignoreSymbols&&Ww(r)||t.ignoreUnderscores&&r.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(r)}var dF=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),r=t.get(e);return r===void 0&&(r={},t.set(e,r)),r}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let r=this._getProperties(e),i=r[t];return i===void 0&&(i=Reflect.getOwnPropertyDescriptor(e,t),r[t]=i),i}getProxy(e,t,r,i){if(this.isUnsubscribed)return e;let n=e[i],s=n||e;this._pathCache.set(s,t);let a=this._proxyCache.get(s);return a===void 0&&(a=n===void 0?new Proxy(e,r):e,this._proxyCache.set(s,a)),a}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,Ln.get(t,this.getPath(e)))}defineProperty(e,t,r){return Reflect.defineProperty(e,t,r)?(this.isUnsubscribed||(this._getProperties(e)[t]=r),!0):!1}setProperty(e,t,r,i,n){if(!this._equals(n,r)||!(t in e)){let s=this._getOwnPropertyDescriptor(e,t);return s!==void 0&&"set"in s?Reflect.set(e,t,r,i):Reflect.set(e,t,r)}return!0}deleteProperty(e,t,r){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let i=this._getDescriptorCache().get(e);i&&(delete i[t],this._pathCache.delete(r))}return!0}return!1}isSameDescriptor(e,t,r){let i=this._getOwnPropertyDescriptor(t,r);return e!==void 0&&i!==void 0&&Object.is(e.value,i.value)&&(e.writable||!1)===(i.writable||!1)&&(e.enumerable||!1)===(i.enumerable||!1)&&(e.configurable||!1)===(i.configurable||!1)&&e.get===i.get&&e.set===i.set}isGetInvariant(e,t){let r=this._getOwnPropertyDescriptor(e,t);return r!==void 0&&r.configurable!==!0&&r.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function Sy(e){return toString.call(e)==="[object Object]"}function sp(){return!0}function yh(e,t){return e.length!==t.length||e.some((r,i)=>t[i]!==r)}var KT=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),fF=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),ZT={push:sp,pop:sp,shift:sp,unshift:sp,copyWithin:yh,reverse:yh,sort:yh,splice:yh,flat:yh,fill:yh},pF=new Set([...KT,...fF,...Object.keys(ZT)]);function ap(e,t){if(e.size!==t.size)return!0;for(let r of e)if(!t.has(r))return!0;return!1}var $T=["keys","values","entries"],e5=new Set(["has","toString"]),t5={add:ap,clear:ap,delete:ap,forEach:ap},mF=new Set([...e5,...Object.keys(t5),...$T]);function op(e,t){if(e.size!==t.size)return!0;let r;for(let[i,n]of e)if(r=t.get(i),r!==n||r===void 0&&!t.has(i))return!0;return!1}var gF=new Set([...e5,"get"]),r5={set:op,clear:op,delete:op,forEach:op},vF=new Set([...gF,...Object.keys(r5),...$T]),tl=class{constructor(e,t,r,i){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=i,this._changes=i?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return KT.has(e)}_shallowClone(e){let t=e;if(Sy(e))t=me({},e);else if(Hs(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(r=>this._shallowClone(r)));else if(e instanceof Map){t=new Map;for(let[r,i]of e.entries())t.set(r,this._shallowClone(i))}return this._clonedCache.add(t),t}preferredThisArg(e,t,r,i){return e?(Hs(i)?this._onIsChanged=ZT[t]:i instanceof Set?this._onIsChanged=t5[t]:i instanceof Map&&(this._onIsChanged=r5[t]),i):r}update(e,t,r){let i=Ln.after(e,this._path);if(t!=="length"){let n=this.clone;Ln.walk(i,s=>{n&&n[s]&&(this._clonedCache.has(n[s])||(n[s]=this._shallowClone(n[s])),n=n[s])}),this._hasOnValidate&&this._changes.push({path:i,property:t,previous:r}),n&&n[t]&&(n[t]=r)}this._isChanged=!0}undo(e){let t;for(let r=this._changes.length-1;r!==-1;r--)t=this._changes[r],Ln.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},qS=class extends tl{static isHandledMethod(e){return pF.has(e)}},yF=class extends tl{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},YS=class extends tl{static isHandledMethod(e){return mF.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},XS=class extends tl{static isHandledMethod(e){return vF.has(e)}undo(e){for(let[t,r]of this.clone.entries())e.set(t,r);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},xF=class extends tl{constructor(e,t,r,i){super(void 0,t,r,i),this._arg1=r[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},wF=class extends tl{constructor(e,t,r,i){super(void 0,t,r,i),this._weakKey=r[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},Eh=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return Sy(e)||Hs(e)||_y(e)}static isHandledMethod(e,t){return Sy(e)?tl.isHandledMethod(t):Hs(e)?qS.isHandledMethod(t):e instanceof Set?YS.isHandledMethod(t):e instanceof Map?XS.isHandledMethod(t):_y(e)}get isCloning(){return this._stack.length>0}start(e,t,r){let i=tl;Hs(e)?i=qS:e instanceof Date?i=yF:e instanceof Set?i=YS:e instanceof Map?i=XS:e instanceof WeakSet?i=xF:e instanceof WeakMap&&(i=wF),this._stack.push(new i(e,t,r,this._hasOnValidate))}update(e,t,r){this._stack[this._stack.length-1].update(e,t,r)}preferredThisArg(e,t,r){let{name:i}=e,n=Eh.isHandledMethod(r,i);return this._stack[this._stack.length-1].preferredThisArg(n,i,t,r)}isChanged(e,t,r){return this._stack[this._stack.length-1].isChanged(e,t,r)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},bF={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},qw=(e,t,r={})=>{r=me(me({},bF),r);let i=Symbol("ProxyTarget"),{equals:n,isShallow:s,ignoreDetached:a,details:o}=r,l=new dF(n),h=typeof r.onValidate=="function",u=new Eh(h),c=(x,b,_,E,S)=>!h||u.isCloning||r.onValidate(Ln.concat(l.getPath(x),b),_,E,S)===!0,d=(x,b,_,E)=>{!WS(l,r,b)&&!(a&&l.isDetached(x,e))&&f(l.getPath(x),b,_,E)},f=(x,b,_,E,S)=>{u.isCloning?u.update(x,b,E):t(Ln.concat(x,b),_,E,S)},p=x=>x&&(x[i]||x),m=(x,b,_,E)=>lF(x)||_==="constructor"||s&&!Eh.isHandledMethod(b,_)||WS(l,r,_)||l.isGetInvariant(b,_)||a&&l.isDetached(b,e)?x:(E===void 0&&(E=l.getPath(b)),l.getProxy(x,Ln.concat(E,_),g,i)),g={get(x,b,_){if(Ww(b)){if(b===i||b===jw)return x;if(b===JT&&!l.isUnsubscribed&&l.getPath(x).length===0)return l.unsubscribe(),x}let E=_y(x)?Reflect.get(x,b):Reflect.get(x,b,_);return m(E,x,b)},set(x,b,_,E){_=p(_);let S=x[i]||x,P=S[b];if(n(P,_)&&b in x)return!0;let M=c(x,b,_,P);return M&&l.setProperty(S,b,_,E,P)?(d(x,b,x[b],P),!0):!M},defineProperty(x,b,_){if(!l.isSameDescriptor(_,x,b)){let E=x[b];c(x,b,_.value,E)&&l.defineProperty(x,b,_,E)&&d(x,b,_.value,E)}return!0},deleteProperty(x,b){if(!Reflect.has(x,b))return!0;let _=Reflect.get(x,b),E=c(x,b,void 0,_);return E&&l.deleteProperty(x,b,_)?(d(x,b,void 0,_),!0):!E},apply(x,b,_){let E=b[i]||b;if(l.isUnsubscribed)return Reflect.apply(x,E,_);if((o===!1||o!==!0&&!o.includes(x.name))&&Eh.isHandledType(E)){let S=Ln.initial(l.getPath(x)),P=Eh.isHandledMethod(E,x.name);u.start(E,S,_);let M=Reflect.apply(x,u.preferredThisArg(x,b,E),P?_.map(H=>p(H)):_),B=u.isChanged(E,n),R=u.stop();if(Eh.isHandledType(M)&&P&&(b instanceof Map&&x.name==="get"&&(S=Ln.concat(S,_[0])),M=l.getProxy(M,S,g)),B){let H={name:x.name,args:_,result:M},Q=u.isCloning?Ln.initial(S):S,z=u.isCloning?Ln.last(S):"";c(Ln.get(e,Q),z,E,R,H)?f(Q,z,E,R,H):u.undo(E)}return(b instanceof Map||b instanceof Set)&&uF(M)?cF(M,x,b,S,m):M}return Reflect.apply(x,b,_)}},v=l.getProxy(e,r.pathAsArray?[]:"",g);return t=t.bind(v),h&&(r.onValidate=r.onValidate.bind(v)),v};qw.target=e=>e&&e[jw]||e;qw.unsubscribe=e=>e[JT]||e;var QS=qw,_F=typeof global=="object"&&global&&global.Object===Object&&global,i5=_F,SF=typeof self=="object"&&self&&self.Object===Object&&self,MF=i5||SF||Function("return this")(),vs=MF,AF=vs.Symbol,ua=AF,n5=Object.prototype,EF=n5.hasOwnProperty,CF=n5.toString,dc=ua?ua.toStringTag:void 0;function TF(e){var t=EF.call(e,dc),r=e[dc];try{e[dc]=void 0;var i=!0}catch{}var n=CF.call(e);return i&&(t?e[dc]=r:delete e[dc]),n}var DF=TF,PF=Object.prototype,LF=PF.toString;function RF(e){return LF.call(e)}var OF=RF,IF="[object Null]",NF="[object Undefined]",JS=ua?ua.toStringTag:void 0;function BF(e){return e==null?e===void 0?NF:IF:JS&&JS in Object(e)?DF(e):OF(e)}var Zl=BF;function kF(e){return e!=null&&typeof e=="object"}var al=kF,zF="[object Symbol]";function FF(e){return typeof e=="symbol"||al(e)&&Zl(e)==zF}var Pm=FF;function UF(e,t){for(var r=-1,i=e==null?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var s5=UF,HF=Array.isArray,Qa=HF,GF=1/0,KS=ua?ua.prototype:void 0,ZS=KS?KS.toString:void 0;function a5(e){if(typeof e=="string")return e;if(Qa(e))return s5(e,a5)+"";if(Pm(e))return ZS?ZS.call(e):"";var t=e+"";return t=="0"&&1/e==-GF?"-0":t}var VF=a5,jF=/\s/;function WF(e){for(var t=e.length;t--&&jF.test(e.charAt(t)););return t}var qF=WF,YF=/^\s+/;function XF(e){return e&&e.slice(0,qF(e)+1).replace(YF,"")}var QF=XF;function JF(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ps=JF,$S=0/0,KF=/^[-+]0x[0-9a-f]+$/i,ZF=/^0b[01]+$/i,$F=/^0o[0-7]+$/i,eU=parseInt;function tU(e){if(typeof e=="number")return e;if(Pm(e))return $S;if(ps(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ps(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=QF(e);var r=ZF.test(e);return r||$F.test(e)?eU(e.slice(2),r?2:8):KF.test(e)?$S:+e}var eM=tU;function rU(e){return e}var o5=rU,iU="[object AsyncFunction]",nU="[object Function]",sU="[object GeneratorFunction]",aU="[object Proxy]";function oU(e){if(!ps(e))return!1;var t=Zl(e);return t==nU||t==sU||t==iU||t==aU}var Yw=oU,lU=vs["__core-js_shared__"],dv=lU,tM=function(){var e=/[^.]+$/.exec(dv&&dv.keys&&dv.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function hU(e){return!!tM&&tM in e}var uU=hU,cU=Function.prototype,dU=cU.toString;function fU(e){if(e!=null){try{return dU.call(e)}catch{}try{return e+""}catch{}}return""}var $l=fU,pU=/[\\^$.*+?()[\]{}|]/g,mU=/^\[object .+?Constructor\]$/,gU=Function.prototype,vU=Object.prototype,yU=gU.toString,xU=vU.hasOwnProperty,wU=RegExp("^"+yU.call(xU).replace(pU,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function bU(e){if(!ps(e)||uU(e))return!1;var t=Yw(e)?wU:mU;return t.test($l(e))}var _U=bU;function SU(e,t){return e==null?void 0:e[t]}var MU=SU;function AU(e,t){var r=MU(e,t);return _U(r)?r:void 0}var eh=AU,EU=eh(vs,"WeakMap"),My=EU,rM=Object.create,CU=function(){function e(){}return function(t){if(!ps(t))return{};if(rM)return rM(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),TU=CU;function DU(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var PU=DU;function LU(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t}var l5=LU,RU=800,OU=16,IU=Date.now;function NU(e){var t=0,r=0;return function(){var i=IU(),n=OU-(i-r);if(r=i,n>0){if(++t>=RU)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var BU=NU;function kU(e){return function(){return e}}var zU=kU,FU=function(){try{var e=eh(Object,"defineProperty");return e({},"",{}),e}catch{}}(),L0=FU,UU=L0?function(e,t){return L0(e,"toString",{configurable:!0,enumerable:!1,value:zU(t),writable:!0})}:o5,HU=UU,GU=BU(HU),h5=GU;function VU(e,t){for(var r=-1,i=e==null?0:e.length;++r<i&&t(e[r],r,e)!==!1;);return e}var jU=VU,WU=9007199254740991,qU=/^(?:0|[1-9]\d*)$/;function YU(e,t){var r=typeof e;return t=t!=null?t:WU,!!t&&(r=="number"||r!="symbol"&&qU.test(e))&&e>-1&&e%1==0&&e<t}var u5=YU;function XU(e,t,r){t=="__proto__"&&L0?L0(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var Xw=XU;function QU(e,t){return e===t||e!==e&&t!==t}var Lm=QU,JU=Object.prototype,KU=JU.hasOwnProperty;function ZU(e,t,r){var i=e[t];(!(KU.call(e,t)&&Lm(i,r))||r===void 0&&!(t in e))&&Xw(e,t,r)}var c5=ZU;function $U(e,t,r,i){var n=!r;r||(r={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=i?i(r[o],e[o],o,r,e):void 0;l===void 0&&(l=e[o]),n?Xw(r,o,l):c5(r,o,l)}return r}var zu=$U,iM=Math.max;function e9(e,t,r){return t=iM(t===void 0?e.length-1:t,0),function(){for(var i=arguments,n=-1,s=iM(i.length-t,0),a=Array(s);++n<s;)a[n]=i[t+n];n=-1;for(var o=Array(t+1);++n<t;)o[n]=i[n];return o[t]=r(a),PU(e,this,o)}}var d5=e9;function t9(e,t){return h5(d5(e,t,o5),e+"")}var r9=t9,i9=9007199254740991;function n9(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=i9}var f5=n9;function s9(e){return e!=null&&f5(e.length)&&!Yw(e)}var Rm=s9;function a9(e,t,r){if(!ps(r))return!1;var i=typeof t;return(i=="number"?Rm(r)&&u5(t,r.length):i=="string"&&t in r)?Lm(r[t],e):!1}var o9=a9;function l9(e){return r9(function(t,r){var i=-1,n=r.length,s=n>1?r[n-1]:void 0,a=n>2?r[2]:void 0;for(s=e.length>3&&typeof s=="function"?(n--,s):void 0,a&&o9(r[0],r[1],a)&&(s=n<3?void 0:s,n=1),t=Object(t);++i<n;){var o=r[i];o&&e(t,o,i,s)}return t})}var h9=l9,u9=Object.prototype;function c9(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||u9;return e===r}var Qw=c9;function d9(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}var f9=d9,p9="[object Arguments]";function m9(e){return al(e)&&Zl(e)==p9}var nM=m9,p5=Object.prototype,g9=p5.hasOwnProperty,v9=p5.propertyIsEnumerable,y9=nM(function(){return arguments}())?nM:function(e){return al(e)&&g9.call(e,"callee")&&!v9.call(e,"callee")},R0=y9;function x9(){return!1}var w9=x9,m5=typeof pn=="object"&&pn&&!pn.nodeType&&pn,sM=m5&&typeof mn=="object"&&mn&&!mn.nodeType&&mn,b9=sM&&sM.exports===m5,aM=b9?vs.Buffer:void 0,_9=aM?aM.isBuffer:void 0,S9=_9||w9,Jw=S9,M9="[object Arguments]",A9="[object Array]",E9="[object Boolean]",C9="[object Date]",T9="[object Error]",D9="[object Function]",P9="[object Map]",L9="[object Number]",R9="[object Object]",O9="[object RegExp]",I9="[object Set]",N9="[object String]",B9="[object WeakMap]",k9="[object ArrayBuffer]",z9="[object DataView]",F9="[object Float32Array]",U9="[object Float64Array]",H9="[object Int8Array]",G9="[object Int16Array]",V9="[object Int32Array]",j9="[object Uint8Array]",W9="[object Uint8ClampedArray]",q9="[object Uint16Array]",Y9="[object Uint32Array]",rr={};rr[F9]=rr[U9]=rr[H9]=rr[G9]=rr[V9]=rr[j9]=rr[W9]=rr[q9]=rr[Y9]=!0;rr[M9]=rr[A9]=rr[k9]=rr[E9]=rr[z9]=rr[C9]=rr[T9]=rr[D9]=rr[P9]=rr[L9]=rr[R9]=rr[O9]=rr[I9]=rr[N9]=rr[B9]=!1;function X9(e){return al(e)&&f5(e.length)&&!!rr[Zl(e)]}var Q9=X9;function J9(e){return function(t){return e(t)}}var Kw=J9,g5=typeof pn=="object"&&pn&&!pn.nodeType&&pn,$c=g5&&typeof mn=="object"&&mn&&!mn.nodeType&&mn,K9=$c&&$c.exports===g5,fv=K9&&i5.process,Z9=function(){try{var e=$c&&$c.require&&$c.require("util").types;return e||fv&&fv.binding&&fv.binding("util")}catch{}}(),bu=Z9,oM=bu&&bu.isTypedArray,$9=oM?Kw(oM):Q9,v5=$9,e7=Object.prototype,t7=e7.hasOwnProperty;function r7(e,t){var r=Qa(e),i=!r&&R0(e),n=!r&&!i&&Jw(e),s=!r&&!i&&!n&&v5(e),a=r||i||n||s,o=a?f9(e.length,String):[],l=o.length;for(var h in e)(t||t7.call(e,h))&&!(a&&(h=="length"||n&&(h=="offset"||h=="parent")||s&&(h=="buffer"||h=="byteLength"||h=="byteOffset")||u5(h,l)))&&o.push(h);return o}var y5=r7;function i7(e,t){return function(r){return e(t(r))}}var x5=i7,n7=x5(Object.keys,Object),s7=n7,a7=Object.prototype,o7=a7.hasOwnProperty;function l7(e){if(!Qw(e))return s7(e);var t=[];for(var r in Object(e))o7.call(e,r)&&r!="constructor"&&t.push(r);return t}var h7=l7;function u7(e){return Rm(e)?y5(e):h7(e)}var Zw=u7;function c7(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var d7=c7,f7=Object.prototype,p7=f7.hasOwnProperty;function m7(e){if(!ps(e))return d7(e);var t=Qw(e),r=[];for(var i in e)i=="constructor"&&(t||!p7.call(e,i))||r.push(i);return r}var g7=m7;function v7(e){return Rm(e)?y5(e,!0):g7(e)}var Zd=v7,y7=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,x7=/^\w*$/;function w7(e,t){if(Qa(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||Pm(e)?!0:x7.test(e)||!y7.test(e)||t!=null&&e in Object(t)}var b7=w7,_7=eh(Object,"create"),Pd=_7;function S7(){this.__data__=Pd?Pd(null):{},this.size=0}var M7=S7;function A7(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var E7=A7,C7="__lodash_hash_undefined__",T7=Object.prototype,D7=T7.hasOwnProperty;function P7(e){var t=this.__data__;if(Pd){var r=t[e];return r===C7?void 0:r}return D7.call(t,e)?t[e]:void 0}var L7=P7,R7=Object.prototype,O7=R7.hasOwnProperty;function I7(e){var t=this.__data__;return Pd?t[e]!==void 0:O7.call(t,e)}var N7=I7,B7="__lodash_hash_undefined__";function k7(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Pd&&t===void 0?B7:t,this}var z7=k7;function Fu(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Fu.prototype.clear=M7;Fu.prototype.delete=E7;Fu.prototype.get=L7;Fu.prototype.has=N7;Fu.prototype.set=z7;var lM=Fu;function F7(){this.__data__=[],this.size=0}var U7=F7;function H7(e,t){for(var r=e.length;r--;)if(Lm(e[r][0],t))return r;return-1}var Om=H7,G7=Array.prototype,V7=G7.splice;function j7(e){var t=this.__data__,r=Om(t,e);if(r<0)return!1;var i=t.length-1;return r==i?t.pop():V7.call(t,r,1),--this.size,!0}var W7=j7;function q7(e){var t=this.__data__,r=Om(t,e);return r<0?void 0:t[r][1]}var Y7=q7;function X7(e){return Om(this.__data__,e)>-1}var Q7=X7;function J7(e,t){var r=this.__data__,i=Om(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}var K7=J7;function Uu(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Uu.prototype.clear=U7;Uu.prototype.delete=W7;Uu.prototype.get=Y7;Uu.prototype.has=Q7;Uu.prototype.set=K7;var Im=Uu,Z7=eh(vs,"Map"),Ld=Z7;function $7(){this.size=0,this.__data__={hash:new lM,map:new(Ld||Im),string:new lM}}var eH=$7;function tH(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var rH=tH;function iH(e,t){var r=e.__data__;return rH(t)?r[typeof t=="string"?"string":"hash"]:r.map}var Nm=iH;function nH(e){var t=Nm(this,e).delete(e);return this.size-=t?1:0,t}var sH=nH;function aH(e){return Nm(this,e).get(e)}var oH=aH;function lH(e){return Nm(this,e).has(e)}var hH=lH;function uH(e,t){var r=Nm(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}var cH=uH;function Hu(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}Hu.prototype.clear=eH;Hu.prototype.delete=sH;Hu.prototype.get=oH;Hu.prototype.has=hH;Hu.prototype.set=cH;var $w=Hu,dH="Expected a function";function eb(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(dH);var r=function(){var i=arguments,n=t?t.apply(this,i):i[0],s=r.cache;if(s.has(n))return s.get(n);var a=e.apply(this,i);return r.cache=s.set(n,a)||s,a};return r.cache=new(eb.Cache||$w),r}eb.Cache=$w;var fH=eb,pH=500;function mH(e){var t=fH(e,function(i){return r.size===pH&&r.clear(),i}),r=t.cache;return t}var gH=mH,vH=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yH=/\\(\\)?/g,xH=gH(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(vH,function(r,i,n,s){t.push(n?s.replace(yH,"$1"):i||r)}),t}),wH=xH;function bH(e){return e==null?"":VF(e)}var _H=bH;function SH(e,t){return Qa(e)?e:b7(e,t)?[e]:wH(_H(e))}var tb=SH,MH=1/0;function AH(e){if(typeof e=="string"||Pm(e))return e;var t=e+"";return t=="0"&&1/e==-MH?"-0":t}var w5=AH;function EH(e,t){t=tb(t,e);for(var r=0,i=t.length;e!=null&&r<i;)e=e[w5(t[r++])];return r&&r==i?e:void 0}var CH=EH;function TH(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}var rb=TH,hM=ua?ua.isConcatSpreadable:void 0;function DH(e){return Qa(e)||R0(e)||!!(hM&&e&&e[hM])}var PH=DH;function b5(e,t,r,i,n){var s=-1,a=e.length;for(r||(r=PH),n||(n=[]);++s<a;){var o=e[s];t>0&&r(o)?t>1?b5(o,t-1,r,i,n):rb(n,o):i||(n[n.length]=o)}return n}var LH=b5;function RH(e){var t=e==null?0:e.length;return t?LH(e,1):[]}var OH=RH;function IH(e){return h5(d5(e,void 0,OH),e+"")}var NH=IH,BH=x5(Object.getPrototypeOf,Object),ib=BH,kH="[object Object]",zH=Function.prototype,FH=Object.prototype,_5=zH.toString,UH=FH.hasOwnProperty,HH=_5.call(Object);function GH(e){if(!al(e)||Zl(e)!=kH)return!1;var t=ib(e);if(t===null)return!0;var r=UH.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&_5.call(r)==HH}var S5=GH;function VH(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),r=r>n?n:r,r<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(n);++i<n;)s[i]=e[i+t];return s}var jH=VH;function WH(){this.__data__=new Im,this.size=0}var qH=WH;function YH(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var XH=YH;function QH(e){return this.__data__.get(e)}var JH=QH;function KH(e){return this.__data__.has(e)}var ZH=KH,$H=200;function eG(e,t){var r=this.__data__;if(r instanceof Im){var i=r.__data__;if(!Ld||i.length<$H-1)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new $w(i)}return r.set(e,t),this.size=r.size,this}var tG=eG;function Gu(e){var t=this.__data__=new Im(e);this.size=t.size}Gu.prototype.clear=qH;Gu.prototype.delete=XH;Gu.prototype.get=JH;Gu.prototype.has=ZH;Gu.prototype.set=tG;var M5=Gu;function rG(e,t){return e&&zu(t,Zw(t),e)}var iG=rG;function nG(e,t){return e&&zu(t,Zd(t),e)}var sG=nG,A5=typeof pn=="object"&&pn&&!pn.nodeType&&pn,uM=A5&&typeof mn=="object"&&mn&&!mn.nodeType&&mn,aG=uM&&uM.exports===A5,cM=aG?vs.Buffer:void 0,dM=cM?cM.allocUnsafe:void 0;function oG(e,t){if(t)return e.slice();var r=e.length,i=dM?dM(r):new e.constructor(r);return e.copy(i),i}var E5=oG;function lG(e,t){for(var r=-1,i=e==null?0:e.length,n=0,s=[];++r<i;){var a=e[r];t(a,r,e)&&(s[n++]=a)}return s}var hG=lG;function uG(){return[]}var C5=uG,cG=Object.prototype,dG=cG.propertyIsEnumerable,fM=Object.getOwnPropertySymbols,fG=fM?function(e){return e==null?[]:(e=Object(e),hG(fM(e),function(t){return dG.call(e,t)}))}:C5,nb=fG;function pG(e,t){return zu(e,nb(e),t)}var mG=pG,gG=Object.getOwnPropertySymbols,vG=gG?function(e){for(var t=[];e;)rb(t,nb(e)),e=ib(e);return t}:C5,T5=vG;function yG(e,t){return zu(e,T5(e),t)}var xG=yG;function wG(e,t,r){var i=t(e);return Qa(e)?i:rb(i,r(e))}var D5=wG;function bG(e){return D5(e,Zw,nb)}var _G=bG;function SG(e){return D5(e,Zd,T5)}var P5=SG,MG=eh(vs,"DataView"),Ay=MG,AG=eh(vs,"Promise"),Ey=AG,EG=eh(vs,"Set"),Cy=EG,pM="[object Map]",CG="[object Object]",mM="[object Promise]",gM="[object Set]",vM="[object WeakMap]",yM="[object DataView]",TG=$l(Ay),DG=$l(Ld),PG=$l(Ey),LG=$l(Cy),RG=$l(My),vl=Zl;(Ay&&vl(new Ay(new ArrayBuffer(1)))!=yM||Ld&&vl(new Ld)!=pM||Ey&&vl(Ey.resolve())!=mM||Cy&&vl(new Cy)!=gM||My&&vl(new My)!=vM)&&(vl=function(e){var t=Zl(e),r=t==CG?e.constructor:void 0,i=r?$l(r):"";if(i)switch(i){case TG:return yM;case DG:return pM;case PG:return mM;case LG:return gM;case RG:return vM}return t});var sb=vl,OG=Object.prototype,IG=OG.hasOwnProperty;function NG(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&IG.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var BG=NG,kG=vs.Uint8Array,xM=kG;function zG(e){var t=new e.constructor(e.byteLength);return new xM(t).set(new xM(e)),t}var ab=zG;function FG(e,t){var r=t?ab(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var UG=FG,HG=/\w*$/;function GG(e){var t=new e.constructor(e.source,HG.exec(e));return t.lastIndex=e.lastIndex,t}var VG=GG,wM=ua?ua.prototype:void 0,bM=wM?wM.valueOf:void 0;function jG(e){return bM?Object(bM.call(e)):{}}var WG=jG;function qG(e,t){var r=t?ab(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var L5=qG,YG="[object Boolean]",XG="[object Date]",QG="[object Map]",JG="[object Number]",KG="[object RegExp]",ZG="[object Set]",$G="[object String]",eV="[object Symbol]",tV="[object ArrayBuffer]",rV="[object DataView]",iV="[object Float32Array]",nV="[object Float64Array]",sV="[object Int8Array]",aV="[object Int16Array]",oV="[object Int32Array]",lV="[object Uint8Array]",hV="[object Uint8ClampedArray]",uV="[object Uint16Array]",cV="[object Uint32Array]";function dV(e,t,r){var i=e.constructor;switch(t){case tV:return ab(e);case YG:case XG:return new i(+e);case rV:return UG(e,r);case iV:case nV:case sV:case aV:case oV:case lV:case hV:case uV:case cV:return L5(e,r);case QG:return new i;case JG:case $G:return new i(e);case KG:return VG(e);case ZG:return new i;case eV:return WG(e)}}var fV=dV;function pV(e){return typeof e.constructor=="function"&&!Qw(e)?TU(ib(e)):{}}var R5=pV,mV="[object Map]";function gV(e){return al(e)&&sb(e)==mV}var vV=gV,_M=bu&&bu.isMap,yV=_M?Kw(_M):vV,xV=yV,wV="[object Set]";function bV(e){return al(e)&&sb(e)==wV}var _V=bV,SM=bu&&bu.isSet,SV=SM?Kw(SM):_V,MV=SV,AV=1,EV=2,CV=4,O5="[object Arguments]",TV="[object Array]",DV="[object Boolean]",PV="[object Date]",LV="[object Error]",I5="[object Function]",RV="[object GeneratorFunction]",OV="[object Map]",IV="[object Number]",N5="[object Object]",NV="[object RegExp]",BV="[object Set]",kV="[object String]",zV="[object Symbol]",FV="[object WeakMap]",UV="[object ArrayBuffer]",HV="[object DataView]",GV="[object Float32Array]",VV="[object Float64Array]",jV="[object Int8Array]",WV="[object Int16Array]",qV="[object Int32Array]",YV="[object Uint8Array]",XV="[object Uint8ClampedArray]",QV="[object Uint16Array]",JV="[object Uint32Array]",Zt={};Zt[O5]=Zt[TV]=Zt[UV]=Zt[HV]=Zt[DV]=Zt[PV]=Zt[GV]=Zt[VV]=Zt[jV]=Zt[WV]=Zt[qV]=Zt[OV]=Zt[IV]=Zt[N5]=Zt[NV]=Zt[BV]=Zt[kV]=Zt[zV]=Zt[YV]=Zt[XV]=Zt[QV]=Zt[JV]=!0;Zt[LV]=Zt[I5]=Zt[FV]=!1;function Hp(e,t,r,i,n,s){var a,o=t&AV,l=t&EV,h=t&CV;if(r&&(a=n?r(e,i,n,s):r(e)),a!==void 0)return a;if(!ps(e))return e;var u=Qa(e);if(u){if(a=BG(e),!o)return l5(e,a)}else{var c=sb(e),d=c==I5||c==RV;if(Jw(e))return E5(e,o);if(c==N5||c==O5||d&&!n){if(a=l||d?{}:R5(e),!o)return l?xG(e,sG(a,e)):mG(e,iG(a,e))}else{if(!Zt[c])return n?e:{};a=fV(e,c,o)}}s||(s=new M5);var f=s.get(e);if(f)return f;s.set(e,a),MV(e)?e.forEach(function(g){a.add(Hp(g,t,r,g,e,s))}):xV(e)&&e.forEach(function(g,v){a.set(v,Hp(g,t,r,v,e,s))});var p=h?l?P5:_G:l?Zd:Zw,m=u?void 0:p(e);return jU(m||e,function(g,v){m&&(v=g,g=e[v]),c5(a,v,Hp(g,t,r,v,e,s))}),a}var B5=Hp,KV=1,ZV=4;function $V(e){return B5(e,KV|ZV)}var k5=$V;function ej(e){return function(t,r,i){for(var n=-1,s=Object(t),a=i(t),o=a.length;o--;){var l=a[e?o:++n];if(r(s[l],l,s)===!1)break}return t}}var tj=ej,rj=tj(),ij=rj,nj=function(){return vs.Date.now()},pv=nj,sj="Expected a function",aj=Math.max,oj=Math.min;function lj(e,t,r){var i,n,s,a,o,l,h=0,u=!1,c=!1,d=!0;if(typeof e!="function")throw new TypeError(sj);t=eM(t)||0,ps(r)&&(u=!!r.leading,c="maxWait"in r,s=c?aj(eM(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d);function f(S){var P=i,M=n;return i=n=void 0,h=S,a=e.apply(M,P),a}function p(S){return h=S,o=setTimeout(v,t),u?f(S):a}function m(S){var P=S-l,M=S-h,B=t-P;return c?oj(B,s-M):B}function g(S){var P=S-l,M=S-h;return l===void 0||P>=t||P<0||c&&M>=s}function v(){var S=pv();if(g(S))return x(S);o=setTimeout(v,m(S))}function x(S){return o=void 0,d&&i?f(S):(i=n=void 0,a)}function b(){o!==void 0&&clearTimeout(o),h=0,i=l=n=o=void 0}function _(){return o===void 0?a:x(pv())}function E(){var S=pv(),P=g(S);if(i=arguments,n=this,l=S,P){if(o===void 0)return p(l);if(c)return clearTimeout(o),o=setTimeout(v,t),f(l)}return o===void 0&&(o=setTimeout(v,t)),a}return E.cancel=b,E.flush=_,E}var z5=lj;function hj(e,t,r){(r!==void 0&&!Lm(e[t],r)||r===void 0&&!(t in e))&&Xw(e,t,r)}var Ty=hj;function uj(e){return al(e)&&Rm(e)}var cj=uj;function dj(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Dy=dj;function fj(e){return zu(e,Zd(e))}var pj=fj;function mj(e,t,r,i,n,s,a){var o=Dy(e,r),l=Dy(t,r),h=a.get(l);if(h){Ty(e,r,h);return}var u=s?s(o,l,r+"",e,t,a):void 0,c=u===void 0;if(c){var d=Qa(l),f=!d&&Jw(l),p=!d&&!f&&v5(l);u=l,d||f||p?Qa(o)?u=o:cj(o)?u=l5(o):f?(c=!1,u=E5(l,!0)):p?(c=!1,u=L5(l,!0)):u=[]:S5(l)||R0(l)?(u=o,R0(o)?u=pj(o):(!ps(o)||Yw(o))&&(u=R5(l))):c=!1}c&&(a.set(l,u),n(u,l,i,s,a),a.delete(l)),Ty(e,r,u)}var gj=mj;function F5(e,t,r,i,n){e!==t&&ij(t,function(s,a){if(n||(n=new M5),ps(s))gj(e,t,a,r,F5,i,n);else{var o=i?i(Dy(e,a),s,a+"",e,t,n):void 0;o===void 0&&(o=s),Ty(e,a,o)}},Zd)}var vj=F5;function yj(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var xj=yj;function wj(e,t){return t.length<2?e:CH(e,jH(t,0,-1))}var bj=wj,_j=h9(function(e,t,r){vj(e,t,r)}),O0=_j;function Sj(e,t){return t=tb(t,e),e=bj(e,t),e==null||delete e[w5(xj(t))]}var Mj=Sj;function Aj(e){return S5(e)?void 0:e}var Ej=Aj,Cj=1,Tj=2,Dj=4,Pj=NH(function(e,t){var r={};if(e==null)return r;var i=!1;t=s5(t,function(s){return s=tb(s,e),i||(i=s.length>1),s}),zu(e,P5(e),r),i&&(r=B5(r,Cj|Tj|Dj,Ej));for(var n=t.length;n--;)Mj(r,t[n]);return r}),Py=Pj,Lj=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),Rj=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),Oj=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||ob&&"ontouchend"in document,Ij=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,Nj=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,Bj=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},kj=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]};Lj();var ob=Rj(),I0=Oj(),zj=Ij(),U5=Nj(),Fj=Bj(),Uj=Number(kj());function Hj(e){return Array.isArray(e)?e:[e]}function lp(e){return ob?e.metaKey:e.ctrlKey}var Rd;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(r){return e.all.includes(r)}e.is=t})(Rd||(Rd={}));var Od;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:5,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(r){return r.type==="PerspectiveCamera"?r.perspective.zoom:r.orthographic.zoom}e.getZoom=t})(Od||(Od={}));var Bo;(e=>{function t(i,n){return i[0]===n[0]&&i[1]===n[1]}e.isEqual=t;function r(i,n,s){return[i[0]+(n[0]-i[0])*s,i[1]+(n[1]-i[1])*s]}e.lerp=r})(Bo||(Bo={}));var wi;(e=>{function t(s,a){return s[0]===a[0]&&s[1]===a[1]&&s[2]===a[2]}e.isEqual=t;function r(s,a){return[s[0]+a[0],s[1]+a[1],s[2]+a[2]]}e.add=r;function i(s,a){return[s[0]-a[0],s[1]-a[1],s[2]-a[2]]}e.sub=i;function n(s,a,o){return[s[0]+(a[0]-s[0])*o,s[1]+(a[1]-s[1])*o,s[2]+(a[2]-s[2])*o]}e.lerp=n})(wi||(wi={}));var N0;(e=>{function t(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]}e.isEqual=t;function r(i,n,s){return[i[0]+(n[0]-i[0])*s,i[1]+(n[1]-i[1])*s,i[2]+(n[2]-i[2])*s,i[3]+(n[3]-i[3])*s]}e.lerp=r})(N0||(N0={}));var jl;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(n,s){for(let a=0;a<16;a++)if(n[a]!==s[a])return!1;return!0}e.isEqual=t;function r(n){return n!=null?n:e.identity}e.simplify=r;function i(n,s){let a=s.slice(0);for(var o=0,l=s.length;o<l;o+=3){let h=n[3]*s[o]+n[7]*s[o+1]+n[11]*s[o+2]+n[15];a[o]=(n[0]*s[o]+n[4]*s[o+1]+n[8]*s[o+2]+n[12])/h,a[o+1]=(n[1]*s[o]+n[5]*s[o+1]+n[9]*s[o+2]+n[13])/h,a[o+2]=(n[2]*s[o]+n[6]*s[o+1]+n[10]*s[o+2]+n[14])/h}return a}e.applyMatrix4=i})(jl||(jl={}));var Di;(e=>{e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function t(a){return{r:Math.round(a.r*255),g:Math.round(a.g*255),b:Math.round(a.b*255),a:1}}e.toRgb255a1=t;function r(a){return{r:a.r,g:a.g,b:a.b}}e.clone=r;function i(a){return a=Math.floor(a),{r:(a>>16&255)/255,g:(a>>8&255)/255,b:(a&255)/255}}e.fromHex=i;function n(a,o){return a.r===o.r&&a.g===o.g&&a.b===o.b}e.equals=n;function s(a,o,l){return{r:a.r+(o.r-a.r)*l,g:a.g+(o.g-a.g)*l,b:a.b+(o.b-a.b)*l}}e.lerp=s})(Di||(Di={}));var Va;(e=>{e.white=qe(me({},Di.white),{a:1});function t(a){return{r:a[0],g:a[1],b:a[2],a:a[3]}}e.from0to1=t;function r(a,o){return qe(me({},Di.fromHex(a)),{a:o})}e.fromHexAndA=r;function i(a){return{r:Math.round(a.r*255),g:Math.round(a.g*255),b:Math.round(a.b*255),a:a.a}}e.toRgb255a1=i;function n(a,o){return Di.equals(a,o)&&a.a===o.a}e.equals=n;function s(a,o,l){return{r:a.r+(o.r-a.r)*l,g:a.g+(o.g-a.g)*l,b:a.b+(o.b-a.b)*l,a:a.a+(o.a-a.a)*l}}e.lerp=s})(Va||(Va={}));var Ly;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(Ly||(Ly={}));var Ry;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(Ry||(Ry={}));var Oy;(e=>e.defaultData={control1:[.5,.05],control2:[.1,.3]})(Oy||(Oy={}));var Iy;(e=>{function t(r,i=.1){return{type:"radial",hideBase:!1,count:3,radial:{radius:Math.max(r[0],r[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},linear:{scale:[1,1,1],rotation:[0,0,0],position:[r[0]+r[0]*i,0,0]},grid:{count:[2,2,2],size:r.map(n=>n*(1+i)),useCenter:!0}}}e.defaultData=t})(Iy||(Iy={}));var Ll=class{modifyById(e,t){let r=this;if(r[e]===void 0)throw new Error("not expected");{let i=qe(me({},r),{[e]:t});return Object.setPrototypeOf(i,Ll.prototype),i}}add(e,t){var r,i;return(i=(r=this.runOp({type:1,id:e,data:t}))==null?void 0:r.data)!=null?i:this}runOp(e){let t=this;if(e.type===1){let r=t[e.id],i;r===void 0?i={type:2,id:e.id}:i={type:1,id:e.id,data:r};let{id:n,data:s}=e,a=qe(me({},t),{[n]:s});return Object.setPrototypeOf(a,Ll.prototype),{data:a,actual:e,reverse:i}}else if(e.type===2){let{id:r}=e,i=t[r];if(i===void 0)return null;{let n=me({},t);return Object.setPrototypeOf(n,Ll.prototype),delete n[r],{data:n,actual:e,reverse:{type:1,id:r,data:i}}}}throw new Error("illegal arg")}};function lb(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let r of t){let i=e[r];i&&typeof i=="object"&&lb(i)}return Object.freeze(e)}function Gj(e,t){let r=0;for(;r<e.length&&r<t.length;){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1;r+=1}return r!==t.length?-1:r!==e.length?1:0}var Vj=class extends Error{};function ko(e,t,r){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let s=e;e=t,t=s}let i=[],n=1/(r+1);for(let s=0;s<r;s++){let a=e+(t-e)*(s+.75+Math.random()*.5)*n;i.push(a)}return i}function H5(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function jj(){return typeof process<"u"}function G5(e,t){for(let r of e)t(r.id,r.data),G5(r.children,t)}function V5(e,t){t(e.id,e.data);for(let r of e.children)V5(r,t)}var _u=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,_u.prototype)}deepFreeze(){let e=0;for(;e<this.length;)lb(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let r of e.children)this.fillCaches0(r,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}isDescendantOf(e,t){for(;e;){let r=this.parent(e);if(r===t)return!0;e=r}return!1}data(e){var t;return(t=this.get(e))==null?void 0:t.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return e===null?this:(t=this.get(e))==null?void 0:t.children}traverseFrom(e,t){if(e===null)this.traverse(t);else{let r=this.get(e);r&&V5(r,t)}}traverse(e){G5(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this.parent(e),i=this.childrenArray(r),n=i.findIndex(a=>a.id===e);if(n<0)throw new Error("not expected");let s=i[n];return i=[...i],i[n]=qe(me({},s),{data:t}),this.modifyArrayBy(r,i)}}modifyArrayBy(e,t){let r=e,i=t;for(;r!==null;){let s=i,a=r;if(r=this.parent(r),r===void 0)throw new Error;i=this.childrenArray(r);let o=i.findIndex(l=>l.id===a);if(o<0)throw new Error;i=[...i],i[o]=qe(me({},i[o]),{children:s})}Object.setPrototypeOf(i,_u.prototype);let n=i;return n.fillCaches(),n}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}}checkDuplicatedIdRec({id:e,children:t}){if(this.get(e)!==void 0)return!0;for(let r of t)if(this.checkDuplicatedIdRec(r))return!0;return!1}addOp(e){let{parent:t,fi:r,id:i,data:n,children:s}=e;if(t!==null&&this.get(t)===void 0||this.checkDuplicatedIdRec(e))return null;{let a=t,o=this.childrenArray(a),l={fi:r,id:i,data:n,children:s};return o=[...o,l],o.sort((h,u)=>h.fi-u.fi),e.localIndex=o.indexOf(l),{data:this.modifyArrayBy(a,o),actual:e,reverse:{type:8,id:i}}}}deleteOp(e){let{id:t}=e;if(this.get(t)===null)return null;{let r=this.parent(t);if(r===void 0)return null;let i=this.childrenArray(r),n=i.findIndex(a=>a.id===t);e.localIndex=n,i=[...i];let s=i.splice(n,1)[0];return{data:this.modifyArrayBy(r,i),actual:e,reverse:qe(me({type:7},s),{parent:r})}}}moveOp(e){let{parent:t,fi:r,id:i}=e;if(t!==null&&this.get(t)===void 0)return this.deleteOp({type:8,id:i});if(t!==null){let c=t;for(;c!==null;){if(c===void 0)throw new Error;if(c===i)throw new Vj("cyclic tree");c=this.parent(c)}}let n=this.parent(i);if(n===void 0)return null;let s=n,a=this.childrenArray(n),o=a.findIndex(c=>c.id===i);a=[...a];let l=a.splice(o,1)[0],h=this.modifyArrayBy(n,a);n=t,a=h.childrenArray(n);let u=l.fi;return l=qe(me({},l),{fi:r}),a=[...a,l],a.sort((c,d)=>c.fi-d.fi),e.localIndex=a.indexOf(l),h=h.modifyArrayBy(n,a),{data:h,actual:e,reverse:{type:9,parent:s,fi:u,id:i}}}previous(e,t){if(t===null){let i=this.childrenArray(e);return i.length===0?null:i[i.length-1].id}let r=null;for(let i of this.childrenArray(e)){if(i.id===t)return r;r=i.id}return null}traverseSortNext(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)+1;if(i<r.length)return r[i].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(t!==void 0){let r=this.childrenArray(t),i=r.findIndex(n=>n.id===e)-1;return i>=0?this.traverseSortPrevious(r[i].id):t}}getAllSorted(e){let t=[];for(let r of e){let i=this.getWithSortKey(r.id);i!==void 0&&t.push(me(me({},r),i))}t.sort((r,i)=>Gj(r.sortKey,i.sortKey));for(let r of t)delete r.sortKey;return t}getWithSortKey(e){var t=e;let r=[],i=this.get(t),n=i;if(i!==void 0){for(;t;)r.splice(0,0,i.fi),t=this.parent(t),t!==null&&(i=this.get(t));return qe(me({},n),{sortKey:r})}}insertBeforeHelper(e,t,r){return this.insertAfterHelper(e,this.previous(e,t),r)}insertAfterHelper(e,t,r){let i=this.childrenArray(e);if(t===null){if(i.length===0)return ko(0,r,r);{let n=i[0].fi;return ko(n-r,n,r)}}else{let n=this.get(t);if(n===void 0||this.parent(t)!==e)throw new Error("illegal args");let s=i.find(a=>a.fi>n.fi);if(s===void 0){let a=i[i.length-1].fi;return ko(a,a+r,r)}else return ko(n.fi,s.fi,r)}}},Ny;(e=>{function t(r,i){if(Array.isArray(r)){let n=i.props,s={},a=[...r],o=!1;if(n)for(let l of Object.keys(n)){let h=parseInt(l);if(isNaN(h))throw new Error("wrong index");s[l]=a[h],a[h]=n[l],o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}else{let n=i.props,s={},a=me({},r),o=!1;if(n)for(let l of Object.keys(n)){s[l]=a[l];let h=n[l];h===void 0?delete a[l]:a[l]=h,o=!0}return o?{data:a,actual:i,reverse:{type:0,props:s}}:null}}e.runOp=t})(Ny||(Ny={}));var tn=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,tn.prototype)}deepFreeze(){let e=0;for(;e<this.length;)lb(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return(t=this.get(e))==null?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let r=this,i=r.findIndex(s=>s.id===e);if(i<0)throw new Error("not expected");let n=r[i];return r=[...r],r[i]=qe(me({},n),{data:t}),this.modifyArrayBy(r)}}modifyArrayBy(e){Object.setPrototypeOf(e,tn.prototype);let t=e;return jj()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}}addOp(e){let{fi:t,id:r,data:i}=e,n=this,s={fi:t,id:r,data:i};return n=[...n,s],n.sort((a,o)=>a.fi-o.fi),e.localIndex=n.indexOf(s),{data:this.modifyArrayBy(n),actual:e,reverse:{type:5,id:r}}}deleteOp(e){let{id:t}=e,r=this,i=r.findIndex(s=>s.id===t);if(i===-1)return null;e.localIndex=i,r=[...r];let n=r.splice(i,1)[0];return{data:this.modifyArrayBy(r),actual:e,reverse:me({type:4},n)}}moveOp(e){let{fi:t,id:r}=e,i=this;i=[...i];let n=i.findIndex(o=>o.id===r);if(n===-1)return null;let s=i[n].fi,a=qe(me({},i[n]),{fi:t});return i[n]=a,i.sort((o,l)=>o.fi-l.fi),e.localIndex=i.indexOf(a),{data:this.modifyArrayBy(i),actual:e,reverse:{type:6,fi:s,id:r}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let r of this){if(r.id===e)return t;t=r.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let r=this;if(e===null){if(r.length===0)return ko(0,t,t);{let i=r[0].fi;return ko(i-t,i,t)}}else{let i=this.get(e);if(i===void 0)throw new Error("illegal args");let n=r.find(s=>s.fi>i.fi);if(n===void 0){let s=r[r.length-1].fi;return ko(s,s+t,t)}else return ko(i.fi,n.fi,t)}}},j5=Symbol(),Bm=Symbol(),km=class{reportOp(e,t){let r=this;if(t===null)return;r._current=t.data;let i=[];for(;!(r instanceof q5);){let n=r._path,s=r._current;if(n!==""&&i.splice(0,0,n),r=r._parent,r===null)return;r.update(n,s)}r.push(i,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let r=t[Bm];r&&r(),delete this._children[e]}}}},Wj=class extends km{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current=qe(me({},this._current),{[e]:t})}runOp(e){this.reportOp(e,Ny.runOp(this._current,e))}},qj=class extends km{constructor(e,t,r){super(),this._parent=e,this._path=t,this._current=r}update(e,t){this._current=qe(me({},this._current),{[e]:t}),Object.setPrototypeOf(this._current,Ll.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},W5={get(e,t){if(t===Bm)return()=>{e._parent=null};if(t===j5)return e._current;let{_current:r,_children:i}=e;if(t==="push"&&Array.isArray(r))throw new Error("not supported to expand array");let n=i===void 0?void 0:i[t];if(n!==void 0)return n;let s=r[t],a=zm(e,t,s);return a!==s?(i===void 0&&(i={},e._children=i),i[t]=a,a):s},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let r=e._current,i=Reflect.getOwnPropertyDescriptor(r,t);return i&&{writable:!0,configurable:!0,enumerable:i.enumerable,value:r[t]}}},Yj=qe(me({},W5),{set(e,t,r){var n;let i={type:0,props:{[t]:(n=X5(r))!=null?n:r}};return e.deleteChildren(t),e.runOp(i),!0},deleteProperty(e,t){let r={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(r),!0}}),Xj=qe(me({},W5),{set(e,t,r){return r===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:r})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}}),hb=class extends km{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[Bm]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,r)=>{e(t,this.data(t))})}data(e){var a;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(a=t.get(e))==null?void 0:a.data,s=zm(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}add(e,t,r,i,n){this.runOp({type:7,parent:e,fi:t,id:r,data:i,children:n})}move(e,t,r){this.runOp({type:9,parent:e,fi:t,id:r})}insertAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}insertBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.add(e,i[n],s.id,s.data,s.children)}}moveAfter(e,t,r){let i=this._current.insertAfterHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}moveBefore(e,t,r){let i=this._current.insertBeforeHelper(e,t,r.length);for(let n=0;n<r.length;n++){let s=r[n];this.move(e,i[n],s)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},ub=class extends km{constructor(e,t,r){super(),this._children={},this._parent=e,this._path=t,this._current=r,this[Bm]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let r=0;r<t;r++){let i=this._current[r].id;e(this.data(this._current[r].id),i)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return qe(me({},this._current.get(e)),{data:this.data(e)})}data(e){var a;let{_current:t,_children:r}=this,i=r===void 0?void 0:r[e];if(i!==void 0)return i;let n=(a=t.get(e))==null?void 0:a.data,s=zm(this,e,n);return s!==n?(r===void 0&&(r={},this._children=r),r[e]=s,s):n}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,r){this.runOp({type:4,fi:e,id:t,data:r})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}insertBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.add(r[i],n.id,n.data)}}moveAfter(e,t){let r=this._current.insertAfterHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}moveBefore(e,t){let r=this._current.insertBeforeHelper(e,t.length);for(let i=0;i<t.length;i++){let n=t[i];this.move(r[i],n)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function mv(e,t,r){if(e.length>0){let i=e[e.length-1];if(i.type===0&&t.type===0&&By.equal(i.path,r)){Object.assign(i.props,t.props);return}}e.push(qe(me({},t),{path:r}))}var q5=class{constructor(e){this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,r,i){mv(this.ts,t,e),mv(this.actual,r,e),mv(this.reverse,i,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function zm(e,t,r){return r instanceof _u?new hb(e,t,r):r instanceof tn?new ub(e,t,r):r instanceof Ll?new Proxy(new qj(e,t,r),Xj):r!==null&&typeof r=="object"?H5(r)?r:new Proxy(new Wj(e,t,r),Yj):r}function Y5(e){let t=new q5(e);return[zm(t,"",e),t]}function MM(e,t){let[r,i]=Y5(e);return t(r),i.result()}function X5(e){return e instanceof hb||e instanceof ub?e._current:e!==null&&typeof e=="object"?e[j5]:e}var By;(e=>{function t(n,s){if(s.length===n.length)for(var a=0;a<n.length;){if(n[a]!==s[a])return!1;a+=1}else return!1;return!0}e.equal=t;function r(n,s,a){let o=i(a,n);if(o!==void 0&&typeof o=="object"&&o!==null){let l=me({},s);return Object.keys(o).forEach(h=>{delete l[h]}),l}else return s}e.removeOverridden=r;function i(n,s,a=0){if(s.length<=a)return n;if((n instanceof _u||n instanceof hb)&&typeof s[a]=="string"||(n instanceof tn||n instanceof ub)&&typeof s[a]=="string")return i(n.data(s[a]),s,a+1);if(typeof s[a]=="number"&&Array.isArray(n)||typeof s[a]=="string"&&typeof n=="object")return i(n[s[a]],s,a+1)}e.zoom=i})(By||(By={}));var Q5=class{},AM=class extends Q5{constructor(e){super(),this.id=e}},EM=class extends Q5{constructor(e){super(),this.data=e}},ky;try{ky=new TextDecoder}catch{}var Ne,qo,ne=0,J5=[],zy=J5,Fy=0,Wi={},Gt,zo,Rn=0,Gs=0,hn,ja,Ni=[],Yt,CM={useRecords:!1,mapsAsObjects:!0},K5=class{},Z5=new K5;Z5.name="MessagePack 0xC1";var Su=!1,B0=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(Ne)return n6(()=>(Hy(),this?this.unpack(e,t):B0.prototype.unpack.call(CM,e,t)));qo=t>-1?t:e.length,ne=0,Fy=0,Gs=0,zo=null,zy=J5,hn=null,Ne=e;try{Yt=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw Ne=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof B0){if(Wi=this,this.structures)return Gt=this.structures,hp();(!Gt||Gt.length>0)&&(Gt=[])}else Wi=CM,(!Gt||Gt.length>0)&&(Gt=[]);return hp()}unpackMultiple(e,t){let r,i=0;try{Su=!0;let n=e.length,s=this?this.unpack(e,n):Um.unpack(e,n);if(t){for(t(s);ne<n;)if(i=ne,t(hp())===!1)return}else{for(r=[s];ne<n;)i=ne,r.push(hp());return r}}catch(n){throw n.lastPosition=i,n.values=r,n}finally{Su=!1,Hy()}}_mergeStructures(e,t){e=e||[];for(let r=0,i=e.length;r<i;r++){let n=e[r];n&&(n.isShared=!0,r>=32&&(n.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let i=e[r],n=t[r];n&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=n)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function hp(){try{if(!Wi.trusted&&!Su){let t=Gt.sharedLength||0;t<Gt.length&&(Gt.length=t)}let e=vr();if(ne==qo)Gt.restoreStructures&&TM(),Gt=null,Ne=null,ja&&(ja=null);else if(ne>qo){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!Su)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw Gt.restoreStructures&&TM(),Hy(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function TM(){for(let e in Gt.restoreStructures)Gt[e]=Gt.restoreStructures[e];Gt.restoreStructures=null}function vr(){let e=Ne[ne++];if(e<160)if(e<128){if(e<64)return e;{let t=Gt[e&63]||Wi.getStructures&&$5()[e&63];return t?(t.read||(t.read=cb(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,Wi.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[t6()]=vr();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(vr(),vr());return t}else{e-=144;let t=new Array(e);for(let r=0;r<e;r++)t[r]=vr();return t}else if(e<192){let t=e-160;if(Gs>=ne)return zo.slice(ne-Rn,(ne+=t)-Rn);if(Gs==0&&qo<140){let r=t<16?db(t):e6(t);if(r!=null)return r}return Uy(t)}else{let t;switch(e){case 192:return null;case 193:return hn?(t=vr(),t>0?hn[1].slice(hn.position1,hn.position1+=t):hn[0].slice(hn.position0,hn.position0-=t)):Z5;case 194:return!1;case 195:return!0;case 196:return gv(Ne[ne++]);case 197:return t=Yt.getUint16(ne),ne+=2,gv(t);case 198:return t=Yt.getUint32(ne),ne+=4,gv(t);case 199:return fl(Ne[ne++]);case 200:return t=Yt.getUint16(ne),ne+=2,fl(t);case 201:return t=Yt.getUint32(ne),ne+=4,fl(t);case 202:if(t=Yt.getFloat32(ne),Wi.useFloat32>2){let r=fb[(Ne[ne]&127)<<1|Ne[ne+1]>>7];return ne+=4,(r*t+(t>0?.5:-.5)>>0)/r}return ne+=4,t;case 203:return t=Yt.getFloat64(ne),ne+=8,t;case 204:return Ne[ne++];case 205:return t=Yt.getUint16(ne),ne+=2,t;case 206:return t=Yt.getUint32(ne),ne+=4,t;case 207:return Wi.int64AsNumber?(t=Yt.getUint32(ne)*4294967296,t+=Yt.getUint32(ne+4)):t=Yt.getBigUint64(ne),ne+=8,t;case 208:return Yt.getInt8(ne++);case 209:return t=Yt.getInt16(ne),ne+=2,t;case 210:return t=Yt.getInt32(ne),ne+=4,t;case 211:return Wi.int64AsNumber?(t=Yt.getInt32(ne)*4294967296,t+=Yt.getUint32(ne+4)):t=Yt.getBigInt64(ne),ne+=8,t;case 212:if(t=Ne[ne++],t==114)return OM(Ne[ne++]&63);{let r=Ni[t];if(r)return r.read?(ne++,r.read(vr())):r.noBuffer?(ne++,r()):r(Ne.subarray(ne,++ne));throw new Error("Unknown extension "+t)}case 213:return t=Ne[ne],t==114?(ne++,OM(Ne[ne++]&63,Ne[ne++])):fl(2);case 214:return fl(4);case 215:return fl(8);case 216:return fl(16);case 217:return t=Ne[ne++],Gs>=ne?zo.slice(ne-Rn,(ne+=t)-Rn):Jj(t);case 218:return t=Yt.getUint16(ne),ne+=2,Gs>=ne?zo.slice(ne-Rn,(ne+=t)-Rn):Kj(t);case 219:return t=Yt.getUint32(ne),ne+=4,Gs>=ne?zo.slice(ne-Rn,(ne+=t)-Rn):Zj(t);case 220:return t=Yt.getUint16(ne),ne+=2,PM(t);case 221:return t=Yt.getUint32(ne),ne+=4,PM(t);case 222:return t=Yt.getUint16(ne),ne+=2,LM(t);case 223:return t=Yt.getUint32(ne),ne+=4,LM(t);default:if(e>=224)return e-256;if(e===void 0){let r=new Error("Unexpected end of MessagePack data");throw r.incomplete=!0,r}throw new Error("Unknown MessagePack token "+e)}}}var Qj=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function cb(e,t){function r(){if(r.count++>2){let n=e.read=new Function("r","return function(){return {"+e.map(s=>Qj.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(vr);return e.highByte===0&&(e.read=DM(t,e.read)),n()}let i={};for(let n=0,s=e.length;n<s;n++){let a=e[n];i[a]=vr()}return i}return r.count=0,e.highByte===0?DM(t,r):r}var DM=(e,t)=>function(){let r=Ne[ne++];if(r===0)return t();let i=e<32?-(e+(r<<5)):e+(r<<5),n=Gt[i]||$5()[i];if(!n)throw new Error("Record id is not defined for "+i);return n.read||(n.read=cb(n,e)),n.read()};function $5(){let e=n6(()=>(Ne=null,Wi.getStructures()));return Gt=Wi._mergeStructures(e,Gt)}var Uy=Fm,Jj=Fm,Kj=Fm,Zj=Fm;function Fm(e){let t;if(e<16&&(t=db(e)))return t;if(e>64&&ky)return ky.decode(Ne.subarray(ne,ne+=e));let r=ne+e,i=[];for(t="";ne<r;){let n=Ne[ne++];if((n&128)===0)i.push(n);else if((n&224)===192){let s=Ne[ne++]&63;i.push((n&31)<<6|s)}else if((n&240)===224){let s=Ne[ne++]&63,a=Ne[ne++]&63;i.push((n&31)<<12|s<<6|a)}else if((n&248)===240){let s=Ne[ne++]&63,a=Ne[ne++]&63,o=Ne[ne++]&63,l=(n&7)<<18|s<<12|a<<6|o;l>65535&&(l-=65536,i.push(l>>>10&1023|55296),l=56320|l&1023),i.push(l)}else i.push(n);i.length>=4096&&(t+=jr.apply(String,i),i.length=0)}return i.length>0&&(t+=jr.apply(String,i)),t}function PM(e){let t=new Array(e);for(let r=0;r<e;r++)t[r]=vr();return t}function LM(e){if(Wi.mapsAsObjects){let t={};for(let r=0;r<e;r++)t[t6()]=vr();return t}else{let t=new Map;for(let r=0;r<e;r++)t.set(vr(),vr());return t}}var jr=String.fromCharCode;function e6(e){let t=ne,r=new Array(e);for(let i=0;i<e;i++){let n=Ne[ne++];if((n&128)>0){ne=t;return}r[i]=n}return jr.apply(String,r)}function db(e){if(e<4)if(e<2){if(e===0)return"";{let t=Ne[ne++];if((t&128)>1){ne-=1;return}return jr(t)}}else{let t=Ne[ne++],r=Ne[ne++];if((t&128)>0||(r&128)>0){ne-=2;return}if(e<3)return jr(t,r);let i=Ne[ne++];if((i&128)>0){ne-=3;return}return jr(t,r,i)}else{let t=Ne[ne++],r=Ne[ne++],i=Ne[ne++],n=Ne[ne++];if((t&128)>0||(r&128)>0||(i&128)>0||(n&128)>0){ne-=4;return}if(e<6){if(e===4)return jr(t,r,i,n);{let s=Ne[ne++];if((s&128)>0){ne-=5;return}return jr(t,r,i,n,s)}}else if(e<8){let s=Ne[ne++],a=Ne[ne++];if((s&128)>0||(a&128)>0){ne-=6;return}if(e<7)return jr(t,r,i,n,s,a);let o=Ne[ne++];if((o&128)>0){ne-=7;return}return jr(t,r,i,n,s,a,o)}else{let s=Ne[ne++],a=Ne[ne++],o=Ne[ne++],l=Ne[ne++];if((s&128)>0||(a&128)>0||(o&128)>0||(l&128)>0){ne-=8;return}if(e<10){if(e===8)return jr(t,r,i,n,s,a,o,l);{let h=Ne[ne++];if((h&128)>0){ne-=9;return}return jr(t,r,i,n,s,a,o,l,h)}}else if(e<12){let h=Ne[ne++],u=Ne[ne++];if((h&128)>0||(u&128)>0){ne-=10;return}if(e<11)return jr(t,r,i,n,s,a,o,l,h,u);let c=Ne[ne++];if((c&128)>0){ne-=11;return}return jr(t,r,i,n,s,a,o,l,h,u,c)}else{let h=Ne[ne++],u=Ne[ne++],c=Ne[ne++],d=Ne[ne++];if((h&128)>0||(u&128)>0||(c&128)>0||(d&128)>0){ne-=12;return}if(e<14){if(e===12)return jr(t,r,i,n,s,a,o,l,h,u,c,d);{let f=Ne[ne++];if((f&128)>0){ne-=13;return}return jr(t,r,i,n,s,a,o,l,h,u,c,d,f)}}else{let f=Ne[ne++],p=Ne[ne++];if((f&128)>0||(p&128)>0){ne-=14;return}if(e<15)return jr(t,r,i,n,s,a,o,l,h,u,c,d,f,p);let m=Ne[ne++];if((m&128)>0){ne-=15;return}return jr(t,r,i,n,s,a,o,l,h,u,c,d,f,p,m)}}}}}function gv(e){return Wi.copyBuffers?Uint8Array.prototype.slice.call(Ne,ne,ne+=e):Ne.subarray(ne,ne+=e)}function fl(e){let t=Ne[ne++];if(Ni[t])return Ni[t](Ne.subarray(ne,ne+=e));throw new Error("Unknown extension type "+t)}var RM=new Array(4096);function t6(){let e=Ne[ne++];if(e>=160&&e<192){if(e=e-160,Gs>=ne)return zo.slice(ne-Rn,(ne+=e)-Rn);if(!(Gs==0&&qo<180))return Uy(e)}else return ne--,vr();let t=(e<<5^(e>1?Yt.getUint16(ne):e>0?Ne[ne]:0))&4095,r=RM[t],i=ne,n=ne+e-3,s,a=0;if(r&&r.bytes==e){for(;i<n;){if(s=Yt.getUint32(i),s!=r[a++]){i=1879048192;break}i+=4}for(n+=3;i<n;)if(s=Ne[i++],s!=r[a++]){i=1879048192;break}if(i===n)return ne=i,r.string;n-=3,i=ne}for(r=[],RM[t]=r,r.bytes=e;i<n;)s=Yt.getUint32(i),r.push(s),i+=4;for(n+=3;i<n;)s=Ne[i++],r.push(s);let o=e<16?db(e):e6(e);return o!=null?r.string=o:r.string=Uy(e)}var OM=(e,t)=>{var r=vr();let i=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let n=Gt[e];return n&&n.isShared&&((Gt.restoreStructures||(Gt.restoreStructures=[]))[e]=n),Gt[e]=r,r.read=cb(r,i),r.read()},r6=typeof self=="object"?self:global;Ni[0]=()=>{};Ni[0].noBuffer=!0;Ni[101]=()=>{let e=vr();return(r6[e[0]]||Error)(e[1])};Ni[105]=e=>{let t=Yt.getUint32(ne-4);ja||(ja=new Map);let r=Ne[ne],i;r>=144&&r<160||r==220||r==221?i=[]:i={};let n={target:i};ja.set(t,n);let s=vr();return n.used?Object.assign(i,s):(n.target=s,s)};Ni[112]=e=>{let t=Yt.getUint32(ne-4),r=ja.get(t);return r.used=!0,r.target};Ni[115]=()=>new Set(vr());var i6=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");Ni[116]=e=>{let t=e[0],r=i6[t];if(!r)throw new Error("Could not find typed array for code "+t);return new r6[r](Uint8Array.prototype.slice.call(e,1).buffer)};Ni[120]=()=>{let e=vr();return new RegExp(e[0],e[1])};Ni[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=ne;ne+=t-4,hn=[vr(),vr()],hn.position0=0,hn.position1=0;let i=ne;ne=r;try{return vr()}finally{ne=i}};Ni[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function n6(e){let t=qo,r=ne,i=Fy,n=Rn,s=Gs,a=zo,o=zy,l=ja,h=hn,u=new Uint8Array(Ne.slice(0,qo)),c=Gt,d=Gt.slice(0,Gt.length),f=Wi,p=Su,m=e();return qo=t,ne=r,Fy=i,Rn=n,Gs=s,zo=a,zy=o,ja=l,hn=h,Ne=u,Su=p,Gt=c,Gt.splice(0,Gt.length,...d),Wi=f,Yt=new DataView(Ne.buffer,Ne.byteOffset,Ne.byteLength),m}function Hy(){Ne=null,ja=null,Gt=null}function $j(e){e.unpack?Ni[e.type]=e.unpack:Ni[e.type]=e}var fb=new Array(147);for(let e=0;e<256;e++)fb[e]=+("1e"+Math.floor(45.15-e*.30103));var Um=new B0({useRecords:!1});Um.unpack;Um.unpackMultiple;Um.unpack;var eW=new Float32Array(1);new Uint8Array(eW.buffer,0,4);var Gp;try{Gp=new TextEncoder}catch{}var k0,pb,Hm=typeof Buffer<"u",vv=Hm?Buffer.allocUnsafeSlow:Uint8Array,s6=Hm?Buffer:Uint8Array,IM=Hm?4294967296:2144337920,fe,br,he=0,Ms,As=null,tW=/[\u0080-\uFFFF]/,fc=Symbol("record-id"),a6=class extends B0{constructor(e){super(e),this.offset=0;let t,r,i,n,s,a=0,o=s6.prototype.utf8Write?function(S,P,M){return fe.utf8Write(S,P,M)}:Gp&&Gp.encodeInto?function(S,P){return Gp.encodeInto(S,fe.subarray(P)).written}:!1,l=this;e||(e={});let h=e&&e.sequential,u=e.structures||e.saveStructures,c=e.maxSharedStructures;if(c==null&&(c=u?32:0),c>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=e.maxOwnStructures;d==null&&(d=u?32:64),h&&!e.saveStructures&&(this.structures=[]);let f=c>32||d+c>64,p=c+64,m=c+d+64;if(m>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],v=0,x=0;this.pack=this.encode=function(S,P){if(fe||(fe=new vv(8192),br=new DataView(fe.buffer,0,8192),he=0),Ms=fe.length-10,Ms-he<2048?(fe=new vv(fe.length),br=new DataView(fe.buffer,0,fe.length),Ms=fe.length-10,he=0):he=he+7&2147483640,t=he,s=l.structuredClone?new Map:null,l.bundleStrings?(As=["",""],fe[he++]=214,fe[he++]=98,As.position=he-t,he+=4):As=null,r=l.structures,r){r.uninitialized&&(r=l._mergeStructures(l.getStructures()));let M=r.sharedLength||0;if(M>c)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let B=0;B<M;B++){let R=r[B];if(!R)continue;let H,Q=r.transitions;for(let z=0,y=R.length;z<y;z++){let A=R[z];H=Q[A],H||(H=Q[A]=Object.create(null)),Q=H}Q[fc]=B+64}a=M}h||(r.nextId=M+64)}i&&(i=!1),n=r||[];try{if(b(S),As){br.setUint32(As.position+t,he-As.position-t);let M=As;As=null,b(M[0]),b(M[1])}if(l.offset=he,s&&s.idsToInsert){he+=s.idsToInsert.length*6,he>Ms&&E(he),l.offset=he;let M=iW(fe.subarray(t,he),s.idsToInsert);return s=null,M}return P&nW?(fe.start=t,fe.end=he,fe):fe.subarray(t,he)}finally{if(r){if(x<10&&x++,v>1e4)r.transitions=null,x=0,v=0,g.length>0&&(g=[]);else if(g.length>0&&!h){for(let M=0,B=g.length;M<B;M++)g[M][fc]=0;g=[]}if(i&&l.saveStructures){let M=r.sharedLength||c;r.length>M&&(r=r.slice(0,M));let B=fe.subarray(t,he);return l.saveStructures(r,a)===!1?(l._mergeStructures(l.getStructures()),l.pack(S)):(a=M,B)}}P&sW&&(he=t)}};let b=S=>{he>Ms&&(fe=E(he));var P=typeof S,M;if(P==="string"){let B=S.length;if(As&&B>=8&&B<4096){let Q=tW.test(S);As[Q?0:1]+=S,fe[he++]=193,b(Q?-B:B);return}let R;B<32?R=1:B<256?R=2:B<65536?R=3:R=5;let H=B*3;if(he+H>Ms&&(fe=E(he+H)),B<64||!o){let Q,z,y,A=he+R;for(Q=0;Q<B;Q++)z=S.charCodeAt(Q),z<128?fe[A++]=z:z<2048?(fe[A++]=z>>6|192,fe[A++]=z&63|128):(z&64512)===55296&&((y=S.charCodeAt(Q+1))&64512)===56320?(z=65536+((z&1023)<<10)+(y&1023),Q++,fe[A++]=z>>18|240,fe[A++]=z>>12&63|128,fe[A++]=z>>6&63|128,fe[A++]=z&63|128):(fe[A++]=z>>12|224,fe[A++]=z>>6&63|128,fe[A++]=z&63|128);M=A-he-R}else M=o(S,he+R,H);M<32?fe[he++]=160|M:M<256?(R<2&&fe.copyWithin(he+2,he+1,he+1+M),fe[he++]=217,fe[he++]=M):M<65536?(R<3&&fe.copyWithin(he+3,he+2,he+2+M),fe[he++]=218,fe[he++]=M>>8,fe[he++]=M&255):(R<5&&fe.copyWithin(he+5,he+3,he+3+M),fe[he++]=219,br.setUint32(he,M),he+=4),he+=M}else if(P==="number")if(S>>>0===S)S<64?fe[he++]=S:S<256?(fe[he++]=204,fe[he++]=S):S<65536?(fe[he++]=205,fe[he++]=S>>8,fe[he++]=S&255):(fe[he++]=206,br.setUint32(he,S),he+=4);else if(S>>0===S)S>=-32?fe[he++]=256+S:S>=-128?(fe[he++]=208,fe[he++]=S+256):S>=-32768?(fe[he++]=209,br.setInt16(he,S),he+=2):(fe[he++]=210,br.setInt32(he,S),he+=4);else{let B;if((B=this.useFloat32)>0&&S<4294967296&&S>=-2147483648){fe[he++]=202,br.setFloat32(he,S);let R;if(B<4||(R=S*fb[(fe[he]&127)<<1|fe[he+1]>>7])>>0===R){he+=4;return}else he--}fe[he++]=203,br.setFloat64(he,S),he+=8}else if(P==="object")if(!S)fe[he++]=192;else{if(s){let R=s.get(S);if(R){if(!R.id){let H=s.idsToInsert||(s.idsToInsert=[]);R.id=H.push(R)}fe[he++]=214,fe[he++]=112,br.setUint32(he,R.id),he+=4;return}else s.set(S,{offset:he-t})}let B=S.constructor;if(B===Object)_(S,!0);else if(B===Array){M=S.length,M<16?fe[he++]=144|M:M<65536?(fe[he++]=220,fe[he++]=M>>8,fe[he++]=M&255):(fe[he++]=221,br.setUint32(he,M),he+=4);for(let R=0;R<M;R++)b(S[R])}else if(B===Map){M=S.size,M<16?fe[he++]=128|M:M<65536?(fe[he++]=222,fe[he++]=M>>8,fe[he++]=M&255):(fe[he++]=223,br.setUint32(he,M),he+=4);for(let[R,H]of S)b(R),b(H)}else{for(let R=0,H=k0.length;R<H;R++){let Q=pb[R];if(S instanceof Q){let z=k0[R];if(z.write){z.type&&(fe[he++]=212,fe[he++]=z.type,fe[he++]=0),b(z.write.call(this,S));return}let y=fe,A=br,D=he;fe=null;let O;try{O=z.pack.call(this,S,C=>(fe=y,y=null,he+=C,he>Ms&&E(he),{target:fe,targetView:br,position:he-C}),b)}finally{y&&(fe=y,br=A,he=D,Ms=fe.length-10)}O&&(O.length+he>Ms&&E(O.length+he),he=rW(O,fe,he,z.type));return}}_(S,!S.hasOwnProperty)}}else if(P==="boolean")fe[he++]=S?195:194;else if(P==="bigint"){if(S<BigInt(1)<<BigInt(63)&&S>=-(BigInt(1)<<BigInt(63)))fe[he++]=211,br.setBigInt64(he,S);else if(S<BigInt(1)<<BigInt(64)&&S>0)fe[he++]=207,br.setBigUint64(he,S);else if(this.largeBigIntToFloat)fe[he++]=203,br.setFloat64(he,Number(S));else throw new RangeError(S+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");he+=8}else if(P==="undefined")this.encodeUndefinedAsNil?fe[he++]=192:(fe[he++]=212,fe[he++]=0,fe[he++]=0);else if(P==="function")b(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+P)},_=this.useRecords===!1?this.variableMapSize?S=>{let P=Object.keys(S),M=P.length;M<16?fe[he++]=128|M:M<65536?(fe[he++]=222,fe[he++]=M>>8,fe[he++]=M&255):(fe[he++]=223,br.setUint32(he,M),he+=4);let B;for(let R=0;R<M;R++)b(B=P[R]),b(S[B])}:(S,P)=>{fe[he++]=222;let M=he-t;he+=2;let B=0;for(let R in S)(P||S.hasOwnProperty(R))&&(b(R),b(S[R]),B++);fe[M+++t]=B>>8,fe[M+t]=B&255}:S=>{let P=Object.keys(S),M,B=n.transitions||(n.transitions=Object.create(null)),R=0;for(let Q=0,z=P.length;Q<z;Q++){let y=P[Q];M=B[y],M||(M=B[y]=Object.create(null),R++),B=M}let H=B[fc];if(H)H>=96&&f?(fe[he++]=((H-=96)&31)+96,fe[he++]=H>>5):fe[he++]=H;else{H=n.nextId,H||(H=64),H<p&&this.shouldShareStructure&&!this.shouldShareStructure(P)?(H=n.nextOwnId,H<m||(H=p),n.nextOwnId=H+1):(H>=m&&(H=p),n.nextId=H+1);let Q=P.highByte=H>=96&&f?H-96>>5:-1;B[fc]=H,n[H-64]=P,H<p?(P.isShared=!0,n.sharedLength=H-63,i=!0,Q>=0?(fe[he++]=(H&31)+96,fe[he++]=Q):fe[he++]=H):(Q>=0?(fe[he++]=213,fe[he++]=114,fe[he++]=(H&31)+96,fe[he++]=Q):(fe[he++]=212,fe[he++]=114,fe[he++]=H),R&&(v+=x*R),g.length>=d&&(g.shift()[fc]=0),g.push(B),b(P))}for(let Q=0,z=P.length;Q<z;Q++)b(S[P[Q]])},E=S=>{let P;if(S>16777216){if(S-t>IM)throw new Error("Packed buffer would be larger than maximum buffer size");P=Math.min(IM,Math.round(Math.max((S-t)*(S>67108864?1.25:2),4194304)/4096)*4096)}else P=(Math.max(S-t<<2,fe.length-1)>>12)+1<<12;let M=new vv(P);return br=new DataView(M.buffer,0,P),fe.copy?fe.copy(M,0,t,S):M.set(fe.slice(t,S)),he-=t,t=0,Ms=M.length-10,fe=M}}useBuffer(e){fe=e,br=new DataView(fe.buffer,fe.byteOffset,fe.byteLength),he=0}};pb=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,K5];k0=[{pack(e,t,r){let i=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:n,targetView:s,position:a}=t(6);n[a++]=214,n[a++]=255,s.setUint32(a,i)}else if(i>0&&i<17179869184){let{target:n,targetView:s,position:a}=t(10);n[a++]=215,n[a++]=255,s.setUint32(a,e.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(a+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:n,targetView:s,position:a}=t(3);n[a++]=212,n[a++]=255,n[a++]=255}else{let{target:n,targetView:s,position:a}=t(15);n[a++]=199,n[a++]=12,n[a++]=255,s.setUint32(a,e.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(i)))}}},{pack(e,t,r){let i=Array.from(e),{target:n,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(n[s++]=212,n[s++]=115,n[s++]=0),r(i)}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=101,i[n++]=0),r([e.name,e.message])}},{pack(e,t,r){let{target:i,position:n}=t(this.structuredClone?3:0);this.structuredClone&&(i[n++]=212,i[n++]=120,i[n++]=0),r([e.source,e.flags])}},{pack(e,t){this.structuredClone?NM(e,16,t):BM(Hm?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==s6&&this.structuredClone?NM(e,i6.indexOf(r.name),t):BM(e,t)}},{pack(e,t){let{target:r,position:i}=t(1);r[i]=193}}];function NM(e,t,r,i){let n=e.byteLength;if(n+1<256){var{target:s,position:a}=r(4+n);s[a++]=199,s[a++]=n+1}else if(n+1<65536){var{target:s,position:a}=r(5+n);s[a++]=200,s[a++]=n+1>>8,s[a++]=n+1&255}else{var{target:s,position:a,targetView:o}=r(7+n);s[a++]=201,o.setUint32(a,n+1),a+=4}s[a++]=116,s[a++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function BM(e,t){let r=e.byteLength;var i,n;if(r<256){var{target:i,position:n}=t(r+2);i[n++]=196,i[n++]=r}else if(r<65536){var{target:i,position:n}=t(r+3);i[n++]=197,i[n++]=r>>8,i[n++]=r&255}else{var{target:i,position:n,targetView:s}=t(r+5);i[n++]=198,s.setUint32(n,r),n+=4}i.set(e,n)}function rW(e,t,r,i){let n=e.length;switch(n){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:n<256?(t[r++]=199,t[r++]=n):n<65536?(t[r++]=200,t[r++]=n>>8,t[r++]=n&255):(t[r++]=201,t[r++]=n>>24,t[r++]=n>>16&255,t[r++]=n>>8&255,t[r++]=n&255)}return t[r++]=i,t.set(e,r),r+=n,r}function iW(e,t){let r,i=t.length*6,n=e.length-i;for(t.sort((s,a)=>s.offset>a.offset?1:-1);r=t.pop();){let s=r.offset,a=r.id;e.copyWithin(s+i,s,n),i-=6;let o=s+i;e[o++]=214,e[o++]=105,e[o++]=a>>24,e[o++]=a>>16&255,e[o++]=a>>8&255,e[o++]=a&255,n=s}return e}function $d(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");pb.unshift(e.Class),k0.unshift(e)}$j(e)}var o6=new a6({useRecords:!1});o6.pack;o6.pack;var nW=512,sW=1024,kM=new a6({structuredClone:!0});$d({Class:Ll.prototype.constructor,type:1,write(e){return me({},e)},read(e){return Object.setPrototypeOf(e,Ll.prototype),e}});$d({Class:tn.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,tn.prototype),e}});$d({Class:_u.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,_u.prototype),e}});$d({Class:AM.prototype.constructor,type:4,write(e){return e.id},read(e){return new AM(e)}});$d({Class:EM.prototype.constructor,type:5,write(e){return e.data},read(e){return new EM(e)}});function aW(e){var t=0;if(e.length===0)return t;for(let r=0;r<e.length;r++){let i=e[r];t=(t<<5)-t+i,t=t&t}return t}function Gy(e){if(H5(e))return e;if(Array.isArray(e))return e.map(Gy);if(typeof e=="object"&&e!==null){let t={};for(let r of Object.keys(e).sort())t[r]=Gy(e[r]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var Vy;(e=>{function t(n){return kM.pack(n)}e.serialize=t;function r(n){return kM.unpack(n)}e.deserialize=r;function i(n){return aW(t(Gy(n))).toString()}e.checksum=i})(Vy||(Vy={}));var jy;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(r){return e.all.includes(r)}e.is=t})(jy||(jy={}));var Wy;(e=>{function t(i){return r(i)}e.defaultData=t;function r(i){if(i==="PointLight")return{type:i,color:Va.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,depth:1e5,helper:!0};if(i==="SpotLight")return{type:i,color:Va.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,helper:!0,shadowResolution:1024,shadowRadius:1};if(i==="DirectionalLight")return{type:i,color:Va.white,intensity:1,shadows:!0,size:1e3,depth:1e5,shadowResolution:1024,helper:!0,shadowRadius:1};throw new Error("not implemented")}})(Wy||(Wy={}));var qy;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(r,i){return r.castShadow===i.castShadow&&r.receiveShadow===i.receiveShadow}e.equals=t})(qy||(qy={}));var Yy;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(r,i){return r.flatShading===i.flatShading&&r.side===i.side&&r.wireframe===i.wireframe}e.equals=t})(Yy||(Yy={}));var Xy;(e=>e.defaultData=qe(me(me({},Yy.defaultData),qy.defaultData),{cloner:null,booleanExclude:null}))(Xy||(Xy={}));var l6=(e=>(e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.Center=3]="Center",e[e.Justify=4]="Justify",e))(l6||{}),h6=(e=>(e[e.Top=1]="Top",e[e.Center=2]="Center",e[e.Bottom=3]="Bottom",e))(h6||{}),u6=(e=>(e[e.None=1]="None",e[e.Upper=2]="Upper",e[e.Lower=3]="Lower",e))(u6||{}),Qy;(e=>e.defaultData={width:100,height:100,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.5,letterSpacing:1,text:"",textTransform:1,color:Va.fromHexAndA(6974058,1),alpha:1,font:"roboto_regular"})(Qy||(Qy={}));var oW=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],Yh;(e=>{function t(n,s){return n==="light"&&s?r(s):i(n)}e.defaultData=t;function r(n){switch(n){case"basic":return{type:"light",category:"basic",alpha:1,visible:!0,mode:0};case"phong":return{category:"phong",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1,visible:!0,mode:0};case"toon":return{category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1,visible:!0,mode:0};case"lambert":return{category:"lambert",emissive:{r:0,g:0,b:0,a:1},type:"light",alpha:1,visible:!0,mode:0};case"physical":return{category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0}}}function i(n){switch(n){case"texture":return{alpha:1,visible:!0,size:[128,128],mode:0,axis:"x",side:2,type:"texture",projection:0,texture:{image:"image_0",wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!0};case"color":return{type:"color",alpha:1,visible:!0,mode:0,color:Di.fromHex(4737101)};case"depth":return{type:"depth",alpha:1,visible:!0,mode:0,gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],steps:[0,1,1,1,1,1,1,1,1,1,1],num:2,near:50,far:200};case"normal":return{type:"normal",alpha:1,visible:!0,mode:0,cnormal:[1,1,1]};case"gradient":return{type:"gradient",alpha:1,visible:!0,mode:0,gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{type:"noise",alpha:1,visible:!0,mode:0,size:[100,100,100],noiseType:0,scale:1,move:1,colorA:qe(me({},Di.fromHex(6710886)),{a:1}),colorB:qe(me({},Di.fromHex(6710886)),{a:1}),colorC:qe(me({},Di.fromHex(16777215)),{a:1}),colorD:qe(me({},Di.fromHex(16777215)),{a:1}),distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8]};case"fresnel":return{type:"fresnel",alpha:1,visible:!0,mode:0,color:Va.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{type:"rainbow",alpha:1,visible:!0,mode:0,filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"matcap":return{type:"matcap",alpha:1,visible:!0,mode:0,texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{type:"transmission",alpha:1,visible:!0,mode:0,thickness:10,ior:1.5,roughness:1};case"displace":return{type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,visible:!0}}}})(Yh||(Yh={}));var Yo;(e=>{function t(l){return!l.layers.some(h=>{if(h.data.type==="texture"&&h.data.projection!==0||h.data.type==="depth"&&!h.data.isWorldSpace||h.data.type==="noise"||h.data.type==="displace")return!0})&&!i(l)}e.isMergable=t;function r(l){let h="";return l.layers.forEach(u=>{Object.entries(u.data).forEach(([c,d])=>{h+=`${c}${d}`,Array.isArray(d)?d.forEach(f=>h+=`${f}`):typeof d=="object"?Object.values(d).forEach(f=>{typeof f=="number"?h+=`${f.toFixed(4)}`:h+=`${f}`}):h+=`${d}`})}),h}e.getHash=r;function i(l){let h=0;for(let u of l.layers)"alpha"in u.data&&u.data.type!=="light"&&u.data.type!=="fresnel"&&(h+=(1-h)*u.data.alpha);return h<1}e.isTransparent=i;function n(){return{layers:new tn}}e.defaultEmptyData=n;function s(l="layer1",h="layer2"){return a("phong",l,h)}e.defaultData=s;function a(l,h="layer1",u="layer2"){let c=new tn;return c.push({fi:0,data:Yh.defaultData("light",l),id:h}),c.push({fi:1,data:Yh.defaultData("color"),id:u}),{layers:c}}e.defaultTwoLayerData=a;function o(l,h="basic",u="layer1",c="layer2"){let d=Yh.defaultData("texture");Object.assign(d.texture,{image:l});let f=new tn;return f.push({fi:0,data:d,id:u}),f.push({fi:1,data:Yh.defaultData("light",h),id:c}),{layers:f}}e.defaultTwoLayerTextureData=o})(Yo||(Yo={}));var z0;(e=>{function t(){return{points:new tn,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(z0||(z0={}));var Jy;(e=>{function t(r){return r==="PolygonGeometry"||r==="RectangleGeometry"||r==="StarGeometry"||r==="TriangleGeometry"||r==="EllipseGeometry"}e.is2DParametricMesh=t})(Jy||(Jy={}));var F0;(e=>{function t(r){if(r==="RectangleGeometry")return{width:320,height:320,type:r,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="VectorGeometry")return{width:1,height:1,type:r,subdivisions:12,shape:z0.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(r==="BooleanGeometry")return{type:r,operation:2,width:0,height:0,depth:0,phongAngle:35};throw new Error("not implemented")}e.defaultData=t})(F0||(F0={}));var Id;(e=>{e.identity=qe(me({},Ly.identity),{hiddenMatrix:jl.identity});function t(n){return{position:n.position,rotation:n.rotation,scale:n.scale,hiddenMatrix:n.hiddenMatrix}}e.fromObject=t;function r(n,s){return{position:(s==null?void 0:s.position)||n.position,rotation:(s==null?void 0:s.rotation)||n.rotation,scale:(s==null?void 0:s.scale)||n.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||n.hiddenMatrix}}e.merge=r;function i(n,s){return{position:wi.isEqual(n.position,s.position)?null:s.position,rotation:wi.isEqual(n.rotation,s.rotation)?null:s.rotation,scale:wi.isEqual(n.scale,s.scale)?null:s.scale,hiddenMatrix:jl.isEqual(n.hiddenMatrix,s.hiddenMatrix)?null:s.hiddenMatrix}}e.diff=i})(Id||(Id={}));var Ja;(e=>e.defaultData=me({states:new tn,events:new tn,visible:!0,raycastLock:!1},Id.identity))(Ja||(Ja={}));var zM;(e=>e.defaultData=me({type:"Empty"},Ja.defaultData))(zM||(zM={}));var U0;(e=>e.defaultData=me(me({type:"Mesh"},Ja.defaultData),Xy.defaultData))(U0||(U0={}));var FM;(e=>e.defaultData=me(me({type:"TextFrame"},Ja.defaultData),Qy.defaultData))(FM||(FM={}));var Ky;(e=>e.defaultData=me(me(me({},Ja.defaultData),Id.identity),Od.defaultData))(Ky||(Ky={}));var UM;(e=>{function t(r){return me(me({},Ja.defaultData),Wy.defaultData(r))}e.defaultData=t})(UM||(UM={}));var HM;(e=>(e.defaultCamera=me({position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:jl.identity,name:"Play Camera",visible:!0,raycastLock:!1,states:new tn,events:new tn},Od.defaultData),e.defaultMeshObject=qe(me(me({name:"Rectangle"},Ja.defaultData),U0.defaultData),{geometry:F0.defaultData("RectangleGeometry"),material:Yo.defaultTwoLayerData("basic","layer1","layer2")}),e.defaultBooleanObject=qe(me(me({name:"Boolean"},Ja.defaultData),U0.defaultData),{geometry:F0.defaultData("BooleanGeometry"),material:Yo.defaultTwoLayerData("phong","layer1","layer2")})))(HM||(HM={}));var H0;(e=>{function t(i,n){if(n===void 0)return i;let s=me({},i);return"material"in s&&"material"in n&&n.material&&(s.material=MM(s.material,a=>{if(typeof a!="string")for(let[o,l]of Object.entries(n.material.layers)){let h=a.layers.data(o);h&&O0(h,l)}}).data),s.materials&&n.materials&&(s.materials=MM(s.materials,a=>{var o,l;for(let h=0;h<s.materials.length;h++){let u=n.materials[h];if(typeof u!="string")for(let[c,d]of Object.entries(u.layers)){let f=(l=(o=a[h])==null?void 0:o.layers)==null?void 0:l.data(c);f&&O0(f,d)}}}).data),s}e.patchMaterialState=t;function r(i,n){var a,o;if(n===void 0)return i;let s=me({},i);if(Object.assign(s,Id.merge(s,n)),Rd.is(i.type)){s.orthographic=me({},s.orthographic),s.perspective=me({},s.perspective);let l=n;((a=l.orthographic)==null?void 0:a.zoom)!==void 0&&(s.orthographic.zoom=l.orthographic.zoom),((o=l.perspective)==null?void 0:o.zoom)!==void 0&&(s.perspective.zoom=l.perspective.zoom),l.isUpVectorFlipped!==void 0&&(s.isUpVectorFlipped=l.isUpVectorFlipped),l.targetOffset!==void 0&&(s.targetOffset=l.targetOffset)}else if(i.type==="Mesh")s.geometry=me({},s.geometry),Object.assign(s.geometry,n.geometry),s=t(s,n);else if(jy.is(i.type)){let l=n;s.intensity!==void 0&&(s.intensity=l.intensity),l.color!==void 0&&(typeof l.color=="string"?s.color=l.color:s.color=Di.clone(l.color))}return s}e.patch=r})(H0||(H0={}));function lW(e,t=!1){let r=e[0].index!==null,i=new Set(Object.keys(e[0].attributes)),n=new Set(Object.keys(e[0].morphAttributes)),s={},a={},o=e[0].morphTargetsRelative,l=new vt,h=0;for(let u=0;u<e.length;++u){let c=e[u],d=0;if(r!==(c.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let f in c.attributes){if(!i.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+f+'" attribute exists among all geometries, or in none of them.'),null;s[f]===void 0&&(s[f]=[]),s[f].push(c.attributes[f]),d++}if(d!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(o!==c.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let f in c.morphAttributes){if(!n.has(f))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;a[f]===void 0&&(a[f]=[]),a[f].push(c.morphAttributes[f])}if(l.userData.mergedUserData=l.userData.mergedUserData||[],l.userData.mergedUserData.push(c.userData),t){let f;if(r)f=c.index.count;else if(c.attributes.position!==void 0)f=c.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;l.addGroup(h,f,u),h+=f}}if(r){let u=0,c=[];for(let d=0;d<e.length;++d){let f=e[d].index;for(let p=0;p<f.count;++p)c.push(f.getX(p)+u);u+=e[d].attributes.position.count}l.setIndex(c)}for(let u in s){let c=GM(s[u]);if(!c)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,c)}for(let u in a){let c=a[u][0].length;if(c===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let d=0;d<c;++d){let f=[];for(let m=0;m<a[u].length;++m)f.push(a[u][m][d]);let p=GM(f);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(p)}}return l}function GM(e){let t,r,i,n=0;for(let o=0;o<e.length;++o){let l=e[o];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(r===void 0&&(r=l.itemSize),r!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=l.normalized),i!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;n+=l.array.length}let s=new t(n),a=0;for(let o=0;o<e.length;++o)s.set(e[o].array,a),a+=e[o].array.length;return new Ct(s,r,i)}var yv={type:"change"},VM={type:"changeZoom"},hW={type:"changePan"},xh={type:"start"},pc={type:"end"},xv=new yn,uW=new $,cW=2*Math.PI,dW=1e-8,fW=.01,jM=2,wv=.125,WM=2,bv=1,_v=1,Sv=.1,pW=class extends nn{constructor(e,t){super(),this.object=e,this.domElement=t,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.preventScroll=!0,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,Sn.DOLLY_ROTATE,Sn.PAN],this.offset=new F,this.eye=new F,this.lastPosition=new F,this.lastQuaternion=new yn,this.current=new $,this.overShoot=new $,this.overRatio=new $,this.spherical=new US,this.sphericalDelta=new US,this.panOffset=new F,this.panLeftV=new F,this.panUpV=new F,this.panV=new F,this.rotateStart=new $,this.rotateEnd=new $,this.rotateDelta=new $,this.panStart=new $,this.panEnd=new $,this.panDelta=new $,this.dollyStart=new $,this.dollyEnd=new $,this.dollyDelta=new $,this.rotationRangeFactor=new $,this.panRangeFactor=new $,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isFirstHover=!0,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.update=()=>{let r=this.object.position;this.offset.copy(r).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(xv.copy(this.object.quaternion).invert()),this.panOffset.applyQuaternion(xv),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion(this.object.quaternion),this.panOffset.applyQuaternion(this.object.quaternion)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-wv),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),r.copy(this.target).add(this.offset);let i=this.spherical.phi%cW;return this.eye.copy(this.offset).normalize(),this.object.up.copy(er.DefaultUp).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),i>0&&i>Math.PI||i<0&&i>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0?(this.sphericalDelta.theta*=1-wv,this.sphericalDelta.phi*=1-wv):this.sphericalDelta.set(0,0,0),this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>fW||8*(1-this.lastQuaternion.dot(this.object.quaternion))>dW?(this.dispatchEvent(yv),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=r=>{this.enabled!==!1&&(this.isPointerDown=!0,zt.length===0&&(this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp)),gW(r),r.pointerType==="touch"?this.onPointerDownTouch(r):this.onPointerDownMouse(r))},this.onPointerMove=r=>{this.enabled!==!1&&(r.pointerType==="touch"?this.onPointerMoveTouch(r):this.onPointerMoveMouse(r))},this.onPointerUp=r=>{YM(r),this.isPointerDown=!1,zt.length===0&&(this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp)),this.dispatchEvent(pc),this.state=-1},this.onPointerCancel=r=>{YM(r)},this.onPointerDownMouse=r=>{let i;switch(this.useKeyEvents?i=this.mouseButtons[r.button]:i=this.mouseButtonsPlay[r.button],i){case 0:if(r.altKey===!0&&!r.shiftKey&&!lp(r)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2;break;case 3:if(lp(r)||r.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}break;case 5:if(lp(r)||r.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(r),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(r),this.state=2}break;default:this.state=-1}this.state!==-1&&this.dispatchEvent(xh)},this.onPointerMoveMouse=r=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(r);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(r);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(r);break}},this.onPointerDownTouch=r=>{switch(XM(r),this.touches[zt.length-1]){case Sn.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case Sn.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case Sn.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case Sn.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}this.state!==-1&&this.dispatchEvent(xh)},this.onPointerMoveTouch=r=>{switch(XM(r),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(r),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(r),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(r),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(r),this.update();break;default:this.state=-1}},this.dispatchEndDebounced=z5(()=>this.dispatchEvent(pc),33),this.onMouseWheel=r=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||((this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth||this.preventScroll)&&r.preventDefault(),this.dispatchEvent(xh),this.handleMouseWheel(r),this.dispatchEndDebounced())},this.onGesture=r=>{if(this.enabled!==!1)if(r.preventDefault(),r.type==="gesturechange"){if(this.enableZoom===!1)return;this.dispatchEvent(xh),r.scale>this.prevScale?this.dollyIn(this.getZoomScale()):r.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=r.scale,this.update()}else this.dispatchEvent(pc)},this.onContextMenu=r=>{this.enabled!==!1&&r.preventDefault()},this.onTouchMove=r=>{(r.touches.length>1||this.preventScroll)&&r.preventDefault()},this.onTouchEnd=r=>{r.preventDefault()},this.onKeyDown=r=>{this.enabled!==!1&&(this.key=r.key)},this.onKeyUp=()=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&this.onPointerUp(zt[0]))},this.onPointerHover=r=>{if(!(U5||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot)){if(window.clearTimeout(this.timerHover),this.isPointerDown=!0,this.isFirstHover){let i={clientX:window.innerWidth/2,clientY:window.innerHeight/2};this.hoverRotatePanMode===2?this.handleMouseDownPan(i):this.hoverRotatePanMode===1&&this.handleMouseDownRotate(i),this.isFirstHover=!1}this.hoverRotatePanMode===2?this.handleMouseMovePan(r,Sv):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(r,Sv),this.timerHover=window.setTimeout(()=>{this.isPointerDown=!1},30)}},this.object=e,this.domElement=t,this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.connect(),this.update()}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(yv),this.isFirstHover=!0,this.update(),this.state=-1}resetTo(e,t,r){this.target.copy(e),this.object.position.copy(t),this.object.zoom=r,this.object.updateProjectionMatrix(),this.dispatchEvent(yv),this.update(),this.state=-1}fromJSON(e){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.isFirstHover=!0,this.hoverRotatePanMode!==0&&this.domElement.addEventListener("pointermove",this.onPointerHover),Sv=(e.hoverRotatePanStrength/100)**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,jM=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let t=this.object.getTarget().applyQuaternion(xv.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+t.y,this.maxV=e.panVerticalOffset.max+t.y,this.minH=-e.panHorizontalOffset.min+t.x,this.maxH=e.panHorizontalOffset.max+t.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=vo(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=vo(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=vo(this.spherical.theta-e.rotationHorizontalOffset.min),this.maxTheta=vo(this.spherical.theta+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,this.preventScroll=e.preventScroll,e.orbitTouches===1&&(this.touches[0]=Sn.ROTATE),e.panTouches===1&&(this.touches[0]=Sn.PAN),e.orbitTouches===2&&(this.touches[1]=Sn.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=Sn.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=Sn.ROTATE),e.panTouches===3&&(this.touches[2]=Sn.PAN)}connect(){this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("pointercancel",this.onPointerCancel),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),I0||(this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture)),this.domElement.addEventListener("touchmove",this.onTouchMove),this.domElement.addEventListener("touchend",this.onTouchEnd)}dispose(){this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("pointercancel",this.onPointerCancel),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),I0||(this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture)),this.domElement.removeEventListener("touchmove",this.onTouchMove),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,r,i,n,s,a,o){this.overShoot.set(0,0);let l,h,u;e instanceof F?(l=e.x,h=e.y,this.current.set(this.target.x,this.target.y),u=!0):(l=e.theta,h=e.phi,this.current.set(vo(this.spherical.theta),vo(this.spherical.phi)),u=!1),r===0&&(this.current.x+=l,this.current.y+=h),(t===3||t===2)&&(!u&&this.isThetaFlipped?this.current.x>i&&this.current.x<0?this.overShoot.x=i-this.current.x:this.current.x<n&&this.current.x>0&&(this.overShoot.x=n-this.current.x):this.current.x>i?this.overShoot.x=i-this.current.x:this.current.x<n&&(this.overShoot.x=n-this.current.x),i===n&&(l=0)),(t===3||t===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<a&&(this.overShoot.y=a-this.current.y),s===a&&(h=0)),u||(this.overShoot.x=vo(this.overShoot.x),this.overShoot.y=vo(this.overShoot.y)),r!==0?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),r===1&&(this.overRatio.x=qM(Math.abs(this.overRatio.x)),this.overRatio.y=qM(Math.abs(this.overRatio.y))),this.isPointerDown||r===1?r===2&&(this.overRatio.x>.9||this.overRatio.y>.9)?this.isPointerDown=!1:(l*this.overShoot.x<0&&(l*=1-this.overRatio.x),h*this.overShoot.y<0&&(h*=1-this.overRatio.y)):r===2&&(!u&&(this.overRatio.x>.002||this.overRatio.y>.002)||u&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(l=this.overShoot.x*.05,h=this.overShoot.y*.05,u?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):u?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,h+=this.overShoot.y),e instanceof F?(e.x=l,e.y=h):(e.theta=l,e.phi=h)}setEnableDampingSpeed(e){this.enableDamping=e,bv=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*jM}getZoomScale(){return Math.pow(.95,WM)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let r=this.domElement;if(r&&this.object.isPerspectiveCamera){let i=this.object.position;this.panV.copy(i).sub(this.target);let n=this.panV.length();n*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*n/r.clientHeight,this.object.matrix),this.panUp(2*t*n/r.clientHeight,this.object.matrix)}else r&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/r.clientWidth,this.object.matrix),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/r.clientHeight,this.object.matrix));this.dispatchEvent(hW)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(VM)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(VM)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(xh),this.dollyOut(e),this.dispatchEvent(pc)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(xh),this.dollyIn(e),this.dispatchEvent(pc)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(bv*t).rotateAround(uW,-this.object.angleOffsetFromUp);let r=this.domElement;this.rotateLeft(2*Math.PI*this.rotateDelta.x/r.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/r.clientHeight),this.rotateStart.copy(this.rotateEnd),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(_v*t),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd),this.update()}handleMouseWheel(e){if(zj===!1&&lp(e)===!1&&mW(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(_v),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(zt.length===2){let e=.5*(zt[0].pageX+zt[1].pageX),t=.5*(zt[0].pageY+zt[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(zt[0].pageX,zt[0].pageY)}handleTouchStartPan(){if(zt.length===2){let e=.5*(zt[0].pageX+zt[1].pageX),t=.5*(zt[0].pageY+zt[1].pageY);this.panStart.set(e,t)}else this.panStart.set(zt[0].pageX,zt[0].pageY)}handleTouchStartDolly(){let e=zt[0].pageX-zt[1].pageX,t=zt[0].pageY-zt[1].pageY,r=Math.sqrt(e*e+t*t);this.dollyStart.set(0,r)}handleTouchStartDollyPan(){this.enableZoom&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(zt.length===2){let r=Mv(e),i=.5*(e.pageX+r.x),n=.5*(e.pageY+r.y);this.rotateEnd.set(i,n)}else{if(e.pointerId!==zt[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(bv);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(zt.length===2){let t=Mv(e),r=.5*(e.pageX+t.x),i=.5*(e.pageY+t.y);this.panEnd.set(r,i)}else{if(e.pointerId!==zt[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(_v),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=Mv(e),r=e.pageX-t.x,i=e.pageY-t.y,n=Math.sqrt(r*r+i*i);this.dollyEnd.set(0,n),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,WM)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}};function vo(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function qM(e){return 1-Math.pow(1-e,4)}function mW(e){return e.wheelDeltaY===0||e.deltaY===0?ob&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY:e.deltaMode===0}var zt=[],G0={};function gW(e){zt.push(e)}function YM(e){delete G0[e.pointerId];for(let t=0;t<zt.length;t++)if(zt[t].pointerId===e.pointerId){zt.splice(t,1);return}}function XM(e){let t=G0[e.pointerId];t===void 0&&(t=new $,G0[e.pointerId]=t),t.set(e.pageX,e.pageY)}function Mv(e){let t=e.pointerId===zt[0].pointerId?zt[1]:zt[0];return G0[t.pointerId]}var mb=class extends $z{constructor(){super(),this.layers.enable(3)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e,t=!0,r=[]){return e.forEach(i=>{i.visible&&this.intersectObject(i,t,r)}),r}createRaycastLineHelper(){let e=new ma({color:65280,linewidth:10}),t=new F(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),r=new F(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),i=this.camera.far-this.camera.near,n=new F().addVectors(t,r.multiplyScalar(i)),s=new vt;return s.setFromPoints([t,n]),new D0(s,e)}},vW=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var a,o,l,h,u;let r=Object.assign({},(a=t==null?void 0:t.parameters)!=null?a:{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:0,cornerSegments:8,hollow:0},e.parameters),i=r.width/2,n=(o=r.radiusTop)!=null?o:i,s=(l=r.radiusBottom)!=null?l:i;return n===s?(n=i,s=i):n>s?(n=i,s=s*i/n):(n=n*i/s,s=i),{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((h=r.height)!=null?h:r.width),depth:Math.abs((u=r.depth)!=null?u:r.width),radiusTop:n,radiusBottom:s})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,radiusTop:h,radiusBottom:u,cornerRadius:c,cornerSegments:d,hollow:f}=e.parameters,p;return c||f?p=new c6(h,u,i,n,s,a,o,l*Math.PI/180,c,c,d,f):p=new kw(h,u,i,n,s,a,o,l*Math.PI/180),p.scale(1,1,r/t),Object.assign(p,{userData:qe(me({},e),{type:"CylinderGeometry"})})}};function yo(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function QM(e){return new $(e.y,-e.x)}var c6=class extends vt{constructor(e,t,r,i,n,s,a,o,l,h,u,c,d=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,r=r||1,i=Math.floor(i)||8,n=Math.floor(n)||1,s=s!==void 0?s:!1,a=a!==void 0?a:0,o=o!==void 0?o:Math.PI*2,s&&(l=0,h=0);let f=[],p=[],m=[],g=[],v=0,x=r/2,b=new F,_=new F;d&&e==0&&(e=l),d&&t==0&&(t=h);let E=new $(e,x),S=new $(t,-x),P=null,M=null,B=null,R=null,H=E.clone().sub(S),Q=0,z=0,y=0;c>0&&(Q=Math.min(e,t)*(1-c),z=e-Q,y=t-Q);let A=E.clone();A.x-=Q;let D=Math.PI-H.angle(),O=H.angle(),C=Math.tan(O/2),I=Math.tan(D/2),k=C+I,L=c?k:I,w=c?k:C;if(l=Math.min(l,(e-z)/L,H.length()/k),h=Math.min(h,(t-y)/w,H.length()/k),l>0){let W=l/C;P=E.clone().sub(new $(W,l)),c&&(B=P.clone(),B.x-=Q-k*l),E.sub(H.clone().setLength(W))}if(h>0){let W=h/I;M=S.clone().sub(new $(W,-h)),S.add(H.clone().setLength(W)),c&&(R=M.clone(),R.x-=Q-k*h,A.sub(H.clone().setLength(W)))}H=E.clone().sub(S);let N=H.length()<.5,X=[];for(let W=0;W<=i;W++){let J=[],K=W/i,ie=K*o+a,Z=new $(Math.sin(ie),Math.cos(ie));R&&M?(T(J,K,Z,D,h,R,-1,!0),T(J,K,Z,O,h,M,-1,!1)):M?(U(J,Z,M.x,0,-1),T(J,K,Z,O,h,M,-1,!1)):s||U(J,Z,t,y,-1);let ue=QM(H).normalize();if(yo(ue,Z,b),!N)for(let le=0;le<=n;le++){let ce=le/n,ke=H.clone().multiplyScalar(ce).add(S);yo(ke,Z,_),p.push(_.x,_.y,_.z),m.push(b.x,b.y,b.z),g.push(K,.5+_.y/r),J.push(v++)}if(B&&P?(T(J,K,Z,D,l,P,1,!1),T(J,K,Z,O,l,B,1,!0)):P?(T(J,K,Z,D,l,P,1,!1),U(J,Z,P.x,0,1)):s||U(J,Z,e,z,1),c&&!N){let le=QM(H).multiplyScalar(-1).normalize();yo(le,Z,b);for(let ce=0;ce<=n;ce++){let ke=ce/n,be=H.clone().multiplyScalar(-ke).add(A);yo(be,Z,_),p.push(_.x,_.y,_.z),m.push(b.x,b.y,b.z),g.push(K,.5+_.y/r),J.push(v++)}}c&&!s&&J.push(J[0]),X.push(J)}for(let W=0;W<X.length-1;W++)for(let J=0;J<X[0].length-1;J++){if(s&&c&&J==n)continue;let K=X[W][J],ie=X[W+1][J],Z=X[W+1][J+1],ue=X[W][J+1],le=p[Z*3+0],ce=p[Z*3+2];f.push(K,ie,ue),(le!=0||ce!=0)&&f.push(ie,Z,ue)}o<Math.PI*2&&(q(-1,X[0],a),q(1,X[X.length-1],a+o)),this.setIndex(f),this.setAttribute("position",new Ge(p,3)),this.setAttribute("normal",new Ge(m,3)),this.setAttribute("uv",new Ge(g,2));function T(W,J,K,ie,Z,ue,le,ce){for(let ke=0;ke<u+1;ke++){let be=ke/u,_e=le<0?be:1-be;ce&&(_e-=1),_e*=ie;let ze=new $(Math.sin(_e),Math.cos(_e)*le),Be=ze.clone().multiplyScalar(Z).add(ue);yo(Be,K,_),p.push(_.x,_.y,_.z),yo(ze,K,b),m.push(b.x,b.y,b.z),g.push(J,.5+_.y/r),W.push(v++)}}function U(W,J,K,ie,Z){let ue=new F,le=new $,ce=[K,ie];Z<0&&ce.reverse();for(let ke of ce)le.set(ke,x*Z),yo(le,J,ue),p.push(ue.x,ue.y,ue.z),m.push(0,Z,0),g.push(.5,.5),W.push(v++)}function q(W,J,K){let ie=new $(Math.sin(K),Math.cos(K)),Z=new $(-Math.cos(K),Math.sin(K)),ue=new F,le=W<0?(be,_e,ze)=>f.push(be,_e,ze):(be,_e,ze)=>f.push(be,ze,_e),ce=new $((e+t+z+y)/4,0);yo(ce,ie,ue),p.push(ue.x,ue.y,ue.z),m.push(Z.x,0,Z.y),g.push(.5,.5);let ke=v++;for(let be of J){let _e=p.slice(be*3,be*3+3);p.push(..._e),m.push(Z.x,0,Z.y);let ze=g.slice(be*2,be*2+2);g.push(...ze),v++}for(let be=ke+1;be<v-1;be++)le(ke,be,be+1);le(ke,v-1,ke+1)}}},yW=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:0,cornerRadiusBottom:0,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:r.width)})}}static build(e){let{width:t,depth:r,height:i,radialSegments:n,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,cornerRadiusTop:h,cornerRadiusBottom:u,cornerSegments:c}=e.parameters,d;return h>0||u>0||l<360?d=new c6(0,t/2,i,n,s,a,o,l*Math.PI/180,h,u,c,0,!0):d=new FT(t/2,i,n,s,a),d.scale(1,1,r/t),Object.assign(d,{userData:qe(me({},e),{type:"ConeGeometry"})})}},xW=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:0,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:r.width)})}}static build(e){let{width:t,height:r,depth:i,widthSegments:n,heightSegments:s,depthSegments:a,cornerRadius:o,cornerSegments:l}=e.parameters,h;return o==0?h=new $o(t,r,i,n,s,a):h=new wW(t,r,i,n,s,a,o,l),Object.assign(h,{userData:qe(me({},e),{type:"CubeGeometry"})})}},Av=Math.PI/2,wW=class extends vt{constructor(e=1,t=1,r=1,i=1,n=1,s=1,a=0,o=4){super(),this.type="BoxBufferGeometry";let l=this;i=Math.floor(i),n=Math.floor(n),s=Math.floor(s),o=Math.floor(o),a=Math.min(a,e/2,t/2,r/2);let h=[],u=[],c=[],d=[],f=0,p=0;m("z","y","x",-1,-1,r,t,e,s,n,0),m("z","y","x",1,-1,r,t,-e,s,n,1),m("x","z","y",1,1,e,r,t,i,s,2),m("x","z","y",1,-1,e,r,-t,i,s,3),m("x","y","z",1,-1,e,t,r,i,n,4),m("x","y","z",-1,-1,e,t,-r,i,n,5),a>0&&(g("z","y","x",-1,-1,1,r,t,e,s,0),g("z","y","x",1,-1,-1,r,t,e,s,1),g("z","y","x",-1,1,-1,r,t,e,s,1),g("z","y","x",1,1,1,r,t,e,s,0),g("x","y","z",-1,-1,-1,e,t,r,i,0),g("x","y","z",1,-1,1,e,t,r,i,1),g("x","y","z",-1,1,1,e,t,r,i,0),g("x","y","z",1,1,-1,e,t,r,i,1),g("y","x","z",-1,-1,1,t,e,r,n,0),g("y","x","z",1,-1,-1,t,e,r,n,1),g("y","x","z",1,1,1,t,e,r,n,1),g("y","x","z",-1,1,-1,t,e,r,n,0),v(1,1,1),v(-1,1,1),v(1,-1,1),v(-1,-1,1),v(1,1,-1),v(-1,1,-1),v(1,-1,-1),v(-1,-1,-1)),this.setIndex(h),this.setAttribute("position",new Ge(u,3)),this.setAttribute("normal",new Ge(c,3)),this.setAttribute("uv",new Ge(d,2));function m(x,b,_,E,S,P,M,B,R,H,Q){let z=(P-2*a)/R,y=(M-2*a)/H,A=P/2-a,D=M/2-a,O=B/2,C=R+1,I=H+1,k=0,L=0,w=new F;for(let N=0;N<I;N++){let X=N*y-D;for(let T=0;T<C;T++){let U=T*z-A;w[x]=U*E,w[b]=X*S,w[_]=O,u.push(w.x,w.y,w.z),w[x]=0,w[b]=0,w[_]=B>0?1:-1,c.push(w.x,w.y,w.z),d.push(T/R),d.push(1-N/H),k+=1}}for(let N=0;N<H;N++)for(let X=0;X<R;X++){let T=f+X+C*N,U=f+X+C*(N+1),q=f+(X+1)+C*(N+1),W=f+(X+1)+C*N;h.push(T,U,W),h.push(U,q,W),L+=6}l.addGroup(p,L,Q),p+=L,f+=k}function g(x,b,_,E,S,P,M,B,R,H,Q){let z=(M-2*a)/H,y=M/2-a,A=B/2-a,D=R/2,O=H+1,C=0,I=0,k=new F,L=new F;for(let w=0;w<o+1;w++){let N=w/o*Av,X=Math.sin(N)*a,T=(1-Math.cos(N))*a,U=Math.sin(N),q=Math.cos(N);k[b]=(A+X)*S,k[_]=(D-T)*P,L[x]=0,L[b]=U*Math.sign(k[b]),L[_]=q*Math.sign(k[_]);for(let W=0;W<O;W++){let J=W*z-y;k[x]=J*E,u.push(k.x,k.y,k.z),c.push(L.x,L.y,L.z),d.push(W/H),d.push(0),C+=1}}for(let w=0;w<o;w++)for(let N=0;N<H;N++){let X=f+N+O*w,T=f+N+O*(w+1),U=f+(N+1)+O*(w+1),q=f+(N+1)+O*w;h.push(X,T,q),h.push(T,U,q),I+=6}l.addGroup(p,I,Q),p+=I,f+=C}function v(x,b,_){let E=new F,S=new F(e/2,t/2,r/2);S.subScalar(a);let P=[],M=x*b*_>0?(R,H,Q)=>h.push(R,H,Q):(R,H,Q)=>h.push(R,Q,H);for(let R=0;R<=o;R++){let H=[],Q=Av*(1-R/o),z=Math.cos(Q),y=Math.sin(Q),A=0;for(let D=0;D<=R;D++){let O=Math.cos(A),C=Math.sin(A);E.x=z*O,E.y=y,E.z=z*C;let I=S.clone().addScaledVector(E,a);u.push(x*I.x,b*I.y,_*I.z),c.push(x*E.x,b*E.y,_*E.z),d.push(0,0),H.push(f++),A+=Av/R}P.push(H)}let B=P.length-1;for(let R=0;R<B;R++){let H=P[R],Q=P[R+1],z=H.length-1;M(H[0],Q[1],Q[0]);for(let y=1;y<=z;y++)M(H[y-1],H[y],Q[y]),M(H[y],Q[y+1],Q[y])}}}},gb=class extends vt{constructor(e=[],t=[],r="",i=1,n=.2,s=4){super(),this.type="PolyhedronGeometryRound";let a=[],o=[],l=[];h(),u(),this.setAttribute("position",new Ge(a,3)),this.setAttribute("normal",new Ge(l,3)),this.setAttribute("uv",new Ge(o,2));return;function h(){var O;n=Math.min(1-1e-5,n),n==0&&(s=0);let c={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[r],d=new F,f=d.clone(),p=new Us,m=n*i,g=i-m,v=s+1,x=new F,b=(C,I)=>x.subVectors(C,I).normalize(),_=(C,I)=>Array(C).fill(void 0).map(I),E=_(e.length/3,(C,I)=>new F().fromArray(e,I*3).setLength(i)),S=[],P=1e6;for(let C=0;C<E.length;C++){let I=E[C],k=[],L,w,N,X=1e10,T=-1;for(;(T=t.indexOf(C,T+1))!=-1;){let J=T-T%3;L=t[J+(T+1)%3],w=t[J+(T+2)%3],N=I.distanceToSquared(E[L]),X=Math.min(X,N),k.push([L,w,N])}X+=1e-6;let U=[],q=0,W=k.length;for(let J=0;J<W;J++){[L,w,N]=k[q];let K=((O=S[L])==null?void 0:O.includes(C))==!0;N<=X&&U.push(L+ +K*P),q=k.findIndex(ie=>ie[0]==w)}S.push(U)}let M=[];{let C=0,I=0,k,L,w=c==3;for(let N=0;N<=s;N++){k=N*(N+1)/2,L=(N+1)*(N+2)/2;for(let X=0;X<s-N;X++)[C,I]=[k+X+N+2,L+X+N+3],M.push(k,L,...w?[I,k]:[C,L],I,C),[k,L]=[C,I];M.push(k,L,k+s+2)}}let B=d.clone(),R=d.clone(),H=d.clone(),Q=d.clone(),z=d.clone(),y=[],A=_(E.length,()=>_(c,()=>d.clone()));for(let C=0;C<E.length;C++){d.copy(E[C]).normalize(),B.copy(d).multiplyScalar(g);let I=S[C];for(let U=0;U<I.length;U++){let q=I[U],W=I[(U+1)%c];p.setFromPointsAndIndices(E,C,q%P,W%P),p.b.sub(p.a).setLength(1e10).add(p.a),p.c.sub(p.a).setLength(1e10).add(p.a),p.closestPointToPoint(B,A[C][U])}let k=[],L=[],w=[],N=new F;s==0&&[...A[C]].reduce((U,q)=>U.add(q),N).multiplyScalar(1/c);for(let U=0;U<c;U++){let q=[],W=(U-1+c)%c,J=A[C][W],K=A[C][U];d.copy(J).sub(B),f.copy(K).sub(B);let ie=B.angleTo(d),Z=d.angleTo(f),ue=Math.cos(ie)*m;s==0?R.copy(N):R.copy(B).setLength(g+ue),L.push(ue);let le=[R,J,K];for(let ce=0;ce<2;ce++){let ke=le[ce],be=le[ce+1];Q.subVectors(ke,B),z.subVectors(be,B),H.crossVectors(Q,z).normalize();for(let _e=0;_e<v;_e++){let ze=[ie,Z][ce]*_e/v;d.copy(Q).applyAxisAngle(H,ze).add(B),k.push(d.clone()),ce&&(b(d,B),q.push([_e==0?ke:d.clone(),x.clone()]))}ce&&(b(be,B),q.push([be,x.clone()]))}w.push(q)}y.push(w);let X=2*v,T=2;for(let U=0;U<c;U++){let q=X*U,W=X*((U+1)%c),J=[k[q]];for(let ie=1;ie<v;ie++){Q=k[q+ie],z=k[W+ie],J.push(Q);for(let Z=1,ue=ie-T+1;Z<=ue;Z++)d.lerpVectors(Q,z,Z/(ue+1)),d.sub(B).setLength(L[U]).add(B),J.push(d.clone());J.push(z)}for(let ie=0;ie<v;ie++)J.push(k[ie+v+q]);J.push(k[W+v]);let K=M.map(ie=>J[ie]);a.push(...K.map(ie=>[ie.x,ie.y,ie.z]).flat()),l.push(...K.map(ie=>(b(ie,B),[x.x,x.y,x.z])).flat())}}let D=[];for(let C=0;C<S.length;C++)for(let I=0;I<c;I++){let k=S[C][I];if(k<P){let L=S[k].findIndex(X=>X%P==C),w=y[C][I],N=y[k][L];for(let X=0;X<v;X++){let T=w[X],U=N[v-X],q=w[X+1],W=N[v-(X+1)];[T,U,q,q,U,W].forEach(J=>{a.push(J[0].x,J[0].y,J[0].z),l.push(J[1].x,J[1].y,J[1].z)})}D.push(w[0][0],N[v][0],w[v][0],N[0][0])}}for(;D.length;){let C,I,k,L;[C,I]=D.splice(0,2);let w=[C];for(;C!=I;)w.push(I),k=D.indexOf(I),L=k%2,I=D.splice(k-L,2)[1-L];x.subVectors(w[0],w[1]).cross(d.subVectors(w[0],w[2])).normalize();let N=x.dot(w[0])<0;N&&x.negate();for(let X=1;X<=w.length-2;X++)[w[X+ +N],w[X+1-+N],w[0]].forEach(T=>{a.push(T.x,T.y,T.z),l.push(x.x,x.y,x.z)})}}function u(){let c=new F;for(let S=0;S<a.length;S+=3){c.x=a[S+0],c.y=a[S+1],c.z=a[S+2];let P=_(c)/2/Math.PI+.5,M=E(c)/Math.PI+.5;o.push(P,1-M)}let d=new F,f=new F,p=new F,m=new F,g=new $,v=new $,x=new $,b=(S,P,M,B)=>{B<0&&S.x===1&&(o[P]=S.x-1),M.x===0&&M.z===0&&(o[P]=B/2/Math.PI+.5)};for(let S=0,P=0;S<a.length;S+=9,P+=6){d.set(a[S+0],a[S+1],a[S+2]),f.set(a[S+3],a[S+4],a[S+5]),p.set(a[S+6],a[S+7],a[S+8]),g.set(o[P+0],o[P+1]),v.set(o[P+2],o[P+3]),x.set(o[P+4],o[P+5]),m.copy(d).add(f).add(p).divideScalar(3);let M=_(m);b(g,P+0,d,M),b(v,P+2,f,M),b(x,P+4,p,M)}for(let S=0;S<o.length;S+=6){let P=o[S+0],M=o[S+2],B=o[S+4],R=Math.max(P,M,B),H=Math.min(P,M,B);R>.9&&H<.1&&(P<.2&&(o[S+0]+=1),M<.2&&(o[S+2]+=1),B<.2&&(o[S+4]+=1))}function _(S){return Math.atan2(S.z,-S.x)}function E(S){return Math.atan2(-S.y,Math.sqrt(S.x*S.x+S.z*S.z))}}}static fromJSON(e){return new gb(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},bW=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new d6(t*.5,s,a):new UT(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:qe(me({},e),{type:"DodecahedronGeometry"})})}},d6=class extends gb{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],o="DodecahedronGeometry";super(s,a,o,e,t,r),this.type=o}static fromJSON(e){return new d6(e.radius,e.corner,e.cornerSides)}},mc=1e-12,vb=class{constructor(e){this.position=new $,this.startPosition=new $,this.uuid=kt.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new vb(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},Zy=class extends vb{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new Zy(this.parent).copy(this)}},au=class extends vb{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new Zy(this),new Zy(this))}static create(e,t){let r=new au(e,new $(...t.position));return r.controls[0].position.set(...t.controlPrevious.position),r.controls[1].position.set(...t.controlNext.position),r.roundness=t.roundness,r.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,r}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let r=0,i=this.controls.length;r<i;r++){let n=this.controls[r];this.position.distanceTo(n.position)<=t?n.position.copy(this.position):n.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new au(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var r,i;let e=(r=this.curveBefore)==null?void 0:r.getTangentAt(1),t=(i=this.curveAfter)==null?void 0:i.getTangentAt(0);return[e,t]}computeNormals(e=new $,t=new $){let[r,i]=this.computeTangents();return r&&i&&(JM(r,e),JM(i,t)),[e,t]}computeTangent(e=new $){let[t,r]=this.computeTangents();return t&&r&&e.copy(t).add(r).normalize(),e}computeNormal(e=new $){let[t,r]=this.computeNormals();return e.copy(t).add(r).normalize(),e}};function JM(e,t=new $){let r=e.length();return t.set(-e.y/r,e.x/r)}var yb=e=>e,Vu=new $,Gm=new $,_W=new $,SW=new $,MW=new $,AW=new $,f6=new F,p6=new F;function EW(e){let t=new $;t.addVectors(e.v0,Vu.subVectors(e.v1,e.v0).multiplyScalar(2/3));let r=new $;return r.addVectors(e.v2,Gm.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new qs(e.v0,t,r,e.v2)}function Lc(e,t,r=Number.EPSILON){return Math.abs(e-t)<r}function CW(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function TW(e,t,r=Number.EPSILON){return e.distanceTo(t)<r}function m6(e,t,r){let i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),n=Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),s=Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));return Math.acos((n*n+i*i-s*s)/(2*n*i))}function DW(e,t,r){return ZM(e,t)&&ZM(t,r)&&$y(e.position,t.position,r.position)}function $y(e,t,r){return Vu.copy(t).sub(e).cross(Gm.copy(r).sub(e))===0}function PW(e,t,r,i,n){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(e.y-t.y)/s,h=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return i.set(o+l,a+h),n.set(o-l,a-h),[i,n]}function LW(e,t,r){let i=e.distanceTo(r),n=t.distanceTo(r);return i<n?t:e}function RW(e,t,r,i,n,s){let a=t.x-e.x,o=t.y-e.y,l=r.x-e.x,h=r.y-e.y,u=Math.sqrt((a+l)*(a+l)+(o+h)*(o+h)),c;return m6(t,e,r)>Math.PI&&(u*=-1),Lc(h,o)?c=(o+h)*(i/u-.5)*8/3/(a-l):c=(a+l)*(i/u-.5)*8/3/(h-o),n.set(t.x-c*o,t.y+c*a),s.set(r.x+c*h,r.y-c*l),[n,s]}function KM(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function ZM(e,t){return $y(e.position,e.controls[1].position,t.position)&&$y(e.position,t.controls[0].position,t.position)}function OW(e,t,r,i,n=.5){let s=Vu.subVectors(t,e).multiplyScalar(n).add(e),a=Gm.subVectors(r,t).multiplyScalar(n).add(t),o=_W.subVectors(i,r).multiplyScalar(n).add(r),l=s,h=SW.subVectors(a,s).multiplyScalar(n).add(s),u=MW.subVectors(o,a).multiplyScalar(n).add(a),c=o,d=AW.subVectors(u,h).multiplyScalar(n).add(h);return[e.x,e.y,l.x,l.y,h.x,h.y,d.x,d.y,u.x,u.y,c.x,c.y,i.x,i.y]}function IW(e,t,r=12,i=!0){let n=p6.set(0,0,0),s,a=0;for(let o=0;o<t.length;o++){let l=yb(t[o]),h=Vu,u=Rl(l,r);for(let c=0;c<=u;c++)if(l instanceof qs||l instanceof Vl||l instanceof ra){if(l.getPoint(c/u,h),n.set(h.x,h.y,0),s!==void 0&&TW(s,n))continue;s===void 0&&(s=f6),s.copy(n),e.setXYZ(a,n.x,n.y,n.z),a++}}return i&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),e}function NW(e,t,r,i=12,n=!0){let s=p6.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){if(r[l]===!1)continue;let h,u=yb(t[l]),c=Vu,d=Rl(u,i);o.push(d);for(let f=0;f<=d;f++)if(u instanceof qs||u instanceof Vl||u instanceof ra){if(u.getPoint(f/d,c),s.set(c.x,c.y,0),h==null?void 0:h.equals(s))continue;h===void 0?h=f6:(e.setXYZ(a,h.x,h.y,h.z),a++,e.setXYZ(a,s.x,s.y,s.z),a++),h.copy(s)}}return n&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),o}function $M(e,t=12,r=!1){let i=[];for(let n=0,s=e.length;n<s;n++){let a=e[n],o=0;if(r&&a.roundedCurveCorner!==void 0){let l=Rl(a.roundedCurveCorner,t)*.5;n>0&&(i[n-1]+=l),o+=l}a.curveAfter!==void 0&&(o+=Rl(a.curveAfter,t)),i.push(o)}return e.length>0&&r&&e[0].roundedCurveCorner!==void 0&&(i[e.length-1]+=Rl(e[0].roundedCurveCorner,t)*.5),i}function Rl(e,t=12){return e&&e instanceof Cm?t*2:e&&(e instanceof ra||e instanceof kT)?1:e&&e instanceof Bw?t*e.points.length:t}function BW(e,t,r=12,i=!0){let n,s=0;for(let a=0;a<t.length;a++){let o=yb(t[a]),l=Rl(o,r),h=Vu;for(let u=0;u<=l;u++)if(o instanceof qs||o instanceof Vl||o instanceof ra){if(o.getPoint(u/l,h),n!==void 0&&CW(n,h,mc))continue;n===void 0&&(n=Gm),n.copy(h),e.push(h.x,h.y),s++}}return Lc(e[0],e[e.length-2],mc)&&Lc(e[1],e[e.length-1],mc)&&(e.pop(),e.pop()),i&&s>1&&!(Lc(e[s-1],e[1],mc)&&Lc(e[s-2],e[0],mc))&&(e.push(e[0],e[1]),s++),e}var Ev=new $,kW=new $,zW=new $,FW=new $,UW=new $,HW=new $,yr=class extends Pl{constructor(e=100,t=100){super(),this.points=[],this.shapeHoles=[],this.eventDispatcher=new nn,this.plane=new Ns(new F(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=kt.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,r){let i=new yr;return i.isClosed=e.isClosed,i.points=e.points.map(n=>au.create(n.id,n.data)),typeof e.roundness=="number"&&(i.roundness=e.roundness),i.shapeHoles=e.shapeHoles.map(n=>yr.createFromState(n)),t!==void 0&&r!==void 0&&i.applySize(t,r),i.update(),i}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,r=this.points.length;t<r;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(t=>this.getPointIndexById(t)).filter(t=>t>=0)}getPointIndexById(e){let t=this.points.length,r=this.points.findIndex(i=>i.uuid===e);if(r<0){let i=t;for(let n=0,s=this.shapeHoles.length;n<s;n++){let a=this.shapeHoles[n],o=a.points.length-1,l=a.getPointIndexById(e);if(l<0)i+=o;else return l+i}}return r}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0)for(let t=0,r=this.shapeHoles.length;t<r;t++){let i=this.shapeHoles[t],n=e-this.points.length;if(n<=i.points.length-1)return i.points[n]}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let r=0,i=this.shapeHoles.length;r<i;r++){let n=this.shapeHoles[r],s=n.points.indexOf(e);if(s>=0)return t+s;t+=n.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(t=>t.points));return[...this.points,...e]}applySize(e,t){e===0&&(e=.001),t===0&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let r=Ev.set(e,t);for(let i=0,n=this.points.length;i<n;i++){let s=this.points[i];s.position.multiply(r),s.controls[0].position.multiply(r),s.controls[1].position.multiply(r)}for(let i=0,n=this.shapeHoles.length;i<n;i++)this.shapeHoles[i].applyScale(e,t);this._update(!1)}createPoint(e,t=0,r=kt.generateUUID()){let i;e instanceof $?i=e:i=new $(e,t);let n=new au(r,i);return n.roundness=this.roundness,n}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,r=this.points.length;t<r;t++){let i=this.points[t];if(i.uuid===e)return i}for(let t=0,r=this.shapeHoles.length;t<r;t++){let i=this.shapeHoles[t].getPointByUuid(e);if(i)return i}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(r=>r.uuid===e);t&&this.removePoint(t)}update(e=!0){for(let t=0,r=this.shapeHoles.length;t<r;t++)this.shapeHoles[t].update(!1);this._update(e)}extractShapePointsToBuffer(e,t=12,r=!1){this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t);let i=r?this.roundedCurveDivisions:this.curveDivisions;return IW(e,r?this.roundedCurves:this.curves,t,this.autoClose),i.reduce((n,s)=>n+s,0)+1}computeCurveDivisions(e=12){return this.curveDivisions=$M(this.points,e,!1),this.roundedCurveDivisions=$M(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t,r=12){return NW(e,this.curves,t,r,this.autoClose).reduce((i,n)=>i+n,0)*2}extractShapePointsToFlatArray(e,t=12){return this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t),BW(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e,t=!1){let r=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let i=t?this.roundedCurveDivisions:this.curveDivisions,n=0;t&&this.points[0].roundedCurveCorner!==void 0&&(n=Rl(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=e-n;s<0&&(s+=i.reduce((a,o)=>a+o,0));for(let a=0,o=i.length;a<o;a++){let l=i[a];if(s<r+l)return[a,(s-r+1)/l];r+=l}return[0,1]}getCurveT(e,t,r){let i=this.points[e],n=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,a=s[e];if(KM(i,n)){let l=i.position.distanceTo(n.position);return i.position.distanceTo(Ev.set(r.x,r.y))/l}let o=0;for(let l=0;l<e;l++)o+=s[l];return(t-o)/a}dispose(){this.eventDispatcher=null}_applyCurveForPoint(e,t){KM(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let r=this.curves[this.curves.length-1];e.curveBefore=r,t.curveAfter=r;let i=r.clone();e.roundedCurveBefore=i,t.roundedCurveAfter=i,e.roundedCurveCorner=void 0,this.roundedCurves.push(i)}_update(e=!0){var r,i,n;if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let s=0,a=this.points.length;s<a;s++){let o=this.points[s];if(s===0)this.moveTo(o.position.x,o.position.y);else{let l=this.points[s-1];this._applyCurveForPoint(o,l)}}let t=this.getLastPoint();if(t!=null&&t.curveAfter&&(t.curveAfter=void 0),this.isClosed){let s=this.points[0],a=this.points[this.points.length-1];this._applyCurveForPoint(s,a)}if(this.points.length>2){let s=0;for(let a=0,o=this.points.length;a<o;a++){let l=this.points[a],h=(r=this.points[a-1])!=null?r:this.points[this.points.length-1],u=(i=this.points[a+1])!=null?i:this.points[0],c=l.roundness,d=h&&u&&DW(h,l,u);if(!l.controlsMoved()&&c>0&&!d){let f=l.curveBefore,p=l.curveAfter;if(f===void 0||p===void 0)continue;let m=l.roundedCurveBefore,g=l.roundedCurveAfter,v=f.getLength(),x=p.getLength(),b=Math.min(c,v*.499),_=Math.min(c,x*.499),E=Math.min(b,_),S=1-E/v,P=E/x,M=f.getPointAt(S,Ev),B=p.getPointAt(P,kW);this._subSplitCurve(f,m,S,M,void 0),this._subSplitCurve(p,g,P,void 0,B);let R;if(this.useCubicForRoundedCorners){let H=m6(M,l.position,B)/2,Q=Math.tan(H)*M.distanceTo(l.position),[z,y]=PW(M,B,Q,zW,FW),A=LW(z,y,l.position),[D,O]=RW(A,M,B,Q,UW,HW);R=new qs(M.clone(),D.clone(),O.clone(),B.clone())}else R=new Vl(M.clone(),l.position.clone(),B.clone());l.roundedCurveCorner=R,this.roundedCurves.splice(a+s,0,R),s++}}}e&&((n=this.eventDispatcher)==null||n.dispatchEvent({type:"update"}))}_subSplitCurve(e,t,r,i,n){if(e instanceof ra)i!==void 0&&t.v2.copy(i),n!==void 0&&t.v1.copy(n);else{let s=e,a=t,o=s.getUtoTmapping(r,0),l=OW(s.v0,s.v1,s.v2,s.v3,o);return i!==void 0&&(a.v0.set(l[0],l[1]),a.v1.set(l[2],l[3]),a.v2.set(l[4],l[5]),a.v3.set(l[6],l[7])),n!==void 0&&(a.v0.set(l[6],l[7]),a.v1.set(l[8],l[9]),a.v2.set(l[10],l[11]),a.v3.set(l[12],l[13])),a}return t}clone(){let e=new yr(this._width,this._height);return e.points=this.points.map(t=>t.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(t=>t.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var r;this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let i=0;i<t;i++){let n=i*7,s=e.points[n+0],a=e.points[n+1],o=e.points[n+2],l=e.points[n+3],h=e.points[n+4],u=e.points[n+5],c=e.points[n+6],d=new au(kt.generateUUID(),new $(s,a));d.controls[0].position.set(o,l),d.controls[1].position.set(h,u),d.roundness=c,this.points.push(d)}return this.shapeHoles=(r=e.shapeHoles)!=null&&r.length?e.shapeHoles.map(i=>{let n=new yr;return n.fromJSON(i),n}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e){let t=(i,n)=>{n instanceof qs&&n.v3.equals(i.position)&&i.controls[0].position.copy(n.v2)},r=i=>{let n=[],s,a;for(s=0,a=i.length;s<a;s++)i[s]instanceof Vl&&(i[s]=EW(i[s]));for(s=0,a=i.length;s<a;s++){let h=i[s],u=s>0?i[s-1]:null,c;h instanceof qs?(c=this.createPoint(h.v0),c.controls[1].position.copy(h.v1)):h instanceof ra&&(c=this.createPoint(h.v1)),c!==void 0&&(u!==null&&t(c,u),n.push(c))}let o=i[i.length-1],l=!1;return o instanceof qs?o.v3.equals(n[0].position)&&(n[0].controls[0].position.copy(o.v2),l=!0):o instanceof ra&&o.v2.equals(n[0].position)&&(l=!0),this.isClosed=l,n};return this.points=r(e.curves),e instanceof Pl&&(this.shapeHoles=e.holes.map(i=>{let n=new yr;return n.fromShape(i),n})),this.update(),this}},ex=Math.PI*2;function Cv({x:e,y:t},r,i,n,s){return{x:e*r+n,y:t*i+s}}function GW(e,t){let r=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),i=Math.cos(e),n=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[{x:i-n*r,y:n+i*r},{x:s+a*r,y:a-s*r},{x:s,y:a}]}function eA(e,t,r,i){let n=e*i-t*r<0?-1:1,s=Math.min(1,Math.max(-1,e*r+t*i));return n*Math.acos(s)}function VW(e,t,r,i,n,s,a,o,l,h){let u=Math.pow(n,2),c=Math.pow(s,2),d=Math.pow(a,2),f=Math.pow(o,2),p=u*c-u*f-c*d;p<0&&(p=0),p/=u*f+c*d,p=Math.sqrt(p)*(l===h?-1:1);let m=p*n/s*o,g=p*-s/n*a,v=m+(e+r)/2,x=g+(t+i)/2,b=(a-m)/n,_=(o-g)/s,E=(-a-m)/n,S=(-o-g)/s,P=eA(1,0,b,_),M=eA(b,_,E,S);return!h&&M>0&&(M-=ex),h&&M<0&&(M+=ex),{centerx:v,centery:x,ang1:P,ang2:M}}function jW({px:e,py:t,cx:r,cy:i,rx:n,ry:s,largeArcFlag:a,sweepFlag:o}){let l=[];if(n===0||s===0)return[];let h=(e-r)/2,u=(t-i)/2;if(h===0&&u===0)return[];n=Math.abs(n),s=Math.abs(s);let c=Math.pow(h,2)/Math.pow(n,2)+Math.pow(u,2)/Math.pow(s,2);c>1&&(n*=Math.sqrt(c),s*=Math.sqrt(c));let d=VW(e,t,r,i,n,s,h,u,a,o),{ang1:f,ang2:p}=d,{centerx:m,centery:g}=d,v=Math.abs(p)/(ex/4);Math.abs(1-v)<1e-7&&(v=1);let x=Math.max(Math.ceil(v),1);p/=x;for(let b=0;b<x;b++)l.push(GW(f,p)),f+=p;return l.map(b=>{let{x:_,y:E}=Cv(b[0],n,s,m,g),{x:S,y:P}=Cv(b[1],n,s,m,g),{x:M,y:B}=Cv(b[2],n,s,m,g);return{x1:_,y1:E,x2:S,y2:P,x:M,y:B}})}var xr;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(xr||(xr={}));var ei;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(ei||(ei={}));function ot(e,t){if(!e)throw t||"Assertion Failed!"}var rt=function(){function e(){}return e.vertEq=function(t,r){return t.s===r.s&&t.t===r.t},e.vertLeq=function(t,r){return t.s<r.s||t.s===r.s&&t.t<=r.t},e.transLeq=function(t,r){return t.t<r.t||t.t===r.t&&t.s<=r.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,r){return Math.abs(t.s-r.s)+Math.abs(t.t-r.t)},e.edgeEval=function(t,r,i){ot(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?n<s?r.t-t.t+(t.t-i.t)*(n/(n+s)):r.t-i.t+(i.t-t.t)*(s/(n+s)):0},e.edgeSign=function(t,r,i){ot(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?(r.t-i.t)*n+(r.t-t.t)*s:0},e.transEval=function(t,r,i){ot(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?n<s?r.s-t.s+(t.s-i.s)*(n/(n+s)):r.s-i.s+(i.s-t.s)*(s/(n+s)):0},e.transSign=function(t,r,i){ot(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?(r.s-i.s)*n+(r.s-t.s)*s:0},e.vertCCW=function(t,r,i){return t.s*(r.t-i.t)+r.s*(i.t-t.t)+i.s*(t.t-r.t)>=0},e.interpolate=function(t,r,i,n){return t=t<0?0:t,i=i<0?0:i,t<=i?i===0?(r+n)/2:r+(n-r)*(t/(t+i)):n+(r-n)*(i/(t+i))},e.intersect=function(t,r,i,n,s){var a,o,l;e.vertLeq(t,r)||(l=t,t=r,r=l),e.vertLeq(i,n)||(l=i,i=n,n=l),e.vertLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.vertLeq(i,r)?e.vertLeq(r,n)?(a=e.edgeEval(t,i,r),o=e.edgeEval(i,r,n),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,r.s)):(a=e.edgeSign(t,i,r),o=-e.edgeSign(t,n,r),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,i.s,o,n.s)):s.s=(i.s+r.s)/2,e.transLeq(t,r)||(l=t,t=r,r=l),e.transLeq(i,n)||(l=i,i=n,n=l),e.transLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.transLeq(i,r)?e.transLeq(r,n)?(a=e.transEval(t,i,r),o=e.transEval(i,r,n),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,r.t)):(a=e.transSign(t,i,r),o=-e.transSign(t,n,r),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,i.t,o,n.t)):s.t=(i.t+r.t)/2},e}(),gc=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),up=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),Ch=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),tA=function(){function e(){var t=new Ch,r=new gc,i=new up(0),n=new up(1);t.next=t.prev=t,t.anEdge=null,r.next=r.prev=r,i.next=i,i.Sym=n,n.next=n,n.Sym=i,this.vHead=t,this.fHead=r,this.eHead=i,this.eHeadSym=n}return e.prototype.makeEdge_=function(t){var r=new up(0),i=new up(1);t.Sym.side<t.side&&(t=t.Sym);var n=t.Sym.next;return i.next=n,n.Sym.next=r,r.next=t,t.Sym.next=i,r.Sym=i,r.Onext=r,r.Lnext=i,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,i.Sym=r,i.Onext=i,i.Lnext=r,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,r},e.prototype.splice_=function(t,r){var i=t.Onext,n=r.Onext;i.Sym.Lnext=r,n.Sym.Lnext=t,t.Onext=n,r.Onext=i},e.prototype.makeVertex_=function(t,r,i){var n=t;ot(n,"Vertex can't be null!");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r;var a=r;do a.Org=n,a=a.Onext;while(a!==r)},e.prototype.makeFace_=function(t,r,i){var n=t;ot(n,"Face can't be null");var s=i.prev;n.prev=s,s.next=n,n.next=i,i.prev=n,n.anEdge=r,n.trail=null,n.marked=!1,n.inside=i.inside;var a=r;do a.Lface=n,a=a.Lnext;while(a!==r)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var r=t.next,i=t.Sym.next;r.Sym.next=i,i.Sym.next=r},e.prototype.killVertex_=function(t,r){var i=t.anEdge,n=i;do n.Org=r,n=n.Onext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.killFace_=function(t,r){var i=t.anEdge,n=i;do n.Lface=r,n=n.Lnext;while(n!==i);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.makeEdge=function(){var t=new Ch,r=new Ch,i=new gc,n=this.makeEdge_(this.eHead);return this.makeVertex_(t,n,this.vHead),this.makeVertex_(r,n.Sym,this.vHead),this.makeFace_(i,n,this.fHead),n},e.prototype.splice=function(t,r){var i=!1,n=!1;if(t!==r){if(r.Org!==t.Org&&(n=!0,this.killVertex_(r.Org,t.Org)),r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(r,t),!n){var s=new Ch;this.makeVertex_(s,r,t.Org),t.Org.anEdge=t}if(!i){var a=new gc;this.makeFace_(a,r,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var r=t.Sym,i=!1;if(t.Lface!==t.Rface&&(i=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!i){var n=new gc;this.makeFace_(n,t,t.Lface)}r.Onext===r?(this.killVertex_(r.Org,null),this.killFace_(r.Lface,null)):(t.Lface.anEdge=r.Oprev,r.Org.anEdge=r.Onext,this.splice_(r,r.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var r=this.makeEdge_(t),i=r.Sym;this.splice_(r,t.Lnext),r.Org=t.Dst;var n=new Ch;return this.makeVertex_(n,i,r.Org),r.Lface=i.Lface=t.Lface,r},e.prototype.splitEdge=function(t){var r=this.addEdgeVertex(t),i=r.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,i),t.Dst=i.Org,i.Dst.anEdge=i.Sym,i.Rface=t.Rface,i.winding=t.winding,i.Sym.winding=t.Sym.winding,i.idx=t.idx,i.Sym.idx=t.Sym.idx,i},e.prototype.connect=function(t,r){var i=!1,n=this.makeEdge_(t),s=n.Sym;if(r.Lface!==t.Lface&&(i=!0,this.killFace_(r.Lface,t.Lface)),this.splice_(n,t.Lnext),this.splice_(s,r),n.Org=t.Dst,s.Org=r.Org,n.Lface=s.Lface=t.Lface,t.Lface.anEdge=s,!i){var a=new gc;this.makeFace_(a,n,t.Lface)}return n},e.prototype.zapFace=function(t){var r=t.anEdge,i,n,s,a,o;n=r.Lnext;do i=n,n=i.Lnext,i.Lface=null,i.Rface===null&&(i.Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),s=i.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(i));while(i!=r);a=t.prev,o=t.next,o.prev=a,a.next=o},e.prototype.countFaceVerts_=function(t){var r=t.anEdge,i=0;do i++,r=r.Lnext;while(r!==t.anEdge);return i},e.prototype.mergeConvexFaces=function(t){var r,i,n,s,a,o,l;for(r=this.fHead.next;r!==this.fHead;r=r.next)if(r.inside)for(i=r.anEdge,a=i.Org;n=i.Lnext,s=i.Sym,s&&s.Lface&&s.Lface.inside&&(o=this.countFaceVerts_(r),l=this.countFaceVerts_(s.Lface),o+l-2<=t&&rt.vertCCW(i.Lprev.Org,i.Org,s.Lnext.Lnext.Org)&&rt.vertCCW(s.Lprev.Org,s.Org,i.Lnext.Lnext.Org)&&(n=s.Lnext,this.delete(s),i=null,s=null)),!(i&&i.Lnext.Org===a);)i=n;return!0},e.prototype.check=function(){var t=this.fHead,r=this.vHead,i=this.eHead,n,s,a,o,l,h;for(s=t,s=t;(n=s.next)!==t;s=n){ot(n.prev===s),l=n.anEdge;do ot(l.Sym!==l),ot(l.Sym.Sym===l),ot(l.Lnext.Onext.Sym===l),ot(l.Onext.Sym.Lnext===l),ot(l.Lface===n),l=l.Lnext;while(l!==n.anEdge)}for(ot(n.prev===s&&n.anEdge===null),o=r,o=r;(a=o.next)!==r;o=a){ot(a.prev===o),l=a.anEdge;do ot(l.Sym!==l),ot(l.Sym.Sym===l),ot(l.Lnext.Onext.Sym===l),ot(l.Onext.Sym.Lnext===l),ot(l.Org===a),l=l.Onext;while(l!==a.anEdge)}for(ot(a.prev===o&&a.anEdge===null),h=i,h=i;(l=h.next)!==i;h=l)ot(l.Sym.next===h.Sym),ot(l.Sym!==l),ot(l.Sym.Sym===l),ot(l.Org!==null),ot(l.Dst!==null),ot(l.Lnext.Onext.Sym===l),ot(l.Onext.Sym.Lnext===l);ot(l.Sym.next===h.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),rA=function(){function e(){this.handle=null}return e}(),iA=function(){function e(){this.key=null,this.node=0}return e}(),WW=function(){function e(t,r){this.leq=r,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var i=0;i<t+1;i++)this.nodes[i]=new rA,this.handles[i]=new iA;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t<<1,a<this.size&&this.leq(i[r[a+1].handle].key,i[r[a].handle].key)&&++a,ot(a<=this.max),s=r[a].handle,a>this.size||this.leq(i[n].key,i[s].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.floatUp_=function(t){var r=this.nodes,i=this.handles,n,s,a;for(n=r[t].handle;;){if(a=t>>1,s=r[a].handle,a===0||this.leq(i[s].key,i[n].key)){r[t].handle=n,i[n].node=t;break}r[t].handle=s,i[s].node=t,t=a}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var r,i;if(r=++this.size,r*2>this.max){this.max*=2;var n,s;for(s=this.nodes.length,this.nodes.length=this.max+1,n=s;n<this.nodes.length;n++)this.nodes[n]=new rA;for(s=this.handles.length,this.handles.length=this.max+1,n=s;n<this.handles.length;n++)this.handles[n]=new iA}return this.freeList===0?i=r:(i=this.freeList,this.freeList=this.handles[i].node),this.nodes[r].handle=i,this.handles[i].node=r,this.handles[i].key=t,this.initialized&&this.floatUp_(r),i},e.prototype.extractMin=function(){var t=this.nodes,r=this.handles,i=t[1].handle,n=r[i].key;return this.size>0&&(t[1].handle=t[this.size].handle,r[t[1].handle].node=1,r[i].key=null,r[i].node=this.freeList,this.freeList=i,--this.size,this.size>0&&this.floatDown_(1)),n},e.prototype.delete=function(t){var r=this.nodes,i=this.handles,n;ot(t>=1&&t<=this.max&&i[t].key!==null),n=i[t].node,r[n].handle=r[this.size].handle,i[r[n].handle].node=n,--this.size,n<=this.size&&(n<=1||this.leq(i[r[n>>1].handle].key,i[r[n].handle].key)?this.floatDown_(n):this.floatUp_(n)),i[t].key=null,i[t].node=this.freeList,this.freeList=t},e}(),Tv=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),nA=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),qW=function(){function e(t,r){this.frame=t,this.leq=r,this.head=new nA,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var r=this.head;do r=r.next;while(r.key!==null&&!this.leq(this.frame,t,r.key));return r},e.prototype.insertBefore=function(t,r){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,r));var i=new nA;return i.key=r,i.next=t.next,t.next.prev=i,i.prev=t,t.next=i,i},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),YW=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.edgeLeq=function(t,r,i){var n=t.event,s=r.eUp,a=i.eUp;if(s.Dst===n)return a.Dst===n?rt.vertLeq(s.Org,a.Org)?rt.edgeSign(a.Dst,s.Org,a.Org)<=0:rt.edgeSign(s.Dst,a.Org,s.Org)>=0:rt.edgeSign(a.Dst,n,a.Org)<=0;if(a.Dst===n)return rt.edgeSign(s.Dst,n,s.Org)>=0;var o=rt.edgeEval(s.Dst,n,s.Org),l=rt.edgeEval(a.Dst,n,a.Org);return o>=l},e.deleteRegion=function(t,r){r.fixUpperEdge&&ot(r.eUp.winding===0),r.eUp.activeRegion=null,t.dict.delete(r.nodeUp)},e.fixUpperEdge=function(t,r,i){ot(r.fixUpperEdge),t.mesh.delete(r.eUp),r.fixUpperEdge=!1,r.eUp=i,i.activeRegion=r},e.topLeftRegion=function(t,r){var i=r.eUp.Org,n;do r=e.regionAbove(r);while(r.eUp.Org===i);if(r.fixUpperEdge){if(n=t.mesh.connect(e.regionBelow(r).eUp.Sym,r.eUp.Lnext),n===null)return null;e.fixUpperEdge(t,r,n),r=e.regionAbove(r)}return r},e.topRightRegion=function(t){var r=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===r);return t},e.addRegionBelow=function(t,r,i){var n=new Tv;return n.eUp=i,n.nodeUp=t.dict.insertBefore(r.nodeUp,n),n.fixUpperEdge=!1,n.sentinel=!1,n.dirty=!1,i.activeRegion=n,n},e.isWindingInside=function(t,r){switch(t.windingRule){case xr.ODD:return(r&1)!==0;case xr.NONZERO:return r!==0;case xr.POSITIVE:return r>0;case xr.NEGATIVE:return r<0;case xr.ABS_GEQ_TWO:return r>=2||r<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,r){r.windingNumber=e.regionAbove(r).windingNumber+r.eUp.winding,r.inside=e.isWindingInside(t,r.windingNumber)},e.finishRegion=function(t,r){var i=r.eUp,n=i.Lface;n.inside=r.inside,n.anEdge=i,e.deleteRegion(t,r)},e.finishLeftRegions=function(t,r,i){for(var n,s=null,a=r,o=r.eUp;a!==i;){if(a.fixUpperEdge=!1,s=e.regionBelow(a),n=s.eUp,n.Org!=o.Org){if(!s.fixUpperEdge){e.finishRegion(t,a);break}n=t.mesh.connect(o.Lprev,n.Sym),e.fixUpperEdge(t,s,n)}o.Onext!==n&&(t.mesh.splice(n.Oprev,n),t.mesh.splice(o,n)),e.finishRegion(t,a),o=s.eUp,a=s}return o},e.addRightEdges=function(t,r,i,n,s,a){var o,l,h,u,c=!0;h=i;do ot(rt.vertLeq(h.Org,h.Dst)),e.addRegionBelow(t,r,h.Sym),h=h.Onext;while(h!==n);for(s===null&&(s=e.regionBelow(r).eUp.Rprev),l=r,u=s;o=e.regionBelow(l),h=o.eUp.Sym,h.Org===u.Org;)h.Onext!==u&&(t.mesh.splice(h.Oprev,h),t.mesh.splice(u.Oprev,h)),o.windingNumber=l.windingNumber-h.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!c&&e.checkForRightSplice(t,l)&&(e.addWinding(h,u),e.deleteRegion(t,l),t.mesh.delete(u)),c=!1,l=o,u=h;l.dirty=!0,ot(l.windingNumber-h.winding===o.windingNumber),a&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,r,i){t.mesh.splice(r,i)},e.vertexWeights=function(t,r,i){var n=rt.vertL1dist(r,t),s=rt.vertL1dist(i,t),a=.5*s/(n+s),o=.5*n/(n+s);t.coords[0]+=a*r.coords[0]+o*i.coords[0],t.coords[1]+=a*r.coords[1]+o*i.coords[1],t.coords[2]+=a*r.coords[2]+o*i.coords[2]},e.getIntersectData=function(t,r,i,n,s,a){r.coords[0]=r.coords[1]=r.coords[2]=0,r.idx=-1,e.vertexWeights(r,i,n),e.vertexWeights(r,s,a)},e.checkForRightSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp;if(rt.vertLeq(n.Org,s.Org)){if(rt.edgeSign(s.Dst,n.Org,s.Org)>0)return!1;rt.vertEq(n.Org,s.Org)?n.Org!==s.Org&&(t.pq.delete(n.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,n)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(n,s.Oprev),r.dirty=i.dirty=!0)}else{if(rt.edgeSign(n.Dst,s.Org,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Oprev,n)}return!0},e.checkForLeftSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a;if(ot(!rt.vertEq(n.Dst,s.Dst)),rt.vertLeq(n.Dst,s.Dst)){if(rt.edgeSign(n.Dst,s.Dst,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,a=t.mesh.splitEdge(n),t.mesh.splice(s.Sym,a),a.Lface.inside=r.inside}else{if(rt.edgeSign(s.Dst,n.Dst,s.Org)>0)return!1;r.dirty=i.dirty=!0,a=t.mesh.splitEdge(s),t.mesh.splice(n.Lnext,s.Sym),a.Rface.inside=r.inside}return!0},e.checkForIntersect=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp,a=n.Org,o=s.Org,l=n.Dst,h=s.Dst,u,c,d=new Ch,f,p;if(ot(!rt.vertEq(h,l)),ot(rt.edgeSign(l,t.event,a)<=0),ot(rt.edgeSign(h,t.event,o)>=0),ot(a!==t.event&&o!==t.event),ot(!r.fixUpperEdge&&!i.fixUpperEdge),a===o||(u=Math.min(a.t,l.t),c=Math.max(o.t,h.t),u>c))return!1;if(rt.vertLeq(a,o)){if(rt.edgeSign(h,a,o)>0)return!1}else if(rt.edgeSign(l,o,a)<0)return!1;return e.debugEvent(t),rt.intersect(l,a,h,o,d),ot(Math.min(a.t,l.t)<=d.t),ot(d.t<=Math.max(o.t,h.t)),ot(Math.min(h.s,l.s)<=d.s),ot(d.s<=Math.max(o.s,a.s)),rt.vertLeq(d,t.event)&&(d.s=t.event.s,d.t=t.event.t),f=rt.vertLeq(a,o)?a:o,rt.vertLeq(f,d)&&(d.s=f.s,d.t=f.t),rt.vertEq(d,a)||rt.vertEq(d,o)?(e.checkForRightSplice(t,r),!1):!rt.vertEq(l,t.event)&&rt.edgeSign(l,t.event,d)>=0||!rt.vertEq(h,t.event)&&rt.edgeSign(h,t.event,d)<=0?h===t.event?(t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Sym,n),r=e.topLeftRegion(t,r),n=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),i),e.addRightEdges(t,r,n.Oprev,n,n,!0),!0):l===t.event?(t.mesh.splitEdge(s.Sym),t.mesh.splice(n.Lnext,s.Oprev),i=r,r=e.topRightRegion(r),p=e.regionBelow(r).eUp.Rprev,i.eUp=s.Oprev,s=e.finishLeftRegions(t,i,null),e.addRightEdges(t,r,s.Onext,n.Rprev,p,!0),!0):(rt.edgeSign(l,t.event,d)>=0&&(e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),n.Org.s=t.event.s,n.Org.t=t.event.t),rt.edgeSign(h,t.event,d)<=0&&(r.dirty=i.dirty=!0,t.mesh.splitEdge(s.Sym),s.Org.s=t.event.s,s.Org.t=t.event.t),!1):(t.mesh.splitEdge(n.Sym),t.mesh.splitEdge(s.Sym),t.mesh.splice(s.Oprev,n),n.Org.s=d.s,n.Org.t=d.t,n.Org.pqHandle=t.pq.insert(n.Org),e.getIntersectData(t,n.Org,a,l,o,h),e.regionAbove(r).dirty=r.dirty=i.dirty=!0,!1)},e.walkDirtyRegions=function(t,r){for(var i=e.regionBelow(r),n,s;;){for(;i.dirty;)r=i,i=e.regionBelow(i);if(!r.dirty&&(i=r,r=e.regionAbove(r),r===null||!r.dirty))return;if(r.dirty=!1,n=r.eUp,s=i.eUp,n.Dst!==s.Dst&&e.checkForLeftSplice(t,r)&&(i.fixUpperEdge?(e.deleteRegion(t,i),t.mesh.delete(s),i=e.regionBelow(r),s=i.eUp):r.fixUpperEdge&&(e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i),n=r.eUp)),n.Org!==s.Org)if(n.Dst!==s.Dst&&!r.fixUpperEdge&&!i.fixUpperEdge&&(n.Dst===t.event||s.Dst===t.event)){if(e.checkForIntersect(t,r))return}else e.checkForRightSplice(t,r);n.Org===s.Org&&n.Dst===s.Dst&&(e.addWinding(s,n),e.deleteRegion(t,r),t.mesh.delete(n),r=e.regionAbove(i))}},e.connectRightVertex=function(t,r,i){var n,s=i.Onext,a=e.regionBelow(r),o=r.eUp,l=a.eUp,h=!1;if(o.Dst!==l.Dst&&e.checkForIntersect(t,r),rt.vertEq(o.Org,t.event)&&(t.mesh.splice(s.Oprev,o),r=e.topLeftRegion(t,r),s=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),a),h=!0),rt.vertEq(l.Org,t.event)&&(t.mesh.splice(i,l.Oprev),i=e.finishLeftRegions(t,a,null),h=!0),h){e.addRightEdges(t,r,i.Onext,s,s,!0);return}rt.vertLeq(l.Org,o.Org)?n=l.Oprev:n=o,n=t.mesh.connect(i.Lprev,n),e.addRightEdges(t,r,n,n.Onext,n.Onext,!1),n.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,r)},e.connectLeftDegenerate=function(t,r,i){var n,s,a,o,l;if(n=r.eUp,rt.vertEq(n.Org,i)){ot(!1),e.spliceMergeVertices(t,n,i.anEdge);return}if(!rt.vertEq(n.Dst,i)){t.mesh.splitEdge(n.Sym),r.fixUpperEdge&&(t.mesh.delete(n.Onext),r.fixUpperEdge=!1),t.mesh.splice(i.anEdge,n),e.sweepEvent(t,i);return}ot(!1),r=e.topRightRegion(r),l=e.regionBelow(r),a=l.eUp.Sym,s=o=a.Onext,l.fixUpperEdge&&(ot(s!==a),e.deleteRegion(t,l),t.mesh.delete(a),a=s.Oprev),t.mesh.splice(i.anEdge,a),rt.edgeGoesLeft(s)||(s=null),e.addRightEdges(t,r,a.Onext,o,s,!0)},e.connectLeftVertex=function(t,r){var i,n,s,a,o,l,h=new Tv;if(h.eUp=r.anEdge.Sym,i=t.dict.search(h).key,n=e.regionBelow(i),!!n){if(a=i.eUp,o=n.eUp,rt.edgeSign(a.Dst,r,a.Org)===0){e.connectLeftDegenerate(t,i,r);return}if(s=rt.vertLeq(o.Dst,a.Dst)?i:n,i.inside||s.fixUpperEdge){if(s===i)l=t.mesh.connect(r.anEdge.Sym,a.Lnext);else{var u=t.mesh.connect(o.Dnext,r.anEdge);l=u.Sym}s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,i,l)),e.sweepEvent(t,r)}else e.addRightEdges(t,i,r.anEdge,r.anEdge,null,!0)}},e.sweepEvent=function(t,r){t.event=r,e.debugEvent(t);for(var i=r.anEdge;i.activeRegion===null;)if(i=i.Onext,i===r.anEdge){e.connectLeftVertex(t,r);return}var n=e.topLeftRegion(t,i.activeRegion);ot(n!==null);var s=e.regionBelow(n),a=s.eUp,o=e.finishLeftRegions(t,s,null);o.Onext===a?e.connectRightVertex(t,n,o):e.addRightEdges(t,n,o.Onext,a,a,!0)},e.addSentinel=function(t,r,i,n){var s=new Tv,a=t.mesh.makeEdge();a.Org.s=i,a.Org.t=n,a.Dst.s=r,a.Dst.t=n,t.event=a.Dst,s.eUp=a,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=t.dict.insert(s)},e.initEdgeDict=function(t){t.dict=new qW(t,e.edgeLeq);var r=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],n=t.bmin[0]-r,s=t.bmax[0]+r,a=t.bmin[1]-i,o=t.bmax[1]+i;e.addSentinel(t,n,s,a),e.addSentinel(t,n,s,o)},e.doneEdgeDict=function(t){for(var r,i=0;(r=t.dict.min().key)!==null;)r.sentinel||(ot(r.fixUpperEdge),ot(++i===1)),ot(r.windingNumber===0),e.deleteRegion(t,r)},e.removeDegenerateEdges=function(t){var r,i,n,s=t.mesh.eHead;for(r=s.next;r!==s;r=i)i=r.next,n=r.Lnext,rt.vertEq(r.Org,r.Dst)&&r.Lnext.Lnext!==r&&(e.spliceMergeVertices(t,n,r),t.mesh.delete(r),r=n,n=r.Lnext),n.Lnext===r&&(n!==r&&((n===i||n===i.Sym)&&(i=i.next),t.mesh.delete(n)),(r===i||r===i.Sym)&&(i=i.next),t.mesh.delete(r))},e.initPriorityQ=function(t){var r,i,n,s=0;for(n=t.mesh.vHead,i=n.next;i!==n;i=i.next)s++;for(s+=8,r=t.pq=new WW(s,rt.vertLeq),n=t.mesh.vHead,i=n.next;i!==n;i=i.next)i.pqHandle=r.insert(i);return i!==n?!1:(r.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,r){var i,n,s;for(i=r.fHead.next;i!==r.fHead;i=n)n=i.next,s=i.anEdge,ot(s.Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,r){r===void 0&&(r=!0);var i,n;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(i=t.pq.extractMin())!==null;){for(;n=t.pq.min(),!(n===null||!rt.vertEq(n,i));)n=t.pq.extractMin(),e.spliceMergeVertices(t,i.anEdge,n.anEdge);e.sweepEvent(t,i)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(r&&t.mesh.check(),!0):!1},e}(),XW=function(){function e(){this.mesh=new tA,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=xr.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]},e.prototype.normalize_=function(t){var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!r)throw"Zero-size vector!";r=Math.sqrt(r),t[0]/=r,t[1]/=r,t[2]/=r},e.prototype.longAxis_=function(t){var r=0;return Math.abs(t[1])>Math.abs(t[0])&&(r=1),Math.abs(t[2])>Math.abs(t[r])&&(r=2),r},e.prototype.computeNormal_=function(t){var r,i,n,s,a,o,l=[0,0,0],h=[0,0,0],u=[0,0,0],c=[0,0,0],d=[0,0,0],f=[null,null,null],p=[null,null,null],m=this.mesh.vHead;r=m.next;for(var g=0;g<3;++g)s=r.coords[g],h[g]=s,p[g]=r,l[g]=s,f[g]=r;for(r=m.next;r!==m;r=r.next)for(var v=0;v<3;++v)s=r.coords[v],s<h[v]&&(h[v]=s,p[v]=r),s>l[v]&&(l[v]=s,f[v]=r);var x=0;if(l[1]-h[1]>l[0]-h[0]&&(x=1),l[2]-h[2]>l[x]-h[x]&&(x=2),h[x]>=l[x]){t[0]=0,t[1]=0,t[2]=1;return}for(o=0,i=p[x],n=f[x],u[0]=i.coords[0]-n.coords[0],u[1]=i.coords[1]-n.coords[1],u[2]=i.coords[2]-n.coords[2],r=m.next;r!==m;r=r.next)c[0]=r.coords[0]-n.coords[0],c[1]=r.coords[1]-n.coords[1],c[2]=r.coords[2]-n.coords[2],d[0]=u[1]*c[2]-u[2]*c[1],d[1]=u[2]*c[0]-u[0]*c[2],d[2]=u[0]*c[1]-u[1]*c[0],a=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],a>o&&(o=a,t[0]=d[0],t[1]=d[1],t[2]=d[2]);o<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(u)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,r,i=this.mesh.vHead,n,s=0,a=t.next;a!==t;a=a.next)if(n=a.anEdge,!(n.winding<=0))do s+=(n.Org.s-n.Dst.s)*(n.Org.t+n.Dst.t),n=n.Lnext;while(n!==a.anEdge);if(s<0){for(r=i.next;r!==i;r=r.next)r.t=-r.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,r=[0,0,0],i,n,s=!1;r[0]=this.normal[0],r[1]=this.normal[1],r[2]=this.normal[2],!r[0]&&!r[1]&&!r[2]&&(this.computeNormal_(r),s=!0),i=this.sUnit,n=this.tUnit;var a=this.longAxis_(r);i[a]=0,i[(a+1)%3]=1,i[(a+2)%3]=0,n[a]=0,n[(a+1)%3]=0,n[(a+2)%3]=r[a]>0?1:-1;for(var o=t.next;o!==t;o=o.next)o.s=this.dot_(o.coords,i),o.t=this.dot_(o.coords,n);s&&this.checkOrientation_();for(var l=!0,h=t.next;h!==t;h=h.next)l?(this.bmin[0]=this.bmax[0]=h.s,this.bmin[1]=this.bmax[1]=h.t,l=!1):(h.s<this.bmin[0]&&(this.bmin[0]=h.s),h.s>this.bmax[0]&&(this.bmax[0]=h.s),h.t<this.bmin[1]&&(this.bmin[1]=h.t),h.t>this.bmax[1]&&(this.bmax[1]=h.t))},e.prototype.addWinding_=function(t,r){t.winding+=r.winding,t.Sym.winding+=r.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,r){var i,n;if(i=r.anEdge,!(i.Lnext!==i&&i.Lnext.Lnext!==i))throw"Mono region invalid";for(;rt.vertLeq(i.Dst,i.Org);i=i.Lprev);for(;rt.vertLeq(i.Org,i.Dst);i=i.Lnext);n=i.Lprev;for(var s=void 0;i.Lnext!==n;)if(rt.vertLeq(i.Dst,n.Org)){for(;n.Lnext!==i&&(rt.edgeGoesLeft(n.Lnext)||rt.edgeSign(n.Org,n.Dst,n.Lnext.Dst)<=0);)s=t.connect(n.Lnext,n),n=s.Sym;n=n.Lprev}else{for(;n.Lnext!==i&&(rt.edgeGoesRight(i.Lprev)||rt.edgeSign(i.Dst,i.Org,i.Lprev.Org)>=0);)s=t.connect(i,i.Lprev),i=s.Sym;i=i.Lnext}if(n.Lnext===i)throw"Mono region invalid";for(;n.Lnext.Lnext!==i;)s=t.connect(n.Lnext,n),n=s.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)if(r=i.next,i.inside&&!this.tessellateMonoRegion_(t,i))return!1;return!0},e.prototype.discardExterior_=function(t){for(var r,i=t.fHead.next;i!==t.fHead;i=r)r=i.next,i.inside||t.zapFace(i)},e.prototype.setWindingNumber_=function(t,r,i){for(var n,s=t.eHead.next;s!==t.eHead;s=n)n=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?r:-r:i?t.delete(s):s.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,r,i,n){var s,a=0,o=0,l;i>3&&t.mergeConvexFaces(i);for(var h=t.vHead.next;h!==t.vHead;h=h.next)h.n=-1;for(var u=t.fHead.next;u!==t.fHead;u=u.next)if(u.n=-1,!!u.inside){s=u.anEdge,l=0;do{var h=s.Org;h.n===-1&&(h.n=o,o++),l++,s=s.Lnext}while(s!==u.anEdge);if(l>i)throw"Face vertex greater that support polygon";u.n=a,++a}this.elementCount=a,r===ei.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*i,this.vertexCount=o,this.vertices=[],this.vertices.length=o*n,this.vertexIndices=[],this.vertexIndices.length=o;for(var h=t.vHead.next;h!==t.vHead;h=h.next)if(h.n!==-1){var c=h.n*n;this.vertices[c+0]=h.coords[0],this.vertices[c+1]=h.coords[1],n>2&&(this.vertices[c+2]=h.coords[2]),this.vertexIndices[h.n]=h.idx}for(var d=0,u=t.fHead.next;u!==t.fHead;u=u.next)if(u.inside){s=u.anEdge,l=0;do{var h=s.Org;this.elements[d++]=h.n,l++,s=s.Lnext}while(s!==u.anEdge);for(var f=l;f<i;++f)this.elements[d++]=-1;if(r===ei.CONNECTED_POLYGONS){s=u.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==u.anEdge);for(var p=l;p<i;++p)this.elements[d++]=-1}}},e.prototype.outputContours_=function(t,r){var i,n,s=0,a=0;this.vertexCount=0,this.elementCount=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){n=i=o.anEdge;do this.vertexCount++,i=i.Lnext;while(i!==n);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*r,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,h=0,u=0;s=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){a=0,n=i=o.anEdge;do this.vertices[l++]=i.Org.coords[0],this.vertices[l++]=i.Org.coords[1],r>2&&(this.vertices[l++]=i.Org.coords[2]),this.vertexIndices[h++]=this.vertexIdCallback?this.vertexIdCallback(i):i.Org.idx,a++,i=i.Lnext;while(i!==n);this.elements[u++]=s,this.elements[u++]=a,s+=a}},e.prototype.addContour=function(t,r){this.mesh===null&&(this.mesh=new tA),t<2&&(t=2),t>3&&(t=3);for(var i=null,n=0;n<r.length;n+=t)i===null?(i=this.mesh.makeEdge(),this.mesh.splice(i,i.Sym)):(this.mesh.splitEdge(i),i=i.Lnext),i.Org.coords[0]=r[n+0],i.Org.coords[1]=r[n+1],t>2?i.Org.coords[2]=r[n+2]:i.Org.coords[2]=0,i.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(i),i.winding=1,i.Sym.winding=-1},e.prototype.tesselate=function(t,r,i,n,s,a){if(t===void 0&&(t=xr.ODD),r===void 0&&(r=ei.POLYGONS),a===void 0&&(a=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=t,n<2&&(n=2),n>3&&(n=3),!this.mesh)return!1;this.projectPolygon_(),YW.computeInterior(this,a);var o=this.mesh;return r===ei.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),a&&o.check(),r===ei.BOUNDARY_CONTOURS?this.outputContours_(o,n):this.outputPolymesh_(o,r,i,n),!0},e}();function Rc(e){var t=e.windingRule,r=t===void 0?xr.ODD:t,i=e.elementType,n=i===void 0?ei.POLYGONS:i,s=e.polySize,a=s===void 0?3:s,o=e.vertexSize,l=o===void 0?2:o,h=e.normal,u=h===void 0?[0,0,1]:h,c=e.contours,d=c===void 0?[]:c,f=e.strict,p=f===void 0?!0:f,m=e.debug,g=m===void 0?!1:m;if(!d&&p)throw new Error("Contours can't be empty");if(d){var v=new XW;e.edgeCreateCallback&&(v.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(v.vertexIdCallback=e.vertexIdCallback);for(var x=0;x<d.length;x++)v.addContour(l||2,d[x]);return v.tesselate(r,n,a,l,u,p),{vertices:v.vertices,vertexIndices:v.vertexIndices,vertexCount:v.vertexCount,elements:v.elements,elementCount:v.elementCount,mesh:g?v.mesh:void 0}}}xr.ODD;xr.NONZERO;xr.POSITIVE;xr.NEGATIVE;xr.ABS_GEQ_TWO;ei.POLYGONS;ei.CONNECTED_POLYGONS;ei.BOUNDARY_CONTOURS;var g6=class extends vt{constructor(e,t=12,r={}){var d,f,p;super(),this.type="ShapeGeometry",this.windingRule=xr.ODD,this.elementType=ei.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:xr.ODD,elementType:ei.POLYGONS,polySize:3,vertexSize:2,strict:!0},r);let i=this._shape.extractShapePointsToFlatArray([],this._curveSegments),n=this._shape.shapeHoles.map(m=>m.extractShapePointsToFlatArray([],this._curveSegments)),s,a=!0,o=!0,l,h;for(let m=0,g=i.length/2;m<g;m++){let v=m*2,x=i[v+0],b=i[v+1];if(l!==void 0&&x!==l&&(a=!1),h!==void 0&&b!==h&&(o=!1),l=x,h=b,!a&&!o)break}!a&&!o&&(s=Rc({contours:[i,...n],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict}));let u=(d=s==null?void 0:s.vertexCount)!=null?d:1,c=(f=s==null?void 0:s.elementCount)!=null?f:1;if(this._positionAttribute=new Ct(new Float32Array(u*3),3),this._normalAttribute=new Ct(new Float32Array(u*3),3),this._uvAttribute=new Ct(new Float32Array(u*2),2),this._indexAttribute=new Ct(new Uint32Array(c*3),1),s){let m=1/0,g=-1/0,v=1/0,x=-1/0;for(let E=0,S=u;E<S;E++){let P=E*2,M=s.vertices[P+0],B=s.vertices[P+1];M<m&&(m=M),M>g&&(g=M),B<v&&(v=B),B>x&&(x=B)}let b=g-m,_=x-v;for(let E=0,S=u;E<S;E++){let P=E*2,M=s.vertices[P+0],B=s.vertices[P+1],R=(M-m)/b,H=(B-v)/_;this._positionAttribute.setXYZ(E,M,B,0),this._normalAttribute.setXYZ(E,0,0,1),this._uvAttribute.setXY(E,R,H)}for(let E=0,S=c;E<S;E++){let P=E*3,M=s.elements[P+0],B=s.elements[P+1],R=s.elements[P+2];this._indexAttribute.setX(P+0,M),this._indexAttribute.setX(P+1,B),this._indexAttribute.setX(P+2,R)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((p=s==null?void 0:s.elementCount)!=null?p:1)*3)}clone(){let e=new g6(this._shape,this._curveSegments);return e.userData=k5(this.userData),e}},tx=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let r=e*tx.eSize;this.buffer=new ArrayBuffer(r);let i=Float32Array.BYTES_PER_ELEMENT,n=0;this.positions=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.normals=new Float32Array(this.buffer,n*i,3*e),n+=3*e,this.uvs=new Float32Array(this.buffer,n*i,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity} \u2192 ${e}`);let r=e*tx.eSize,i=new ArrayBuffer(r),n=Float32Array.BYTES_PER_ELEMENT,s=0,a=new Float32Array(i,s*n,3*e);s+=3*e;let o=new Float32Array(i,s*n,3*e);s+=3*e;let l=new Float32Array(i,s*n,2*e);a.set(this.positions.slice(0,this.size*3)),o.set(this.normals.slice(0,this.size*3)),l.set(this.uvs.slice(0,this.size*2)),this.buffer=i,this.positions=a,this.normals=o,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let i=this.capacity;for(;t>i;)i*=2;this.realloc(i)}let r=this.size;return this.size=t,r}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} \u2192 ${this.size}`),this.realloc(this.size,!0)}},v6=tx;v6.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var Dv=(e,t)=>([r,i])=>(i<r&&(i+=t),(e>=r?e:e+t)<=i),y6=class extends vt{constructor(e,t,r=0,i=12,n=3){super(),this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._bevel=r,this._curveSegments=i,this._bevelSegmentsInput=n,r<=0?(this._bevelSize=0,this._bevelSegments=0):(this._bevelSize=Math.min(r,t/2-1e-12),this._bevelSegments=Math.floor(n));let s=this._shape.extractShapePointsToFlatArray([],i),a=this._shape.shapeHoles.map(E=>{let S=E.extractShapePointsToFlatArray([],i),P=[];for(let M=S.length-1;M>=1;M-=2){let B=S[M-1],R=S[M-0];P.push(B,R)}return P}),o=Rc({windingRule:xr.ODD,elementType:ei.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[s]}),l=Rc({windingRule:xr.ODD,elementType:ei.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...a]});if(!o)throw new Error("error generating geometry");let h=o.elementCount;if(l){o.elementCount+=l.elementCount;for(let E=0;E<l.elements.length;E++){let S=l.elements[E],P=E%2===0?o.vertexCount:0;o.elements.push(S+P)}for(let E=0;E<l.vertexIndices.length;E++){let S=l.vertexIndices[E],P=o.vertexCount;o.vertexIndices.push(S+P)}for(let E=0;E<l.vertices.length;E++){let S=l.vertices[E];o.vertices.push(S)}}let u=1/0,c=-1/0,d=1/0,f=-1/0;for(let E=0,S=o.vertexCount;E<S;E++){let P=E*2,M=o.vertices[P+0],B=o.vertices[P+1];M<u&&(u=M),M>c&&(c=M),B<d&&(d=B),B>f&&(f=B)}this._minX=u,this._minY=d,this._width=c-u,this._height=f-d;let p=o.vertexCount*2*(2+this._bevelSegments);this._buffer=new v6(p);let m=[],g=[];for(let E=o.elementCount-1;E>=0;E--){let S=E>=h,P=E*2,M=o.elements[P+0],B=o.elements[P+1],R=M+B,H={start:M,count:B,normals:[],continuous:[],concave:[]},Q=M,z=R-1,y=M+1,A=this._shape.roundedCurves.length;do{let I=Q-M,k=o.vertices[z*2+0],L=o.vertices[z*2+1],w=o.vertices[Q*2+0],N=o.vertices[Q*2+1],X=o.vertices[y*2+0],T=o.vertices[y*2+1],U=w-k,q=N-L,W=Math.sqrt(U*U+q*q);U/=W,q/=W;let J=w-X,K=N-T,ie=Math.sqrt(J*J+K*K);J/=ie,K/=ie,H.normals[I*2+0]=-K,H.normals[I*2+1]=J,H.concave[I]=U*K-q*J>0;let Z=o.vertexIndices[Q];if(Array.isArray(Z))H.continuous[I]=!1;else{let[ue,le]=this._shape.getCurveIndexFromVertexId(Z-1,!0);if(le>0&&le<1)H.continuous[I]=!0;else{let ce=le===1?ue+1:ue-1;ce=(ce+A)%A;let ke=le===1?0:1,be=this._shape.roundedCurves[ue].getTangent(le),_e=this._shape.roundedCurves[ce].getTangent(ke);H.continuous[I]=be.dot(_e)>.95}}S&&(H.normals[I*2+0]*=-1,H.normals[I*2+1]*=-1),[z,Q,y]=[Q,y,y+1],y>=R&&(y-=B)}while(y!==M+1);let D=[];D.push({bevelI:0,angle:0,size:0,boundary:{vertices:o.vertices.slice(M*2,R*2),vertexCount:B,vertexIndices:new Array(B).fill(!0).map((I,k)=>[k,k]),elements:[0,B],elementCount:1,mesh:null},reverseMap:[],insetPoints:o.vertices.slice(M*2,R*2)});for(let I=1;I<=this._bevelSegments;I++){let k=I/this._bevelSegments*Math.PI/2,L=(1-Math.cos(k))*this._bevelSize,w=[],N=[],X=0;for(let U=0;U<B;U++){let q=U*2,W=(U-1+B)%B*2,J=o.vertices[H.start*2+q+0],K=o.vertices[H.start*2+q+1],ie=-H.normals[W+0]*L,Z=-H.normals[W+1]*L,ue=-H.normals[q+0]*L,le=-H.normals[q+1]*L;if(H.concave[U]||!H.concave[U]&&S){let ce=Math.atan2(Z,ie),ke=Math.atan2(le,ue);ke>ce&&(ke-=Math.PI*2);let be=ke-ce;if(H.continuous[U]||S){let _e=ce+be/2,ze=Math.cos(_e)*L,Be=Math.sin(_e)*L;w[2*X+0]=J+ze*(S?-1:1),w[2*X+1]=K+Be*(S?-1:1),N[X]=U,X++}else{let _e=Math.max(1,Math.floor(i/4*Math.abs(be)/Math.PI));for(let ze=0;ze<=_e;ze++){let Be=ce+be*(ze/_e),Ve=Math.cos(Be)*L,j=Math.sin(Be)*L;w[2*X+0]=J+Ve,w[2*X+1]=K+j,N[X]=U,X++}}}else w[2*X+0]=J+ie,w[2*X+1]=K+Z,N[X]=U,X++,w[2*X+0]=J,w[2*X+1]=K,N[X]=U,X++,w[2*X+0]=J+ue,w[2*X+1]=K+le,N[X]=U,X++}let T=Rc({windingRule:xr.POSITIVE,elementType:ei.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[w],edgeCreateCallback:U=>{let q=U.Org.idx,W=N[q],J=N[(q+1)%N.length];U.idx=[W,J],U.Sym.idx=[J,W]},vertexIdCallback:U=>{let q=U.Lprev.idx;return[q?q[1]:0,U.idx[0]]}});if(!T)throw console.log("Error"),new Error(`error generating bevel geometry for ${I}'th loop`);if(!T.vertexCount)break;for(let U=0;U<T.vertexIndices.length;U++){let[q,W]=T.vertexIndices[U];if(q===W)continue;let J=W;W<q&&(J+=B);for(let K=q;K<J;K++){let ie=K%B,Z=(K+1)%B;if(!H.continuous[ie]||!H.continuous[Z]){T.vertexIndices[U]=[q,ie],T.vertexIndices.splice(U+1,0,[Z,W]),T.vertices.splice((U+1)*2,0,T.vertices[U*2],T.vertices[U*2+1]);break}}}D.push({bevelI:I,angle:k,size:L,boundary:T,reverseMap:N,insetPoints:w})}let O=(I,k,L)=>{let w=0,N=I.boundary.vertexIndices.length;for(;w<N&&L(I.boundary.vertexIndices[k]);)k=(k+1)%N,w++;return w},C=m.length;for(let I=1;I<D.length;I++){let k=D[I-1],L=D[I],w=k.boundary.vertexIndices.length,N=L.boundary.vertexIndices.length;if(!w||!N)break;let X=H.concave.length,T=0,U=Dv(T,B);for(;!k.boundary.vertexIndices.filter(U).length||!L.boundary.vertexIndices.filter(U).length;)T++,U=Dv(T,B);let q=k.boundary.vertexIndices.findIndex(U),W=L.boundary.vertexIndices.findIndex(U);do q=(q+1)%w;while(U(k.boundary.vertexIndices[q]));do W=(W+1)%N;while(U(L.boundary.vertexIndices[W]));T=(T+1)%B;let J=T,K=this.buildBevelVert(H,k,(q-1+w)%w),ie=this.buildBevelVert(H,L,(W-1+N)%N),Z=K,ue=ie,le,ce,ke=!1;do{U=Dv(T,B);let be=O(k,q,U),_e=O(L,W,U),ze=ke;if(ke=!1,be&&!_e){for(let Be=0;Be<be;Be++)le=this.buildBevelVert(H,k,(q+Be)%w,Be/(be-1)),m.push(Z.topN,le.topP,ue.topN),m.push(le.bottomP,Z.bottomN,ue.bottomN),Z=le;ke=!0}else if(!be&&_e)for(let Be=0;Be<_e;Be++)ce=this.buildBevelVert(H,L,(W+Be)%N,Be/(_e-1)),m.push(ue.topN,Z.topP,ce.topP),m.push(Z.bottomP,ue.bottomN,ce.bottomP),ue=ce;else if(be&&_e)if(le=this.buildBevelVert(H,k,q,0),ce=this.buildBevelVert(H,L,W,0),ze?(m.push(Z.topN,ce.topP,ue.topN),m.push(Z.topN,le.topP,ce.topP),m.push(ce.bottomP,Z.bottomN,ue.bottomN),m.push(ce.bottomP,le.bottomP,Z.bottomN)):(m.push(ue.topN,Z.topN,le.topP),m.push(ue.topN,le.topP,ce.topP),m.push(le.bottomP,Z.bottomN,ue.bottomN),m.push(le.bottomP,ue.bottomN,ce.bottomP)),Z=le,ue=ce,be===_e)for(let Be=1;Be<be;Be++)le=this.buildBevelVert(H,k,(q+Be)%w,Be/(be-1)),ce=this.buildBevelVert(H,L,(W+Be)%N,Be/(_e-1)),m.push(Z.topN,le.topP,ue.topN),m.push(ue.topN,le.topP,ce.topP),m.push(le.bottomP,Z.bottomN,ue.bottomN),m.push(le.bottomP,ue.bottomN,ce.bottomP),Z=le,ue=ce;else if(be>_e){let Be=be/_e,Ve=0;for(let j=1;j<be;j++)le=this.buildBevelVert(H,k,(q+j)%w,j/(be-1)),m.push(Z.topN,le.topP,ue.topN),m.push(le.bottomP,Z.bottomN,ue.bottomN),Z=le,j>(Ve+1)*Be&&(Ve++,ce=this.buildBevelVert(H,L,(W+Ve)%N,Ve/(_e-1)),m.push(ue.topN,le.topP,ce.topP),m.push(le.bottomP,ue.bottomN,ce.bottomP),ue=ce)}else{let Be=_e/be,Ve=0;for(let j=1;j<_e;j++)ce=this.buildBevelVert(H,L,(W+j)%N,j/(_e-1)),m.push(ue.topN,le.topP,ce.topP),m.push(le.bottomP,ue.bottomN,ce.bottomP),ue=ce,j>(Ve+1)*Be&&(Ve++,le=this.buildBevelVert(H,k,(q+Ve)%w,Ve/(be-1)),m.push(Z.topN,le.topP,ue.topN),m.push(le.bottomP,Z.bottomN,ue.bottomN),Z=le)}q=(q+be)%w,W=(W+_e)%N,T=(T+1)%X}while(T!==J)}{let I=D[0];for(let k=0,L=I.boundary.vertexCount;k<L;k++){let w=this.buildBevelVert(H,I,k),N=this.buildBevelVert(H,I,(k+1)%L);m.push(N.topP,w.topN,w.bottomN),m.push(N.topP,w.bottomN,N.bottomP)}}if(S){let I=[];for(let k=m.length-1;k>=C+2;k-=3){let L=m[k-2],w=m[k-1],N=m[k-0];I.push(N,w,L)}m.splice(C,m.length-C,...I)}if(S){let I=[];for(let k=D[D.length-1].boundary.vertices.length-1;k>=1;k-=2){let L=D[D.length-1].boundary.vertices[k-1],w=D[D.length-1].boundary.vertices[k-0];I.push(L,w)}g.push(I)}if(!S){let I=D[D.length-1],k=Rc({windingRule:D.length>1?xr.POSITIVE:xr.ODD,elementType:ei.POLYGONS,vertexSize:2,strict:!0,contours:[I.insetPoints,...g]});if(!k)throw new Error("Error generating geometry for surface");Object.assign(this,{capStartIndex:m.length});for(let L=0;L<k.elementCount*3;L+=3){let w=this.buildSurfaceVert(k,k.elements[L+0]),N=this.buildSurfaceVert(k,k.elements[L+1]),X=this.buildSurfaceVert(k,k.elements[L+2]);m.push(w.top,N.top,X.top),m.push(X.bottom,N.bottom,w.bottom)}}this.vertexCache={}}this._buffer.shrink();let v=new Ct(Uint32Array.from(m),1),x=new Ct(this._buffer.positions,3),b=new Ct(this._buffer.normals,3),_=new Ct(this._buffer.uvs,2);x.needsUpdate=!0,b.needsUpdate=!0,_.needsUpdate=!0,v.needsUpdate=!0,this.setAttribute("position",x),this.setAttribute("normal",b),this.setAttribute("uv",_),this.setIndex(v)}buildSurfaceVert(e,t){let r=t.toString();if(r in this.vertexCache)return this.vertexCache[r];let i=e.vertices[t*2+0],n=e.vertices[t*2+1],s=(i-this._minX)/this._width,a=(n-this._minY)/this._height,o=this._buffer.get(2),l=o*3,h=o*2,u={top:o+0,bottom:o+1};return this._buffer.positions[l+0]=i,this._buffer.positions[l+1]=n,this._buffer.positions[l+2]=this._depth,this._buffer.normals[l+0]=0,this._buffer.normals[l+1]=0,this._buffer.normals[l+2]=1,this._buffer.uvs[h+0]=s,this._buffer.uvs[h+1]=a,this._buffer.positions[l+3]=i,this._buffer.positions[l+4]=n,this._buffer.positions[l+5]=0,this._buffer.normals[l+3]=0,this._buffer.normals[l+4]=0,this._buffer.normals[l+5]=-1,this._buffer.uvs[h+2]=s,this._buffer.uvs[h+3]=a,this.vertexCache[r]=u,u}buildBevelVert(e,t,r,i=1){let n=`${t.bevelI}:${r}`;if(n in this.vertexCache)return this.vertexCache[n];let[s,a]=t.boundary.vertexIndices[r],o,l,h,u;s!==a?(l=s,o=a,u=!1,h=e.continuous[l]&&e.continuous[o]):(o=s,l=(o-1+e.count)%e.count,u=e.concave[o]&&t.bevelI>0,h=e.continuous[o]||u);let c=Math.cos(t.angle),d=Math.sin(t.angle),f=r*2,p=o*2,m=l*2,g=t.boundary.vertices[f+0],v=t.boundary.vertices[f+1],x=(1-d)*this._bevelSize,b=(g-this._minX)/this._width,_=(v-this._minY)/this._height,E=e.normals[p+0],S=e.normals[p+1],P=e.normals[m+0],M=e.normals[m+1];if(u){let z=P-E,y=M-S;E=E+z*(1-i),S=S+y*(1-i);let A=Math.sqrt(E*E+S*S);E/=A,S/=A}let B=this._buffer.get(h?2:4),R=B*3,H=B*2,Q={i:r,fi:o,topP:B+0,topN:B+0,bottomP:B+1,bottomN:B+1};return this._buffer.positions[R+0]=g,this._buffer.positions[R+1]=v,this._buffer.positions[R+2]=this._depth-x,this._buffer.normals[R+0]=E*c,this._buffer.normals[R+1]=S*c,this._buffer.normals[R+2]=d,this._buffer.uvs[H+0]=b,this._buffer.uvs[H+1]=_,this._buffer.positions[R+3]=g,this._buffer.positions[R+4]=v,this._buffer.positions[R+5]=x,this._buffer.normals[R+3]=E*c,this._buffer.normals[R+4]=S*c,this._buffer.normals[R+5]=-d,this._buffer.uvs[H+2]=_,this._buffer.uvs[H+3]=b,h||(B+=2,R+=6,H+=4,Q.topP=B+0,Q.bottomP=B+1,this._buffer.positions[R+0]=g,this._buffer.positions[R+1]=v,this._buffer.positions[R+2]=this._depth-x,this._buffer.normals[R+0]=P*c,this._buffer.normals[R+1]=M*c,this._buffer.normals[R+2]=d,this._buffer.uvs[H+0]=b,this._buffer.uvs[H+1]=_,this._buffer.positions[R+3]=g,this._buffer.positions[R+4]=v,this._buffer.positions[R+5]=x,this._buffer.normals[R+3]=P*c,this._buffer.normals[R+4]=M*c,this._buffer.normals[R+5]=-d,this._buffer.uvs[H+2]=_,this._buffer.uvs[H+3]=b),this.vertexCache[n]=Q,Q}clone(){let e=new y6(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=k5(this.userData),e}},Ka=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var h,u,c,d,f,p,m;let r=Object.assign({},(h=t==null?void 0:t.parameters)!=null?h:{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),i=Math.abs(r.width),n=Math.abs((u=r.height)!=null?u:r.width),s=Math.abs((c=r.depth)!=null?c:0),a=(d=e.shape)!=null?d:t==null?void 0:t.shape,o=(f=a==null?void 0:a.roundness)!=null?f:r.roundness;a!==void 0&&(a instanceof yr?(a.width!==i||a.height!==n)&&a.applySize(i,n):a=new yr(i,n).fromJSON(a),((p=e.parameters)==null?void 0:p.roundness)!==void 0&&((m=e.parameters)==null?void 0:m.roundness)>0&&a.update(!1));let l=a!=null?a:new yr(i,n);return{parameters:Object.assign(r,{width:i,height:n,depth:s,roundness:o}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:r,extrudeBevelSegments:i,subdivisions:n,roundness:s}=e.parameters;e.shape.roundness=s;let a;return t<=0?a=new g6(e.shape,n):a=new y6(e.shape,t,r,n,i),Object.assign(a,{userData:qe(me({},e),{type:"VectorGeometry"})})}},x6=Math.PI*2,QW=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof yr?e.shape:new yr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:0)})}}static build(e){let{width:t,height:r,spikes:i,angle:n,innerRadius:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,h=e.shape,u=t*.5,c=r*.5,d=JW(h,u,c,n*Math.PI/180,i,s);h.isClosed=!0,h.update();let f=Ka.create({shape:h,parameters:{subdivisions:d,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(f,{userData:qe(me({},e),{type:"EllipseGeometry"})})}};function JW(e,t,r,i,n,s){if(i>=x6)return n>30||n%4===0?(ZW(e,t,r,s),Math.round(n/4)):sA(e,i,n,t,r,s);let a={x:0,y:r},o=i+Math.PI*.5,l={x:Math.cos(o)*t,y:Math.sin(o)*r},h=jW({px:a.x,py:a.y,cx:l.x,cy:l.y,rx:t,ry:r,largeArcFlag:i>Math.PI,sweepFlag:!0});return n>30||n%h.length===0?KW(e,a.x,a.y,h,n,t,r,s):sA(e,i,n,t,r,s)}function KW(e,t,r,i,n,s,a,o){let l=Math.round(n/i.length);e.addPoint(ou(t,r));for(let h=0,u=i.length;h<u;h++){let c=i[h],d=e.points[h],f=ou(c.x,c.y);d.controls[1].position.set(c.x1,c.y1),f.controls[0].position.set(c.x2,c.y2),e.addPoint(f)}return o>0?w6(e,s,a,o):e.addPoint(ou(0,0)),l}function sA(e,t,r,i,n,s){let a=-t/r;for(let o=0;o<=r;o++){let l=a*o,h=Math.sin(l)*i,u=Math.cos(l)*n;e.addPoint(ou(h,u))}return t<x6?s>0?w6(e,i,n,s):e.addPoint(ou(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&b6(e,i,n,s)),1}function ZW(e,t,r,i=0,n=0,s=0){let a=.5522847498,o=t*a,l=r*a;e.addPoint(cp(n-t,s,n-t,s-l,n-t,s+l)),e.addPoint(cp(n,s+r,n-o,s+r,n+o,s+r)),e.addPoint(cp(n+t,s,n+t,s+l,n+t,s-l)),e.addPoint(cp(n,s-r,n+o,s-r,n-o,s-r)),i>0&&b6(e,t,r,i)}function ou(e,t){return new au(kt.generateUUID(),new $(e,t))}function cp(e,t,r,i,n,s){let a=ou(e,t);return a.controls[0].position.set(r,i),a.controls[1].position.set(n,s),a}function w6(e,t,r,i){_6(e,t,r,i).forEach(n=>e.addPoint(n))}function b6(e,t,r,i){let n=_6(e,t,r,i),s=new yr;n.forEach(a=>s.addPoint(a)),s.isClosed=!0,e.shapeHoles.push(s)}function _6(e,t,r,i){let n=i*t/100,s=n*(Math.abs(r)/Math.abs(t)),a=new $(n/t,s/r),o=e.points.map(l=>{let h=l.clone();return h.uuid=kt.generateUUID(),h}).reverse();return o.forEach(l=>{l.position.multiply(a);let h=l.controls[0].position.clone().multiply(a),u=l.controls[1].position.clone().multiply(a);l.controls[0].position.copy(u),l.controls[1].position.copy(h)}),o}var $W=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var o,l,h;let r=Object.assign({},(o=t==null?void 0:t.parameters)!=null?o:{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),i=Math.abs(r.width),n=Math.abs((l=r.height)!=null?l:i),s=Math.abs((h=r.depth)!=null?h:i),a=Math.abs(Math.min(i,s))/2;return{parameters:Object.assign(r,{width:i,height:n,depth:s,radius:a,segments:Math.round(r.segments),pathSegments:Math.round(r.pathSegments),cornerSegments:Math.round(r.cornerSegments)})}}static build(e){let{width:t,height:r,depth:i,radius:n,revolutions:s,segments:a,pathRadius:o,pathType:l,pathSegments:h,cornerRadius:u,cornerSegments:c}=e.parameters,d=new S6(!1,t,r,i,n,s,a,o,l,h,u,c);return Object.assign(d,{userData:qe(me({},e),{type:"HelixGeometry"})})}},S6=class extends vt{constructor(e=!0,t=1,r=1,i=1,n=1,s=1,a=1,o=1,l=1,h=1,u=1,c=1){super();let d=e&&s===1;d&&(c=0),u>100&&(u=100);let f=()=>new F,p=new F,m=f(),g=f(),v=f(),x,b,_,E,S,P,M,B,R=f(),H=f(),Q=f(),z=f(),y=f(),A=f(),D=f(),O=f(),C=r-2*o+.001,I=C/s,k=Math.ceil(a*s),L=k+1,w=C/k,N=-C/2,X=h+1,T=2*Math.PI/h,U=Math.PI/2/c,q=.01,W=Math.min((1-u/100)*o,o-q),J=o-W,K=0,ie=2,Z=c*ie+ie,ue=X*Z/ie,le=ue+X*L,ce=X*(L+Z),[ke,be,_e]=[3,3,2].map(Me=>Array(ce*Me).fill(0)),ze=[],Be=n-o;function Ve(Me,xe){let Y=Math.PI/2;P=xe*w,B=2*Math.PI*(P%I)/I+Y,P+=N,M=Math.sin(B)*Be,S=Math.cos(B)*Be,e?Me.set(S,M,P):Me.set(S,P,M)}Ve(p,-1e-10),Ve(m,0),R.copy(p),Ve(p,1);let j=p.distanceTo(m),G=J+W,se=j*k+2*G,ye=W,ge=se-G;for(let Me=0;Me<=k;Me++){Ve(g,Me),O.subVectors(g,R).normalize(),R.copy(g),A.copy(g).setComponent(+e+1,0).normalize(),D.crossVectors(O,A).normalize();let xe=Me===0,Y=Me===k,Ee=xe?3*Math.PI/2:U,ve=xe?ye:ge,Le=xe?X:le,Oe=xe?0:ce-X,Ie=O.clone().multiplyScalar(xe?-J:J).add(g),pe=O.clone().multiplyScalar(xe?-1:1).normalize();for(let Xe=0;Xe<X;Xe++){let He=Xe*T;if(H.addVectors(p.copy(A).multiplyScalar(o*Math.cos(He)),m.copy(D).multiplyScalar(o*Math.sin(He))),Q.copy(H).normalize(),xe||Y){d||(K=Oe+Xe,[0,1,2].forEach(je=>{ke[K*3+je]=Ie.getComponent(je),be[K*3+je]=pe.getComponent(je)}),_e[K*2]=+Y,_e[K*2+1]=Xe/h),m.copy(Q).multiplyScalar(W),v.addVectors(g,m);for(let je=0;je<c;je++){let qt=je*U+Ee;z.addVectors(p.copy(O).multiplyScalar(J*Math.sin(qt)),m.copy(Q).multiplyScalar(J*Math.cos(qt))),y.copy(z).normalize(),m.addVectors(v,z),z.normalize(),K=Le+je*X+Xe,[0,1,2].forEach(Dt=>{ke[K*3+Dt]=m.getComponent(Dt),be[K*3+Dt]=y.getComponent(Dt)});let Mt=+xe+Math.sin(qt);_e[K*2]=(ve+J*Mt)/se,_e[K*2+1]=Xe/h}}m.addVectors(g,H),K=ue+Me*X+Xe,[0,1,2].forEach(je=>{ke[K*3+je]=m.getComponent(je),be[K*3+je]=Q.getComponent(je)}),_e[K*2]=(G+Me*j)/se,_e[K*2+1]=Xe/h}}let we=L+2*c+ie,et=1,[oe,De]=d?[et,et+L-1]:[0,we-1];for(let Me=oe;Me<=De-1;Me++){let xe=d&&Me===De-1;for(let Y=0;Y<X-1;Y++)x=Me*X+Y,b=x+1,_=(xe?Y:x)+X,E=(xe?Y+1:b)+X,Me===0?ze.push(b,E,_):Me===we-2?ze.push(x,b,_):ze.push(x,b,_,b,E,_)}this.setIndex(ze),this.setAttribute("position",new Ge(ke,3)),this.setAttribute("normal",new Ge(be,3)),this.setAttribute("uv",new Ge(_e,2))}},eq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:r.width)})}}static build(e){let{width:t,height:r,depth:i,detail:n,corner:s,cornerSides:a}=e.parameters,o=n===0&&s!==0?new M6(t*.5,s,a):new jT(t*.5,n);return o.scale(1,r/t,i/t),Object.assign(o,{userData:qe(me({},e),{type:"IcosahedronGeometry"})})}},M6=class extends gb{constructor(e=1,t=.2,r=4){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a="IcosahedronGeometry";super(n,s,a,e,t,r),this.type=a}static fromJSON(e){return new M6(e.radius,e.corner,e.cornerSides)}},tq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s,a,o;((n=(i=e.parameters)==null?void 0:i.points)!=null?n:[]).forEach(l=>{Array.isArray(l)&&(l.x=l[0],l.y=l[1])});let r=Object.assign({},(s=t==null?void 0:t.parameters)!=null?s:{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((a=r.height)!=null?a:r.width),depth:Math.abs((o=r.depth)!=null?o:r.width)})}}static build(e){let{points:t,segments:r,verticalSegments:i}=e.parameters,n=new Pl;n.moveTo(t[0].x,t[0].y),n.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new zT(n.extractPoints(i).shape,r);return s.rotateZ(Math.PI),Object.assign(s,{userData:qe(me({},e),{type:"LatheGeometry"})})}},Es=new wt,Pv=new er,dp=new F,V0=class extends nn{constructor(){super(),this.uuid=kt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new xi().getNormalMatrix(e);for(let r=0,i=this.vertices.length;r<i;r++)this.vertices[r].applyMatrix4(e);for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];n.normal.applyMatrix3(t).normalize();for(let s=0,a=n.vertexNormals.length;s<a;s++)n.vertexNormals[s].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return Es.makeRotationX(e),this.applyMatrix4(Es),this}rotateY(e){return Es.makeRotationY(e),this.applyMatrix4(Es),this}rotateZ(e){return Es.makeRotationZ(e),this.applyMatrix4(Es),this}translate(e,t,r){return Es.makeTranslation(e,t,r),this.applyMatrix4(Es),this}scale(e,t,r){return Es.makeScale(e,t,r),this.applyMatrix4(Es),this}lookAt(e){return Pv.lookAt(e),Pv.updateMatrix(),this.applyMatrix4(Pv.matrix),this}fromBufferGeometry(e){let t=this,r=e.index!==null?e.index:void 0,i=e.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let n=i.position,s=i.normal,a=i.color,o=i.uv,l=i.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let c=0;c<n.count;c++)t.vertices.push(new F().fromBufferAttribute(n,c)),a!==void 0&&t.colors.push(new Ue().fromBufferAttribute(a,c));function h(c,d,f,p){let m=a===void 0?[]:[t.colors[c].clone(),t.colors[d].clone(),t.colors[f].clone()],g=s===void 0?[]:[new F().fromBufferAttribute(s,c),new F().fromBufferAttribute(s,d),new F().fromBufferAttribute(s,f)],v=new rx(c,d,f,g,m,p);t.faces.push(v),o!==void 0&&t.faceVertexUvs[0].push([new $().fromBufferAttribute(o,c),new $().fromBufferAttribute(o,d),new $().fromBufferAttribute(o,f)]),l!==void 0&&t.faceVertexUvs[1].push([new $().fromBufferAttribute(l,c),new $().fromBufferAttribute(l,d),new $().fromBufferAttribute(l,f)])}let u=e.groups;if(u.length>0)for(let c=0;c<u.length;c++){let d=u[c],f=d.start,p=d.count;for(let m=f,g=f+p;m<g;m+=3)r!==void 0?h(r.getX(m),r.getX(m+1),r.getX(m+2),d.materialIndex):h(m,m+1,m+2,d.materialIndex)}else if(r!==void 0)for(let c=0;c<r.count;c+=3)h(r.getX(c),r.getX(c+1),r.getX(c+2));else for(let c=0;c<n.count;c+=3)h(c,c+1,c+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(dp).negate(),this.translate(dp.x,dp.y,dp.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,r=t===0?1:1/t,i=new wt;return i.set(r,0,0,-r*e.x,0,r,0,-r*e.y,0,0,r,-r*e.z,0,0,0,1),this.applyMatrix4(i),this}computeFaceNormals(){let e=new F,t=new F;for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=this.vertices[n.a],a=this.vertices[n.b],o=this.vertices[n.c];e.subVectors(o,a),t.subVectors(s,a),e.cross(t),e.normalize(),n.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let r=0,i=this.vertices.length;r<i;r++)t[r]=new F;if(e){let r=new F,i=new F;for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=this.vertices[a.a],l=this.vertices[a.b],h=this.vertices[a.c];r.subVectors(h,l),i.subVectors(o,l),r.cross(i),t[a.a].add(r),t[a.b].add(r),t[a.c].add(r)}}else{this.computeFaceNormals();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r];t[n.a].add(n.normal),t[n.b].add(n.normal),t[n.c].add(n.normal)}}for(let r=0,i=this.vertices.length;r<i;r++)t[r].normalize();for(let r=0,i=this.faces.length;r<i;r++){let n=this.faces[r],s=n.vertexNormals;s.length===3?(s[0].copy(t[n.a]),s[1].copy(t[n.b]),s[2].copy(t[n.c])):(s[0]=t[n.a].clone(),s[1]=t[n.b].clone(),s[2]=t[n.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let r=this.faces[e],i=r.vertexNormals;i.length===3?(i[0].copy(r.normal),i[1].copy(r.normal),i[2].copy(r.normal)):(i[0]=r.normal.clone(),i[1]=r.normal.clone(),i[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]);for(let n=0,s=i.vertexNormals.length;n<s;n++)i.__originalVertexNormals[n]?i.__originalVertexNormals[n].copy(i.vertexNormals[n]):i.__originalVertexNormals[n]=i.vertexNormals[n].clone()}let e=new V0;e.faces=this.faces;for(let t=0,r=this.morphTargets.length;t<r;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let n=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(let a=0,o=this.faces.length;a<o;a++){let l=new F,h={a:new F,b:new F,c:new F};n.push(l),s.push(h)}}let i=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let n=0,s=this.faces.length;n<s;n++){let a=this.faces[n],o=i.faceNormals[n],l=i.vertexNormals[n];o.copy(a.normal),l.a.copy(a.vertexNormals[0]),l.b.copy(a.vertexNormals[1]),l.c.copy(a.vertexNormals[2])}}for(let t=0,r=this.faces.length;t<r;t++){let i=this.faces[t];i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new gs),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ha),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,r=0){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}let i,n=this.vertices.length,s=this.vertices,a=e.vertices,o=this.faces,l=e.faces,h=this.colors,u=e.colors;t!==void 0&&(i=new xi().getNormalMatrix(t));for(let c=0,d=a.length;c<d;c++){let f=a[c].clone();t!==void 0&&f.applyMatrix4(t),s.push(f)}for(let c=0,d=u.length;c<d;c++)h.push(u[c].clone());for(let c=0,d=l.length;c<d;c++){let f=l[c],p,m,g=f.vertexNormals,v=f.vertexColors,x=new rx(f.a+n,f.b+n,f.c+n);x.normal.copy(f.normal),i!==void 0&&x.normal.applyMatrix3(i).normalize();for(let b=0,_=g.length;b<_;b++)p=g[b].clone(),i!==void 0&&p.applyMatrix3(i).normalize(),x.vertexNormals.push(p);x.color.copy(f.color);for(let b=0,_=v.length;b<_;b++)m=v[b],x.vertexColors.push(m.clone());x.materialIndex=f.materialIndex+r,o.push(x)}for(let c=0,d=e.faceVertexUvs.length;c<d;c++){let f=e.faceVertexUvs[c];this.faceVertexUvs[c]===void 0&&(this.faceVertexUvs[c]=[]);for(let p=0,m=f.length;p<m;p++){let g=f[p],v=[];for(let x=0,b=g.length;x<b;x++)v.push(g[x].clone());this.faceVertexUvs[c].push(v)}}}mergeMesh(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)}mergeVertices(e=4){let t={},r=[],i=[],n=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let h=this.vertices[o],u=Math.round(h.x*n)+"_"+Math.round(h.y*n)+"_"+Math.round(h.z*n);t[u]===void 0?(t[u]=o,r.push(this.vertices[o]),i[o]=r.length-1):i[o]=i[t[u]]}let s=[];for(let o=0,l=this.faces.length;o<l;o++){let h=this.faces[o];h.a=i[h.a],h.b=i[h.b],h.c=i[h.c];let u=[h.a,h.b,h.c];for(let c=0;c<3;c++)if(u[c]===u[(c+1)%3]){s.push(o);break}}for(let o=s.length-1;o>=0;o--){let l=s[o];this.faces.splice(l,1);for(let h=0,u=this.faceVertexUvs.length;h<u;h++)this.faceVertexUvs[h].splice(l,1)}let a=this.vertices.length-r.length;return this.vertices=r,a}setFromPoints(e){this.vertices=[];for(let t=0,r=e.length;t<r;t++){let i=e[t];this.vertices.push(new F(i.x,i.y,i.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let o=0;o<t;o++)e[o]._id=o;function r(o,l){return o.materialIndex-l.materialIndex}e.sort(r);let i=this.faceVertexUvs[0],n=this.faceVertexUvs[1],s,a;i&&i.length===t&&(s=[]),n&&n.length===t&&(a=[]);for(let o=0;o<t;o++){let l=e[o]._id;s&&s.push(i[l]),a&&a.push(n[l])}s&&(this.faceVertexUvs[0]=s),a&&(this.faceVertexUvs[1]=a)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let f=this.parameters;for(let p in f)f[p]!==void 0&&(e[p]=f[p]);return e}let t=[];for(let f=0;f<this.vertices.length;f++){let p=this.vertices[f];t.push(p.x,p.y,p.z)}let r=[],i=[],n={},s=[],a={},o=[],l={};for(let f=0;f<this.faces.length;f++){let p=this.faces[f],m=!0,g=!1,v=this.faceVertexUvs[0][f]!==void 0,x=p.normal.length()>0,b=p.vertexNormals.length>0,_=p.color.r!==1||p.color.g!==1||p.color.b!==1,E=p.vertexColors.length>0,S=0;if(S=h(S,0,0),S=h(S,1,m),S=h(S,2,g),S=h(S,3,v),S=h(S,4,x),S=h(S,5,b),S=h(S,6,_),S=h(S,7,E),r.push(S),r.push(p.a,p.b,p.c),r.push(p.materialIndex),v){let P=this.faceVertexUvs[0][f];r.push(d(P[0]),d(P[1]),d(P[2]))}if(x&&r.push(u(p.normal)),b){let P=p.vertexNormals;r.push(u(P[0]),u(P[1]),u(P[2]))}if(_&&r.push(c(p.color)),E){let P=p.vertexColors;r.push(c(P[0]),c(P[1]),c(P[2]))}}function h(f,p,m){return m?f|1<<p:f&~(1<<p)}function u(f){let p=f.x.toString()+f.y.toString()+f.z.toString();return n[p]!==void 0||(n[p]=i.length/3,i.push(f.x,f.y,f.z)),n[p]}function c(f){let p=f.r.toString()+f.g.toString()+f.b.toString();return a[p]!==void 0||(a[p]=s.length,s.push(f.getHex())),a[p]}function d(f){let p=f.x.toString()+f.y.toString();return l[p]!==void 0||(l[p]=o.length/2,o.push(f.x,f.y)),l[p]}return e.data={},e.data.vertices=t,e.data.normals=i,s.length>0&&(e.data.colors=s),o.length>0&&(e.data.uvs=[o]),e.data.faces=r,e}clone(){return new V0().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let c=0,d=t.length;c<d;c++)this.vertices.push(t[c].clone());let r=e.colors;for(let c=0,d=r.length;c<d;c++)this.colors.push(r[c].clone());let i=e.faces;for(let c=0,d=i.length;c<d;c++)this.faces.push(i[c].clone());for(let c=0,d=e.faceVertexUvs.length;c<d;c++){let f=e.faceVertexUvs[c];this.faceVertexUvs[c]===void 0&&(this.faceVertexUvs[c]=[]);for(let p=0,m=f.length;p<m;p++){let g=f[p],v=[];for(let x=0,b=g.length;x<b;x++){let _=g[x];v.push(_.clone())}this.faceVertexUvs[c].push(v)}}let n=e.morphTargets;for(let c=0,d=n.length;c<d;c++){let f={};if(f.name=n[c].name,n[c].vertices!==void 0){f.vertices=[];for(let p=0,m=n[c].vertices.length;p<m;p++)f.vertices.push(n[c].vertices[p].clone())}if(n[c].normals!==void 0){f.normals=[];for(let p=0,m=n[c].normals.length;p<m;p++)f.normals.push(n[c].normals[p].clone())}this.morphTargets.push(f)}let s=e.morphNormals;for(let c=0,d=s.length;c<d;c++){let f={};if(s[c].vertexNormals!==void 0){f.vertexNormals=[];for(let p=0,m=s[c].vertexNormals.length;p<m;p++){let g=s[c].vertexNormals[p],v={};v.a=g.a.clone(),v.b=g.b.clone(),v.c=g.c.clone(),f.vertexNormals.push(v)}}if(s[c].faceNormals!==void 0){f.faceNormals=[];for(let p=0,m=s[c].faceNormals.length;p<m;p++)f.faceNormals.push(s[c].faceNormals[p].clone())}this.morphNormals.push(f)}let a=e.skinWeights;for(let c=0,d=a.length;c<d;c++)this.skinWeights.push(a[c].clone());let o=e.skinIndices;for(let c=0,d=o.length;c<d;c++)this.skinIndices.push(o[c].clone());let l=e.lineDistances;for(let c=0,d=l.length;c<d;c++)this.lineDistances.push(l[c]);let h=e.boundingBox;h!==null&&(this.boundingBox=h.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new rq().fromGeometry(this),t=new vt,r=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",new Ct(r,3).copyVector3sArray(e.vertices)),e.normals.length>0){let i=new Float32Array(e.normals.length*3);t.setAttribute("normal",new Ct(i,3).copyVector3sArray(e.normals))}if(e.colors.length>0){let i=new Float32Array(e.colors.length*3);t.setAttribute("color",new Ct(i,3).copyColorsArray(e.colors))}if(e.uvs.length>0){let i=new Float32Array(e.uvs.length*2);t.setAttribute("uv",new Ct(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){let i=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",new Ct(i,2).copyVector2sArray(e.uvs2))}t.groups=e.groups;for(let i in e.morphTargets){let n=[],s=e.morphTargets[i];for(let a=0,o=s.length;a<o;a++){let l=s[a],h=new Ge(l.data.length*3,3);h.name=l.name,n.push(h.copyVector3sArray(l.data))}t.morphAttributes[i]=n}if(e.skinIndices.length>0){let i=new Ge(e.skinIndices.length*4,4);t.setAttribute("skinIndex",i.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){let i=new Ge(e.skinWeights.length*4,4);t.setAttribute("skinWeight",i.copyVector4sArray(e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new vt,r=e.geometry;if(e.isPoints||e.isLine){let i=new Ge(r.vertices.length*3,3),n=new Ge(r.colors.length*3,3);if(t.setAttribute("position",i.copyVector3sArray(r.vertices)),t.setAttribute("color",n.copyColorsArray(r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length){let s=new Ge(r.lineDistances.length,1);t.setAttribute("lineDistance",s.copyArray(r.lineDistances))}r.boundingSphere!==null&&(t.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(t.boundingBox=r.boundingBox.clone())}else e.isMesh&&(t=r.toBufferGeometry());return t}};V0.prototype.isGeometry=!0;var rq=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],r,i,n,s=e.faces;for(i=0;i<s.length;i++){let a=s[i];a.materialIndex!==n&&(n=a.materialIndex,r!==void 0&&(r.count=i*3-r.start,t.push(r)),r={start:i*3,materialIndex:n})}r!==void 0&&(r.count=i*3-r.start,t.push(r)),this.groups=t}fromGeometry(e){let t=e.faces,r=e.vertices,i=e.faceVertexUvs,n=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,a=e.morphTargets,o=a.length,l;if(o>0){l=[];for(let g=0;g<o;g++)l[g]={name:a[g].name,data:[]};this.morphTargets.position=l}let h=e.morphNormals,u=h.length,c;if(u>0){c=[];for(let g=0;g<u;g++)c[g]={name:h[g].name,data:[]};this.morphTargets.normal=c}let d=e.skinIndices,f=e.skinWeights,p=d.length===r.length,m=f.length===r.length;r.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let g=0;g<t.length;g++){let v=t[g];this.vertices.push(r[v.a],r[v.b],r[v.c]);let x=v.vertexNormals;if(x.length===3)this.normals.push(x[0],x[1],x[2]);else{let _=v.normal;this.normals.push(_,_,_)}let b=v.vertexColors;if(b.length===3)this.colors.push(b[0],b[1],b[2]);else{let _=v.color;this.colors.push(_,_,_)}if(n===!0){let _=i[0][g];_!==void 0?this.uvs.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",g),this.uvs.push(new $,new $,new $))}if(s===!0){let _=i[1][g];_!==void 0?this.uvs2.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",g),this.uvs2.push(new $,new $,new $))}for(let _=0;_<o;_++){let E=a[_].vertices;l[_].data.push(E[v.a],E[v.b],E[v.c])}for(let _=0;_<u;_++){let E=h[_].vertexNormals[g];c[_].data.push(E.a,E.b,E.c)}p&&this.skinIndices.push(d[v.a],d[v.b],d[v.c]),m&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},rx=class{constructor(e,t,r,i,n,s=0){this.a=e,this.b=t,this.c=r,this.normal=i&&i.isVector3?i:new F,this.vertexNormals=Array.isArray(i)?i:[],this.color=n&&n.isColor?n:new Ue,this.vertexColors=Array.isArray(n)?n:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,r=e.vertexColors.length;t<r;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}},iq=["a","b","c"];function nq(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function Lv(e,t,r){let i=Math.min(e,t),n=Math.max(e,t),s=i+"_"+n;return r.get(s)}function Rv(e,t,r,i,n,s){let a=Math.min(e,t),o=Math.max(e,t),l=a+"_"+o,h;if(i.has(l))h=i.get(l);else{let u=r[a],c=r[o];h={a:u,b:c,newEdge:null,faces:[]},i.set(l,h)}h.faces.push(n),s[e].edges.push(h),s[t].edges.push(h)}function sq(e,t,r,i){let n,s,a;for(n=0,s=e.length;n<s;n++)r[n]={edges:[]};for(n=0,s=t.length;n<s;n++)a=t[n],Rv(a.a,a.b,e,i,a,r),Rv(a.b,a.c,e,i,a,r),Rv(a.c,a.a,e,i,a,r)}function fp(e,t,r,i,n){e.push(new rx(t,r,i,void 0,void 0,n))}function wh(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function pp(e,t,r,i){e.push([t.clone(),r.clone(),i.clone()])}var aq=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof vt?e=new V0().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new F,r,i,n,s,a,o=e.vertices,l=e.faces,h=e.faceVertexUvs[0],u=h!==void 0&&h.length>0,c=[],d=new Map;sq(o,l,c,d);let f=[],p,m,g,v,x,b,_;for(let q of Array.from(d.keys())){for(m=d.get(q),g=new F,x=3/8,b=1/8,_=m.faces.length,_!=2&&(x=.5,b=0,_!=1),g.addVectors(m.a,m.b).multiplyScalar(x),t.set(0,0,0),s=0;s<_;s++){for(v=m.faces[s],a=0;a<3&&(p=o[nq(v,iq[a])],!(p!==m.a&&p!==m.b));a++);p&&t.add(p)}t.multiplyScalar(b),g.add(t),m.newEdge=f.length,f.push(g)}let E,S,P,M,B,R,H,Q=[];for(i=0,n=o.length;i<n;i++){for(R=o[i],B=c[i].edges,r=B.length,r==3?E=3/16:r>3&&(E=3/(8*r)),S=1-r*Number(E),P=E,r<=2&&(r==2?(S=3/4,P=1/8):r==1||r==0),H=R.clone().multiplyScalar(S),t.set(0,0,0),s=0;s<r;s++)M=B[s],p=M.a!==R?M.a:M.b,t.add(p);t.multiplyScalar(Number(P)),H.add(t),Q.push(H)}let z=Q.concat(f),y=Q.length,A,D,O,C=[],I=[],k,L,w,N,X=new $,T=new $,U=new $;for(i=0,n=l.length;i<n;i++)v=l[i],A=Number(Lv(v.a,v.b,d).newEdge)+y,D=Number(Lv(v.b,v.c,d).newEdge)+y,O=Number(Lv(v.c,v.a,d).newEdge)+y,fp(C,A,D,O,v.materialIndex),fp(C,v.a,A,O,v.materialIndex),fp(C,v.b,D,A,v.materialIndex),fp(C,v.c,O,D,v.materialIndex),u&&(k=h[i],L=k[0],w=k[1],N=k[2],X.set(wh(L.x,w.x),wh(L.y,w.y)),T.set(wh(w.x,N.x),wh(w.y,N.y)),U.set(wh(L.x,N.x),wh(L.y,N.y)),pp(I,X,T,U),pp(I,L,X,U),pp(I,w,T,X),pp(I,N,U,T));e.vertices=z,e.faces=C,u&&(e.faceVertexUvs[0]=I)}},kr=new F,oq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var s,a;let r=(a=(s=e.geometry)!=null?s:t==null?void 0:t.geometry)!=null?a:new vt().copy(new $o(100,100,100)),i;t===void 0?(r.computeBoundingBox(),r.boundingBox.getSize(kr),i={width:kr.x,height:kr.y,depth:kr.z,subdivisions:0}):i=t.parameters;let n=me(me({},i),e.parameters);return{parameters:{width:Math.abs(n.width),height:Math.abs(n.height),depth:Math.abs(n.depth),subdivisions:Math.abs(n.subdivisions)},geometry:r}}static build(e){var l;let{width:t,height:r,depth:i,subdivisions:n}=e.parameters,s=(l=e.geometry)!=null?l:new vt().copy(new $o(100,100,100)),a=s.userData.parameters;a===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(kr)):kr.set(a.width,a.height,a.depth),(t!==kr.x||r!==kr.y||i!==kr.z)&&s.scale(kr.x===0?1:t/kr.x,kr.y===0?1:r/kr.y,kr.z===0?1:i/kr.z);let o=s.originalGeometry;return n>0?(o===void 0||(a==null?void 0:a.subdivisions)!==n)&&(o===void 0&&(o=s),s=new aq(n).modify(o).toBufferGeometry()):(o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()),o!==void 0&&Object.assign(s,{originalGeometry:o}),delete e.geometry,Object.assign(s,{userData:qe(me({},e),{type:"NonParametricGeometry"})})}static loadFromUrl(e,t,r){new Gw(r).load(e,i=>{let n=this.normalizeInputs({geometry:i});i.boundingBox.getSize(kr);let s=100/kr.x;Object.assign(n.parameters,{width:100,height:kr.y*s,depth:kr.z*s}),t(this.build(n))})}},lq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof yr?e.shape:new yr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:0)})}}static build(e){let{width:t,height:r,spikes:i,cornerRadius:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}=e.parameters,l=e.shape,h=t*.5,u=r*.5,c=0,d=0,f=2*Math.PI/i;for(let m=0;m<i;m++){let g=f*m,v=c+Math.sin(g)*h,x=d+Math.cos(g)*u;l.addPoint(l.createPoint(v,x))}l.isClosed=!0;for(let m=0,g=l.points.length;m<g;m++)l.points[m].roundness=n;l.roundness=n,l.update();let p=Ka.create({shape:l,parameters:{roundness:n,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(p,{userData:qe(me({},e),{type:"PolygonGeometry"})})}},hq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:r.width)})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,heightSegments:s,openEnded:a,cornerRadius:o,cornerSegments:l}=e.parameters,h=new cq(t*.5,r,n,s,a,o,l);return h.scale(1,1,i/t),Object.assign(h,{userData:qe(me({},e),{type:"PyramidGeometry"})})}};function vc(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function Ov(e,t,r,i,n,s){let a=t.clone().sub(e),o=r.clone().sub(e),l=a.angleTo(o);if(a.normalize(),o.normalize(),i===n){let h=a.add(o).normalize();s.copy(e).addScaledVector(h,i/Math.sin(l/2))}else{let h=a.angleTo(o);s.copy(e),s.addScaledVector(a,n/Math.sin(h)),s.addScaledVector(o,i/Math.sin(h))}}function uq(e,t,r){let i=e.clone().sub(t),n=r.clone().sub(t);return i.projectOnVector(n),i.add(t)}var cq=class extends vt{constructor(e=.5,t=1,r=4,i=1,n=!1,s=0,a=4){super(),r=Math.floor(Math.max(3,r)),i=Math.floor(i),a=Math.floor(a);let o=[],l=[],h=[],u=[],c=0,d=t/2,f=Math.PI/r,p=e*Math.cos(Math.PI/r),m=2*Math.PI/r,g=(r-2)*Math.PI/r,v=Math.PI-g,x=new F(0,-d,0),b=new F(0,d,0),_=new $(e,-d),E=new $(p,-d),S=new $(0,b.y).sub(E),P=new $(0,b.y).sub(_),M=new $(S.y,-S.x).normalize(),B=new $(P.y,-P.x).normalize(),R=e*Math.cos(Math.PI/r)*Math.tan((Math.PI-S.angle())/2)-1e-8;s=Math.min(s,R);let H;{let O=new F(M.x,M.y,0),C=new F(Math.cos(m)*O.x,O.y,Math.sin(m)*O.x);H=O.angleTo(C)}let Q=s/Math.tan((Math.PI-S.angle())/2),z=s/Math.tan((Math.PI-H)/2),y=new F;if(!n){l.push(x.x,x.y,x.z),h.push(0,-1,0),u.push(0,0);let O=c++,C=[],I=_.clone(),k=Q/Math.cos(Math.PI/r);I.x-=k;for(let L=0;L<r;L++){let w=L/r*Math.PI*2+f,N=new $(Math.sin(w),Math.cos(w));vc(I,N,y),l.push(y.x,y.y,y.z),h.push(0,-1,0),u.push(0,0),C.push(c++)}for(let L=0;L<C.length;L++)o.push(C[L],O,C[(L+1)%C.length])}{let O=new F,C=new F,I=new F,k=new F,L=new F,w=new F;for(let N=0;N<r;N++){let X=N/r*Math.PI*2+f,T=(N+.5)/r*Math.PI*2+f,U=(N+1)/r*Math.PI*2+f,q=new $(Math.sin(X),Math.cos(X)),W=new $(Math.sin(T),Math.cos(T)),J=new $(Math.sin(U),Math.cos(U));vc(_,q,C),vc(_,J,I),vc(M,W,O),Ov(b,C,I,z,z,k),l.push(k.x,k.y,k.z),Ov(C,b,I,z,Q,L),l.push(L.x,L.y,L.z),Ov(I,C,b,Q,z,w),l.push(w.x,w.y,w.z),h.push(O.x,O.y,O.z),h.push(O.x,O.y,O.z),h.push(O.x,O.y,O.z),u.push(0,0),u.push(0,0),u.push(0,0);let K=c++,ie=c++,Z=c++;if(o.push(K,ie,Z),s>0){{let ce=C.clone().add(I).multiplyScalar(.5),ke=b.clone().sub(ce).normalize(),be=x.clone().sub(ce).normalize().add(ke).normalize().multiplyScalar(-1),_e=w.clone().sub(L);A(ce,_e,be,S.angle())}let ue,le;{let ce=new F;vc(B,J,ce);let ke=w.clone().add(k).multiplyScalar(.5);ke=uq(ke,I,b);let be=w.clone().sub(k);[ue,le]=A(ke,be,ce,H,k.y)}{let ce=ue,ke=ce.clone().setY(0).normalize(),be=new F(0,-1,0),_e=ke.clone().cross(be);D(ce,ke,be,_e)}{let ce=S.angle(),ke=Math.PI-ce,be=b.clone();be.y-=s/Math.sin(ce-Math.PI/2);let _e=new F,ze=[];for(let Ve=0;Ve<a;Ve++){let j=[],G=Math.PI/2-ke*Ve/a,se=Math.cos(G),ye=Math.sin(G),ge=T;for(let we=0;we<=Ve;we++){let et=Math.cos(ge),oe=Math.sin(ge);O.x=se*oe,O.y=ye,O.z=se*et,_e.copy(be).addScaledVector(O,s),l.push(_e.x,_e.y,_e.z),h.push(O.x,O.y,O.z),u.push(0,0),j.push(c++),ge+=Math.PI*2/Ve/r}ze.push(j)}le.reverse(),ze.push(le);let Be=ze.length-1;for(let Ve=0;Ve<Be;Ve++){let j=ze[Ve],G=ze[Ve+1],se=j.length-1;o.push(G[1],j[0],G[0]);for(let ye=1;ye<=se;ye++)o.push(j[ye],j[ye-1],G[ye]),o.push(G[ye+1],j[ye],G[ye])}}}}}this.setIndex(o),this.setAttribute("position",new Ge(l,3)),this.setAttribute("normal",new Ge(h,3)),this.setAttribute("uv",new Ge(u,2));function A(O,C,I,k,L){let w=-k/2,N=(Math.PI-k)/2,X=C.clone().normalize().cross(I);O.addScaledVector(I,-s/Math.sin(N));let T=new F,U=new F,q=1,W=c,J=[];for(let K=0;K<=a;K++){let ie=w+K/a*k;U.set(0,0,0),U.addScaledVector(X,Math.sin(ie)),U.addScaledVector(I,Math.cos(ie));for(let Z=0;Z<=q;Z++){let ue=Z/q-.5;if(T.copy(O),T.addScaledVector(C,ue),T.addScaledVector(U,s),L!=null){let le=Math.max(0,T.y-L);T.addScaledVector(C,-le/C.y)}l.push(T.x,T.y,T.z),h.push(U.x,U.y,U.z),u.push(0,0),Z===0&&J.push(c),c++}}for(let K=0;K<a;K++)for(let ie=0;ie<q;ie++){let Z=W+ie+(q+1)*K,ue=Z+(q+1),le=ue+1,ce=Z+1;o.push(Z,ue,ce),o.push(ue,le,ce)}return[O.clone().addScaledVector(C,.5),J]}function D(O,C,I,k){let L=Math.PI/2,w=P.angle()-L,N=[],X=new F,T=new F;for(let q=0;q<=a;q++){let W=[],J=q/a;for(let K=0;K<=q;K++){let ie=((q?K/q:0)-.5)*v,Z=Math.cos(ie),ue=Math.sin(ie),le=Math.atan(Math.tan(w)*Z),ce=(L+le)*J,ke=Math.cos(ce),be=Math.sin(ce);X.set(0,0,0),X.addScaledVector(C,be*Z),X.addScaledVector(I,ke),X.addScaledVector(k,be*ue),T.copy(O).addScaledVector(X,s),l.push(T.x,T.y,T.z),h.push(X.x,X.y,X.z),u.push(0,0),W.push(c++)}N.push(W)}let U=N.length-1;for(let q=0;q<U;q++){let W=N[q],J=N[q+1],K=W.length-1;o.push(W[0],J[1],J[0]);for(let ie=1;ie<=K;ie++)o.push(W[ie-1],W[ie],J[ie]),o.push(W[ie],J[ie+1],J[ie])}}}},A6=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n,s,a,o;let r=Object.assign({},(n=t==null?void 0:t.parameters)!=null?n:{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),i=Object.assign((s=t==null?void 0:t.ui)!=null?s:{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof yr?e.shape:new yr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((a=r.height)!=null?a:r.width),depth:Math.abs((o=r.depth)!=null?o:0)}),ui:i}}static build(e){let t=e.shape,{width:r,height:i,cornerRadius:n,cornerType:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,h={x:r*.5,y:i*.5},u={x:-h.x,y:-h.y},c={x:h.x,y:h.y};function d(_,E,S){return E>r&&S>i?Math.min(_*r/E,_*i/S):E>r?_*r/E:S>i?_*i/S:_}let f=[];f[0]=n[0]===0?0:d(n[0],n[0]+n[3],n[0]+n[1]),f[1]=n[1]===0?0:d(n[1],n[1]+n[2],n[1]+n[0]),f[2]=n[2]===0?0:d(n[2],n[2]+n[1],n[2]+n[3]),f[3]=n[3]===0?0:d(n[3],n[3]+n[0],n[3]+n[2]);let p=u.x,m=c.x,g=c.y,v=u.y;t.addPoint(t.createPoint(p,g)),t.addPoint(t.createPoint(m,g)),t.addPoint(t.createPoint(m,v)),t.addPoint(t.createPoint(p,v)),t.isClosed=!0;let x=!0;for(let _=0,E=t.points.length;_<E;_++)t.points[_].roundness=f[_],_>0&&f[_]!==f[_-1]&&(x=!1);x&&(t.roundness=f[0]),t.useCubicForRoundedCorners=s!==1,t.update();let b=Ka.create({shape:t,parameters:{depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(b,{userData:qe(me({},e),{type:"RectangleGeometry"})})}},dq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:r.width)})}}static build(e){let{width:t=100,height:r=t,depth:i=t,widthSegments:n=64,heightSegments:s=64,phiStart:a,phiLength:o,thetaStart:l,thetaLength:h}=e.parameters,u=new Fw(.5*t,n,s,a,o,l,h);return u.scale(1,r/t,i/t),Object.assign(u,{userData:qe(me({},e),{type:"SphereGeometry"})})}},fq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:0})}}static build(e){let{width:t=100,height:r=t,widthSegments:i=8,heightSegments:n=8}=e.parameters,s=new Mm(t,r,i,n);return s.scale(1,1,1),Object.assign(s,{userData:qe(me({},e),{type:"PlaneGeometry"})})}},pq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:r.width)})}}static build(e){let{width:t,height:r,depth:i,angle:n,cornerRadius:s,cornerSegments:a}=e.parameters,o=new mq(t,r,i,n,s,a);return Object.assign(o,{userData:qe(me({},e),{type:"BackdropGeometry"})})}},mq=class extends vt{constructor(e=1,t=1,r=1,i=90,n=10,s=24){super(),this.type="BackdropGeometry";let a=[],o=[],l=[],h=.001;n==0&&(s=1),s=Math.max(1,Math.floor(s)),n=Math.min(n,100),i=Math.min(180-h,i),i*=Math.PI/180;let u=[],c=(q=0,W=0,J=0)=>new F(q,W,J),d=c(),f=c(),[p,m,g]=[t/2,e/2,r/2],v=-m,x=+m,[b,_,E]=[c(v,-p,+g),c(v,-p,-g),c(v,+p,-g)],[S,P]=[q=>Math.sin(q),q=>Math.cos(q)],M=(q,W=!1)=>Math.sin(q-Math.PI/(1+ +W)),B=(q,W=!1)=>Math.cos(q-Math.PI/(1+ +W));E.y=S(i)*t-p;let R=P(i)*t-g;i<=Math.PI/2?E.z=Math.min(R,b.z-h):_.z=Math.min(_.z-R-g,b.z-h),d.subVectors(b,_),f.subVectors(E,_);let H=Math.min(d.length(),f.length())*n/100,Q=H*Math.tan(i/2),z=H/Math.cos(i/2),y=d.clone().normalize().add(f.normalize()).setLength(z).add(_);d.set(0,M(i,!0),B(i,!0)),u.push([E,d.clone()]);let A=(Math.PI-i)/s;for(let q=0;q<=s;q++){let W=Math.PI/2+i+q*A;d.set(0,S(W)*Q,P(W)*Q),d.add(y),f.set(0,M(W),B(W)),u.push([d.clone(),f.clone()])}u.push([b,c(0,1,0)]);let D=Math.sin(A/2)*Q*2,O=u.length-1,C=u[0][0].distanceTo(u[1][0]),I=u[O-1][0].distanceTo(u[O][0]),k=C+D*s+I;u[0].push(1);for(let q=0;q<=s;q++)u[q+1].push(1-(C+q*D)/k);u[O].push(0);let[L,w,N]=u[0],X,T,U;for(let q=1;q<u.length;q++)[X,T,U]=u[q],a.push(v,L.y,L.z,v,X.y,X.z,x,L.y,L.z,x,L.y,L.z,v,X.y,X.z,x,X.y,X.z),o.push(0,w.y,w.z,0,T.y,T.z,0,w.y,w.z,0,w.y,w.z,0,T.y,T.z,0,T.y,T.z),l.push(0,N,0,U,1,N,1,N,0,U,1,U),[L,w,N]=[X,T,U];this.setAttribute("position",new Ge(a,3)),this.setAttribute("normal",new Ge(o,3)),this.setAttribute("uv",new Ge(l,2))}},gq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof yr?e.shape:new yr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:0)})}}static build(e){let{width:t,height:r,innerRadiusPercent:i,spikes:n,cornerRadius:s,angle:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:h}=e.parameters,u=e.shape,c=t*.5,d=r*.5,f=0,p=0,m=a*Math.PI/360/n,g=Math.PI/2*3*-1,v=c*i/100,x=d*i/100;if(n===3&&i===50){m=2*Math.PI/n;for(let _=0;_<n;_++){let E=m*_,S=f+Math.sin(E)*c,P=p+Math.cos(E)*d;u.addPoint(u.createPoint(S,P))}}else for(let _=0;_<n;_++){let E=f+Math.cos(g)*c,S=p+Math.sin(g)*d;u.addPoint(u.createPoint(E,S)),g+=m,E=f+Math.cos(g)*v,S=p+Math.sin(g)*x,u.addPoint(u.createPoint(E,S)),g+=m}u.isClosed=!0;for(let _=0,E=u.points.length;_<E;_++)u.points[_].roundness=s;u.roundness=s,u.update();let b=Ka.create({shape:u,parameters:{roundness:s,depth:o,extrudeBevelSize:l,extrudeBevelSegments:h}});return Object.assign(b,{userData:qe(me({},e),{type:"StarGeometry"})})}},E6=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,depth:0},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:0)})}}static build(e){let{width:t,height:r}=e.parameters,i=new Mm(t,r);return Object.assign(i,{userData:qe(me({},e),{type:"TextFrameGeometry"})})}},vq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var a,o,l;let r=Object.assign({},(a=t==null?void 0:t.parameters)!=null?a:{width:100,radialSegments:32,tubularSegments:64,arc:Math.PI*2,cornerRadius:30,cornerSegments:8},e.parameters),i=Math.abs(r.width),n=Math.abs((o=r.height)!=null?o:r.width),s=Math.abs((l=r.depth)!=null?l:r.width*.25);return{parameters:Object.assign(r,{width:i,height:n,depth:s})}}static build(e){let{width:t,height:r,depth:i,radialSegments:n,tubularSegments:s,arc:a,cornerRadius:o,cornerSegments:l}=e.parameters,h=yq(t,r,i,t*.5,a,s,0,0,n,o,l);return h.scale(1,r/t,1),Object.assign(h,{userData:qe(me({},e),{type:"TorusGeometry"})})}};function yq(e,t,r,i,n,s,a,o,l,h,u){return[t,r]=[r,t],a=t/2,n/=2*Math.PI,n==1&&(h=0),new S6(!0,e,t,r,i,n,s,a,o,l,h,u)}var xq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s,a;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width),depth:Math.abs((s=r.depth)!=null?s:r.width),tube:(a=r.tube)!=null?a:r.width*.125})}}static build(e){let{width:t,tube:r,tubularSegments:i,radialSegments:n,p:s,q:a}=e.parameters,o=t*.5;o!==r&&(o-=r);let l=new qT(o,r,i,n,s,a);return Object.assign(l,{userData:qe(me({},e),{type:"TorusKnotGeometry"})})}},wq=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var i,n,s;let r=Object.assign({},(i=t==null?void 0:t.parameters)!=null?i:{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof yr?e.shape:new yr,parameters:Object.assign(r,{width:Math.abs(r.width),height:Math.abs((n=r.height)!=null?n:r.width*(r.isRect?1:Math.sqrt(3)/2)),depth:Math.abs((s=r.depth)!=null?s:0)})}}static build(e){let{width:t=100,height:r,cornerRadius:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a,isRect:o}=e.parameters,l=e.shape,h=t*.5,u=r*.5;o?(l.addPoint(l.createPoint(-h,u)),l.addPoint(l.createPoint(h,-u)),l.addPoint(l.createPoint(-h,-u))):(l.addPoint(l.createPoint(0,u)),l.addPoint(l.createPoint(h,-u)),l.addPoint(l.createPoint(-h,-u))),l.isClosed=!0;for(let d=0,f=l.points.length;d<f;d++)l.points[d].roundness=i;l.roundness=i,l.update();let c=Ka.create({shape:l,parameters:{roundness:i,depth:n,extrudeBevelSize:s,extrudeBevelSegments:a}});return Object.assign(c,{userData:qe(me({},e),{type:"TriangleGeometry"})})}},C6={};gT(C6,{addBarycentricAttribute:()=>Sq,fixUvs:()=>Aq,loadFromUrl:()=>Mq,resizeGeometry:()=>_q,roundShapePolygon:()=>bq});var aA=function(e,t){let r=t.x-e.x,i=t.y-e.y,n=Math.sqrt(r*r+i*i),s=r/n,a=i/n,o=Math.atan2(a,s);return{x:r,y:i,len:n,nx:s,ny:a,ang:o}},bq=(e,t,r)=>{let i,n,s,a,o,l,h,u,c,d,f,p,m,g,v=t.length;for(a=t[v-2],e.curves=[],i=1;i<v-1;i++){o=t[i%v],l=t[(i+1)%v];let x=aA(o,a),b=aA(o,l);h=x.nx*b.ny-x.ny*b.nx,u=x.nx*b.nx-x.ny*-b.ny,f=Math.asin(h),c=1,d=!1,u<0?f<0?f=Math.PI+f:(f=Math.PI-f,c=-1,d=!0):f>0&&(c=-1,d=!0),p=f/2,g=Math.abs(Math.cos(p)*r/Math.sin(p)),g>Math.min(x.len/2,b.len/2)?(g=Math.min(x.len/2,b.len/2),m=Math.abs(g*Math.sin(p)/Math.cos(p))):m=r,n=o.x+b.nx*g,s=o.y+b.ny*g,n+=-b.ny*m*c,s+=b.nx*m*c,e.absarc(n,s,m,x.ang+Math.PI/2*c,b.ang-Math.PI/2*c,d),a=o,o=l}e.closePath()},_q=(e,{width:t,height:r,depth:i})=>{t=Math.abs(t),r=Math.abs(r),i=Math.abs(i);let n=e.userData.parameters,s,a,o;t===0?(t=n.width,s=1):s=t/n.width,r===0?(r=n.height,a=1):a=r/n.height,i===0?(i=n.depth,o=1):o=i/n.depth,e.scale(s,a,o),n.width=t,n.height=r,n.depth=i},Sq=(e,t)=>{let r=[new F(1,0,0),new F(0,1,0),new F(0,0,1)],i=e.attributes.position,n=new Float32Array(i.count*3);for(let s=0,a=i.count;s<a;s++)r[s%3].toArray(n,s*3);e.setAttribute(t,new Ge(n,3))},Mq=e=>new Promise(t=>{new Gw().load(e,r=>t(r))}),Aq=(e,t,r)=>{let i=e.getAttribute("uv");if(i)for(let n=0;n<i.count;n++){let s=i.getX(n),a=i.getY(n);i.setXY(n,(s+t/2)/t,1-(a-r/2)/r*-1)}},T6=new Promise(e=>{}),oA=class{constructor(e){e=e!=null?e:{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},Lt=class{constructor(e){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=kt.generateUUID(),this.type=e,this.name="",this.userData={}}analyze(e,t){t=t!=null?t:{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,r){return r=r!=null?r:{},this.analyze(e,r),this.flow(e,t,r)}flow(e,t,r){r=r!=null?r:{},e.addFlow(r.slot,r.cache,r.context);let i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}build(e,t,r){t=t!=null?t:this.getType(e,t);let i=e.getNodeData(r!=null?r:this);return e.analyzing&&this.appendDepsNode(e,i,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,r)}updateFrame(e){}generateReadonly(e,t,r,i,n,s){return""}generate(e,t,r,i,n){return""}parse(e,t,r,i){}appendDepsNode(e,t,r){t.deps=(t.deps||0)+1;let i=e.getTypeLength(r);(i>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=i,t.output=r)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}getJSONNode(e){if((e==null?void 0:e.materials)&&(e==null?void 0:e.materials[this.uuid])!==void 0)return e.materials[this.uuid]}getHash(){let e="{",t,r;for(t in this)r=this[t],r instanceof Lt&&(e+='"'+t+'":'+r.getHash()+",");if(this.hashProperties)for(let i=0;i<this.hashProperties.length;i++)t=this.hashProperties[i],r=this[t],e+='"'+t+'":"'+String(r)+'",';return e+='"id":"'+this.uuid+'"}',e}copy(e){return this.name=e.name,e.type&&(this.type=e.type),e.frameId&&(this.frameId=e.frameId),e.hashProperties&&(this.hashProperties=e.hashProperties.map(t=>t)),this.userData=JSON.parse(JSON.stringify(e.userData)),this.shortcuts=JSON.parse(JSON.stringify(e.shortcuts)),this}clone(){return new this.constructor().copy(this)}createJSONNode(e){let t=e===void 0||typeof e=="string";if(typeof this.type!="string")throw new Error("Node does not allow serialization.");let r={};return r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),JSON.stringify(this.userData)!=="{}"&&(r.userData=this.userData),!t&&e&&(e.nodes[this.uuid]=r),r}toJSON(e){var t;return(t=this.getJSONNode(e))!=null?t:this.createJSONNode(e)}fromJSON(e,t){return this.uuid=e.uuid,this.type=e.type,e.name&&(this.name=e.name),e.userData&&(this.userData=e.userData),this}},Eq=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,r){r=r!==void 0?r:!0,this.keywords[e]={callback:t,cache:r}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},qi=new Eq,nr=class extends Lt{constructor(e,t){super(e),this.scope="",t=t!=null?t:{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,r,i){if(t=t!=null?t:this.getType(e),this.getShared(e,t)){let n=this.getUnique(e,t);n&&this.uuid===void 0&&(this.uuid=kt.generateUUID()),r=e.getUUID(r!=null?r:this.getUUID(),!n);let s=e.getNodeData(r),a=s.output||this.getType(e);if(e.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,r)):super.build(e,t,r);if(n)return s.name=s.name||super.build(e,t,r),s.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||s.deps===1))return super.build(e,t,r);r=this.getUUID(!1);let o=this.getTemp(e,r);if(o)return e.format(o,a,t);{o=super.generate(e,t,r,s.output,i);let l=this.generate(e,a,r);return e.addNodeCode(o+" = "+l+";"),e.format(o,a,t)}}return super.build(e,t,r)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let r=e.getVars()[t];return r?r.name:void 0}generate(e,t,r,i,n){return this.getShared(e,t)||console.error("TempNode is not shared"),r=r!=null?r:this.uuid,e.getTempVar(r,i!=null?i:this.getType(e),n,this.getLabel()).name}},Gn=class extends nr{constructor(e,t){t=t!=null?t:{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}createJSONNode(e){let t=super.createJSONNode(e);return this.readonly===!0&&(t.readonly=this.readonly),t}fromJSON(e,t){return super.fromJSON(e,t),e.readonly!==void 0&&this.setReadonly(e.readonly),this}generate(e,t,r,i,n,s){r=e.getUUID(r!=null?r:this.getUUID()),i=i!=null?i:this.getType(e);let a=e.getNodeData(r);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}copy(e){return super.copy(e),this.readonly=e.readonly,this}},Dn=class extends Gn{constructor(e=0,t){super("v2"),this.nodeType="Vector2",this.value=e instanceof $?e:new $(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,r,i,n,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",i,t)}copy(e){return super.copy(e),this.value.copy(e.value),this}},On=class extends Gn{constructor(e=0,t,r){super("v3"),this.nodeType="Vector3",this.value=e instanceof F?e:new F(e,t,r)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}get z(){return this.value.z}set z(e){this.value.z=e}generateReadonly(e,t,r,i,n,s){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,t)}copy(e){return super.copy(e),this.value.copy(e.value),this}},ia=class extends Ue{constructor(e,t,r,i){super(e,t,r),this.isColorA=!0,this.a=i}setRGBA(e,t,r,i){super.setRGB(e,t,r),this.a=i}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},Xh=class extends Gn{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof ia?e:new ia(e.r,e.g,e.b,e.a)}generateReadonly(e,t,r,i,n,s){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",i,t)}copy(e){return super.copy(e),this.value.copy(e.value),this}},Cq=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,lA=/[a-z_0-9]+/gi,ut=class extends nr{constructor(e,t,r,i,n){super(n),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=n===void 0,this.isInterface=!1,this.parse(e,t,r,i)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,r,i,n){let s,a=0,o=this.src;if(this.includes)for(let h=0;h<this.includes.length;h++)e.include(this.includes[h],this);for(let h in this.extensions)e.extensions[h]=!0;let l=[];for(;s=lA.exec(this.src);)l.push(s);for(let h=0;h<l.length;h++){let u=l[h],c=u[0],d=this.isMethod?!this.getInputByName(c):!0,f=c;if(this.keywords[c]||this.useKeywords&&d&&qi.containsKeyword(c)){let p=this.keywords[c];if(!p){let m=qi.getKeywordData(c);m.cache&&(p=e.keywords[c]),p=p||qi.getKeyword(c,e),m.cache&&(e.keywords[c]=p)}f=p.build(e)}c!==f&&(o=o.substring(0,u.index+a)+f+o.substring(u.index+c.length+a),a+=f.length-c.length),this.getIncludeByName(f)===void 0&&qi.contains(f)&&e.include(qi.get(f))}return t==="source"?o:this.isMethod?(this.isInterface||e.include(this,void 0,o),this.name):e.format("( "+o+" )",this.getType(e),t)}parse(e,t,r,i){if(this.src=e||"",this.includes=t!=null?t:[],this.extensions=r!=null?r:{},this.keywords=i!=null?i:{},this.isMethod){let n=Cq.exec(this.src);if(this.inputs=[],n&&n.length==4){this.type=n[1],this.name=n[2];let s=n[3].match(lA);if(s){let a=0;for(;a<s.length;){let o=s[a++],l;o==="in"||o==="out"||o==="inout"?l=s[a++]:(l=o,o="");let h=s[a++];this.inputs.push({name:h,type:l,qualifier:o})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}copy(e){return super.copy(e),this.isMethod=e.isMethod,this.useKeywords=e.useKeywords,e.type!==void 0&&(this.type=e.type),this.parse(e.src,e.includes,e.extensions,e.keywords),this}toJSON(e){var r;let t=this.getJSONNode(e);if(!t){t=this.createJSONNode(e),t.src=this.src,t.isMethod=this.isMethod,t.useKeywords=this.useKeywords,this.isMethod||(t.type=this.type),t.extensions=JSON.parse(JSON.stringify(this.extensions));let i={};for(let n in this.keywords)i[n]=this.keywords[n].toJSON(e).uuid;if(t.keywords=i,(r=this.includes)==null?void 0:r.length){let n=[];for(let s=0;s<this.includes.length;s++)n.push(this.includes[s].toJSON(e).uuid);t.includes=n}t.isMethod=this.isMethod,t.inputs=this.inputs}return t.nodeType=this.nodeType,t}fromJSON(e,t){if(super.fromJSON(e,t),e.inputs!==void 0&&(this.inputs=e.inputs),e.isMethod!==void 0&&(this.isMethod=e.isMethod),e.src&&(this.src=e.src),e.isMethod&&(this.isMethod=e.isMethod),e.useKeywords&&(this.useKeywords=e.useKeywords),e.type&&(this.type=e.type),e.extensions&&(this.extensions=e.extensions),e.keywords&&t){this.keywords={};for(let r in e.keywords)this.keywords[r]=t.getNode(e.keywords[r])}return e.includes&&t&&(this.includes=e.includes.map(r=>t.getNode(r))),this}},Tq=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,D6=class extends nr{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||D6.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,r,i,n){this.src=e||"";let s,a,o="",l=Tq.exec(e);this.useDefine=n!=null?n:this.src.charAt(0)==="#",l&&l.length>1?(a=l[1],s=l[2],o=l[3]):(s=this.src,a="f"),this.name=s,this.type=a,this.value=o}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,r,i,n){return e.format(this.name,this.getType(e),t)}copy(e){return super.copy(e),this.parse(e.src,void 0,void 0,void 0,e.useDefine),this}},Qt=D6;Qt.PI="PI",Qt.PI2="PI2",Qt.RECIPROCAL_PI="RECIPROCAL_PI",Qt.RECIPROCAL_PI2="RECIPROCAL_PI2",Qt.LOG2="LOG2",Qt.EPSILON="EPSILON";var Dq=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),Pq=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),P6=class extends nr{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,r,i,n){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=Dq.exec(e);if(t){let r=t[2],i;for(;i=Pq.exec(r);)this.inputs.push({type:i[1],name:i[2]});this.name=t[1]}else this.name="";this.type=this.name}},xb=class extends nr{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e!=null?e:0}generate(e,t){e.requires.uv[this.index]=!0;let r=this.index>0?this.index+1:"",i=e.isShader("vertex")?"uv"+r:"vUv"+r;return e.format(i,this.getType(e),t)}copy(e){return super.copy(e),this.index=e.index,this}toJSON(e){let t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),t.index=this.index),t.nodeType=this.nodeType,t}fromJSON(e,t){return super.fromJSON(e,t),e.index&&(this.index=e.index),this}};qi.addKeyword("uv",function(){return new xb});qi.addKeyword("uv2",function(){return new xb(1)});var Th=class extends nr{constructor(e=new Lt,t){super("v4"),this.nodeType="ColorSpace",this.factor=new Lt,this.input=e,this.method=t!=null?t:Th.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case la:return["Linear"];case St:return["sRGB"];default:return[]}}generate(e,t){var a;let r=this.input.build(e,"v4"),i=this.getType(e),n=Th.Nodes[this.method],s=e.include(n);if(s===Th.LINEAR_TO_LINEAR)return e.format(r,i,t);if(((a=n.inputs)==null?void 0:a.length)===2){let o=this.factor.build(e,"f");return e.format(s+"( "+r+", "+o+" )",i,t)}else return e.format(s+"( "+r+" )",i,t)}fromEncoding(e){let t=Th.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=Th.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}copy(e){return super.copy(e),this.input.copy(e.input),this.method=e.method,this.factor.copy(e.factor),this}},Ys=Th;Ys.Nodes={LinearToLinear:new ut(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new ut(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new ut(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},Ys.LINEAR_TO_LINEAR="LinearToLinear",Ys.SRGB_TO_LINEAR="sRGBToLinear",Ys.LINEAR_TO_SRGB="LinearTosRGB";var pr=class extends ut{constructor(e="",t,r,i,n){super(e,n,i,r,t),this.nodeType="Expression"}},Dh=class extends Qr{toJSON(e){let t=super.toJSON(e),r=e===void 0||typeof e=="string";if(this.image!==void 0&&!r){let i=this.image;if(Array.isArray(i)){e.images[i.uuid].url=[];for(let n=0;n<i.length;n++)e.images[i.uuid].url[n]=hA(i[n])}else e.images[i.uuid].url=hA(i)}return t}};function hA(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?Lq(e):(console.warn("THREE.Texture: Unable to serialize Texture."),"")}var bh;function Lq(e){if(/^data:/i.test(e.src))return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{bh===void 0&&(bh=document.createElement("canvas")),bh.width=e.width,bh.height=e.height;let i=bh.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=bh}let r=e.src.startsWith("blob:")?e.fileName:e.src;return/\.jpe?g$/i.test(r)?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}var Vs=class extends Gn{constructor(e=new Dh,t,r,i){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t!=null?t:new xb,this.bias=r,this.project=i!==void 0?i:!1}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){var h;if(t==="sampler2D")return this.getTexture(e,t);let r=this.getTexture(e,t),i=this.uv.build(e,this.project?"v4":"v2"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s,a;this.project?s="texture2DProj":s=n?"tex2DBias":"tex2D",n?a=s+"( "+r+", "+i+", "+n+" )":a=s+"( "+r+", "+i+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(o),this.colorSpace=(h=this.colorSpace)!=null?h:new Ys(new pr("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,l),e.removeContext(),e.format(a,l,t)}copy(e){return super.copy(e),e.value.isRenderTargetTexture?this.value=e.value:this.value.copy(e.value),this.uv.copy(e.uv),e.bias?this.bias?this.bias.copy(e.bias):this.bias=e.bias.clone():this.bias=void 0,e.colorSpace?this.colorSpace?this.colorSpace.copy(e.colorSpace):this.colorSpace=e.colorSpace.clone():this.colorSpace=void 0,this.project=e.project,e.value.isRenderTargetTexture||(this.value.updateMatrix(),this.value.needsUpdate=!0),this}},$e=class extends Gn{constructor(e){super("f"),this.nodeType="Float",this.value=e!=null?e:0}generateReadonly(e,t,r,i,n,s){return e.format(this.value+(this.value%1?"":".0"),i,t)}copy(e){return super.copy(e),this.value=e.value,this}},uA=class extends nr{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t!=null?t:[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,r,i,n){i=this.getType(e);let s=this.value,a=s.build(e,t)+"( ",o=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let h=s.inputs[l],u=this.inputs[l]||this.inputs[h.name];o.push(u.build(e,e.getTypeByFormat(h.type)))}a+=o.join(", ")+" )"}return e.format(a,i,t)}copy(e){return super.copy(e),this.value.copy(e.value),this.inputs=e.inputs.map(t=>t.clone()),this}toJSON(e){var r;let t=this.getJSONNode(e);if(!t){let i=this.value;if(t=this.createJSONNode(e),t.value=this.value.toJSON(e).uuid,(r=i.inputs)==null?void 0:r.length){t.inputs={};for(let n=0;n<i.inputs.length;n++){let s=i.inputs[n],a=this.inputs[n];t.inputs[s.name]=a.toJSON(e).uuid}}}return t}},L6=class extends nr{constructor(e=new Lt,t=new Lt,r=L6.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=r}getType(e){let t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t}generate(e,t){let r=this.getType(e);this.type=r;let i=this.a.build(e,r),n=this.b.build(e,r);return e.format("( "+i+" "+this.op+" "+n+" )",r,t)}copy(e){return super.copy(e),this.a.copy(e.a),this.b.copy(e.b),this.op=e.op,this}},Xs=L6;Xs.ADD="+",Xs.SUB="-",Xs.MUL="*",Xs.DIV="/";var Xt=class extends nr{constructor(e=new Lt,t=Xt.ABS,r,i){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:i=t,typeof r!="string"?this.c=r:i=r,this.method=i,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case Xt.MIX:case Xt.CLAMP:case Xt.REFRACT:case Xt.SMOOTHSTEP:case Xt.FACEFORWARD:return 3;case Xt.MIN:case Xt.MAX:case Xt.MOD:case Xt.STEP:case Xt.REFLECT:case Xt.DISTANCE:case Xt.DOT:case Xt.CROSS:case Xt.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,i=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>i?this.a.getType(e):r>i?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case Xt.LENGTH:case Xt.DISTANCE:case Xt.DOT:return"f";case Xt.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let r,i,n,s=this.a?e.getTypeLength(this.a.getType(e)):0,a=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),h=this.getType(e);switch(this.type=h,this.method){case Xt.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case Xt.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case Xt.CROSS:r=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case Xt.STEP:r=this.a.build(e,s===1?"f":l),i=this.b.build(e,l);break;case Xt.MIN:case Xt.MAX:case Xt.MOD:r=this.a.build(e,l),i=this.b.build(e,a===1?"f":l);break;case Xt.REFRACT:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,"f");break;case Xt.MIX:r=this.a.build(e,l),i=this.b.build(e,l),n=this.c.build(e,o===1?"f":l);break;default:r=this.a.build(e,l),this.b&&(i=this.b.build(e,l)),this.c&&(n=this.c.build(e,l));break}let u=[];u.push(r),i&&u.push(i),n&&u.push(n);let c=this.getNumInputs(e);if(u.length!==c)throw Error(`Arguments not match used in "${this.method}". Require ${c}, currently ${u.length}.`);return e.format(this.method+"( "+u.join(", ")+" )",h,t)}copy(e){return super.copy(e),this.a.copy(e.a),this.b=e.b instanceof Lt?e.b.clone():e.b,this.c=e.c instanceof Lt?e.c.clone():e.c,this.method=e.method,this}},mt=Xt;mt.RAD="radians",mt.DEG="degrees",mt.EXP="exp",mt.EXP2="exp2",mt.LOG="log",mt.LOG2="log2",mt.SQRT="sqrt",mt.INV_SQRT="inversesqrt",mt.FLOOR="floor",mt.CEIL="ceil",mt.NORMALIZE="normalize",mt.FRACT="fract",mt.SATURATE="saturate",mt.SIN="sin",mt.COS="cos",mt.TAN="tan",mt.ASIN="asin",mt.ACOS="acos",mt.ARCTAN="atan",mt.ABS="abs",mt.SIGN="sign",mt.LENGTH="length",mt.NEGATE="negate",mt.INVERT="invert",mt.MIN="min",mt.MAX="max",mt.MOD="mod",mt.STEP="step",mt.REFLECT="reflect",mt.DISTANCE="distance",mt.DOT="dot",mt.CROSS="cross",mt.POW="pow",mt.MIX="mix",mt.CLAMP="clamp",mt.REFRACT="refract",mt.SMOOTHSTEP="smoothstep",mt.FACEFORWARD="faceforward";var Oc=class extends nr{constructor(e=new Lt,t=new Lt,r=new Lt){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=r}bilinearCubeUV(e,t,r,i){var o,l,h,u;let n=new uA(Oc.Nodes.bilinearCubeUV,[t,r,i]);this.colorSpaceTL=(o=this.colorSpaceTL)!=null?o:new Ys(new pr("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(n.build(e)+".tl"),this.colorSpaceTR=(l=this.colorSpaceTR)!=null?l:new Ys(new pr("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(n.build(e)+".tr"),this.colorSpaceBL=(h=this.colorSpaceBL)!=null?h:new Ys(new pr("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(n.build(e)+".bl"),this.colorSpaceBR=(u=this.colorSpaceBR)!=null?u:new Ys(new pr("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(n.build(e)+".br");let s={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(s),this.colorSpaceTLExp=new pr(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new pr(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new pr(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new pr(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let a=new pr("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return a.keywords.cubeUV_TL=this.colorSpaceTLExp,a.keywords.cubeUV_TR=this.colorSpaceTRExp,a.keywords.cubeUV_BL=this.colorSpaceBLExp,a.keywords.cubeUV_BR=this.colorSpaceBRExp,a.keywords.cubeUV=n,a}generate(e,t){if(e.isShader("fragment")){let r=this.uv,i=this.bias||e.context.roughness,n=new uA(Oc.Nodes.roughnessToMip,[i]),s=new mt(n,Oc.Nodes.m0,Oc.Nodes.cubeUV_maxMipLevel,mt.CLAMP),a=new mt(s,mt.FLOOR),o=new mt(s,mt.FRACT),l=this.bilinearCubeUV(e,this.value,r,a),h=this.bilinearCubeUV(e,this.value,r,new Xs(a,new $e(1).setReadonly(!0),Xs.ADD)),u=new mt(l,h,o,mt.MIX);return e.format(u.build(e),"v4",t)}else return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}copy(e){return super.copy(e),this.uv.copy(e.uv),this.bias.copy(e.bias),this.value.copy(e.value),e.colorSpaceTL?this.colorSpaceTL?this.colorSpaceTL.copy(e.colorSpaceTL):this.colorSpaceTL=e.colorSpaceTL.clone():this.colorSpaceTL=void 0,e.colorSpaceTR?this.colorSpaceTR?this.colorSpaceTR.copy(e.colorSpaceTR):this.colorSpaceTR=e.colorSpaceTR.clone():this.colorSpaceTR=void 0,e.colorSpaceBL?this.colorSpaceBL?this.colorSpaceBL.copy(e.colorSpaceBL):this.colorSpaceBL=e.colorSpaceBL.clone():this.colorSpaceBL=void 0,e.colorSpaceBR?this.colorSpaceBR?this.colorSpaceBR.copy(e.colorSpaceBR):this.colorSpaceBR=e.colorSpaceBR.clone():this.colorSpaceBR=void 0,e.colorSpaceTLExp?this.colorSpaceTLExp?this.colorSpaceTLExp.copy(e.colorSpaceTLExp):this.colorSpaceTLExp=e.colorSpaceTLExp.clone():this.colorSpaceTLExp=void 0,e.colorSpaceTRExp?this.colorSpaceTRExp?this.colorSpaceTRExp.copy(e.colorSpaceTRExp):this.colorSpaceTRExp=e.colorSpaceTRExp.clone():this.colorSpaceTRExp=void 0,e.colorSpaceBLExp?this.colorSpaceBLExp?this.colorSpaceBLExp.copy(e.colorSpaceBLExp):this.colorSpaceBLExp=e.colorSpaceBLExp.clone():this.colorSpaceBLExp=void 0,e.colorSpaceBRExp?this.colorSpaceBRExp?this.colorSpaceBRExp.copy(e.colorSpaceBRExp):this.colorSpaceBRExp=e.colorSpaceBRExp.clone():this.colorSpaceBRExp=void 0,this}},ix=Oc;ix.Nodes=function(){let e=new P6(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new Qt("float cubeUV_maxMipLevel 8.0",!0),r=new Qt("float cubeUV_minMipLevel 4.0",!0),i=new Qt("float cubeUV_maxTileSize 256.0",!0),n=new Qt("float cubeUV_minTileSize 16.0",!0),s=new ut(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let a=new ut(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);a.useKeywords=!1;let o=new ut(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,s,a,t,r,i,n]);o.useKeywords=!1;let l=new Qt("float r0 1.0",!0),h=new Qt("float v0 0.339",!0),u=new Qt("float m0 -2.0",!0),c=new Qt("float r1 0.8",!0),d=new Qt("float v1 0.276",!0),f=new Qt("float m1 -1.0",!0),p=new Qt("float r4 0.4",!0),m=new Qt("float v4 0.046",!0),g=new Qt("float m4 2.0",!0),v=new Qt("float r5 0.305",!0),x=new Qt("float v5 0.016",!0),b=new Qt("float m5 3.0",!0),_=new Qt("float r6 0.21",!0),E=new Qt("float v6 0.0038",!0),S=new Qt("float m6 4.0",!0),P=[l,h,u,c,d,f,p,m,g,v,x,b,_,E,S],M=new ut(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,P);return{bilinearCubeUV:o,roughnessToMip:M,m0:u,cubeUV_maxMipLevel:t}}();var Ph=class extends nr{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e!=null?e:Ph.VIEW}getShared(){return this.scope===Ph.WORLD}build(e,t,r,i){let n=e.context[this.scope+"Normal"];return n?n.build(e,t,r,i):super.build(e,t,r)}generate(e,t,r,i,n){let s;switch(this.scope){case Ph.VIEW:e.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case Ph.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case Ph.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal");break}return e.format(s,this.getType(e),t)}copy(e){return super.copy(e),this.scope=e.scope,this}toJSON(e){let t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),t.scope=this.scope),t.nodeType=this.nodeType,t}fromJSON(e,t){return super.fromJSON(e,t),e.scope&&(this.scope=e.scope),this}},Ki=Ph;Ki.LOCAL="local",Ki.WORLD="world",Ki.VIEW="view",Ki.NORMAL="normal";qi.addKeyword("viewNormal",function(){return new Ki(Ki.VIEW)});qi.addKeyword("localNormal",function(){return new Ki(Ki.NORMAL)});qi.addKeyword("worldNormal",function(){return new Ki(Ki.WORLD)});var Ta=class extends nr{constructor(e){super("v3"),this.nodeType="Position",this.scope=e!=null?e:Ta.LOCAL}getType(){switch(this.scope){case Ta.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Ta.LOCAL:case Ta.WORLD:return!1}return!0}generate(e,t,r,i,n){let s;switch(this.scope){case Ta.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case Ta.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case Ta.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Ta.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(s,this.getType(),t)}copy(e){return super.copy(e),this.scope=e.scope,this}toJSON(e){let t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),t.scope=this.scope),t.nodeType=this.nodeType,t}fromJSON(e,t){return super.fromJSON(e,t),e.scope&&(this.scope=e.scope),this}},dn=Ta;dn.LOCAL="local",dn.WORLD="world",dn.VIEW="view",dn.PROJECTION="projection";qi.addKeyword("position",function(){return new dn});qi.addKeyword("worldPosition",function(){return new dn(dn.WORLD)});qi.addKeyword("viewPosition",function(){return new dn(dn.VIEW)});var Ts=class extends nr{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e!=null?e:Ts.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case Ts.SPHERE:return"v2"}return this.type}generate(e,t){let r=this.getUnique(e);if(e.isShader("fragment")){let i;switch(this.scope){case Ts.VECTOR:{let n=new Ki(Ki.VIEW),s=e.context.roughness,a=n.build(e,"v3"),o=new dn(dn.VIEW).build(e,"v3"),l=s?s.build(e,"f"):void 0,h=`reflect( -normalize( ${o} ), ${a} )`;l&&(h=`normalize( mix( ${h}, ${a}, ${l} * ${l} ) )`);let u=`inverseTransformDirection( ${h}, viewMatrix )`;r?(e.addNodeCode(`vec3 reflectVec = ${u};`),i="reflectVec"):i=u;break}case Ts.CUBE:{let n=new Ts(Ts.VECTOR).build(e,"v3"),s="vec3( -"+n+".x, "+n+".yz )";r?(e.addNodeCode(`vec3 reflectCubeVec = ${s};`),i="reflectCubeVec"):i=s;break}case Ts.SPHERE:{let n=new Ts(Ts.VECTOR).build(e,"v3"),s="normalize( ( viewMatrix * vec4( "+n+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";r?(e.addNodeCode(`vec2 reflectSphereVec = ${s};`),i="reflectSphereVec"):i=s;break}}return e.format(i,this.getType(),t)}else return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}copy(e){return super.copy(e),this.scope=e.scope,this}toJSON(e){let t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),t.scope=this.scope),t.nodeType=this.nodeType,t}fromJSON(e,t){return super.fromJSON(e,t),e.scope&&(this.scope=e.scope),this}},lu=Ts;lu.CUBE="cube",lu.SPHERE="sphere",lu.VECTOR="vector";var Rq=class extends nr{constructor(e=new Vs,t,r){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new ix(this.value,t!=null?t:new lu(lu.VECTOR),r),this.irradianceNode=new ix(this.value,new Ki(Ki.WORLD),new $e(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}copy(e){return super.copy(e),this.value.copy(e.value),this.radianceNode.copy(e.radianceNode),this.irradianceNode.copy(e.irradianceNode),this}},Oq=class extends Gn{constructor(e=new Lw,t,r){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t!=null?t:new lu,this.bias=r}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var l,h;if(t==="samplerCube")return this.getTexture(e,t);let r=this.getTexture(e,t),i=(l=this.uv)==null?void 0:l.build(e,"v3"),n=this.bias?this.bias.build(e,"f"):void 0;n===void 0&&e.context.bias&&(n=e.context.bias.setTexture(this).build(e,"f"));let s;n?s="texCubeBias( "+r+", "+i+", "+n+" )":s="texCube( "+r+", "+i+" )";let a={include:e.isShader("vertex"),ignoreCache:!0},o=this.getType(e);return e.addContext(a),this.colorSpace=(h=this.colorSpace)!=null?h:new Ys(new pr("",o)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(e,o),e.removeContext(),e.format(s,o,t)}copy(e){return super.copy(e),this.value.copy(e.value),e.uv?this.uv?this.uv.copy(e.uv):this.uv=e.uv.clone():this.uv=void 0,e.bias?this.bias?this.bias.copy(e.bias):this.bias=e.bias.clone():this.bias=void 0,this}},cA=["x","y","z","w"],Iq=["float","vec2","vec3","vec4"],Nq={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},Bq={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},kq=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.getIncludesCode=function(){function e(t,r){return t.deps.length-r.deps.length}return function(t,r){let i=this.getIncludes(t,r);if(!i)return"";let n="";i=i.sort(e);for(let s=0;s<i.length;s++)i[s].src&&(n+=i[s].src+`
`);return n}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.requires={uv:[],color:[],lights:!1,fog:!1,transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.buildShader("vertex",e),this.buildShader("fragment",t);for(let r=0;r<this.requires.uv.length;r++)if(this.requires.uv[r]){let i=r>0?r+1:"";this.addVaryCode("varying vec2 vUv"+i+";"),r>0&&this.addVertexParsCode("attribute vec2 uv"+i+";"),this.addVertexFinalCode("vUv"+i+" = uv"+i+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.material=e,this.renderer=t,this.requires.lights=e.lights,this.requires.fog=e.fog,this.mergeDefines(e.defines),this}addFlow(e,t,r){return this.addSlot(e).addCache(t).addContext(r)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e!=null?e:"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t!=null?t:this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t!=null?t:this.shader]+=e+`
`}clearNodeCode(e){e=e!=null?e:this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t!=null?t:this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t!=null?t:this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,r,i="varying",n="V",s=""){let a=this.getVars(i),o=a[e];if(!o){let l=a.length;o={name:r||"node"+n+l+(s?"_"+s:""),type:t},a.push(o),a[e]=o}return o}getTempVar(e,t,r,i){return this.getVar(e,t,r,this.shader,"T",i)}getAttribute(e,t){if(!this.attributes[e]){let r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t!=null?t:"";let r="";for(let i=0,n=e.length;i<n;++i){let s=e[i],a=s.type,o=s.name,l=s.size,h=this.getFormatByType(a);if(h===void 0)throw new Error("Node pars "+h+" not found.");h.includes("[]")?r+=t+" "+h.substring(0,h.length-2)+" "+o+`[${l}];
`:r+=t+" "+h+" "+o+`;
`}return r}getVars(e){return this.inputs.vars[e!=null?e:this.shader]}getNodeData(e){let t=e instanceof Lt?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,r,i,n,s){if(t.includes("[]")){let a=this.inputs.arrayUniforms,o=a.list.length,l=new oA({type:t,size:r.size,name:i||"nodeUA"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}else{let a=this.inputs.uniforms,o=a.list.length,l=new oA({type:t,name:i||"nodeU"+o+(s?"_"+s:""),node:r,needsUpdate:n});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,r,i,n){return this.createUniform("vertex",e,t,r,i,n)}createFragmentUniform(e,t,r,i,n){return this.createUniform("fragment",e,t,r,i,n)}include(e,t,r){var s;let i;if(e=typeof e=="string"?qi.get(e):e,this.context.include===!1)return e.name;e instanceof ut?i=this.includes.functions:e instanceof Qt?i=this.includes.consts:e instanceof P6&&(i=this.includes.structs);let n=i[this.shader]=i[this.shader]||[];if(e){let a=n[e.name];if(a||(a=n[e.name]={node:e,deps:[]},n.push(a),a.src=e.build(this,"source")),e instanceof ut&&t&&n[t.name]&&n[t.name].deps.indexOf(e)===-1&&(n[t.name].deps.push(e),(s=e.includes)==null?void 0:s.length)){let o=0;do this.include(e.includes[o++],t);while(o<e.includes.length)}return r&&(a.src=r),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return Iq[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!=null&&r.isNode)return r}}resolve(...e){for(let t=0;t<arguments.length;t++){let r=e[t];if(r!==void 0){if(r.isNode)return r;if(r.isTexture)switch(r.mapping){case zl:case Fl:return new Oq(r);case Xd:return new Rq(new Vs(r));default:return new Vs(r)}else{if(r.isVector2)return new Dn(r);if(r.isVector3)return new On(r);if(r.isVector4)return new Xh(r)}}}}format(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return Nq[e]||e}getFormatByType(e){return Bq[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return cA[e]}getIndexByElement(e){return cA.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=la,t===la&&this.context.gamma&&(t=St),t}},dA=class extends Lt{constructor(e=new Lt){super("v4"),this.nodeType="Raw",this.value=e}generate(e){let t=this.value.analyzeAndFlow(e,this.type),r=t.code+`
`;return e.isShader("vertex")?r+="gl_Position = "+t.result+";":r+="gl_FragColor = "+t.result+";",r}copy(e){return super.copy(e),this.value.copy(e.value),this}},Rr=class extends Gn{constructor(e=0,t,r,i){super("c"),this.nodeType="Color",this.value=e instanceof ia?e:new ia(e||0,t,r,i)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,r,i,n,s){r=e.getUUID(r!=null?r:this.getUUID()),i=i!=null?i:this.getType(e);let a=e.getNodeData(r),o=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return o?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(a.vertex.name,i,t)):(a.fragment||(a.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(a.fragment.name,i,t))}generateReadonly(e,t,r,i,n,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,t)}},Ft=class extends Gn{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e!=null?e:0)}generateReadonly(e,t,r,i,n,s){return e.format(this.value.toString(),i,t)}copy(e){return super.copy(e),this.value=e.value,this}},Cr=class{constructor(e,t,r,i){if(this.next=void 0,this.uniforms={},this.textures={},this.defines={},this.id=e,this.uuid=t,r){this.type=r.type;for(let n in r)n!=="type"&&n!=="calpha"&&(this.uniforms[`f${this.id}_${n}`]=r[n]);for(let n in i)this.defines[n]=i[n]}}copy(e){this.id=e.id,this.type=e.type,this.defines=me({},e.defines);for(let t in e.uniforms)this.getName(t)==="transmissionSamplerMap"||this.getName(t)==="transmissionDepthMap"||(this.uniforms[t]?this.uniforms[t].copy(e.uniforms[t]):this.uniforms[t]=e.uniforms[t].clone());return this}clone(){return new Cr(this.id).copy(this)}fromJSON(e,t){this.id=e.id,this.defines=me({},e.defines);for(let r in e.uniforms)this.uniforms[r]=t.getNode(e.uniforms[r]);if(e.type==="texture"){if(!(`f${this.id}_textureSize`in this.uniforms)){let r=this.uniforms[`f${this.id}_texture`].value.image;this.uniforms[`f${e.id}_textureSize`]=new On(r.width,r.height)}`f${this.id}_size`in this.uniforms||(this.uniforms[`f${e.id}_size`]=new Dn(200,200)),`f${e.id}_axis`in this.uniforms||(this.uniforms[`f${e.id}_axis`]=new Ft(0)),`f${e.id}_side`in this.uniforms||(this.uniforms[`f${e.id}_side`]=new Ft(0)),`f${e.id}_projection`in this.uniforms||(this.uniforms[`f${e.id}_projection`]=new Ft(0))}else e.type==="noise"?(`f${e.id}_noiseType`in this.uniforms||(this.uniforms[`f${e.id}_noiseType`]=new Ft(0)),`f${e.id}_size`in this.uniforms||(this.uniforms[`f${e.id}_size`]=new On(-1,-1,-1))):e.type==="depth"&&(`f${e.id}_isWorldSpace`in this.uniforms||(this.uniforms[`f${e.id}_isWorldSpace`]=new $e(1)));return this}toJSON(e){let t={};for(let r in this.uniforms)t[r]=this.uniforms[r].toJSON(e).uuid;return{id:this.id,type:this.type,defines:JSON.parse(JSON.stringify(this.defines)),uniforms:t,next:this.next==null?void 0:this.next.toJSON(e)}}copyUniforms(e){for(let t in this.uniforms){let r=this.getName(t);r!==void 0&&e.uniforms[`f${e.id}_${r}`]&&r!=="transmissionDepthMap"&&r!=="transmissionSamplerMap"&&this.uniforms[t].copy(e.uniforms[`f${e.id}_${r}`])}return this}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let r=`f${this.id}_${e}`;this.hasValueByKey(r)&&t!==void 0&&(this.uniforms[r].value=t)}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getValues(){let e={type:this.type};for(let t in this.uniforms){let r=this.getName(t);if(r===void 0)continue;let i=this.uniforms[`f${this.id}_${r}`].value;i!==void 0&&(Array.isArray(i)?e[r]=i.map(n=>n.clone?n.clone():n):e[r]=i.clone?i.clone():i)}return e}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let r=this.getName(t);r&&e.push(r)}return e}isEqual(e){for(let t in e.uniforms){let r=e.getName(t);if(!r)return!1;let i=this.getValue(r),n=e.uniforms[t].value;if(n.value instanceof Qr){if(i.image!==n.image)return!1}else if(Array.isArray(n)){let s=i;for(let a=0,o=s.length;a<o;++a)if(s[a]!==n[a])return!1}else{let s=i;if(s.equals){if(!s.equals(n))return!1}else if(i!==n)return!1}}return!0}dispose(){}};function zq(e){let t=e instanceof Cr?e.type:e;return t==="texture"||t==="displace_map"||t==="matcap"}var fA=class extends Gn{constructor(e){super("b"),this.nodeType="Bool",this.value=e!=null?e:!1}generateReadonly(e,t,r,i){return e.format(this.value?"true":"false",i,t)}copy(e){return super.copy(e),this.value=e.value,this}},Ic=class extends Gn{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof Tt?new Array(e).fill(t):new Array(e).fill(new Tt(0))}copy(e){return super.copy(e),this.value=e.value.map(t=>t.clone()),this}},Fa=class extends Gn{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}copy(e){return super.copy(e),this.size=e.size,this.value=[...e.value],this}},R6=class extends Gn{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e!=null?e:new xi}generateReadonly(e,t,r,i,n,s){return e.format("mat3("+this.value.elements.join(", ")+")",i,t)}copy(e){return super.copy(e),this.elements=e.elements,this}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},Vp=class extends nr{constructor(e=new Vs,t,r,i,n,s,a,o,l){super("v3"),this.nodeType="CustomTexture",this.firstTime=!0,this.texture=e,this.textureSize=t,this.crop=r,this.projection=i,this.axis=n,this.side=s,this.size=a,this.mat=new R6(this.texture.value.matrix),this.alpha=o,this.mode=l,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let r=`g${this.uuid.toString().replace(/-/g,"")}`,i;switch(this.projection.value){case 3:i=e.include(Vp.Nodes.cylindrical);break;case 2:i=e.include(Vp.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],a=new ut(`
		vec3 ${r}_planarTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {

				vec2 uvs = ( mat * vec3( (${r}_vCustomUv * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===0?"":`lalpha *= step(0.0, ${this.side.value===2?"-1.0 * ":""}dot(vObjectNormal, mat * ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}`);i=e.include(a);break;default:i=e.include(Vp.Nodes.uv);break}if(this.projection.value===1&&this.firstTime){e.addVertexParsCode(`varying vec2 ${r}_vCustomUv;`),e.addFragmentParsCode(`varying vec2 ${r}_vCustomUv;`);let s=["zy","xz","xy"][this.axis.value];e.addVertexFinalCode(`${r}_vCustomUv = (1. + (transformed.${s})) / 2.;`)}e.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.texture.getTexture(e,"t")),n.push(this.textureSize.build(e,"v2")),n.push(this.crop.build(e,"f")),n.push(this.mat.build(e,"mat3")),n.push(this.size.build(e,"v2")),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),this.firstTime=!this.firstTime,e.format(i+"("+n.join(",")+")",this.getType(e),t)}copy(e){return super.copy(e),this.texture.copy(e.texture),this.textureSize=e.textureSize.clone(),this.crop=e.crop.clone(),this.projection=e.projection.clone(),this.axis=e.axis.clone(),this.size=e.size.clone(),this.alpha=e.alpha.clone(),this.mode=e.mode.clone(),this}},O6=Vp;O6.Nodes=function(){let e=new ut(`
vec3 cylindricalTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}
`),t=new ut(`
vec3 sphericalTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}
`),r=new ut(`vec3 uvTexture(sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float alpha, int mode, out float calpha) {

				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return col;
			}`);return{cylindrical:e,spherical:t,uv:r}}();var I6=class extends nr{constructor(e,t,r,i,n,s,a){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=r,this.intensity=i,this.factor=n,this.alpha=s,this.mode=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=e.include(I6.Nodes.fresnel),i=[];return i.push(this.color.build(e,"c")),i.push(this.bias.build(e,"f")),i.push(this.scale.build(e,"f")),i.push(this.intensity.build(e,"f")),i.push(this.factor.build(e,"f")),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}copy(e){return super.copy(e),this.color=e.color.clone(),this.bias=e.bias.clone(),this.scale=e.scale.clone(),this.intensity=e.intensity.clone(),this.factor=e.factor.clone(),this.alpha=e.alpha.clone(),this.mode=e.mode.clone(),this.calpha=e.calpha,this}},N6=I6;N6.Nodes=function(){return{fresnel:new ut(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, float alpha, int mode, out float calpha) {
				float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

				float lalpha = clamp( fresnel, 0.0, 1.0 ) * alpha;
				calpha = lalpha / clamp(lalpha + accumAlpha, 0.001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;
				return color;
			}`)}}();var wb=(e=>(e.SIMPLEX="simplex3d",e.SIMPLEX_FRACTAL="simplex3dFractal",e.ASHIMA="simplexAshima",e.FBM="fbm",e.PERLIN="perlin",e))(wb||{}),os=function(){let e=new ut(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new ut(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new Qt("float F3 0.3333333"),t.keywords.G3=new Qt("float G3 0.1666667");let r=new ut(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[t]),i=new ut("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),n=new ut("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new ut(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[i,n]),a=new ut("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),o=new ut("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[a]),l=new ut(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[o]),h=new ut(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);h.keywords.NUM_OCTAVES=new Qt(`int NUM_OCTAVES ${5}`);let u=new ut("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),c=new ut(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[i,n,u]);return{simplex:t,simplexFractal:r,simplexAshima:s,fbm:h,perlin:c}}(),B6=class extends nr{constructor(e,t,r,i,n,s,a){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=r,this.noiseStrength=i,this.noiseScale=n,this.offset=s,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(B6.Nodes.rainbow),i=[];return i.push(this.filmThickness.build(e,"f")),i.push(this.movement.build(e,"f")),i.push(this.wavelengths.build(e,"v3")),i.push(this.noiseStrength.build(e,"f")),i.push(this.noiseScale.build(e,"f")),i.push(this.offset.build(e,"v3")),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}copy(e){return super.copy(e),this.filmThickness=e.filmThickness.clone(),this.movement=e.movement.clone(),this.wavelengths=e.wavelengths.clone(),this.noiseStrength=e.noiseStrength.clone(),this.noiseScale=e.noiseScale.clone(),this.offset=e.offset.clone(),this.alpha=e.alpha.clone(),this.calpha=e.calpha,this}},k6=B6;k6.Nodes=function(){let e=new ut(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[os.simplex]);return{rainbow:new ut(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, float alpha, out float calpha) {
                 vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

                 float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);
                 float lalpha = alpha * rainbowContribution;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

                 return res;
             }`,[e])}}();var z6=class extends nr{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=r,this.transmissionSamplerSize=i,this.transmissionSamplerMap=n,this.transmissionDepthMap=s,this.aspectRatio=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",30),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let r=e.include(z6.Nodes.transmission),i=[];return i.push(this.thickness.build(e,"f")),i.push(this.ior.build(e,"f")),i.push(this.roughness.build(e,"f")),i.push(this.transmissionSamplerSize.build(e,"v2")),i.push(this.transmissionSamplerMap.getTexture(e,"t")),i.push(this.transmissionDepthMap.getTexture(e,"t")),i.push(this.aspectRatio.build(e,"v2")),i.push("normal"),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}copy(e){return super.copy(this),this.thickness=e.thickness.clone(),this.ior=e.ior.clone(),this.roughness=e.roughness.clone(),this.transmissionSamplerSize=e.transmissionSamplerSize.clone(),this.transmissionSamplerMap=e.transmissionSamplerMap,this.transmissionDepthMap=e.transmissionDepthMap,this.alpha=e.alpha.clone(),this.calpha=e.calpha,this}},F6=z6;F6.Nodes=function(){let e=new ut(`
            float gaussian(vec2 i) {
                const float sigma = float(NUM_SAMPLES) * .25;
                return exp( -.5* dot(i/=sigma,i) ) / ( 6.28 * sigma*sigma );
            }`),t=new ut(`
            vec4 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

                const int LOD = 2;
                const int sLOD = 4; // tile size = 2^LOD

                vec4 O = vec4(0);
                const int s = NUM_SAMPLES/sLOD;
                for ( int i = 0; i < s*s; i++ ) {
                    int modulo = (i)-((i)/(s))*(s);
                    vec2 d = vec2(float(modulo), float(i/s))*float(sLOD) - float(NUM_SAMPLES)/2.;
                    vec2 uv = U + (scale * aspectRatio) * d;
                    // What is the depth of the opaque object we're trying to sample
                    float opaqueDepth = texture2D(dm, uv).r;
                    if (opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU + ((scale * min(lod / 2., 1.)) * aspectRatio) * d;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
		            #ifdef TEXTURE_LOD_EXT
                    O += gaussian(d) * texture2DLodEXT( sp, uv, lod);
                    #else
                    O += gaussian(d) * textureLod( sp, uv, lod);
                    #endif
                }
                return O / O.a;
            }`,[e]),r=new ut(`
            vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        // Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		        // The thickness is specified in local space.
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),i=new ut(`
float applyIorToRoughness( float roughness, float ior ) {
		// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
		// an IOR of 1.5 results in the default amount of microfacet refraction.
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	} `),n=new ut(`
vec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
        float lod = applyIorToRoughness(roughness, ior);

        return blur(transmissionSamplerMap, fragCoord, vec2(lod / (transmissionSamplerSize.x / 2.)), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
	}`,[i,t]),s=new ut(`
vec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
        vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
        vec3 refractedRayExit = position + transmissionRay;

        // Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
        vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
        vec2 refractionCoords = ndcPos.xy / ndcPos.w;
        refractionCoords += 1.0;
        refractionCoords /= 2.0;

        vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
        vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
        unrefractedCoords += 1.0;
        unrefractedCoords /= 2.0;

        // Sample framebuffer to get pixel the refracted ray hits.
        vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
        // Get the specular component.
        return vec4( ( 1.0 ) * transmittedLight.rgb, transmittedLight.a );
    }`,[n,r]);return{transmission:new ut(`
            vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec4 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                float lalpha = alpha;

                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
                 return transmission.rgb;
            }`,[s])}}();var U6=class extends nr{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t}generate(e,t){if(e.isShader("fragment")){let r=e.include(U6.Nodes.customNormal),i=[];return i.push(this.cnormal.build(e,"v3")),i.push("normal"),i.push(this.alpha.build(e,"f")),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}copy(e){return super.copy(e),this.cnormal.copy(e.cnormal),this.alpha.copy(e.alpha),this}},H6=U6;H6.Nodes=function(){return{customNormal:new ut(`vec3 customNormal(vec3 cnormal, vec3 norm, float alpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return normal;
			}`)}}();var G6=class extends nr{constructor(e,t,r,i,n,s,a,o){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=r,this.steps=i,this.offset=n,this.morph=s,this.angle=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let r=e.include(G6.Nodes.gradient),i=[];return i.push(this.gradientType.build(e,"i")),i.push(this.smooth.build(e,"b")),i.push(this.colors.build(e,"v4[]")),i.push(this.steps.build(e,"f[]")),i.push(this.offset.build(e,"v2")),i.push(this.morph.build(e,"v2")),i.push(this.angle.build(e,"f")),i.push(this.alpha.build(e,"f")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}copy(e){return super.copy(e),this.gradientType=e.gradientType.clone(),this.smooth=e.smooth.clone(),this.colors=e.colors.clone(),this.steps=e.steps.clone(),this.offset=e.offset.clone(),this.morph=e.morph.clone(),this.angle=e.angle.clone(),this.alpha=e.alpha.clone(),this.calpha=e.calpha,this}},V6=G6;V6.Nodes=function(){return{gradient:new ut(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return color.xyz;
			}`)}}();var nx=(e=>(e.NOISE="noise",e.MAP="map",e))(nx||{}),j6=class extends nr{constructor(e=new Ft(0),t,r,i,n,s){super("v3"),this.nodeType="VertexDisplacement",this.displacementTypeIndex=e,this.intensity=t,this.movementOrTexture=r,Object.values(nx)[this.displacementTypeIndex.value]==="map"&&(this.mat=new R6(this.movementOrTexture.value.matrix)),this.cropOrOffset=i,this.scale=n,this.noiseFunctionIndex=s}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let r,i=[];switch(i.push("displaced_position"),i.push("displaced_normal"),Object.values(nx)[this.displacementTypeIndex.value]){case"map":{r=e.include(j6.Nodes.map),i.push(this.movementOrTexture.getTexture(e,"t")),i.push("uv"),i.push(this.cropOrOffset.build(e,"f")),this.mat&&i.push(this.mat.build(e,"mat3"));break}case"noise":{let n=Object.values(wb)[this.noiseFunctionIndex.value],s=new ut(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),a=new ut(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement) {
							return p + n * ${n}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
						}`,[os.simplex,os.simplexFractal,os.simplexAshima,os.fbm,os.perlin]),o=new ut(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[a,s]);r=e.include(o),i.push(this.scale.build(e,"f")),i.push(this.cropOrOffset.build(e,"v3")),i.push(this.movementOrTexture.build(e,"f"));break}}return i.push(this.intensity.build(e,"f")),i.push("displaced_normal"),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}copy(e){var t,r;return super.copy(e),this.noiseFunctionIndex=(t=e.noiseFunctionIndex)==null?void 0:t.clone(),this.scale=(r=e.scale)==null?void 0:r.clone(),this.cropOrOffset=e.cropOrOffset.clone(),this.intensity=e.intensity.clone(),this.movementOrTexture=e.movementOrTexture.clone(),this}},sx=j6;sx.Nodes=function(){let e=new ut(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new ut(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new ut(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var W6=class extends nr{constructor(e=new Lt,t=new Lt,r=new Lt,i=new Lt,n=new Lt,s=new Lt,a=new Lt,o=new Lt,l=new Lt,h=new Lt,u=new Lt,c=new Lt){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=r,this.fA=i,this.fB=n,this.distortion=s,this.colorA=a,this.colorB=o,this.colorC=l,this.colorD=h,this.alpha=u,this.noiseType=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,r,i,n){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=Object.values(wb)[this.noiseType.value],a=new ut(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, float alpha, out float calpha) {
                vec3 st = position / size;
				st /= scale;
				vec3 q = vec3(${s}(st),
							  ${s}(st + vec3(1.0)),
							  ${s}(st + vec3(1.0)));
				vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
							  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
							  ${s}(st * q));
				float f = ${s}(st + r);
				vec4 color;
				color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
				color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
				color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));

                float lalpha = alpha * color.a;
                calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );

			    accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				return clamp(color, 0.0, 1.0).rgb;
			}`,[os.simplex,os.simplexFractal,os.simplexAshima,os.fbm,os.perlin]),o=e.include(a),l=[];return l.push(this.scale.build(e,"f")),l.push(this.size.build(e,"v3")),l.push(this.move.build(e,"f")),l.push(this.fA.build(e,"v2")),l.push(this.fB.build(e,"v2")),l.push(this.distortion.build(e,"v2")),l.push(this.colorA.build(e,"v4")),l.push(this.colorB.build(e,"v4")),l.push(this.colorC.build(e,"v4")),l.push(this.colorD.build(e,"v4")),l.push(this.alpha.build(e,"f")),l.push(this.calpha),e.format(o+"("+l.join(",")+")",this.getType(e),t)}copy(e){return super.copy(e),this.scale.copy(e.scale),this.size.copy(e.size),this.move.copy(e.move),this.fA.copy(e.fA),this.fB.copy(e.fB),this.distortion.copy(e.distortion),this.colorA.copy(e.colorA),this.colorB.copy(e.colorB),this.colorC.copy(e.colorC),this.colorD.copy(e.colorD),this.alpha.copy(e.alpha),this.calpha=e.calpha,this.noiseType.copy(e.noiseType),this}};W6.numOctaves=5;var pA=class extends nr{constructor(e=new Lt,t=new Lt,r=new Lt,i=new Lt){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=r,this.mode=i}generate(e,t){if(e.isShader("fragment")){let r=[];return r.push(this.a.build(e,"c")),r.push(this.b.build(e,"c")),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),e.format("spe_blend("+r.join(",")+")",this.getType(e),t)}else return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}copy(e){return super.copy(e),this.a.copy(e.a),this.b.copy(e.b),this.alpha.copy(e.alpha),this.mode.copy(e.mode),this}},Nc=class extends nr{constructor(e,t,r,i,n,s,a,o,l,h,u,c){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=r,this.far=i,this.isVector=n,this.isWorldSpace=s,this.origin=a,this.direction=o,this.colors=l,this.steps=h,this.num=u,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let r=`g${this.uuid.toString().replace(/-/g,"")}`,i=new ut(`vec3 ${r}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${r}_MAX_COLORS], float steps[${r}_MAX_COLORS], float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${r}_IS_VECTOR
                   #ifdef ${r}_LINEAR
                       #ifdef ${r}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${r}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${r}_SMOOTH
				for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${r}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a;
               calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );

			   accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
               return color.rgb;
			}`,[Nc.Nodes.vectorLinearWorldSpaceDepth,Nc.Nodes.vectorLinearObjectSpaceDepth,Nc.Nodes.vectorSphericalObjectSpaceDepth,Nc.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${r}_MAX_COLORS`,this.num.value+1),this.smooth.value&&e.define(`${r}_SMOOTH`),this.isVector.value>.5&&e.define(`${r}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${r}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${r}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let n=e.include(i),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(n+"("+s.join(",")+")",this.getType(e),t)}else return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}copy(e){return super.copy(e),this.gradientType=e.gradientType.clone(),this.smooth=e.smooth.clone(),this.near=e.near.clone(),this.far=e.far.clone(),this.isVector=e.isVector.clone(),this.isWorldSpace=e.isWorldSpace.clone(),this.origin=e.origin.clone(),this.direction=e.direction.clone(),this.colors=e.colors.clone(),this.steps=e.steps.clone(),this.alpha=e.alpha.clone(),this.calpha=e.calpha,this}},q6=Nc;q6.Nodes=function(){let e=new ut(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new ut(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),r=new ut(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),i=new ut(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:r,vectorSphericalObjectSpaceDepth:i}}();var Y6=class extends nr{constructor(e,t,r){super("v3"),this.nodeType="Matcap",this.texture=e,this.alpha=t,this.mode=r,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let r=e.include(Y6.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let i=[];return i.push(this.texture.getTexture(e,"t")),i.push("normal"),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),e.format(r+"("+i.join(",")+")",this.getType(e),t)}else return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}copy(e){return super.copy(e),this.texture=e.texture.clone(),this.alpha=e.alpha.clone(),this.mode=e.mode.clone(),this.calpha=e.calpha,this}},X6=Y6;X6.Nodes=function(){return{matcap:new ut(`vec3 matcap(sampler2D matcapTex, vec3 normal, float alpha, int mode, out float calpha) {
                vec3 viewDir = normalize( vViewPosition );
                vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
                vec3 y = cross( viewDir, x );
                vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
                vec4 matcapColor = texture2D( matcapTex, uv );

                calpha =  alpha / clamp( alpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;
                
                return matcapColor.rgb;
            }
            `)}}();var th=class{constructor(e){this.id=2,this.layerCount=2,this.uuid=kt.generateUUID(),this.needsUpdate=!1,this._material=e,this._layerNodes=[];let t=this._createLayer({id:0,type:"color"});this._material.color=t.color,this._material.alpha===void 0&&(this._material.alpha=new $e(1));let r=new $e(1),i=new Ft(0);"shadingAlpha"in this._material&&"shadingBlend"in this._material&&(this._material.shadingAlpha=r,this._material.shadingBlend=i),this._layerNodes.push({id:0,type:"color",color:t.color,alpha:t.alpha,mode:t.mode}),this._layerNodes.push({id:1,type:"light",alpha:r,mode:i}),this.head=t.layer,this.head.next=new Cr(1,void 0,{type:"light",alpha:r,mode:i}),this.attachLightNodes(this.getLightLayer())}get material(){return this._material}set material(e){var n;this._material=e;let t,r,i=this.head;for(;i!==void 0;){if(i.type==="light"){t=i.uniforms[`f${i.id}_alpha`],r=i.uniforms[`f${i.id}_mode`];break}i=i.next}"shadingAlpha"in this._material&&"shadingBlend"in this._material&&(this._material.shadingAlpha=t,this._material.shadingBlend=r),this.attachLightNodes((n=e.userData.layers)==null?void 0:n.getLightLayer()),this.blendColors(),this.blendAfterColors(),this.blendPositions()}getLayersOfType(e){let t=[],r=this.head;for(;r;)r.type===e&&t.push(r),r=r.next;return t}addLayer(e){var i;if(e.id=(i=e.id)!=null?i:++this.id,this.layerCount++,e.type==="light"){let n=this.createLightLayer(e);return this.uuid=kt.generateUUID(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),n}let t=this._createLayer(e),r=t.layer;if(this.head===void 0)this.head=r;else{let n=this.head;for(;n.next!=null;)n=n.next;n.next=r}return t.color&&this._layerNodes.push({id:r.id,type:"color",color:t.color,alpha:t.alpha,mode:t.mode}),t.position&&this._layerNodes.push({id:r.id,type:"position",position:t.position}),this.uuid=kt.generateUUID(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),r}addLayerBeforeAt(e,t){var a;let r=this.head;e.id=(a=e.id)!=null?a:++this.id,this.layerCount++;let i=this._createLayer(e),n=i.layer;n.next=t;let s=0;if(r===t)this.head=n,i.color&&this._layerNodes.splice(0,0,{id:n.id,type:"color",color:i.color,alpha:i.alpha,mode:i.mode}),i.position&&this._layerNodes.splice(0,0,{id:n.id,type:"position",position:i.position});else{for(s=1;(r==null?void 0:r.next)!==t;)r=r==null?void 0:r.next,s++;r.next=n,i.color&&this._layerNodes.splice(s,0,{id:n.id,type:"color",color:i.color,alpha:i.alpha,mode:i.mode}),i.position&&this._layerNodes.splice(s,0,{id:n.id,type:"position",position:i.position})}return this.uuid=kt.generateUUID(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),n}addLayerAt(e,t){var n;t.id=(n=t.id)!=null?n:++this.id,this.layerCount++;let r=this._createLayer(t),i=r.layer;if(r.color&&this._layerNodes.splice(e,0,{id:i.id,type:"color",color:r.color,alpha:r.alpha,mode:r.mode}),r.position&&this._layerNodes.splice(e,0,{id:i.id,type:"position",position:r.position}),e==0)i.next=this.head,this.head=i;else{let s=this.head,a=this.head.next;for(let o=0;o<e-1;o++)s=a,a=a.next;i.next=a,s.next=i}return this.uuid=kt.generateUUID(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),i}removeLayer(e){let t=this.head,r,i=0;if((t==null?void 0:t.id)==e)this.head=t.next;else for(i=1,r=t,t=t==null?void 0:t.next;t!=null;){if(t.id==e){r.next=t.next;break}i++,r=t,t=t.next}return this.cleanupChangedLayer(t),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.uuid=kt.generateUUID(),this.layerCount--,i}changeLayer(e,t){let r,i=this.head,n;if((i==null?void 0:i.id)==e){let s=this._createLayer(me({id:e,uuid:i.uuid},t));n=s.layer,n.next=i.next,this.head=n,s.color&&(this._layerNodes[0]={id:n.id,type:"color",color:s.color,alpha:s.alpha,mode:s.mode}),s.position&&(this._layerNodes[0]={id:n.id,type:"position",position:s.position}),n.uniforms[`f${e}_mode`].value=i.uniforms[`f${e}_mode`].value,n.uniforms[`f${e}_alpha`].value=i.uniforms[`f${e}_alpha`].value}else{r=i,i=i.next;let s=1;for(;i!=null;){if(i.id==e){let a=this._createLayer(me({id:e,uuid:i.uuid},t));n=a.layer,r.next=n,n.next=i.next,a.color&&(this._layerNodes[s]={id:e,type:"color",color:a.color,alpha:a.alpha,mode:a.mode}),a.position&&(this._layerNodes[s]={id:e,type:"position",position:a.position}),n.uniforms[`f${e}_mode`].value=i.uniforms[`f${e}_mode`].value,n.uniforms[`f${e}_alpha`].value=i.uniforms[`f${e}_alpha`].value;break}r=i,i=i.next,s++}}return this.uuid=kt.generateUUID(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),n}getLayer(e){let t=this.head;for(;t!=null&&t.id!=e;)t=t.next;return t}getLayerByUuid(e){let t=this.head;for(;t!==void 0;){if(t.uuid===e)return t;t=t.next}}getLayers(){let e=[],t=this.head;for(;t!=null;)e.push(t),t=t.next;return e}getLayerPosition(e){let t=this.head,r=0;for(;t!==void 0&&t.id!=e;)r++,t=t.next;return r}getDefines(){}getBeforeProgram(){}getLightingProgram(){}getAfterProgram(){}getVarPrograms(){}getUniforms(){}moveLayer(e,t){let r,i=this.head,n;if(e==0)r=this.head,this.head=r.next;else{for(let a=0;a<e;a++)n=i,i=i.next;n.next=i.next,r=i}if(i=this.head,n=void 0,t==0)r.next=this.head,this.head=r;else{for(let a=0;a<t-1;a++)i=i.next;r.next=i==null?void 0:i.next,i.next=r}let s=this._layerNodes.splice(e,1)[0];this._layerNodes.splice(t,0,s),this.uuid=kt.generateUUID(),this.blendColors(),this.blendAfterColors()}updateLayerUniform(){this.uuid=kt.generateUUID(),this.blendColors(),this.blendAfterColors()}copy(e){this.needsUpdate=!1,this.layerCount=e.layerCount,this._layerNodes=[],this.layerCount=0,this.head=void 0,this.rebuildLayerNodes(this.head,e.head);let t=e.head,r=this.head;for(;t.next!=null;)this.rebuildLayerNodes(r,t.next),r=r.next,t=t.next;return this.id=e.id,this.uuid=e.uuid,this.blendColors(),this.blendAfterColors(),this.blendPositions(),this}createLightLayer(e){let t=new $e(e.alpha),r=new Ft(e.mode);this._material.shadingAlpha=t,this._material.shadingBlend=r,this._layerNodes.push({id:e.id,type:"light",alpha:t,mode:r});let i=new Cr(e.id,void 0,{type:"light",alpha:t,mode:r});if(this.head===void 0)this.head=i;else{let n=this.head;for(;n.next!=null;)n=n.next;n.next=i}return this.attachLightNodes(this.getLightLayer()),i}rebuildLayerNodes(e,t,r=!1){if(t.type==="light"){let i=r?t.uniforms[`f${t.id}_alpha`]:new $e(t.uniforms[`f${t.id}_alpha`].value),n=r?t.uniforms[`f${t.id}_mode`]:new Ft(t.uniforms[`f${t.id}_mode`].value);this._material.shadingAlpha=i,this._material.shadingBlend=n,this._layerNodes.push({id:t.id,type:"light",alpha:i,mode:n}),this.head===void 0?this.head=new Cr(t.id,t.uuid,{type:"light",alpha:i,mode:n}):e&&(e.next=new Cr(t.id,t.uuid,{type:"light",alpha:i,mode:n})),this.attachLightNodes(t)}else{let i={type:t.type,id:t.id};for(let n in t.uniforms){let s=t.getName(n);if(!s)continue;let a=`f${t.id}_${s}`;if(Array.isArray(t.uniforms[a].value))i[s]=t.uniforms[a].value.map(o=>o.clone&&!r?o.clone():o);else{let o=t.uniforms[a].value;if(s==="transmissionDepthMap"){i[s]=o;continue}o!=null&&(i[s]=o.clone&&!r&&!o.isRenderTargetTexture?o.clone():o)}}this.addLayer(i)}}attachLightNodes(e){var i,n,s,a,o,l,h,u,c,d,f;let t={},r=this.getLightLayer();switch(this._material.userData.category){case"Lambert":t.emissive=new Rr((n=(i=e==null?void 0:e.getValue("emissive"))==null?void 0:i.clone())!=null?n:0);break;case"Phong":t.shininess=new $e((s=e==null?void 0:e.getValue("shininess"))!=null?s:30),t.specular=new Rr((o=(a=e==null?void 0:e.getValue("specular"))==null?void 0:a.clone())!=null?o:1118481);break;case"Toon":t.shininess=new $e((l=e==null?void 0:e.getValue("shininess"))!=null?l:30),t.specular=new Rr((u=(h=e==null?void 0:e.getValue("specular"))==null?void 0:h.clone())!=null?u:1118481);break;case"Physical":t.roughness=new $e((c=e==null?void 0:e.getValue("roughness"))!=null?c:.3),t.metalness=new $e((d=e==null?void 0:e.getValue("metalness"))!=null?d:0),t.reflectivity=new $e((f=e==null?void 0:e.getValue("reflectivity"))!=null?f:.5);break}Object.keys(t).forEach(p=>{this._material[p]=t[p],r.uniforms[`f${r.id}_${p}`]=t[p]})}clone(e){return new th(e).copy(this)}toJSON(e){return{id:this.id,uuid:this.uuid,head:this.head.toJSON(e)}}fromJSON(e,t,r){let i=new Cr(e.head.id,void 0,{type:e.head.type}).fromJSON(e.head,t),n=e.head.next,s=i;for(;n!=null;)s.next=new Cr(n.id,void 0,{type:n.type}).fromJSON(n,t),n=n.next,s=s.next;this._layerNodes=[],this.head=void 0,this.rebuildLayerNodes(this.head,i,!0);let a=i;for(s=this.head;a.next!=null;)this.rebuildLayerNodes(s,a.next,!0),s=s.next,a=a.next;return this._material=r,this.id=e.id,this.uuid=e.uuid,this.blendColors(),this.blendAfterColors(),this.blendPositions(),this}getLightLayer(){var t;let e=this.head;for(;e!==void 0&&e.type!=="light";)e=(t=e.next)!=null?t:e;return e}dispose(){let e=this.head;for(this._layerNodes=[],this.layerCount=0;e!==void 0;)e.hasOwnProperty("dispose")===!0&&e.dispose(),e=e.next;this.head=void 0}_createLayer(e){var r,i,n,s,a,o,l,h,u,c,d,f,p,m,g,v,x,b,_,E,S,P,M,B,R,H,Q,z,y,A,D,O,C,I,k,L,w,N,X,T,U,q,W,J,K,ie,Z,ue,le,ce,ke,be,_e,ze,Be,Ve,j,G,se,ye,ge,we,et,oe,De,Me,xe,Y,Ee,ve,Le,Oe,Ie,pe,Xe,He,je,qt,Mt,Dt;let t=e.type;switch(t){case"color":{let at=new Rr((r=e.color)!=null?r:5855577),Fe=new $e((i=e.alpha)!=null?i:1),We=new pr("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");We.keywords.alpha=Fe;let dt=new Ft((n=e.mode)!=null?n:0);return at.alpha=Fe,{layer:new Cr(e.id,e.uuid,{type:t,color:at,alpha:Fe,calpha:We,mode:dt}),color:at,alpha:We,mode:dt}}case"texture":{let at=(s=e.texture)!=null?s:new Dh,Fe=at.matrix;e.mat&&Fe.copy(e.mat),at.needsUpdate=!0;let We=new $e((a=e.crop)!=null?a:0),dt=new Ft((o=e.projection)!=null?o:0),Je=new Ft((l=e.axis)!=null?l:0),it=new Ft((h=e.side)!=null?h:0),It=new Dn(e.size?new $(e.size[0],e.size[1]):new $(100,100)),st=new $e((u=e.alpha)!=null?u:1),V=new Ft((c=e.mode)!=null?c:0),ee=new Vs(at),re=new On((d=e.textureSize)!=null?d:new F(at.image?at.image.width:0,at.image?at.image.height:0)),te=new O6(ee,re,We,dt,Je,it,It,st,V),de=new pr(te.calpha,"f");return{layer:new Cr(e.id,e.uuid,{type:t,texture:ee,textureSize:re,crop:We,projection:dt,axis:Je,side:it,size:It,mat:te.mat,alpha:st,calpha:de,mode:V}),color:te,alpha:de,mode:V}}case"matcap":{let at=(f=e.texture)!=null?f:new Dh;at.needsUpdate=!0;let Fe=new $e((p=e.alpha)!=null?p:1),We=new Vs(at),dt=new Ft((m=e.mode)!=null?m:0),Je=new X6(We,Fe,dt),it=new pr(Je.calpha,"f");return{layer:new Cr(e.id,e.uuid,{type:t,texture:We,alpha:Fe,calpha:it,mode:dt}),color:Je,alpha:it,mode:dt}}case"fresnel":{let at=new Rr((g=e.color)!=null?g:16777215),Fe=new $e((v=e.bias)!=null?v:.1),We=new $e((x=e.scale)!=null?x:1),dt=new $e((b=e.intensity)!=null?b:2),Je=new $e((_=e.factor)!=null?_:1),it=new $e((E=e.alpha)!=null?E:1),It=new Ft((S=e.mode)!=null?S:0),st=new N6(at,Fe,We,dt,Je,it,It),V=new pr(st.calpha,"f");return{layer:new Cr(e.id,e.uuid,{type:t,color:at,bias:Fe,scale:We,intensity:dt,factor:Je,alpha:it,calpha:V,mode:It}),color:st,alpha:V,mode:It}}case"rainbow":{let at=new $e((P=e.filmThickness)!=null?P:30),Fe=new $e((M=e.movement)!=null?M:0),We=new On((B=e.wavelengths)!=null?B:new F(0,0,0)),dt=new $e((R=e.noiseStrength)!=null?R:0),Je=new $e((H=e.noiseScale)!=null?H:1),it=new On((Q=e.offset)!=null?Q:new F(0,0,0)),It=new $e((z=e.alpha)!=null?z:1),st=new k6(at,Fe,We,dt,Je,it,It),V=new pr(st.calpha,"f"),ee=new Ft((y=e.mode)!=null?y:0);return{layer:new Cr(e.id,e.uuid,{type:t,filmThickness:at,movement:Fe,wavelengths:We,noiseStrength:dt,noiseScale:Je,offset:it,alpha:It,calpha:V,mode:ee}),color:st,alpha:V,mode:ee}}case"transmission":{let at=new $e((A=e.thickness)!=null?A:10),Fe=new $e((D=e.ior)!=null?D:1.5),We=new $e((O=e.roughness)!=null?O:.5),dt=new Dn((C=e.transmissionSamplerSize)!=null?C:new $(2048,2048)),Je=(I=e.transmissionSamplerMap)!=null?I:new Dh,it=(k=e.transmissionDepthMap)!=null?k:new Dh,It=new Vs(Je),st=new Vs(it),V=window.innerWidth,ee=window.innerHeight,re=V>=ee?new Dn(ee/V,1):new Dn(1,V/ee),te=new $e((L=e.alpha)!=null?L:1),de=new F6(at,Fe,We,dt,It,st,re,te),Ce=new pr(de.calpha,"f"),Re=new Ft((w=e.mode)!=null?w:0);return{layer:new Cr(e.id,e.uuid,{type:t,thickness:at,ior:Fe,roughness:We,transmissionSamplerSize:dt,transmissionSamplerMap:It,transmissionDepthMap:st,aspectRatio:re,alpha:te,calpha:Ce,mode:Re}),color:de,alpha:Ce,mode:Re}}case"depth":{let at=new Ft((N=e.gradientType)!=null?N:0),Fe=new fA((X=e.smooth)!=null?X:!1),We=new $e((T=e.near)!=null?T:50),dt=new $e((U=e.far)!=null?U:200),Je=new $e((q=e.isVector)!=null?q:1),it=new $e((W=e.isWorldSpace)!=null?W:0),It=new On((J=e.origin)!=null?J:new F),st=new On((K=e.direction)!=null?K:new F),V=new Ft((ie=e.num)!=null?ie:0),ee;e.colors?ee=new Ic(V.value+1,e.colors):(ee=new Ic(V.value+1,new Tt(0,0,0,1)),ee.value[1]=new Tt(1,1,1,1));let re;e.steps?re=new Fa(V.value+1,e.steps):(re=new Fa(V.value+1,1),re.value[0]=0);let te=new $e((Z=e.alpha)!=null?Z:1),de=new Ft((ue=e.mode)!=null?ue:0),Ce=new q6(at,Fe,We,dt,Je,it,It,st,ee,re,V,te),Re=new pr(Ce.calpha,"f");return{layer:new Cr(e.id,e.uuid,{type:t,gradientType:at,smooth:Fe,near:We,far:dt,isVector:Je,isWorldSpace:it,origin:It,direction:st,colors:ee,steps:re,num:V,alpha:te,calpha:Re,mode:de}),color:Ce,alpha:Re,mode:de}}case"noise":{let at=new $e((le=e.scale)!=null?le:1),Fe=new On((ce=e.size)!=null?ce:new F(100,100,100)),We=new $e((ke=e.move)!=null?ke:1),dt=new Dn((be=e.fA)!=null?be:new $(1.7,9.2)),Je=new Dn((_e=e.fB)!=null?_e:new $(8.3,2.8)),it=new Dn((ze=e.distortion)!=null?ze:new $(1,1)),It=new Xh(e.colorA),st=new Xh(e.colorB),V=new Xh(e.colorC),ee=new Xh(e.colorD),re=new $e((Be=e.alpha)!=null?Be:1),te=new Ft((Ve=e.mode)!=null?Ve:0),de=new Ft((j=e.noiseType)!=null?j:0),Ce=new W6(at,Fe,We,dt,Je,it,It,st,V,ee,re,de),Re=new pr(Ce.calpha,"f");return{layer:new Cr(e.id,e.uuid,{type:t,scale:at,size:Fe,move:We,fA:dt,fB:Je,distortion:it,colorA:It,colorB:st,colorC:V,colorD:ee,alpha:re,calpha:Re,mode:te,noiseType:de}),color:Ce,alpha:Re,mode:te}}case"normal":{let at=new On((G=e.cnormal)!=null?G:new F(1,1,1)),Fe=new $e((se=e.alpha)!=null?se:1),We=new Ft((ye=e.mode)!=null?ye:0),dt=new H6(at,Fe),Je=new pr("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");return Je.keywords.alpha=Fe,{layer:new Cr(e.id,e.uuid,{type:t,cnormal:at,alpha:Fe,calpha:Je,mode:We}),color:dt,alpha:Je,mode:We}}case"gradient":{let at=new Ft((ge=e.gradientType)!=null?ge:0),Fe=new fA((we=e.smooth)!=null?we:!1),We;e.colors?We=new Ic(e.colors.length,e.colors):(We=new Ic(10,new Tt(0,0,0,1)),We.value[1]=new Tt(1,1,1,1));let dt;e.steps?dt=new Fa(e.steps.length,e.steps):(dt=new Fa(10,1),dt.value[0]=0);let Je=new Dn((et=e.offset)!=null?et:new $(0,0)),it=new Dn((oe=e.morph)!=null?oe:new $(0,0)),It=new $e((De=e.angle)!=null?De:0),st=new $e((Me=e.alpha)!=null?Me:1),V=new Ft((xe=e.mode)!=null?xe:0),ee=new V6(at,Fe,We,dt,Je,it,It,st),re=new pr(ee.calpha,"f");return{layer:new Cr(e.id,e.uuid,{type:t,gradientType:at,smooth:Fe,colors:We,steps:dt,offset:Je,morph:it,angle:It,alpha:st,calpha:re,mode:V}),color:ee,alpha:re,mode:V}}case"displace":{let at=new Ft((Y=e.displacementType)!=null?Y:0);if(at.value===0){let Fe=new On((Ee=e.offset)!=null?Ee:new F(0,0,0)),We=new $e((ve=e.scale)!=null?ve:10),dt=new $e((Le=e.intensity)!=null?Le:8),Je=new $e((Oe=e.movement)!=null?Oe:1),it=new $e((Ie=e.alpha)!=null?Ie:1),It=new Ft((pe=e.mode)!=null?pe:0),st=new Ft((Xe=e.noiseType)!=null?Xe:0),V=new sx(at,dt,Je,Fe,We,st);return{layer:new Cr(e.id,e.uuid,{displacementType:at,type:t,offset:Fe,scale:We,intensity:dt,movement:Je,alpha:it,mode:It,noiseType:st}),position:V}}else if(at.value===1){let Fe=(He=e.texture)!=null?He:new Dh,We=Fe.matrix;e.mat&&We.copy(e.mat),Fe.needsUpdate=!0;let dt=new $e((je=e.intensity)!=null?je:8),Je=new Vs(Fe),it=new $e((qt=e.crop)!=null?qt:0),It=new $e((Mt=e.alpha)!=null?Mt:1),st=new Ft((Dt=e.mode)!=null?Dt:0),V=new sx(at,dt,Je,it);return{layer:new Cr(e.id,e.uuid,{displacementType:at,type:t,intensity:dt,texture:Je,crop:it,mat:V.mat,alpha:It,mode:st}),position:V}}return{}}}return{}}blendColors(){let e=this._layerNodes.findIndex(r=>r.type==="color"),t=this._layerNodes.findIndex(r=>r.type==="light");if(e!==-1&&e<t){let r=this._layerNodes[e].color;for(let i=e+1;i<t;++i){let n=this._layerNodes[i];n.type==="color"&&(r=new pA(r,n.color,n.alpha,n.mode))}this._material.color=r}else this._material.color=void 0}blendAfterColors(){let e=new pr("outgoingLight","f"),t=this._layerNodes.findIndex(r=>r.type==="light");if(this._layerNodes.length>t+1){for(let r=t+1;r<this._layerNodes.length;++r){let i=this._layerNodes[r];i.type==="color"&&(e=new pA(e,i.color,i.alpha,i.mode))}"afterColor"in this._material&&(this._material.afterColor=e)}else"afterColor"in this._material&&(this._material.afterColor=void 0)}blendPositions(){let e=this._layerNodes.filter(t=>t.type==="position");if(e.length>0){let t=e[0].position;for(let r=1;r<e.length;++r)e[r]&&(t=new Xs(t,e[r].position,Xs.ADD),t=new Xs(t,new $e(.5).setReadonly(!0),Xs.MUL));this._material.position=t}else this._material.position=void 0}cleanupChangedLayer(e){switch(this._layerNodes=this._layerNodes.filter(t=>t.id!==e.id),e.type){case"displace":{this.blendPositions();break}default:{this.blendColors(),this.blendAfterColors();break}}}},ju=class extends Gr{constructor(e,t,r){super(r),this.isNodeMaterial=!0,this.type="NodeMaterial",this.wireframeLinecap="",this.wireframeLinejoin="",this.uniformsBackup={},this.userData={type:"",category:"",nodeType:""},this.fog=!0,this.vertex=e!=null?e:new dA(new dn(dn.PROJECTION)),this.fragment=t!=null?t:new dA(new Rr(5855577)),this.updaters=[],this.isDetached=!0,this.dithering=!0,this.onBeforeCompile=this._onBeforeCompile}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}_onBeforeCompile(e,t){this.build({renderer:t}),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}_getLayerStack(e){let t=new th(this);return e&&(async()=>{for(;e.image===void 0;)await new Promise(r=>requestAnimationFrame(r));t.addLayerAt(1,{type:"texture",texture:e}),this.dispose()})(),t}clampUniformsForPreview(e,t){let r=(i,n,s)=>Math.min(Math.max(i,n),s);if(this.userData.layers){for(let i of this.userData.layers.getLayers())if(i.type=="displace"){this.uniformsBackup[`f${i.id}_intensity`]=i.uniforms[`f${i.id}_intensity`].value;let n=r(i.uniforms[`f${i.id}_intensity`].value,e,t);i.uniforms[`f${i.id}_intensity`].value=n}}}restoreClampedUniforms(){if(this.userData.layers)for(let e of this.userData.layers.getLayers())e.type=="displace"&&(e.uniforms[`f${e.id}_intensity`].value=this.uniformsBackup[`f${e.id}_intensity`])}customProgramCacheKey(){return this.getHash()}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(e){var r;e=e!=null?e:{};let t=(r=e.builder)!=null?r:new kq;return t.setMaterial(this,e.renderer),t.build(this.vertex,this.fragment),this.vertexShader=t.getCode("vertex"),this.fragmentShader=t.getCode("fragment"),this.defines=t.defines,this.uniforms=t.uniforms,this.extensions=t.extensions,this.updaters=t.updaters,this.fog=t.requires.fog,this.lights=t.requires.lights,this.transparent=t.requires.transparent||this.blending>El,this}getHash(){let e="{";return e+='"vertex":'+this.vertex.getHash()+",",e+='"fragment":'+this.fragment.getHash(),e+="}",e}copy(e){let t=this.uuid;for(let r in e)this[r]=e[r];return this.uuid=t,e.userData!==void 0&&(this.userData=JSON.parse(JSON.stringify(e.userData))),this}toJSON(e){let t=this.userData.layers;this.userData.layers=void 0;let r=super.toJSON(e);return r.type="ShaderMaterial",r.userData={type:this.userData.type,category:this.userData.category,nodeType:this.type,layers:t.toJSON(e)},r.vertex=this.vertex.toJSON(e).uuid,r.fragment=this.fragment.toJSON(e).uuid,delete r.vertexShader,delete r.fragmentShader,delete r.color,delete r.shininess,delete r.specular,delete r.roughness,delete r.metalness,delete r.uniforms,e&&!e.materials[this.uuid]&&(e.materials[this.uuid]=r),this.userData.layers=t,r}fromJSON(e,t){var r;this.defines=(r=e.defines)!=null?r:{},this.depthFunc=e.depthFunc,this.depthWrite=e.depthWrite,this.side=e.side!==void 0?e.side:Zo,this.transparent=e.transparent,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.wireframe=e.wireframe,this.userData.layers.fromJSON(e.userData.layers,t,this)}get penumbraSizeNode(){return this.fragment.penumbraSize}set penumbraSizeNode(e){this.fragment.penumbraSize=e}};Object.defineProperties(ju.prototype,{properties:{get:function(){return this.fragment.properties}},needsUpdate:{set:function(e){e===!0&&this.version++,this.needsCompile=e},get:function(){return this.needsCompile}}});var Fq=class extends Lt{constructor(){super("basic"),this.nodeType="Basic",this.color=new Rr(5855577)}generate(e){let t;if(e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(Nu.merge([Pe.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{this.color===void 0&&(this.color=new Rr(5855577)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let r=this.color.flow(e,"c",{slot:"color"}),i=this.alpha?this.alpha.flow(e,"f"):void 0,n=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=i!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let s=["#include <normal_fragment_begin>",r.code];i&&s.push(i.code,"#ifdef ALPHATEST"," if ( "+i.result+" <= ALPHATEST ) discard;","#endif"),n?s.push(n.code,`vec3 outgoingLight = ${r.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${n.result}, 1.0, SPE_BLENDING_NORMAL);`):s.push(`vec3 finalColor = ${r.result};`),i?s.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${i.result} );`):s.push("gl_FragColor = vec4("+r.result+", 1.0 );"),s.push("#include <fog_fragment>","#include <dithering_fragment>"),t=s.join(`
`)}return t}copy(e){return super.copy(e),e.color&&(this.color=e.color.clone()),e.position&&(this.position=e.position.clone()),e.alpha&&(this.alpha=e.alpha.clone()),e.afterColor&&(this.afterColor=e.afterColor.clone()),e.shadingAlpha&&(this.shadingAlpha=e.shadingAlpha.clone()),e.shadingBlend&&(this.shadingBlend=e.shadingBlend.clone()),this}},Uq=class extends ju{constructor(e=new Fq,t){super(e,e,t),this.type="BasicNodeMaterial",this.fragment=e}get color(){return this.fragment.color}set color(e){this.fragment.color=e}get afterColor(){return this.fragment.afterColor}set afterColor(e){this.fragment.afterColor=e}get alpha(){return this.fragment.alpha}set alpha(e){this.fragment.alpha=e}get shadingAlpha(){return this.fragment.shadingAlpha}set shadingAlpha(e){this.fragment.shadingAlpha=e}get shadingBlend(){return this.fragment.shadingBlend}set shadingBlend(e){this.fragment.shadingBlend=e}get position(){return this.fragment.position}set position(e){this.fragment.position=e}},Za=class extends Uq{constructor(e,t,r){super(t,e),this.userData.type="BasicMaterial",this.userData.category="Basic",this.userData.layers=r!=null?r:this._getLayerStack(e==null?void 0:e.map)}get layersList(){return this.userData.layers}set layersList(e){this.userData.layers=e}equals(e){return this.userData.type===e.userData.type&&this.userData.layers.uuid==e.userData.layers.uuid}copy(e){if(e.userData.layers!==void 0&&e.userData.layers instanceof th){let t=e.userData.layers,r=e.fragment;super.copy(e);let i=r.clone();this.fragment=i,this.vertex=i;let n=t.clone(this);this.userData.layers=n}else super.copy(e);return this}static fromJSON(e,t,r){let i=r.getNode(t.vertex),n=new Za(void 0,i);return n.fromJSON(t,r),n}static fromMaterial(e){let t=new Za(e.map?{map:e.map}:{}),r=t.fragment;return r.color.value.copy(e.color),r.alpha.value=e.opacity,t}dispose(){super.dispose()}},Hq=class extends Lt{constructor(){super("phong"),this.nodeType="Phong",this.color=new Rr(5855577),this.specular=new Rr(1118481),this.shininess=new $e(30),this.penumbraSize=new Fa(5,.5),this.shadingAlpha=new $e(1),this.shadingBlend=new Ft(0)}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(Nu.merge([Pe.fog,Pe.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:this.penumbraSize}),this.color===void 0&&(this.color=new Rr(5855577)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),n=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;",`uniform float penumbraSize[${5}];`,"#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];h.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",i.code,"	vec3 specular = "+i.result+";",n.code,"	float shininess = max( 0.0001, "+n.result+" );","	float specularStrength = 1.0;"),l&&h.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;"),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${a.result} );
				}
				`),o&&h.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}copy(e){return super.copy(e),e.color&&(this.color=e.color.clone()),this.specular=e.specular.clone(),this.shininess=e.shininess.clone(),e.position&&(this.position=e.position.clone()),e.afterColor&&(this.afterColor=e.afterColor.clone()),e.alpha&&(this.alpha=e.alpha.clone()),e.shadingAlpha&&(this.shadingAlpha=e.shadingAlpha.clone()),e.shadingBlend&&(this.shadingBlend=e.shadingBlend.clone()),this}},Gq=class extends ju{constructor(e=new Hq,t){super(e,e,t),this.type="PhongNodeMaterial",this.fragment=e}get color(){return this.fragment.color}set color(e){this.fragment.color=e}get afterColor(){return this.fragment.afterColor}set afterColor(e){this.fragment.afterColor=e}get alpha(){return this.fragment.alpha}set alpha(e){this.fragment.alpha=e}get shadingAlpha(){return this.fragment.shadingAlpha}set shadingAlpha(e){this.fragment.shadingAlpha=e}get shadingBlend(){return this.fragment.shadingBlend}set shadingBlend(e){this.fragment.shadingBlend=e}get position(){return this.fragment.position}set position(e){this.fragment.position=e}get specular(){return this.fragment.specular}set specular(e){this.fragment.specular=e}get shininess(){return this.fragment.shininess}set shininess(e){this.fragment.shininess=e}},Wl=class extends Gq{constructor(e,t,r){super(t,e),this.userData.type="PhongMaterial",this.userData.category="Phong",this.userData.layers=r!=null?r:this._getLayerStack(e==null?void 0:e.map)}get layersList(){return this.userData.layers}set layersList(e){this.userData.layers=e}equals(e){return this.userData.type===e.userData.type&&this.userData.layers.uuid==e.userData.layers.uuid}copy(e){if(e.userData.layers!==void 0&&e.userData.layers instanceof th){let t=e.userData.layers,r=e.fragment;super.copy(e);let i=r.clone();this.fragment=i,this.vertex=i;let n=t.clone(this);this.userData.layers=n,i.shadingAlpha.value=r.shadingAlpha.value,i.shadingBlend.value=r.shadingBlend.value}else super.copy(e);return this}static fromJSON(e,t,r){let i=r.getNode(t.vertex),n=new Wl(void 0,i);return n.fromJSON(t,r),n}static fromMaterial(e){let t=new Wl(e.map?{map:e.map}:{}),r=t.fragment;return r.color.value.copy(e.color),r.alpha.value=e.opacity,t}dispose(){super.dispose()}},Vq=class extends Lt{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new Rr(5855577),this.emissive=new Rr(0),this.emissiveIntensity=new $e(1),this.penumbraSize=new Fa(5,.5),this.shadingAlpha=new $e(1),this.shadingBlend=new Ft(0)}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(Nu.merge([Pe.fog,Pe.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:this.penumbraSize}),this.color===void 0&&(this.color=new Rr(5855577)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.emissive.flow(e,"c",{slot:"emissive"}),n=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode([`uniform float penumbraSize[${5}];`,"varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];h.push(r.code,"vec3 diffuseColor = "+r.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),l&&h.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),h.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),i&&h.push(i.code,"reflectedLight.directDiffuse += "+i.result+" * "+n.result+";"),h.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;"),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${a.result} );
				}
				`),o&&h.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}copy(e){return super.copy(e),this.emissiveIntensity=e.emissiveIntensity.clone(),e.color&&(this.color=e.color.clone()),e.position&&(this.position=e.position.clone()),e.afterColor&&(this.afterColor=e.afterColor.clone()),e.alpha&&(this.alpha=e.alpha.clone()),e.shadingAlpha&&(this.shadingAlpha=e.shadingAlpha.clone()),e.shadingBlend&&(this.shadingBlend=e.shadingBlend.clone()),e.emissive&&(this.emissive=e.emissive.clone()),this}},jq=class extends ju{constructor(e=new Vq,t){super(e,e,t),this.type="LambertNodeMaterial",this.fragment=e}get color(){return this.fragment.color}set color(e){this.fragment.color=e}get afterColor(){return this.fragment.afterColor}set afterColor(e){this.fragment.afterColor=e}get alpha(){return this.fragment.alpha}set alpha(e){this.fragment.alpha=e}get shadingAlpha(){return this.fragment.shadingAlpha}set shadingAlpha(e){this.fragment.shadingAlpha=e}get shadingBlend(){return this.fragment.shadingBlend}set shadingBlend(e){this.fragment.shadingBlend=e}get position(){return this.fragment.position}set position(e){this.fragment.position=e}get emissive(){return this.fragment.emissive}set emissive(e){this.fragment.emissive=e}get emissiveIntensity(){return this.fragment.emissiveIntensity}set emissiveIntensity(e){this.fragment.emissiveIntensity=e}},Q6=class extends jq{constructor(e,t,r){super(t,e),this.userData.type="LambertMaterial",this.userData.category="Lambert",this.userData.layers=r!=null?r:this._getLayerStack(e==null?void 0:e.map)}get layersList(){return this.userData.layers}set layersList(e){this.userData.layers=e}equals(e){return this.userData.type===e.userData.type&&this.userData.layers.uuid==e.userData.layers.uuid}copy(e){if(e.userData.layers!==void 0&&e.userData.layers instanceof th){let t=e.userData.layers,r=e.fragment;super.copy(e);let i=r.clone();this.fragment=i,this.vertex=i;let n=t.clone(this);this.userData.layers=n,i.shadingAlpha.value=r.shadingAlpha.value,i.shadingBlend.value=r.shadingBlend.value}else super.copy(e);return this}static fromJSON(e,t,r){let i=r.getNode(t.vertex),n=new Q6(void 0,i);return n.fromJSON(t,r),n}dispose(){super.dispose()}},Wq=class extends Lt{constructor(){super("toon"),this.nodeType="Toon",this.color=new Rr(5855577),this.specular=new Rr(1118481),this.shininess=new $e(30),this.penumbraSize=new Fa(5,.5),this.shadingAlpha=new $e(1),this.shadingBlend=new Ft(0)}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(Nu.merge([Pe.fog,Pe.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:this.penumbraSize}),this.color===void 0&&(this.color=new Rr(5855577)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let r=this.color.flow(e,"c",{slot:"color"}),i=this.specular.flow(e,"c"),n=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode([`uniform float penumbraSize[${5}];`,"varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];h.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",i.code,"	vec3 specular = "+i.result+";",n.code,"	float shininess = max( 0.0001, "+n.result+" );","	float specularStrength = 1.0;"),l&&h.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result}, ${a.result} );
				}
				`),o&&h.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}copy(e){return super.copy(e),e.color&&(this.color=e.color.clone()),this.specular=e.specular.clone(),this.shininess=e.shininess.clone(),e.position&&(this.position=e.position.clone()),e.afterColor&&(this.afterColor=e.afterColor.clone()),e.alpha&&(this.alpha=e.alpha.clone()),e.shadingAlpha&&(this.shadingAlpha=e.shadingAlpha.clone()),e.shadingBlend&&(this.shadingBlend=e.shadingBlend.clone()),this}},qq=class extends ju{constructor(e=new Wq,t){super(e,e,t),this.type="ToonNodeMaterial",this.fragment=e}get color(){return this.fragment.color}set color(e){this.fragment.color=e}get afterColor(){return this.fragment.afterColor}set afterColor(e){this.fragment.afterColor=e}get alpha(){return this.fragment.alpha}set alpha(e){this.fragment.alpha=e}get shadingAlpha(){return this.fragment.shadingAlpha}set shadingAlpha(e){this.fragment.shadingAlpha=e}get shadingBlend(){return this.fragment.shadingBlend}set shadingBlend(e){this.fragment.shadingBlend=e}get position(){return this.fragment.position}set position(e){this.fragment.position=e}get specular(){return this.fragment.specular}set specular(e){this.fragment.specular=e}get shininess(){return this.fragment.shininess}set shininess(e){this.fragment.shininess=e}},J6=class extends qq{constructor(e,t,r){super(t,e),this.userData.type="ToonMaterial",this.userData.category="Toon",this.userData.layers=r!=null?r:this._getLayerStack(e==null?void 0:e.map)}get layersList(){return this.userData.layers}set layersList(e){this.userData.layers=e}equals(e){return this.userData.type===e.userData.type&&this.userData.layers.uuid==e.userData.layers.uuid}copy(e){if(e.userData.layers!==void 0&&e.userData.layers instanceof th){let t=e.userData.layers,r=e.fragment;super.copy(e);let i=r.clone();this.fragment=i,this.vertex=i;let n=t.clone(this);this.userData.layers=n,i.shadingAlpha.value=r.shadingAlpha.value,i.shadingBlend.value=r.shadingBlend.value}else super.copy(e);return this}static fromJSON(e,t,r){let i=r.getNode(t.vertex),n=new J6(void 0,i);return n.fromJSON(t,r),n}dispose(){super.dispose()}},Yq=class extends Lt{constructor(){super("standard"),this.nodeType="Standard",this.color=new Rr(5855577),this.roughness=new $e(.3),this.metalness=new $e(0),this.reflectivity=new $e(.5),this.penumbraSize=new Fa(5,.5),this.shadingAlpha=new $e(1),this.shadingBlend=new Ft(0)}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let r=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(Nu.merge([Pe.fog,Pe.lights])),Pe.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let i=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];r&&i.push(r.code,r.result?"displaced_position = "+r.result+";":""),i.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),i.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),i.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=i.join(`
`)}else{e.mergeUniform({penumbraSize:this.penumbraSize});let r={gamma:!0};this.color===void 0&&(this.color=new Rr(5855577)),this.color.analyze(e,{slot:"color",context:r}),this.roughness.analyze(e),this.metalness.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let i=this.color.flow(e,"c",{slot:"color",context:r}),n=this.roughness.flow(e,"f"),s=this.metalness.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,h=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=h!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;",`uniform float penumbraSize[${5}];`,"#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let c=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];c.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",n.code,"	float roughnessFactor = "+n.result+";",s.code,"	float metalnessFactor = "+s.result+";"),h&&c.push(h.code,"#ifdef ALPHATEST","	if ( "+h.result+" <= ALPHATEST ) discard;","#endif"),c.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),c.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),u?c.push(u.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+u.result+" ) ), diffuseColor, metalnessFactor );"):c.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),c.push("#include <lights_fragment_begin>"),c.push("#include <lights_fragment_end>"),c.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),c.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result}, ${o.result} );
				}
				`),l&&c.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),h?c.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${h.result} );`):c.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=c.join(`
`)}return t}copy(e){return super.copy(e),e.color&&(this.color=e.color.clone()),this.roughness=e.roughness.clone(),this.metalness=e.metalness.clone(),e.position&&(this.position=e.position.clone()),e.afterColor&&(this.afterColor=e.afterColor.clone()),e.alpha&&(this.alpha=e.alpha.clone()),e.reflectivity&&(this.reflectivity=e.reflectivity.clone()),e.shadingAlpha&&(this.shadingAlpha=e.shadingAlpha.clone()),e.shadingBlend&&(this.shadingBlend=e.shadingBlend.clone()),this}},Xq=class extends ju{constructor(e=new Yq,t){super(e,e,t),this.type="StandardNodeMaterial",this.fragment=e}get color(){return this.fragment.color}set color(e){this.fragment.color=e}get afterColor(){return this.fragment.afterColor}set afterColor(e){this.fragment.afterColor=e}get alpha(){return this.fragment.alpha}set alpha(e){this.fragment.alpha=e}get shadingAlpha(){return this.fragment.shadingAlpha}set shadingAlpha(e){this.fragment.shadingAlpha=e}get shadingBlend(){return this.fragment.shadingBlend}set shadingBlend(e){this.fragment.shadingBlend=e}get position(){return this.fragment.position}set position(e){this.fragment.position=e}get roughness(){return this.fragment.roughness}set roughness(e){this.fragment.roughness=e}get metalness(){return this.fragment.metalness}set metalness(e){this.fragment.metalness=e}get reflectivity(){return this.fragment.reflectivity}set reflectivity(e){this.fragment.reflectivity=e}},K6=class extends Xq{constructor(e,t,r){super(t,e),this.userData.type="PhysicalMaterial",this.userData.category="Physical",this.userData.layers=r!=null?r:this._getLayerStack(e==null?void 0:e.map)}get layersList(){return this.userData.layers}set layersList(e){this.userData.layers=e}equals(e){return this.userData.type===e.userData.type&&this.userData.layers.uuid==e.userData.layers.uuid}copy(e){if(e.userData.layers!==void 0&&e.userData.layers instanceof th){let t=e.userData.layers,r=e.fragment;super.copy(e);let i=r.clone();this.fragment=i,this.vertex=i;let n=t.clone(this);this.userData.layers=n,i.shadingAlpha.value=r.shadingAlpha.value,i.shadingBlend.value=r.shadingBlend.value}else super.copy(e);return this}static fromJSON(e,t,r){let i=r.getNode(t.vertex),n=new K6(void 0,i);return n.fromJSON(t,r),n}dispose(){super.dispose()}};function Li(e,t){let r;if(typeof e=="string"){let i=t==null?void 0:t.getColor(e);i?r=i:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),r=new ia(0,0,0,0))}else return"a"in e?new ia(e.r,e.g,e.b,e.a):new ia(e.r,e.g,e.b,1);return r}function Z6(e,t){switch(e.data.type){case"light":return ys(e);case"fresnel":return Jq(e,t);case"gradient":return Kq(e);case"depth":return Zq(e);case"normal":return $q(e);case"noise":return eY(e,t);case"texture":return tY(e,t);case"rainbow":return rY(e);case"transmission":return iY(e,t);case"matcap":return nY(e,t);case"displace":return sY(e);case"color":default:return Qq(e,t)}}function $6(e){return{type:e.data.type}}function ys(e){let{alpha:t,mode:r}=e.data;return qe(me({},$6(e)),{alpha:t,mode:r})}function Qq(e,t){return qe(me({},ys(e)),{color:Li(e.data.color,t)})}function Jq(e,t){let{bias:r,scale:i,intensity:n,factor:s,color:a}=e.data;return qe(me({},ys(e)),{color:Li(a,t),bias:r,scale:i,intensity:n,factor:s})}function Kq(e){let{gradientType:t,smooth:r,colors:i,steps:n,angle:s,offset:a,morph:o}=e.data;return qe(me({},ys(e)),{gradientType:t,smooth:r,colors:i.map(l=>new Tt(l[0],l[1],l[2],l[3])),num:i.length,steps:n,offset:new $(...a),morph:new $(...o),angle:s})}function Zq(e){let{gradientType:t,near:r,far:i,isVector:n,isWorldSpace:s,origin:a,direction:o,colors:l,steps:h,smooth:u,num:c}=e.data;return qe(me({},ys(e)),{gradientType:t,near:r,far:i,isVector:n,isWorldSpace:s,origin:new F(...a),direction:o?new F(...o):new F(1,0,0),num:c,colors:l.map(d=>new Tt(d[0],d[1],d[2],d[3])),steps:h,smooth:u})}function $q(e){let{cnormal:t}=e.data;return qe(me({},ys(e)),{cnormal:new F(t[0],t[1],t[2])})}function eY(e,t){let{data:r}=e;return qe(me({},ys(e)),{scale:r.scale,move:r.move,fA:new $(...r.fA),fB:new $(...r.fB),size:new F(...r.size),distortion:new $(...r.distortion),colorA:Li(r.colorA,t),colorB:Li(r.colorB,t),colorC:Li(r.colorC,t),colorD:Li(r.colorD,t),noiseType:r.noiseType})}function tY(e,t){let{projection:r,axis:i,side:n,crop:s,size:a}=e.data,{image:o,wrapping:l,repeat:h,offset:u}=e.data.texture,c=new Qr,d;if(typeof o=="string")d=t==null?void 0:t.getImage(o);else{let f=new Image;f.src=Nd(o.data),f.onload=()=>{t!=null&&t.onImageLoad&&(t==null||t.onImageLoad())},d=f}return c.image=d,c.repeat.set(h[0],h[1]),c.offset.set(u[0],u[1]),c.wrapS=c.wrapT=l,qe(me({},ys(e)),{texture:c,mat:new xi().setUvTransform(u[0],u[1],h[0],h[1],0,0,0),crop:s,projection:r,axis:["x","y","z"].indexOf(i),side:[2,0,1].indexOf(n),size:a})}function rY(e){let{data:t}=e;return qe(me({},ys(e)),{filmThickness:t.filmThickness,movement:t.movement,wavelengths:new F(...t.wavelengths),noiseStrength:t.noiseStrength,noiseScale:t.noiseScale,offset:new F(...t.offset)})}function iY(e,t){let{data:r}=e;return qe(me({},ys(e)),{thickness:r.thickness,ior:r.ior,roughness:r.roughness,transmissionSamplerMap:t.transmissionSamplerMap,transmissionDepthMap:t.transmissionDepthMap})}function nY(e,t){let r=new Qr,{image:i}=e.data.texture,n;if(typeof i=="string")n=t==null?void 0:t.getImage(i);else{let a=new Image;a.src=Nd(i.data),a.onload=()=>{t!=null&&t.onImageLoad&&(t==null||t.onImageLoad())},n=a}r.image=n;let s=16777215;return qe(me({},ys(e)),{color:s,texture:r})}function sY(e){let{data:t}=e,r=qe(me({},$6(e)),{intensity:t.intensity});if(t.displacementType==="noise")return qe(me({},r),{offset:new F(...t.offset),scale:t.scale,movement:t.movement,noiseType:t.noiseType});{let i=new Qr,n=new xi().setUvTransform(0,0,1,1,0,0,0);return qe(me({},r),{texture:i,mat:n,crop:t.crop})}}function eD(e,t,r){if(r.type==="displace"&&(e==="intensity"||e==="visible")){let i=t.uniforms[`f${t.id}_intensity`];return i?(i.value=r.intensity*(r.visible?1:0),i):void 0}if(r.type!=="displace"&&(e==="alpha"||e==="visible")){let i=t.uniforms[`f${t.id}_alpha`];return i?(i.value=r.alpha*(r.visible?1:0),i):void 0}}var ed;(e=>{function t(r){return new Ue(r.x,r.y,r.z).getHex()}e.getHex=t})(ed||(ed={}));var mA;(e=>{function t(r){return new Tt(r.r,r.g,r.b,r.a)}e.getThreeVector4=t})(mA||(mA={}));var gA;(e=>{function t(i,n){i.setRGB(n.r,n.g,n.b)}e.setThreeColor=t;function r(i){return new Ue(i.r,i.g,i.b).getHex()}e.getHex=r})(gA||(gA={}));function bb(e,t){return typeof e=="string"?t.getMaterialOrDeletedPlaceholder(e):tD(e,t)}function aY(e,t){return e.map(r=>bb(r,t))}function tD(e,t){var a,o;let r=(a=e.layers)!=null?a:Yo.defaultTwoLayerData("phong").layers,i=oY(r),n;switch(i.category){case"basic":n=new Za;break;case"lambert":{n=new Q6;break}case"toon":{n=new J6;break}case"physical":n=new K6;break;case"phong":default:{n=new Wl;break}}n.name=(o=e.name)!=null?o:"Untitled Material";let s=n.userData.layers;lY(s);for(let l=r.length-1;l>=0;l--)hY(s,r[l],t);switch(i.category){case"basic":break;case"lambert":{let u=n,c=Li(i.emissive,t);c instanceof Ue?u.emissive.value=c:u.emissive.value.setHex(ed.getHex(c));break}case"toon":{let u=n,c=i;u.shininess.value=c.shininess;let d=Li(c.specular,t);d instanceof Ue?u.specular.value=d:u.specular.value.setHex(ed.getHex(d));break}case"physical":let l=n,h=i;l.metalness.value=h.metalness,l.roughness.value=h.roughness,l.reflectivity.value=h.reflectivity;break;case"phong":default:{let u=n,c=i;u.shininess.value=c.shininess;let d=Li(c.specular,t);d instanceof Ue?u.specular.value=d:u.specular.value.setHex(ed.getHex(d));break}}return n.penumbraSizeNode=t.penumbraSizeNode,s.blendColors(),s.blendAfterColors(),s.blendPositions(),n}function oY(e){for(let t of e)if(t.data.type==="light")return t.data;return{type:"light",category:"basic",visible:!0,alpha:1,mode:0}}function lY(e){for(let t of e.getLayers())e.removeLayer(t.id)}function hY(e,t,r){let i=Z6(t,r);i.type==="transmission"&&(i.transmissionSamplerMap=r==null?void 0:r.transmissionSamplerMap,i.transmissionDepthMap=r==null?void 0:r.transmissionDepthMap);let n=e.addLayer(i);n.uuid=t.id;for(let s in t.data)eD(s,n,t.data)}var uY=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

vec2 vogelDiskSample(int sample_index, int sample_count, float angle)
{
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sample_index) + 0.5f) / sqrt(float(sample_count));
  float theta = float(sample_index) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// NOTE: For now we aren't using this screen-space noise. But we should enable
// it again once we do some sort of temporal AA. Then we could potentially lower
// the number of samples needed and still get a pretty smooth result.
// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos)
{
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, ${5} - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

vec4 shadowmod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}
vec4 shadowperm(vec4 x){return shadowmod289(((x * 34.0) + 1.0) * x);}
float shadowNoise(vec3 p){
            vec3 a = floor(p);
            vec3 d = p - a;
            d = d * d * (3.0 - 2.0 * d);
            vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
            vec4 k1 = shadowperm(b.xyxy);
            vec4 k2 = shadowperm(k1.xyxy + b.zzww);
            vec4 c = k2 + a.zzzz;
            vec4 k3 = shadowperm(c);
            vec4 k4 = shadowperm(c + 1.0);
            vec4 o1 = fract(k3 * (1.0 / 41.0));
            vec4 o2 = fract(k4 * (1.0 / 41.0));
            vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
            vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
            return o4.y * d.y + o4.x * (1.0 - d.y);
        }

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;
    float temporalOffset = shadowNoise(floor(vWPosition * 10.));

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    //float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        float temporalOffset = shadowNoise(floor(vWPosition * 10.));
        float temporalAngle  = temporalOffset * PI2;


        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,cY=_t.lights_fragment_begin,dY=_t.shadowmask_pars_fragment,ax=!1,fY=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},rD=(e="medium")=>{if(!ax){ax=!0;let t=fY(e);_t.shadowmap_pars_fragment=uY(t);let r=cY.slice();r=r.replace("getShadow( spotShadowMap[ i ]",`getShadow( UNROLLED_LOOP_INDEX + ${3}, spotShadowMap[ i ]`),r=r.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),_t.lights_fragment_begin=r;let i=dY.slice();i=i.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),_t.shadowmask_pars_fragment=i}},pY=e=>{ax=!1,rD(e)},td=e=>"isEntity"in e,Mi=e=>"isAbstractMesh"in e,Mr=e=>e!==null&&e.isBooleanMesh,mY=e=>e.objectType==="CombinedCamera",gY=e=>td(e)&&(e.objectType==="LightDirectional"||e.objectType==="LightSpot"||e.objectType==="LightPoint"),ef=e=>"objectHelper"in e;function iD(e,t){var i;let r=!1;t.position&&(e.position.fromArray(t.position),r=!0),t.rotation&&(e.rotation.fromArray(t.rotation),r=!0),t.scale&&(r=!0,e.scale.fromArray(t.scale)),t.hiddenMatrix!==void 0&&"hiddenMatrix"in e&&(r=!0,e.hiddenMatrix.fromArray((i=t.hiddenMatrix)!=null?i:jl.identity)),r&&(e.updateMatrix(),Mr(e.parent)&&Mi(e)&&e.invalidateDownstreamBooleanData(!0).recomputeBoolean()),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&e.updateWorldMatrix(!1,!0),e.objectType==="CombinedCamera"&&(t.isUpVectorFlipped!==void 0&&(e.isUpVectorFlipped=t.isUpVectorFlipped),e.updateUp())}function vY(e,t){iD(e,t),t.name!==void 0&&(e.name=t.name),t.visible!==void 0&&(e.isEntity?e.visibility=t.visible:e.visible=t.visible)}function yY(e,t,r){vY(e,t),t.color!==void 0&&(e.color=Li(t.color,r)),t.intensity!==void 0&&(e.intensity=t.intensity),t.shadows!==void 0&&!(e instanceof wy)&&(e.castShadow=t.shadows),e.shadow&&!(e instanceof wy)&&t.depth!==void 0&&(e.shadow.camera.far=t.depth,e.shadow.needsUpdate=!0),t.helper!==void 0&&ef(e)&&(e.enableHelper=t.helper,e.gizmos.shadowmap.visible=t.helper)}function xY(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var _h=new gs,Ls=new F,Rs=new F,hu=new wt,nD=[new F(-1,1,1),new F(-1,-1,1),new F(1,-1,1),new F(1,1,1),new F(-1,1,-1),new F(-1,-1,-1),new F(1,-1,-1),new F(1,1,-1)],wY=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],bY=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]];function _Y(e,t,r=0,i=t.count){let n=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,h=-1/0;for(let u=r;u<i;u++){let c=t.getX(u),d=t.getY(u),f=t.getZ(u);c<n&&(n=c),d<s&&(s=d),f<a&&(a=f),c>o&&(o=c),d>l&&(l=d),f>h&&(h=f)}return e.min.set(n,s,a),e.max.set(o,l,h),e}var vA=(e,t,r,i)=>{var n;if(Mi(e)){let s=e.geometry.userData.parameters,a=e.geometry.getAttribute("position");e.geometry.userData.type==="SubdivGeometry"?Ls.copy(e.originalGeometry.boundingSphere.center):a!==void 0&&(_Y(_h,a,e.geometry.drawRange.start,e.geometry.drawRange.count<1/0?e.geometry.drawRange.count:a.count),_h.getCenter(Ls)),e.forceComputeSize?_h.getSize(Rs).multiplyScalar(.5):Rs.set(s.width,s.height,(n=s.depth)!=null?n:0).multiplyScalar(.5)}else if(ef(e)&&i===!0){let s=e.geometryHelper.getAttribute("position");_h.setFromArray(s.array),_h.getCenter(Ls),_h.getSize(Rs).multiplyScalar(.5)}else Ls.setScalar(0),Rs.setScalar(0);hu.copy(t).multiply(e.matrixWorld),Rs.x===0&&Rs.y===0&&Rs.z===0?r.push(new F(Ls.x,Ls.y,Ls.z).applyMatrix4(hu)):nD.forEach(s=>{r.push(s.clone().multiply(Rs).add(Ls).applyMatrix4(hu))})},yA=class extends gs{constructor(){super(...arguments),this.matrix=new wt,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let r=new wt().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,r,t)}expandByObjectSize(e,t,r=!1){let i=[];return r===!0?e.traverseEntity(n=>{n.visible&&vA(n,t,i,e.enableHelper===!0)}):vA(e,t,i,e.enableHelper===!0),this.setFromPoints(i)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4(hu.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(Rs).multiplyScalar(.5),this.getCenter(Ls),hu.copy(this.matrix).setPosition(Ls),this.vertices=nD.map(e=>e.clone().multiply(Rs).applyMatrix4(hu))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=wY.map(([e,t])=>new eF(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new F))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=bY.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}};function yc(e){let t=[];for(let r in e){let i=e[r];delete i.metadata,t.push(i)}return t}function SY(e){let t=[];for(let r in e)t.push(e[r]);return t}var sD=e=>class extends e{hasEntityChild(){return this.children.some(t=>td(t))}isDescendantOf(t){t instanceof er&&(t=t.uuid);let r=this;for(;r.parent;){if(r.parent.uuid===t)return!0;r=r.parent}return!1}attach(t,r){this.updateWorldMatrix(!0,!1);let i=new wt().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),i.multiply(t.parent.matrixWorld)),td(t)?t.hiddenMatrix.premultiply(i):t.applyMatrix4(i),t.updateWorldMatrix(!1,!1),this.add(t),r!==void 0&&(this.children.pop(),this.children.splice(r,0,t)),this}copy(t,r=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),r===!0)for(let i=0;i<t.children.length;i++){let n=t.children[i];this.add(n.clone())}return this}toJSON(t){let r=t===void 0,i={object:{uuid:"",objectType:""}};t===void 0&&(t={geometries:{},materials:{},textures:{},images:{},interactionStates:{},nodes:{}},i.metadata={version:1.5,type:"Object",generator:"Object3D.toJSON"});let n={uuid:this.uuid,objectType:this.type};if(this.name!==""&&(n.name=this.name),n.matrix=this.matrix.toArray(),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),n.layers=this.layers.mask,JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData),this.children.length>0){n.children=[];for(let s of this.children)(td(s)||s instanceof Jd)&&n.children.push(s.toJSON(t).object)}if(r){let s=yc(t.geometries),a=yc(t.materials),o=yc(t.textures),l=yc(t.images),h=yc(t.interactionStates),u=SY(t.nodes);s.length>0&&(i.geometries=s),a.length>0&&(i.materials=a),o.length>0&&(i.textures=o),l.length>0&&(i.images=l),h.length>0&&(i.interactionStates=h),u.length>0&&(i.nodes=u)}return i.object=n,i}fromJSON(t){return this.uuid=t.uuid,t.name!==void 0&&(this.name=t.name),t.matrix!==void 0?(this.matrix.fromArray(t.matrix),t.matrixAutoUpdate!==void 0&&(this.matrixAutoUpdate=t.matrixAutoUpdate),this.matrixAutoUpdate&&this.matrix.decompose(this.position,this.quaternion,this.scale)):(t.position!==void 0&&this.position.fromArray(t.position),t.rotation!==void 0&&this.rotation.fromArray(t.rotation),t.quaternion!==void 0&&this.quaternion.fromArray(t.quaternion),t.scale!==void 0&&this.scale.fromArray(t.scale)),this.castShadow=t.castShadow!==void 0,this.receiveShadow=t.receiveShadow!==void 0,t.visible!==void 0&&(this.visible=t.visible),t.frustumCulled!==void 0&&(this.frustumCulled=t.frustumCulled),t.renderOrder!==void 0&&(this.renderOrder=t.renderOrder),t.layers!==void 0&&(this.layers.mask=t.layers),t.userData!==void 0&&(this.userData=t.userData),this}},ks=e=>"isEntity"in e,MY=e=>"isAbstractMesh"in e,Wu=e=>class extends sD(e){constructor(){super(...arguments),this.objectType="",this.isEntity=!0,this.raycastLock=!1,this.scaleLock=!1,this.hiddenMatrix=new wt,this._singleBBox=new yA,this._recursiveBBox=new yA,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.forceComputeSize=!1}set visibility(t){this.visible=t;for(let r of this.children)ks(r)&&r.traverseEntity(i=>{ef(i)&&i.visible&&(i.objectHelper.visible=t)})}get visibility(){return this.visible}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}resetBBoxNeedsUpdate(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this.traverseAncestors(t=>{ks(t)&&(t.singleBBoxNeedsUpdate=!0,t.recursiveBBoxNeedsUpdate=!0)}),this.traverseEntity(t=>{t.singleBBoxNeedsUpdate=!0,t.recursiveBBoxNeedsUpdate=!0})}traverseEntity(t){t(this);for(let r of this.children)ks(r)&&r.traverseEntity(t)}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let r of this.children)r.updateMatrixWorld(t)}updateWorldMatrix(t,r){let i=this.parent;if(t&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),r)for(let n of this.children)n.updateWorldMatrix(!1,!0)}shallowClone(t){return new this.constructor().shallowCopy(this,t)}shallowCopy(t,r=!0){if(super.copy(t,!1),this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),r===!0)for(let i of t.children)ks(i)&&this.add(i.shallowClone());return this}clone(t){return new this.constructor().copy(this,t)}copy(t,r=!0){if(super.copy(t,!1),this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),r===!0)for(let i of t.children)ks(i)&&this.add(i.clone());return this}keepChildrenMatrixWorld(){let t=new wt,r=this.matrixWorld.clone();this.updateWorldMatrix(!1,!1),t.copy(this.matrixWorld).invert(),t.multiply(r);for(let i of this.children)ks(i)&&i.hiddenMatrix.premultiply(t)}toJSON(t){let r=super.toJSON(t),i=r.object;return this.raycastLock===!0&&(i.raycastLock=!0),this.scaleLock===!0&&(i.scaleLock=!0),i.hiddenMatrix=this.hiddenMatrix.toArray(),r}fromJSON(t){return super.fromJSON(t),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.scaleLock!==void 0&&(this.scaleLock=t.scaleLock),this.hiddenMatrix.fromArray(t.hiddenMatrix),this}fromObject3D(t){let r=t.children;return t.children=[],Object.assign(t,{raycastLock:!1,scaleLock:!1,hiddenMatrix:new wt}),this.copy(t),t.children=r,this}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let r={position:this.position.toArray(),rotation:[this.rotation.x,this.rotation.y,this.rotation.z],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return Py(r,t)}fromObjectTransformState(t){return t.position&&this.position.fromArray(t.position),t.rotation&&this.rotation.fromArray(t.rotation),t.scale&&this.scale.fromArray(t.scale),t.hiddenMatrix&&this.hiddenMatrix.fromArray(t.hiddenMatrix),this.updateMatrix(),this}toState(t=[]){let r=me({name:this.name,visible:this.visible,raycastLock:this.raycastLock},this.toObjectTransformState(t));return Py(r,t)}fromState(t,r){return t.name&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.type!=="OrthographicCamera"&&t.type!=="PerspectiveCamera"&&(this.matrixAutoUpdate=!1),t.visible!==void 0&&(this.visibility=t.visible),this.fromObjectTransformState(t),this}},xA=class extends er{constructor(e,t={}){super(),this.object=e;let r=e.recursiveBBox.getSize(new F),i=.1;this.parameters=Iy.defaultData(r.toArray(),i),O0(this.parameters,t),this.update(),this.setHideBase(this.parameters.hideBase)}refreshMaterial(){if("material"in this.object)for(let e of this.children)e.material=this.object.material}setHideBase(e){if("material"in this.object){if(Array.isArray(this.object.material)){if(this.children.length>0){for(let t of this.object.material)t.visible=!0;if(e){let t=this.object.material.map(r=>r.clone());for(let r of this.children)r.material=t}else for(let t of this.children)t.material=this.object.material}for(let t of this.object.material)t.visible=!e}else{if(this.children.length>0)if(this.object.material.visible=!0,e){let t=this.object.material.clone();for(let r of this.children)r.material=t}else for(let t of this.children)t.material=this.object.material;this.object.material.visible=!e}this.parameters.hideBase=e}}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters)}this.children.forEach(e=>e.updateMatrix())}_updateCount(){let e=this.parameters.type==="grid"?this.parameters.grid.count[0]*this.parameters.grid.count[1]*this.parameters.grid.count[2]:this.parameters.count;if(this.children.length!==e)if(this.children.length<e)for(let t=0,r=e-this.children.length;t<r;++t){let i=this.object.shallowClone(!1);i.visible=!0,this.add(i),this.parameters.hideBase&&this.setHideBase(!0)}else for(let t=0,r=this.children.length-e;t<r;++t)this.remove(this.children[0])}_updateRadial(e){let t=e.radial,r=t.start*kt.DEG2RAD,i=t.end*kt.DEG2RAD,n=r-i,s=new Hl(t.rotation[0]*kt.DEG2RAD,t.rotation[1]*kt.DEG2RAD,t.rotation[2]*kt.DEG2RAD),a;switch(t.axis){case"z":a=new F(0,0,1);break;case"y":a=new F(0,1,0);break;default:case"x":a=new F(1,0,0);break}for(let[o,l]of this.children.entries()){l.hiddenMatrix.identity(),l.scale.x=t.scale[0],l.scale.y=t.scale[1],l.scale.z=t.scale[2],l.position.setScalar(0);let h=n/e.count*o-r;switch(t.axis){case"x":l.rotation.set(0,h,0);break;case"y":l.rotation.set(0,0,h);break;case"z":l.rotation.set(h,0,0);break}l.translateOnAxis(a,t.radius),l.position.x+=t.position[0],l.position.y+=t.position[1],l.position.z+=t.position[2],t.alignment===!0?(l.rotation.x+=s.x,l.rotation.y+=s.y,l.rotation.z+=s.z):l.rotation.copy(s)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let t=e.linear,r=new Hl(t.rotation[0]*kt.DEG2RAD,t.rotation[1]*kt.DEG2RAD,t.rotation[2]*kt.DEG2RAD);for(let[i,n]of this.children.entries())n.hiddenMatrix.identity(),n.scale.x=1+(t.scale[0]-1)*i,n.scale.y=1+(t.scale[1]-1)*i,n.scale.z=1+(t.scale[2]-1)*i,n.rotation.x=r.x*i,n.rotation.y=r.y*i,n.rotation.z=r.z*i,n.position.x=t.position[0]*i,n.position.y=t.position[1]*i,n.position.z=t.position[2]*i}_updateGrid(e){let t=0,r=e.grid;if(r.useCenter===!0){let i={x:r.count[0]%2===0?2:1,y:r.count[1]%2===0?2:1,z:r.count[2]%2===0?2:1},n=new F(r.size[0]*(r.count[0]-i.x)*.5,r.size[1]*(r.count[1]-i.y)*.5,r.size[2]*(r.count[2]-i.z)*.5);for(let s=0;s<r.count[0];s++)for(let a=0;a<r.count[1];a++)for(let o=0;o<r.count[2];o++){let l=this.children[t++];l.hiddenMatrix.identity(),l.scale.setScalar(1),l.rotation.set(0,0,0),l.position.x=r.size[0]*s-n.x,l.position.y=r.size[1]*a-n.y,l.position.z=r.size[2]*o-n.z}}else for(let i=0;i<r.count[0];i++)for(let n=0;n<r.count[1];n++)for(let s=0;s<r.count[2];s++){let a=this.children[t++];a.hiddenMatrix.identity(),a.scale.setScalar(1),a.rotation.set(0,0,0),a.position.x=r.size[0]*i,a.position.y=-r.size[1]*n,a.position.z=-r.size[2]*s}}fromJSON(e){return this}toJSON(){return{}}fromClonerState(e){return e.hideBase!==void 0&&this.setHideBase(e.hideBase),O0(this.parameters,e),this.update(),this}},Bi=class extends Wu(Ji){constructor(e,t){super(e,t),this.isAbstractMesh=!0,this.isBooleanMesh=!1,this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new wt,this.booleanExclude=null,Array.isArray(t)&&(this.selectedMaterial=0,e.groups.length===0&&e.addGroup(0,e.getAttribute("position").count,0))}get cloner(){return this._cloner}set cloner(e){this._cloner&&this.remove(this._cloner),e&&this.add(e),this._cloner=e}getSelectedMaterial(e){return Array.isArray(this.material)?(this.selectedMaterial===void 0&&(this.selectedMaterial=e!=null?e:0),this.material[e!=null?e:this.selectedMaterial]):this.material}setSelectedMaterial(e,t){Array.isArray(this.material)?(this.selectedMaterial===void 0&&(this.selectedMaterial=t!=null?t:0),t=t!=null?t:this.selectedMaterial,this.material[t].dispose(),this.material[t]=e):(this.material.dispose(),this.material=e)}updateGeometry(e){let t=this.geometry,r=dD[t.userData.type],i=this.objectType==="NonParametric"?Object.assign({},t.userData,{geometry:t}):t.userData,n=r.build(r.normalizeInputs(e,i)),s=t.uuid;if(this.geometry.dispose(),this.geometry=n,this.geometry.uuid=s,this.geometry.computeBoundingSphere(),this.cloner)for(let a of this.cloner.children)a.geometry=this.geometry}resizeGeometry(e,t,r){C6.resizeGeometry(this.geometry,{width:e,height:t,depth:r})}shallowClone(e){return new this.constructor(this.geometry,this.material).shallowCopy(this,e)}clone(e){let t=this.objectType==="NonParametric"?Object.assign({},this.geometry.userData,{geometry:this.geometry.clone()}):this.geometry.userData,r=ox(t),i=Array.isArray(this.material)?this.material.map(n=>n.clone()):this.material.clone();return new this.constructor(r,i).copy(this,e)}copy(e,t=!0){return super.copy(e,t),e.cloner&&(this.cloner=new xA(e,e.cloner.parameters),this.add(this.cloner)),this}setFromClonerState(e){e===null?this.cloner=void 0:(this.cloner===void 0&&(this.cloner=new xA(this)),this.cloner.fromClonerState(e))}fromState(e,t){var r,i,n;return super.fromState(e),e.type==="Mesh"&&(this.setFromClonerState(e.cloner),this.castShadow=(r=e.castShadow)!=null?r:!0,this.receiveShadow=(i=e.receiveShadow)!=null?i:!0,this.booleanExclude=(n=e.booleanExclude)!=null?n:null),this}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Eo.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),Mr(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)Mi(e)&&(e.freeBooleanPointer(),Mr(e)&&e.invalidateUpstreamBooleanData())}},AY=new F(0,0,1),wA=new F,bA=new F,_A=new xi,_b=class extends Bi{constructor(e=Ka.create({}),t=new Za({side:ti})){var r;super(e,t),this.recursiveSelection=!1,this.objectType="VectorObject",this.eventDispatcher=new nn,this._onShapeUpdate=()=>{this.updateGeometry({}),this.geometry.computeBoundingSphere(),this.geometry.computeBoundingBox()},this.castShadow=!0,this.receiveShadow=!0,this.forceComputeSize=!0,this.shape=e.userData.shape,(r=this.shape.eventDispatcher)==null||r.addEventListener("update",this._onShapeUpdate)}toJSON(e){let t=super.toJSON(e);return t.object.objectType="VectorObject",t}fromState(e){return super.fromState(e),this.shape.update(),this}setHelperVisibility(){}updateGeometry(e){if(super.updateGeometry(e),"userData"in this.geometry){let t=this.geometry.userData.parameters;this.eventDispatcher.dispatchEvent({type:"geometryUpdate",parameters:t})}}setShape(e){var t,r;this.shape&&((t=this.shape.eventDispatcher)==null||t.removeEventListener("update",this._onShapeUpdate)),this.shape=e,(r=this.shape.eventDispatcher)==null||r.addEventListener("update",this._onShapeUpdate)}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),_A.getNormalMatrix(this.matrixWorld),wA.copy(AY).applyMatrix3(_A).normalize(),bA.setFromMatrixPosition(this.matrixWorld),this.shape.plane.setFromNormalAndCoplanarPoint(wA,bA)}clone(e){let t=this.shape.clone(),r=this.material.clone(),i=this.geometry.userData,n=Ka.create(Object.assign({},i,{shape:t})),s=new _b(n,r).copy(this,e);return s.shape=t,t.update(),s}raycast(e,t){Bi.prototype.raycast.call(this,e,t)}};function aD(e,t){return EY(e)}function EY(e){let t={parameters:e,type:e.type};if(e.type==="VectorGeometry"){let i=yr.createFromState(e.shape,e.width,e.height);t.shape=i}else e.type==="NonParametricGeometry"&&(e.data.groups&&e.data.groups.forEach(i=>{var n;return i.materialIndex=Math.max((n=i.materialIndex)!=null?n:0,0)}),t.geometry=new Gw().parse(e));let r;try{r=ox(t)}catch(i){console.error(i)}if(!r){let i=yr.createFromState(z0.defaultData(),100,100);t.shape=i,r=ox(t)}return r}var ht;T6.then(e=>{ht=e});var SA=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),MA=new Uint32Array([0,1,2,3]),AA=new Uint8Array([4]),as=class{static build(e,t,r,i,n){var h,u;let s,a,o,l=(u=(h=e==null?void 0:e.phongAngle)!=null?h:t==null?void 0:t.phongAngle)!=null?u:35;if(i===!1&&(l=-1),e.positionWASM!==void 0){r&&r!==0&&(ht.free_bvh(r),ht.free_subdivision_surface(r));try{s=as.allocate(e,n)}catch(c){console.error(c,e),s=as.allocate({positionWASM:SA,indexWASM:MA,verticesPerFaceWASM:AA},n)}ht.set_destination_refinement_level(s,0),a=as.buildLevel(s,!0,l)}else s=r,e.phongAngle!==void 0&&(a=as.buildLevel(s,!0,l));return e.subdivisions!==void 0&&(ht.set_destination_refinement_level(s,e.subdivisions),e.subdivisions>0?o=as.buildLevel(s,!1,l):o=null),{subdivPointer:s,originalGeometry:a,subdividedGeometry:o}}static primitiveToQuads(e,t){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let r=e.shape!==void 0?t.geometry:aD(e),i,n,s,a;return{positions:i,triIndices:a}=oD(r.getAttribute("position"),r.getIndex()),{indices:n,verticesPerFace:s}=lD(i,a,r),{positions:i,indices:n,verticesPerFace:s}}static allocate(e,t){var b;let r,i,n,s=[],a=[];e.positionWASM&&e.positionWASM.length>0?(r=e.positionWASM,i=e.indexWASM,n=e.verticesPerFaceWASM):(r=SA,i=MA,n=AA);let o=r.length,l=i.length,h=n.length,u=r.length+s.length+a.length,c=i.length+n.length,d=u*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,f=u*Float32Array.BYTES_PER_ELEMENT,p=ht._malloc(d),m=new Float32Array(ht.HEAPF32.buffer,p,u),g=new Uint32Array(ht.HEAPU32.buffer,p+f,c);m.set(r,0),m.set(s,r.length),m.set(a,r.length+s.length),g.set(i,0),g.set(n,i.length);let v;(b=e==null?void 0:e.scaleBaked)!=null&&b.some(_=>_!==1)&&(v=new wt().makeScale(...e.scaleBaked)),t&&(v?v.premultiply(t):v=t);let x=v?ht.alloc_subdivision_surface2(p,o,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,h,v.elements):ht.alloc_subdivision_surface(p,o,p+f,l,p+f+i.length*Uint32Array.BYTES_PER_ELEMENT,h);return ht._free(p),x}static buildLevel(e,t,r,i,n){let s=n?ht.get_mesh_data2(e,t?ht.Level.CONTROL:ht.Level.REFINED,r,n.elements):ht.get_mesh_data(e,t?ht.Level.CONTROL:ht.Level.REFINED,r),a=8,o=ht.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(4,4+4),h=0,u=ht.HEAPU32[o[h]>>2],c=ht.HEAPF32.subarray(u>>2,(u>>2)+l[h]);h++;let d=ht.HEAPU32[o[h]>>2],f=ht.HEAPF32.subarray(d>>2,(d>>2)+l[h]);h++;let p=ht.HEAPU32[o[h]>>2],m=ht.HEAPU32.subarray(p>>2,(p>>2)+l[h]);h++;let g=ht.HEAPU32[o[h]>>2],v=ht.HEAPU32.subarray(g>>2,(g>>2)+l[h]);if(h++,i===void 0){let x=new vt;if(x.setIndex(new Qc(v,1)),x.setAttribute("position",new Ge(c,3)),x.setAttribute("normal",new Ge(f,3)),t){x.setAttribute("faceMap",new Qc(m,1));let b=new Float32Array(f.length/3*4).fill(0);x.setAttribute("color",new Ct(b,4))}return ht.free_mesh_data(s),x.userData.type="SubdivGeometry",x}i.getAttribute("position").copyArray(c),i.getAttribute("normal").copyArray(f),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,ht.free_mesh_data(s)}static buildControlCageWireframe(e,t,r){let i=ht.get_wireframe_data_for_base_level(e),n=4,s=ht.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(2,2+2),o=0,l=ht.HEAPU32[s[o]>>2],h=ht.HEAPF32.subarray(l>>2,(l>>2)+a[o]);o++;let u=ht.HEAPU32[s[o]>>2],c=ht.HEAPU32.subarray(u>>2,(u>>2)+a[o]);if(t===void 0){let d=new vt;d.setAttribute("position",new Ge(h,3));let f=new Float32Array(h.length);for(let p=0,m=h.length;p<m;)f[p++]=r.r,f[p++]=r.g,f[p++]=r.b;return d.setAttribute("color",new Ct(f,3)),d.setIndex(new Qc(c,1)),ht.free_wireframe_data_for_base_level(i),d}t.getAttribute("position").copyArray(h),t.attributes.position.needsUpdate=!0,ht.free_wireframe_data_for_base_level(i)}static updateCollabMesh(e,t,r){t||ht.set_destination_refinement_level(e,1);let i=r?ht.get_topological_data2(e,t?ht.Level.CONTROL:ht.Level.REFINED,r.elements):ht.get_topological_data(e,t?ht.Level.CONTROL:ht.Level.REFINED),n=6,s=ht.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(3,3+3),o=0,l=ht.HEAPU32[s[o]>>2],h=new Float32Array(ht.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let u=ht.HEAPU32[s[o]>>2],c=new Uint32Array(ht.HEAPU32.subarray(u>>2,(u>>2)+a[o]));o++;let d=ht.HEAPU32[s[o]>>2],f=new Uint8Array(ht.HEAPU32.subarray(d>>2,(d>>2)+a[o]));return ht.free_topological_data(i),{positions:h,indices:c,verticesPerFace:f}}},EA=["getX","getY","getZ"];function oD(e,t){let r={},i=t?t.count:e.count,n=0,s=[],a=[],o=1e4;for(let h=0;h<i;h++){let u=t?t.getX(h):h,c="";for(let d=0;d<3;d++)c+=`${~~(e[EA[d]](u)*o)},`;if(c in r)s.push(r[c]);else{for(let d=0;d<3;d++)a.push(e[EA[d]](u));r[c]=n,s.push(n),n++}}let l=[];for(let h=0;h<s.length;h+=3)s[h]===s[h+1]||s[h]===s[h+2]||s[h+1]===s[h+2]||l.push(s[h],s[h+1],s[h+2]);return{positions:a,triIndices:l}}var mp=new F,Iv=new F,Nv=new F,Bv=new F;function lD(e,t,r){var s;let i=[],n=[];if(r.userData.shape!==void 0&&r.userData.parameters.depth===0){let a=r.userData.shape.extractShapePointsToFlatArray([]),o=0;for(let h=0;h<a.length;h+=2)o+=(a[h]-a[(h===0?a.length:h)-2])*(a[h+1]+a[(h===0?a.length:h)-1]);e.length=0;let l=0;if(o<0)for(let h=0;h<a.length;h+=2)e.push(a[h],a[h+1],0),i.push(l++);else for(let h=a.length-2;h>=0;h-=2)e.push(a[h],a[h+1],0),i.push(l++);return n.push(l),{indices:i,verticesPerFace:n}}for(let a=0,o=(s=r.capStartIndex)!=null?s:t.length;a<o;)if(t[a+1]===t[a+3]&&t[a+2]===t[a+5]||t[a+0]===t[a+3]&&t[a+2]===t[a+4]){mp.set(e[t[a]*3],e[t[a]*3+1],e[t[a]*3+2]),Iv.set(e[t[a+1]*3],e[t[a+1]*3+1],e[t[a+1]*3+2]),Nv.set(e[t[a+4]*3],e[t[a+4]*3+1],e[t[a+4]*3+2]),Bv.set(e[t[a+5]*3],e[t[a+5]*3+1],e[t[a+5]*3+2]),Iv.sub(mp).normalize(),Nv.sub(mp).normalize(),Bv.sub(mp).normalize();let l=Iv.cross(Nv).dot(Bv);Math.abs(l)>.005?(i.push(t[a],t[a+1],t[a+2]),n.push(3),a+=3):(i.push(t[a],t[a+1],t[a+4],t[a+5]),n.push(4),a+=6)}else i.push(t[a],t[a+1],t[a+2]),n.push(3),a+=3;if(r.capStartIndex!==void 0){let a=[],o=[],l=0;for(let h=0,u=0;h<e.length;h+=3,u++)e[h+2]===0&&(a.push(u),l++),e[h+2]===r.userData.parameters.depth&&o.push(u);if(r.userData.parameters.extrudeBevelSize===0){let h=o[0];o[0]=o[1],o[1]=h}a.reverse(),i.push(...a,...o),n.push(l,l)}return{indices:i,verticesPerFace:n}}var Eo={};gT(Eo,{calcBoolean:()=>LY,calcBooleanTopological:()=>PY,freeMeshSet:()=>IY,getMeshSet:()=>RY,transformMeshSet:()=>OY});var hD,CY=new Promise(e=>{hD=e}),CA=!1;async function TY(){if(CA)return;let e="https://unpkg.com/@splinetool/boolean-wasm@0.9.66/build",[t,r]=await Promise.all([FR(()=>import("./boolean.1f3172d1.js"),[]),fetch(`${e}/boolean.wasm`).then(n=>n.arrayBuffer())]),i=await t.default({wasmBinary:r});hD(i),CA=!0}var Et,uu;CY.then(e=>Et=e);function DY(e,t){let r,{positions:i,triIndices:n}=oD(e.getAttribute("position"),e.getIndex()),s;if(t){let{indices:a,verticesPerFace:o}=lD(i,n,e);s=o.length,r=[];for(let l=0,h=0;l<s;l++){r.push(o[l]);for(let u=0;u<o[l];u++)r.push(a[h++])}}else{let a=n.length;r=Array(a+a/3),s=0;for(let o=0,l=0;l<r.length;)r[l++]=3,s++,r[l++]=n[o++],r[l++]=n[o++],r[l++]=n[o++]}return{positions:i,faceIndices:r,nFaces:s}}function uD(e){let t=e.length,r=t*Uint32Array.BYTES_PER_ELEMENT,i=t*Float32Array.BYTES_PER_ELEMENT,n=Number.isInteger(e[0])?r:i,s=Et._malloc(n);return(Number.isInteger(e[0])?new Uint32Array(Et.HEAPU32.buffer,s,t):new Float32Array(Et.HEAPF32.buffer,s,t)).set(e,0),s}function cD(e){switch(e){case 0:return Et.OP.UNION;case 1:return Et.OP.INTERSECTION;case 2:return Et.OP.A_MINUS_B;case 3:return Et.OP.B_MINUS_A;case 4:return Et.OP.SYMMETRIC_DIFFERENCE;case 5:return Et.OP.ALL;default:throw new Error("Unknown boolean operation "+e)}}function PY(e,t){uu===void 0&&(uu=Et.init_csg());let r=uD(e),i=Et.csg_calc_topological(uu,r,e.length,cD(t));Et._free(r);let n=6,s=Et.HEAPU32.subarray(i>>2,(i>>2)+n),a=s.subarray(3,3+3),o=0,l=Et.HEAPU32[s[o]>>2],h=new Float32Array(Et.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let u=Et.HEAPU32[s[o]>>2],c=new Uint32Array(Et.HEAPU32.subarray(u>>2,(u>>2)+a[o]));o++;let d=Et.HEAPU32[s[o]>>2],f=new Uint8Array(Et.HEAPU32.subarray(d>>2,(d>>2)+a[o]));return Et.free_mesh_data(i),{positions:h,indices:c,verticesPerFace:f}}function LY(e,t,r,i){uu===void 0&&(uu=Et.init_csg());let n=uD(e),s=Et.csg_calc(uu,n,e.length,i,cD(t));Et._free(n);let a=5,o=Et.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(2,2+3),h=0,u=Et.HEAPU32[o[h]>>2],c=Et.HEAPF32.subarray(u>>2,(u>>2)+l[h]);h++;let d=Et.HEAPU32[o[h]>>2],f=Et.HEAPF32.subarray(d>>2,(d>>2)+l[h]);h++;let p=l[h];r.setAttribute("position",new Ge(c,3)),r.setAttribute("normal",new Ge(f,3));let m=Et.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return r.boundingSphere===null&&(r.boundingSphere=new ha),r.boundingSphere.center.set(m[0],m[1],m[2]),r.boundingSphere.radius=(m[3]**2+m[4]**2+m[5]**2)**.5,r.userData.parameters={width:m[3]*2,height:m[4]*2,depth:m[5]*2},Et.free_mesh_data(s),p}function RY(e,t){if(Et===void 0)return-1;let r,i,n;if(t&&e.userData.positions!==void 0){let p=e.userData;n=p.verticesPerFace.length,r=p.positions,i=Array(p.verticesPerFace.reduce((m,g)=>m+g,0)+n);for(let m=0,g=0,v=0;m<p.verticesPerFace.length;m++){i[v++]=p.verticesPerFace[m];for(let x=0;x<p.verticesPerFace[m];x++)i[v++]=p.indices[g++]}}else({positions:r,faceIndices:i,nFaces:n}=DY(e,t));let s=r.length,a=i.length,o=r.length,l=i.length,h=o*Float32Array.BYTES_PER_ELEMENT+l*Uint32Array.BYTES_PER_ELEMENT,u=o*Float32Array.BYTES_PER_ELEMENT,c=Et._malloc(h),d=new Float32Array(Et.HEAPF32.buffer,c,o),f=new Uint32Array(Et.HEAPU32.buffer,c+u,l);return d.set(r,0),f.set(i,0),Et.get_csg_mesh(c,s,c+u,a,n)}function OY(e,t){Et.transform_csg_mesh(e,t.elements)}function IY(e){Et.free_csg_mesh(e)}var dD={ConeGeometry:yW,CubeGeometry:xW,CylinderGeometry:vW,DodecahedronGeometry:bW,EllipseGeometry:QW,HelixGeometry:$W,IcosahedronGeometry:eq,LatheGeometry:tq,NonParametricGeometry:oq,PolygonGeometry:lq,PyramidGeometry:hq,RectangleGeometry:A6,SphereGeometry:dq,PlaneGeometry:fq,BackdropGeometry:pq,StarGeometry:gq,TextFrameGeometry:E6,TorusGeometry:vq,TorusKnotGeometry:xq,TriangleGeometry:wq,VectorGeometry:Ka},ox=e=>dD[e.type].create(e),TA=new wt;function DA(e){let t=!1;return e.scene.objects.traverse((r,i)=>{var n;((n=i.geometry)==null?void 0:n.type)==="BooleanGeometry"&&(t=!0)}),t}var NY=class extends Bi{constructor(e=new vt,t=new Wl){super(e,t),this.booleanOp=2,this.phongAngle=35,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.isBooleanMesh=!0,this.castShadow=!0,this.receiveShadow=!0,this.geometry.userData.parameters={width:0,height:0,depth:0},this.onAfterRender=this.recomputeBoolean.bind(this)}reInit(){this.isBooleanMesh=!0,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry.userData.parameters={width:0,height:0,depth:0},this.onAfterRender=this.recomputeBoolean.bind(this)}recomputeBoolean(e){var r;if(this.booleanMeshSetAddress!==-1)return;for(let i=0;i<this.children.length;i++){let n=this.children[i];Mr(n)&&n.recomputeBoolean(e===!0)}this.meshSetAddresses=[];for(let i=0;i<this.children.length;i++){let n=this.children[i];if(MY(n)&&n.booleanExclude===!1&&((r=n.geometry.attributes.position)==null?void 0:r.count)>0&&n.geometry.drawRange.count>0){if(n.booleanMeshSetAddress===-1){if(n.booleanMeshSetAddress=Eo.getMeshSet(n.geometry,e===!0),n.booleanMeshSetAddress===-1)return;Eo.transformMeshSet(n.booleanMeshSetAddress,n.matrix),n.booleanMatrixInvOld.copy(n.matrix).invert(),n.booleanWasTransformed=!1}else Mr(n)&&n.needsTransformForDownstream===!0?(Eo.transformMeshSet(n.booleanMeshSetAddress,n.matrix),n.needsTransformForDownstream=!1):n.booleanWasTransformed===!0&&(TA.multiplyMatrices(n.matrix,n.booleanMatrixInvOld),Eo.transformMeshSet(n.booleanMeshSetAddress,TA),n.booleanMatrixInvOld.copy(n.matrix).invert(),n.booleanWasTransformed=!1);this.meshSetAddresses.push(n.booleanMeshSetAddress)}}if(this.meshSetAddresses.length===0){this.geometry.setDrawRange(0,0);return}if(e===!0)return Eo.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let t=this.geometry;t.dispose(),this.geometry=new vt,this.geometry.userData=t.userData,this.geometry.boundingSphere=t.boundingSphere;try{this.booleanMeshSetAddress=Eo.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(i){this.booleanMeshSetAddress=0,console.error(i)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0}toJSON(e){let t=super.toJSON(e);return t.object.objectType="Mesh3D",t}updateGeometry(e){let t=e.parameters;t.operation!==void 0&&(this.booleanOp=t.operation),t.phongAngle!==void 0&&(this.phongAngle=t.phongAngle),this.invalidateDownstreamBooleanData().recomputeBoolean()}},tf=e=>{var t;return t=class extends e{constructor(){super(...arguments),this.isObjectHelper=!0}},t.geometryHelper=new $o(30,30,30),t},gp=new Sm,kv=new ha,PA=new wt,rf=(e,t,r,i,n=!1)=>{let s=t,a=e.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),kv.copy(s.boundingSphere),kv.applyMatrix4(a),r.ray.intersectsSphere(kv)===!1||(PA.copy(a).invert(),gp.copy(r.ray).applyMatrix4(PA),s.boundingBox!==null&&gp.intersectsBox(s.boundingBox)===!1))return;let o,l,h,u,c=s.index,d=s.attributes.position,f=s.drawRange,p,m;if(n===!1){let v=Math.max(0,f.start),x=Math.min(c.count,f.start+f.count);for(p=v,m=x;p<m;p+=3)if(l=c.getX(p),h=c.getX(p+1),u=c.getX(p+2),o=g(e,r,gp,d,l,h,u),o){o.faceIndex=Math.floor(p/3),i.push(o);return}}else{let v=s.attributes.position,x=new F,b=new F,_=new F,E=new F,S=2,P=1/((e.scale.x+e.scale.y+e.scale.z)/3),M=P*P,B=Math.max(0,f.start),R=Math.min(v.count,f.start+f.count);for(let H=B,Q=R-1;H<Q;H+=S){if(x.fromBufferAttribute(v,H),b.fromBufferAttribute(v,H+1),gp.distanceSqToSegment(x,b,E,_)>M)continue;E.applyMatrix4(e.matrixWorld);let z=r.ray.origin.distanceTo(E);z<r.near||z>r.far||i.push({distance:z,point:_.clone().applyMatrix4(e.matrixWorld),object:e})}}function g(v,x,b,_,E,S,P){let M=new F,B=new F,R=new F,H=new F,Q=new F;if(M.fromBufferAttribute(_,E),B.fromBufferAttribute(_,S),R.fromBufferAttribute(_,P),b.intersectTriangle(M,B,R,!1,H)===null)return null;Q.copy(H),Q.applyMatrix4(v.matrixWorld);let z=x.ray.origin.distanceTo(Q);return z<x.near||z>x.far?null:{faceIndex:1,distance:z,point:Q.clone(),object:v}}},vp=new F,An=new Bu,BY=class extends Qd{constructor(e){let t=new vt,r=new ma({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],n=[],s={},a=new Ue(15711266),o=new Ue(15711266),l=new Ue(2857471);h("n1","n2",a),h("n2","n4",a),h("n4","n3",a),h("n3","n1",a),h("f1","f2",a),h("f2","f4",a),h("f4","f3",a),h("f3","f1",a),h("n1","f1",a),h("n2","f2",a),h("n3","f3",a),h("n4","f4",a),h("p","n1",o),h("p","n2",o),h("p","n3",o),h("p","n4",o),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l);function h(c,d,f){u(c,f),u(d,f)}function u(c,d){i.push(0,0,0),n.push(d.r,d.g,d.b),s[c]===void 0&&(s[c]=[]),s[c].push(i.length/3-1)}t.setAttribute("position",new Ge(i,3)),t.setAttribute("color",new Ge(n,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;An.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let r=1,i=1,n=.8;Jn("n1",t,e,An,-r,-i,n),Jn("n2",t,e,An,r,-i,n),Jn("n3",t,e,An,-r,i,n),Jn("n4",t,e,An,r,i,n);let s=n;Jn("f1",t,e,An,-r,-i,s),Jn("f2",t,e,An,r,-i,s),Jn("f3",t,e,An,-r,i,s),Jn("f4",t,e,An,r,i,s);let a=s,o=.5;Jn("u1",t,e,An,r*.7*o,i*1.1,a),Jn("u2",t,e,An,-r*.7*o,i*1.1,a),Jn("u3",t,e,An,0,i*(1.1+.9*o),a),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Jn(e,t,r,i,n,s,a){vp.set(n,s,a).unproject(i);let o=t[e];if(o!==void 0){let l=r.getAttribute("position");for(let h=0,u=o.length;h<u;h++)l.setXYZ(o[h],vp.x,vp.y,vp.z)}}var kY=class extends tf(BY){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){rf(this.object,this.geometry,e,t,!0)}},fD=class extends tf(iF){constructor(e,t=15,r=10066329){super(e,t,r),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){rf(this.object,fD.geometryHelper,e,t)}},pD=class extends tf(nF){constructor(e,t=15){super(t),this.object=e,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}raycast(e,t){rf(this.object,pD.geometryHelper,e,t)}update(){}},mD=class extends tf(rF){constructor(e,t=15,r=6710886){super(e,t,r),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){rf(this.object,mD.geometryHelper,e,t)}},lx=class extends tf(tF){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){rf(this.object,lx.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=lx._vector,t=this.object.distance?this.object.distance:1e3,r=t*Math.tan(this.object.angle);this.cone.scale.set(r,r,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let i=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let n=0,s=this.cone.material.length;n<s;n++)this.cone.material[n].color.set(i);else this.cone.material.color.set(i)}}},gD=lx;gD._vector=new F;var nf=(e,t)=>class extends e{constructor(){super(...arguments),this.objectHelper=new t(this),this.enableHelper=!1}set visibility(r){this.visible=r,this.setHelperVisibility(r),this.setHelperChildrenVisibility(r)}get visibility(){return this.visible}get geometryHelper(){return t.geometryHelper}setHelperVisibility(r){this.objectHelper.visible=r}setHelperChildrenVisibility(r){for(let i of this.children)ks(i)&&i.traverseEntity(n=>{ef(n)&&n.visible&&(n.objectHelper.visible=r)})}raycast(r,i){this.objectHelper.raycast(r,i)}copy(r,i=!0){return super.copy(r,i),r.enableHelper!==void 0&&(this.enableHelper=r.enableHelper),r.objectHelper!==void 0&&(this.objectHelper.visible=r.objectHelper.visible),this}toJSON(r){let i=super.toJSON(r),n=i.object;return n.enableHelper=this.enableHelper,i}fromJSON(r){return super.fromJSON(r),r.enableHelper!==void 0&&(this.enableHelper=!0),this}fromLightState(r,i){if(this.objectType==="LightDirectional"||this.objectType==="LightPoint"||this.objectType==="LightSpot"){let n=this;r.color!==void 0&&(n.color=Li(r.color,i)),r.intensity!==void 0&&(n.intensity=r.intensity),r.depth!==void 0&&(n.shadow.camera.far=r.depth,n.shadow.needsUpdate=!0),r.shadows!==void 0&&(this.castShadow=r.shadows),r.helper!==void 0&&(this.enableHelper=r.helper,n.gizmos.shadowmap.visible=r.helper)}return this}},Sh=new F,zv=new F,Mu=class extends nf(Wu(Bu),kY){constructor(e=window.innerWidth,t=window.innerHeight,r=45,i,n=1e5){super(),this.objectType="CombinedCamera",this._cameraType="OrthographicCamera",this.targetOffset=Od.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.width=e,this.height=t,this.orthoCamera=new Ow(e*-.5,e*.5,t*.5,t*-.5,i!=null?i:-5e4,n),this.perspCamera=new gi(r,e/t,i!=null?i:50,n),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.fov=this.perspCamera.fov,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.toOrthographic(!0)}static createFromState(e,t){let r=new Mu().fromState(t);return r.enableHelper=!0,r.objectHelper.update(),r.uuid=e,r}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}setNear(e,t){e==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e){super.lookAt(e),this.getWorldPosition(Sh),this.targetOffset=Sh.distanceTo(e)}getTarget(e=new F){return this.getWorldDirection(zv),this.getWorldPosition(Sh),zv.multiplyScalar(this.targetOffset),e.copy(Sh).add(zv),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(Sh),Sh.distanceTo(e)}updateUp(){let e=this.getWorldQuaternion(new yn),t=new F(0,0,1).applyQuaternion(e),r=new F().copy(er.DefaultUp);this.isUpVectorFlipped&&r.negate(),r.applyQuaternion(e);let i=new F().copy(er.DefaultUp).projectOnPlane(t),n=new F().crossVectors(i,r).dot(t)>=0?1:-1;this.angleOffsetFromUp=i.angleTo(r)*n}getViewFrontToObject(e){let t=e.getWorldPosition(new F),r=e.getWorldDirection(new F).multiplyScalar(this.targetOffset);return{position:t.clone().add(r),target:t}}getViewToObject(e){let t=e.getWorldPosition(new F),r=this.getWorldDirection(new F).multiplyScalar(this.targetOffset);return{position:t.clone().sub(r),target:t}}setViewplaneSize(e,t){this.left=-e*.5,this.right=e*.5,this.top=t*.5,this.bottom=-t*.5,this.aspect=e/t,this.updateProjectionMatrix()}toOrthographic(e){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",(this.enableHelper===!0||e===!0)&&this.objectHelper.update()}toPerspective(e){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",(this.enableHelper===!0||e===!0)&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,r,i,n,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,t,r,i,n,s):this.orthoCamera.setViewOffset(e,t,r,i,n,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}updateProjectionMatrix(e){this._cameraType==="PerspectiveCamera"?this.toPerspective(e):this._cameraType==="OrthographicCamera"&&this.toOrthographic(e)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}fromCameraRender(e){let t={near:this.orthoCamera.near,far:this.orthoCamera.far},r={near:this.perspCamera.near,far:this.perspCamera.far};return this.copy(e),this.name="",this.enableHelper=!0,this.objectHelper.visible=!0,this.orthoCamera.near=t.near,this.orthoCamera.far=t.far,this.perspCamera.near=r.near,this.perspCamera.far=r.far,this.updateProjectionMatrix(),this}toJSON(e){let t=super.toJSON(e),r=t.object;return r.objectType="CombinedCamera",r.cameraType=this.cameraType,r.targetOffset=this.targetOffset,r.isUpVectorFlipped=this.isUpVectorFlipped,r.angleOffsetFromUp=this.angleOffsetFromUp,r.left=this.left,r.right=this.right,r.top=this.top,r.bottom=this.bottom,this.view!==null&&(r.view=Object.assign({},this.view)),r.zoomOrtho=this.orthoCamera.zoom,r.nearOrtho=this.orthoCamera.near,r.far=this.far,r.aspect=this.aspect,r.fov=this.fov,r.focus=this.focus,r.filmGauge=this.filmGauge,r.filmOffset=this.filmOffset,r.zoomPersp=this.perspCamera.zoom,r.nearPersp=this.perspCamera.near,t}fromJSON(e){var t;if(super.fromJSON(e),this.cameraType=e.cameraType,e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.orbitControlsTarget!==void 0){let r=this.getWorldPosition(new F),i=new F().fromArray(e.orbitControlsTarget);this.targetOffset=i.distanceTo(r)}else e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset);return this.isUpVectorFlipped=!1,this.angleOffsetFromUp=(t=e.angleOffsetFromUp)!=null?t:0,e.left!==void 0&&(this.left=e.left),e.right!==void 0&&(this.right=e.right),e.top!==void 0&&(this.top=e.top),e.bottom!==void 0&&(this.bottom=e.bottom),e.view!==void 0&&(this.view=Object.assign({},e.view)),e.zoomOrtho!==void 0&&(this.orthoCamera.zoom=e.zoomOrtho),e.nearOrtho!==void 0&&(this.orthoCamera.near=e.nearOrtho),e.far!==void 0&&(this.far=e.far),e.aspect!==void 0&&(this.aspect=e.aspect),e.fov!==void 0&&(this.fov=e.fov),e.focus!==void 0&&(this.focus=e.focus),e.filmGauge!==void 0&&(this.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(this.filmOffset=e.filmOffset),e.zoomPersp!==void 0&&(this.perspCamera.zoom=e.zoomPersp),e.nearPersp!==void 0&&(this.perspCamera.near=e.nearPersp),this.updateProjectionMatrix(),this}toCameraState(e=[]){let t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return Py(t,e)}fromCameraState(e){let{orthographic:t,perspective:r}=e;return e.type!==void 0&&(this.cameraType=e.type),e.far!==void 0&&(this.far=e.far),t!==void 0&&(t.near!==void 0&&(this.orthoCamera.near=t.near),t.zoom!==void 0&&(this.orthoCamera.zoom=t.zoom)),r!==void 0&&(r.near!==void 0&&(this.perspCamera.near=r.near),r.fov!==void 0&&(this.perspCamera.fov=r.fov),r.zoom!==void 0&&(this.perspCamera.zoom=r.zoom)),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix(),this}toState(e){return qe(me(me({},super.toState(e)),this.toCameraState(e)),{type:this.cameraType})}fromState(e){return super.fromState(e),this.fromCameraState(e),this}},j0=class extends nf(Wu(Pc),pD){constructor(){super(...arguments),this.objectType="EmptyObject"}static createFromState(e,t){let r=new j0().fromState(t);return r.uuid=e,r.enableHelper=!0,r.objectHelper.update(),r}toJSON(e){let t=super.toJSON(e);return t.object.objectType="EmptyObject",t}},vD=class extends nf(Wu(Qz),fD){constructor(...e){super(...e),this.objectType="LightDirectional",this._gizmos={},this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1;let t=this.shadow.camera;t.top=1250,t.bottom=-1250,t.right=1250,t.left=-1250,t.near=-1e4,t.far=2500;let r=new No(this.shadow.camera);r.visible=!1,this._gizmos.shadowmap=r,this.update()}static createFromState(e,t,r){let i=new vD().fromState(t,r);return i.uuid=e,i}get gizmos(){return this._gizmos}showGizmos(){for(let e in this._gizmos){let t=this._gizmos[e];t instanceof No&&(t.visible=!0)}}hideGizmos(){for(let e in this._gizmos){let t=this._gizmos[e];t instanceof No&&(t.visible=!1)}}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this._gizmos){let t=this._gizmos[e];t instanceof No&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.enableHelper===!0&&this.objectHelper.visible===!0&&this.objectHelper.update()}copy(e,t=!0){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){let t=super.toJSON(e),r=t.object;return r.objectType="LightDirectional",r.color=this.color.getHex(),r.intensity=this.intensity,r.shadow=this.shadow.toJSON(),t}fromJSON(e){var i;super.fromJSON(e),this.color.set(e.color),this.intensity=e.intensity,this.shadow.normalBias=(i=e.shadow.normalBias)!=null?i:0,this.shadow.radius=e.shadow.radius,this.shadow.mapSize.fromArray(e.shadow.mapSize);let t=this.shadow.camera,r=e.shadow.camera;return t.near=r.near,t.far=r.far,t.zoom=r.zoom,t.left=r.left,t.right=r.right,t.top=r.top,t.bottom=r.bottom,r.view!==void 0&&(t.view=Object.assign({},r.view)),this}fromDirectionalLightState(e,t){let r=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;return super.fromLightState(e,t),e.size!==void 0&&xY(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),r&&this.update(),this}fromState(e,t){return super.fromState(e),this.fromDirectionalLightState(e,t),this}},yD=class extends nf(Wu(Yz),mD){constructor(...e){super(...e),this.objectType="LightPoint",this._gizmos={},this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1;let t=this.shadow.camera;t.fov=90,t.aspect=1,t.near=100,t.far=2500;let r=new F(-t.far+this.position.x,-t.far+this.position.y,-t.far+this.position.z),i=new F(t.far+this.position.x,t.far+this.position.y,t.far+this.position.z),n=new gs(r,i),s=new np(n,new Ue(16755200));s.visible=!1,this._gizmos.shadowmap=s,this.update()}static createFromState(e,t,r){let i=new yD().fromState(t,r);return i.uuid=e,i}get gizmos(){return this._gizmos}showGizmos(){for(let e in this._gizmos){let t=this._gizmos[e];t instanceof np&&(t.visible=!0)}}hideGizmos(){for(let e in this._gizmos){let t=this._gizmos[e];t instanceof np&&(t.visible=!1)}}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this._gizmos))for(let e in this._gizmos){let t=this._gizmos[e];if(t instanceof np){let r=this.shadow.camera,i=new F(-r.far+this.position.x,-r.far+this.position.y,-r.far+this.position.z),n=new F(r.far+this.position.x,r.far+this.position.y,r.far+this.position.z);t.box.set(i,n),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.enableHelper===!0&&this.objectHelper.visible===!0&&this.objectHelper.update()}copy(e,t=!0){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){let t=super.toJSON(e),r=t.object;return r.objectType="LightPoint",r.color=this.color.getHex(),r.intensity=this.intensity,r.distance=this.distance,r.decay=this.decay,r.shadow=this.shadow.toJSON(),t}fromJSON(e){var i,n;super.fromJSON(e),this.color.set(e.color),this.intensity=e.intensity,this.distance=e.distance,this.decay=e.decay,this.shadow.normalBias=(i=e.shadow.normalBias)!=null?i:0,this.shadow.radius=e.shadow.radius,this.shadow.mapSize.fromArray((n=e.shadow.mapSize)!=null?n:[512,512]),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null);let t=this.shadow.camera,r=e.shadow.camera;return t.near=r.near,t.far=r.far,t.zoom=r.zoom,t.fov=r.fov,t.focus=r.focus,t.aspect=r.aspect,t.filmGauge=r.filmGauge,t.filmOffset=r.filmOffset,r.view!==void 0&&(t.view=Object.assign({},r.view)),this}fromPointLightState(e,t){return super.fromLightState(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),this}fromState(e,t){return super.fromState(e),this.fromPointLightState(e,t),this}},LA=new F,RA=new F,OA=new yn,xD=class extends nf(Wu(Wz),gD){constructor(...e){super(...e),this.objectType="LightSpot",this._gizmos={},this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1;let t=this.shadow.camera;t.fov=kt.RAD2DEG*2*this.angle,t.aspect=1,t.near=100,t.far=2500;let r=new No(this.shadow.camera);r.visible=!1,this._gizmos.shadowmap=r,this.update()}static createFromState(e,t,r){let i=new xD().fromState(t,r);return i.uuid=e,i}get gizmos(){return this._gizmos}showGizmos(){for(let e in this._gizmos){let t=this._gizmos[e];t instanceof No&&(t.visible=!0)}}hideGizmos(){for(let e in this._gizmos){let t=this._gizmos[e];t instanceof No&&(t.visible=!1)}}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this._gizmos){let t=this._gizmos[e];t instanceof No&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),RA.setFromMatrixPosition(this.matrixWorld),OA.setFromRotationMatrix(this.matrixWorld),LA.copy(this.up).applyQuaternion(OA).negate().multiplyScalar(this.distance),this.target.position.copy(RA).add(LA),this.target.updateMatrixWorld(),this.enableHelper===!0&&this.objectHelper.visible===!0&&this.objectHelper.update()}copy(e,t=!0){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){let t=super.toJSON(e),r=t.object;return r.objectType="LightSpot",r.color=this.color.getHex(),r.intensity=this.intensity,r.distance=this.distance,r.angle=this.angle,r.decay=this.decay,r.penumbra=this.penumbra,r.shadow=this.shadow.toJSON(),t}fromJSON(e){var i;super.fromJSON(e),this.color.set(e.color),this.intensity=e.intensity,this.distance=e.distance,this.angle=e.angle,this.decay=e.decay,this.penumbra=e.penumbra,this.shadow.normalBias=(i=e.shadow.normalBias)!=null?i:0,this.shadow.radius=e.shadow.radius,this.shadow.mapSize.fromArray(e.shadow.mapSize);let t=this.shadow.camera,r=e.shadow.camera;return t.near=r.near,t.far=r.far,t.zoom=r.zoom,t.fov=r.fov,t.focus=r.focus,t.aspect=r.aspect,t.filmGauge=r.filmGauge,t.filmOffset=r.filmOffset,r.view!==void 0&&(t.view=Object.assign({},r.view)),this}fromSpotLightState(e,t){return super.fromLightState(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),this}fromState(e,t){return super.fromState(e),this.fromSpotLightState(e,t),this}},IA=e=>e.tagName==="VIDEO",hx=class{static resize(e,t,r){let i=e/t,n;if(!r.image)return;let s=r.image;IA(s)?n=s.videoWidth/s.videoHeight:n=s.width/s.height,i>n&&(r.imageType=="WEBCAM"?r.repeat.set(-1,1*n/i):r.repeat.set(1,1*n/i)),i<n&&(r.imageType=="WEBCAM"?r.repeat.set(1*i/n*-1,1):r.repeat.set(1*i/n,1)),i==n&&(r.imageType=="WEBCAM"?r.repeat.set(-1,1):r.repeat.set(1,1))}static resizeTextureLayer(e,t,r){let i=e/t,n=r.image!==void 0?r.image.width/r.image.height:1,s;i>n?s={x:1,y:n/i}:i<n?s={x:i/n,y:1}:s={x:1,y:1},r.repeat.set(s.x,s.y),r.updateMatrix()}static resizeTextureLayers(e,t,r){let i=r.userData.layers,n=i.getLayers();for(let s=0;s<n.length;s++){let a=n[s];zq(a)&&(hx.resizeTextureLayer(e,t,a.uniforms[`f${a.id}_texture`].value),i.updateLayerUniform())}}static resizeComplex(e,t,r,i){let n=e/t,s,a=r.image;IA(a)?s=a.videoWidth/a.videoHeight:s=a.width/a.height,i.geometry.type.includes("Shape")?(n>s&&(r.imageType=="WEBCAM"?r.repeat.set(1/e*-1,1/t*s/n):r.repeat.set(1/e,1/t*s/n)),n<s&&(r.imageType=="WEBCAM"?r.repeat.set(1/e*n/s*-1,1/t):r.repeat.set(1/e*n/s,1/t)),n==s&&(r.imageType=="WEBCAM"?r.repeat.set(1/e*-1,1/t):r.repeat.set(1/e,1/t))):(n>s&&(r.imageType=="WEBCAM"?r.repeat.set(-1,1*s/n):r.repeat.set(1,1*s/n)),n<s&&(r.imageType=="WEBCAM"?r.repeat.set(1*n/s*-1,1):r.repeat.set(1*n/s,1)),n==s&&(r.imageType=="WEBCAM"?r.repeat.set(-1,1):r.repeat.set(1,1)))}},wD=class extends Bi{constructor(e,t=new Za){super(e,t),this.objectType="Mesh2D",this.castShadow=!0,this.receiveShadow=!0}updateGeometry(e){super.updateGeometry(e),this.material.userData.layers&&hx.resizeTextureLayers(this.geometry.userData.parameters.width,this.geometry.userData.parameters.height,this.material)}resizeGeometry(e,t){super.resizeGeometry(e,t,0),this.material.userData.layers&&hx.resizeTextureLayers(this.geometry.userData.parameters.width,this.geometry.userData.parameters.height,this.material)}toJSON(e){let t=super.toJSON(e);return t.object.objectType="Mesh2D",t}clone(){let e=super.clone();return e.updateGeometry({}),e}static fromTexture(e){let t,r;if(e instanceof tz){let s=e.image;t=s.videoWidth*.5,r=s.videoHeight*.5}else{let s=e.image;t=s.width*.5,r=s.height*.5}let i=A6.create({parameters:{width:t,height:r}}),n=new Za;return n.layersList.changeLayer(0,{type:"texture",texture:e}),n.layersList.moveLayer(0,1),n.dispose(),new wD(i,n)}},bD=class extends Bi{constructor(e,t=new Wl){super(e,t),this.objectType="Mesh3D",this.castShadow=!0,this.receiveShadow=!0}toJSON(e){let t=super.toJSON(e);return t.object.objectType="Mesh3D",t}},_D=class extends bD{constructor(e,t=new Wl){super(e,t),this.objectType="NonParametric"}toJSON(e){let t=super.toJSON(e);return t.object.objectType="NonParametric",t}},zY=class extends Dm{constructor(e){super(e)}load(e,t,r,i){let n=this,s=new P0(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(n.withCredentials),s.load(e,function(a){let o;try{o=JSON.parse(a)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),o=JSON.parse(a.substring(65,a.length-2))}let l=n.parse(o);t&&t(l)},r,i)}parse(e){return new FY(e)}},FY=class{constructor(e){this.isFont=!0,this.type="Font",this.data=e}generateShapes(e,t=100){let r=[],i=UY(e,t,this.data);for(let n=0,s=i.length;n<s;n++)Array.prototype.push.apply(r,i[n].toShapes());return r}};function UY(e,t,r){let i=Array.from(e),n=t/r.resolution,s=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*n,a=[],o=0,l=0;for(let h=0;h<i.length;h++){let u=i[h];if(u===`
`)o=0,l-=s;else{let c=HY(u,n,o,l,r);o+=c.offsetX,a.push(c.path)}}return a}function HY(e,t,r,i,n){let s=n.glyphs[e]||n.glyphs["?"];if(!s){console.error('THREE.Font: character "'+e+'" does not exists in font family '+n.familyName+".");return}let a=new sF,o,l,h,u,c,d,f,p;if(s.o){let m=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let g=0,v=m.length;g<v;)switch(m[g++]){case"m":o=m[g++]*t+r,l=m[g++]*t+i,a.moveTo(o,l);break;case"l":o=m[g++]*t+r,l=m[g++]*t+i,a.lineTo(o,l);break;case"q":h=m[g++]*t+r,u=m[g++]*t+i,c=m[g++]*t+r,d=m[g++]*t+i,a.quadraticCurveTo(c,d,h,u);break;case"b":h=m[g++]*t+r,u=m[g++]*t+i,c=m[g++]*t+r,d=m[g++]*t+i,f=m[g++]*t+r,p=m[g++]*t+i,a.bezierCurveTo(c,d,f,p,h,u);break}}return{offsetX:s.ha*t,path:a}}var Er=class extends Ji{constructor({char:e,originalChar:t,fontFamily:r,letterSpacing:i,fontSize:n,LOD:s=16},a=new Gl({color:0,opacity:1,visible:!0,transparent:!0,side:ti})){let o=Er.loadChar(e,r,s);super(o.geometry,a),this.char=e,this.originalChar=t!=null?t:e,this.fontFamily=r,this.letterSpacing=i,this.fontSize=n,this.LOD=s,this.resolution=o.resolution,this.glyphsHa=o.glyphsHa,this.localPosition=new $,this.charSize=0,this.geometry.userData={type:"CharacterGeometry",parameters:{char:this.char,fontFamily:this.fontFamily,letterSpacing:this.letterSpacing,fontSize:this.fontSize,lod:this.LOD,resolution:this.resolution,charSize:this.charSize,localPosition:this.localPosition}},this.updateFontSize(this.fontSize)}static get FONTS_PATH(){return Er._fontPath}static set FONTS_PATH(e){Er._fontPath=e}updatePosition(e,t){this.localPosition.copy(e);let r=new F(this.localPosition.x,-this.localPosition.y,0);this.position.copy(r).add(t)}updateFontSize(e){let t=e/this.resolution;this.fontSize=e,this.scale.set(this.fontSize,this.fontSize,1),this.charSize=this.glyphsHa*t*this.letterSpacing}updateFontFamily(e){if(this.fontFamily===e)return;this.fontFamily=e;let t=Er.loadChar(this.char,e,this.LOD);this.geometry=t.geometry,this.resolution=t.resolution,this.glyphsHa=t.glyphsHa,this.geometry.userData={type:"CharacterGeometry",parameters:{char:this.char,fontFamily:this.fontFamily,letterSpacing:this.letterSpacing,fontSize:this.fontSize,lod:this.LOD,resolution:this.resolution,charSize:this.charSize,localPosition:this.localPosition}},this.updateFontSize(this.fontSize)}updateChar(e){if(this.char===e)return;this.char=e;let t=Er.loadChar(e,this.fontFamily,this.LOD);this.geometry=t.geometry,this.resolution=t.resolution,this.glyphsHa=t.glyphsHa,this.geometry.userData={type:"CharacterGeometry",parameters:{char:this.char,fontFamily:this.fontFamily,letterSpacing:this.letterSpacing,fontSize:this.fontSize,lod:this.LOD,resolution:this.resolution,charSize:this.charSize,localPosition:this.localPosition}},this.updateFontSize(this.fontSize)}updateLetterSpacing(e){this.letterSpacing!==e&&(this.letterSpacing=e,this.updateFontSize(this.fontSize))}updateLOD(e){if(this.LOD===e)return;this.LOD=e;let t=Er.loadChar(this.char,this.fontFamily,this.LOD);this.geometry=t.geometry,this.resolution=t.resolution,this.glyphsHa=t.glyphsHa,this.geometry.userData={type:"CharacterGeometry",parameters:{char:this.char,fontFamily:this.fontFamily,letterSpacing:this.letterSpacing,fontSize:this.fontSize,lod:this.LOD,resolution:this.resolution,charSize:this.charSize,localPosition:this.localPosition}},this.updateFontSize(this.fontSize)}clone(){let e={char:this.char,originalChar:this.originalChar,fontFamily:this.fontFamily,letterSpacing:this.letterSpacing,fontSize:this.fontSize,LOD:this.LOD};return new Er(e).copy(this)}static loadFont(e){return new Promise(function(t,r){Er.fontCache[e]?t(Er.fontCache[e]):new zY().load(Er.FONTS_PATH+e+".json",i=>{Er.fontCache[e]=i,t(i)},void 0,r)})}static loadChar(e,t,r){if(Er.charCache[e]){if(Er.charCache[e][r]&&Er.charCache[e][r].fontFamily===t)return Er.charCache[e][r]}else Er.charCache[e]={};let i=Er.fontCache[t],n=i.generateShapes(e,1);return Er.charCache[e][r]={geometry:new WT(n,r),fontFamily:t,resolution:i.data.resolution,glyphsHa:i.data.glyphs[e].ha},Er.charCache[e][r]}},Pn=Er;Pn.charCache={},Pn.fontCache={},Pn._fontPath="/_assets/_fonts/";var yp=new $,jp=class{constructor(e,t,r){this.message=[],this.endLine=!0,this.yLinePos=e,this.lineHeight=t,this.maxCharSize=r,this.nextChar3DPos=new $(0,this.yLinePos+this.maxCharSize*this.lineHeight),this.align=1}addChar3D(e,t,r=this.message.length){this.message.splice(r,0,e),e.fontSize>this.maxCharSize?(this.maxCharSize=e.fontSize,this.nextChar3DPos.y=this.yLinePos+this.maxCharSize*this.lineHeight,this.fullUpdate(t)):(e.updatePosition(this.nextChar3DPos,t),this.nextChar3DPos.x+=e.charSize)}deleteChar3D(e=this.message.length-1){let t=this.message[e];if(t)return this.message.splice(e,1),this.nextChar3DPos.x-=t.charSize,t}isEndLine(e){this.endLine=e}fullUpdate(e,t=0){this.nextChar3DPos.x=0;for(let r=t,i=this.message.length;r<i;r+=1)this.message[r].updatePosition(this.nextChar3DPos,e),this.nextChar3DPos.x+=this.message[r].charSize}checkOverFlow(e){let t,r=this.message.length-1;if(r<=0)return!1;for(;r>=0;){if(this.message[r].char!==" "){t=this.message[r];break}r-=1}return!!(r>=0&&t&&t.localPosition.x+t.charSize>e)}containSpaceOverFlow(e=this.message.length-1){for(let t=e;t>=0;t-=1)if(this.message[t].char===" ")return!0;return!1}containSpace(e=this.message.length-1){if(this.endLine)return!0;for(let t=e;t>=0;t-=1)if(this.message[t].char===" ")return!0;return!1}popWord(e=this.message.length-1){let t=[],r=!0,i;for(i=e;i>=0;i-=1)if(this.message[i].char===" "){r=!1,t.length===0&&(i-=1,t.splice(0,0,this.message[i]));break}else t.splice(0,0,this.message[i]);return r?t=[]:this.message.splice(i+1,t.length),t}getWord(e=0,t=1){let r=[],i=e;for(i=e;;i+=t){if(!this.message[i]||this.message[i].char===" "){r.length===0&&this.message[i]&&(r.push(this.message[i]),this.message.splice(i,1));break}t>0?(r.push(this.message[i]),this.message.splice(i,1),i-=t):(r.splice(0,0,this.message[i]),this.message.splice(i,1))}return r}getWordAtIndex(e){let t=[];for(let r=e;r<this.message.length&&this.message[r].char!==" ";r++)t.push(this.message[r]);for(let r=e-1;r>=0&&this.message[r].char!==" ";r--)t.splice(0,0,this.message[r]);return t}wordSize(e=0,t=-1){let r=0,i=e;for(;i>=0&&i<this.message.length;){if(this.message[i].char===" "){r===0&&(r=this.message[i].charSize);break}r+=this.message[i].charSize,i+=t}return(i<0||i>=this.message.length)&&!this.endLine?this.message[e]?this.message[e].charSize:999999999:r===0?999999999:r}spaceLeft(e){return e-this.nextChar3DPos.x}popChar(e=this.message.length-1){return this.nextChar3DPos.x-=this.message[e].charSize,this.message.splice(e,1)}isEmpty(){return!this.message.length}updateNextCharPosY(){this.nextChar3DPos.y=this.yLinePos+this.maxCharSize*this.lineHeight}updateYLinePos(e){this.yLinePos=e,this.updateNextCharPosY()}updatelineHeight(e){this.lineHeight=e,this.updateNextCharPosY()}updateFontSize(e,t=0,r=this.message.length-1){for(let i=t;i<=r;i+=1)this.message[i].updateFontSize(e);this.maxCharSize=e,this.nextChar3DPos.y=this.yLinePos+this.maxCharSize*this.lineHeight}countSpaces(){let e=0;for(let t=0;t<this.message.length;t++)this.message[t].char===" "&&(e+=1);return e}alignText(e,t,r,i,n){switch(r){case 1:this.leftAlign(e,n);break;case 3:this.centerAlign(this.spaceLeft(t),e,n);break;case 2:this.rightAlign(this.spaceLeft(t),e,n);break;case 4:this.justifyAlign(this.spaceLeft(t),e,n);break}}offsetCharacters(e,t,r){yp.set(t,r);let i=this.message.length;for(let n=0;n<i;n++)this.message[n].updatePosition(this.message[n].localPosition.add(yp),e)}leftAlign(e,t){this.align=1,this.offsetCharacters(e,0,t)}centerAlign(e,t,r){this.align=3,this.offsetCharacters(t,e/2,r)}rightAlign(e,t,r){this.align=2,this.offsetCharacters(t,e,r)}justifyAlign(e,t,r){if(this.align=4,this.endLine){this.offsetCharacters(t,0,r);return}let i=this.countSpaces();if(i===0){this.offsetCharacters(t,0,r);return}let n=e/i,s=0;for(let a=0;a<this.message.length;a++)this.message[a].char===" "&&(s+=n),yp.set(s,r),this.message[a].updatePosition(this.message[a].localPosition.add(yp),t)}clone(){let e=new jp(this.yLinePos,this.lineHeight,this.maxCharSize);e.nextChar3DPos=this.nextChar3DPos.clone(),e.align=this.align,e.endLine=this.endLine;for(let t=0;t<this.message.length;t++)e.message.push(this.message[t].clone());return e}},SD=class extends Bi{constructor(e,t=new Za({transparent:!0,opacity:1,visible:!1,side:ti})){super(e,t),this.objectType="TextFrame",this.charContainer=new er,this.add(this.charContainer),this.material.visible=!1,this._geometryUserData=e.userData,this.userData.textFrame={hexColor:null,opacity:1,visible:!0,text:"",fontSize:16,lineHeight:1.5,letterSpacing:1,fontFamily:"roboto_regular",textTransform:1,horizontalAlignment:1,verticalAlignment:1,LOD:16,maxLineSize:this._geometryUserData.parameters.width,textOrigin:new F(this._geometryUserData.parameters.width*-.5,this._geometryUserData.parameters.height*.5,0),textLines:[]},this.createTextLine()}static createFromState(e,t,r){let i=E6.create({parameters:{width:t.width,height:t.height}}),n=new SD(i).fromState(t,r);return n.uuid=e,n}async updateText(e){this.clearText();let t=this.userData.textFrame,r=t.fontFamily;await Pn.loadFont(r),t.text=e;let i=t.textOrigin,n=new Gl({visible:t.visible,transparent:!0,side:ti}),s=e.split(`
`),a=0;this.userData.textFrame.textLines=s.map((o,l)=>{let h=new jp(a,t.lineHeight,t.fontSize);return h.message=o.split("").map(u=>{let c={char:u,fontFamily:r,letterSpacing:t.letterSpacing,fontSize:t.fontSize,LOD:16},d=n.clone();d.color=t.hexColor,d.opacity=t.opacity;let f=new Pn(c,d);return h.addChar3D(f,i),this.charContainer.add(f),f}),a+=h.maxCharSize*h.lineHeight,h}),this.textFullUpdate(),this.checkOverFlow()}clearText(){let e=this.userData.textFrame.textLines;for(;this.charContainer.children.length;){let t=this.charContainer.children[0];this.charContainer.remove(t)}for(;e.length;)e.pop()}raycast(e,t){let r=[];if(super.raycast(e,r),r.length>0){t.push(r[0]);return}let i=[];for(let n=0,s=this.charContainer.children.length;n<s;++n)if(this.charContainer.children[n]instanceof Pn&&(e.intersectObject(this.charContainer.children[n],!1,i),i.length>0)){i[0].object=this,t.push(i[0]);return}}updateGeometry(e){var l,h,u,c;let t=this.userData,r=this.geometry.userData,i=r.parameters.width,n=r.parameters.height,s=(h=(l=e.parameters)==null?void 0:l.width)!=null?h:i,a=(c=(u=e.parameters)==null?void 0:u.height)!=null?c:n,o=t.textFrame;super.updateGeometry(e),o.maxLineSize=s,o.textOrigin.set(-.5*s,.5*a,0),a!==n?(this.checkOverFlow(),this.checkCapacity()):s!==i&&(i<s?this.checkCapacity():i>s&&this.checkOverFlow())}checkOverFlow(e=0){let t=this.userData,r=t.textFrame.textOrigin,i=t.textFrame.textLines;for(let n=e;n<i.length;n++){i[n].updateYLinePos(this.getNewLinePosition(n)),i[n].fullUpdate(r);let s=[];for(;i[n].checkOverFlow(t.textFrame.maxLineSize);)i[n].containSpaceOverFlow()?s.unshift(i[n].getWord(i[n].message.length-1,-1)):s.unshift(i[n].popChar());if(s.length>0){i[n+1]===void 0?(i[n].isEndLine(!1),this.createTextLine()):i[n].endLine&&(this.createTextLine(n+1),i[n].isEndLine(!1),i[n+1].isEndLine(!0));let a=0;for(let o=0;o<s.length;o+=1)for(let l=0;l<s[o].length;l+=1)i[n+1].addChar3D(s[o][l],r,a),a+=1;i[n+1].fullUpdate(r)}i[n].fullUpdate(r)}this.textFullUpdate(e)}checkCapacity(e=0){let t=this.userData,r=t.textFrame.textOrigin,i=t.textFrame.maxLineSize,n=t.textFrame.textLines;for(let s=e;s<n.length;s+=1)if(n[s].updateYLinePos(this.getNewLinePosition(s)),n[s].fullUpdate(r),!!n[s-1])for(;!n[s-1].endLine;){let a,o=n[s-1].spaceLeft(i);if(n[s].wordSize(0,1)<=o){n[s].containSpace()?a=n[s].getWord(0,1):a=n[s].popChar(0);for(let l=0;l<a.length;l+=1)a[l]&&n[s-1].addChar3D(a[l],r)}else{n[s].isEmpty()?(n[s].endLine&&n[s-1].isEndLine(!0),n.splice(s,1),s-=1):(n[s].updateYLinePos(this.getNewLinePosition(s)),n[s].fullUpdate(r));break}}this.textFullUpdate(e)}createTextLine(e=this.userData.textFrame.textLines.length){let t=this.userData.textFrame;t.textLines.splice(e,0,new jp(this.getNewLinePosition(e),t.lineHeight,t.fontSize))}textFullUpdate(e=0){let t=this.userData.textFrame,r=t.textLines,i=this.getVerticalAlignmentOffSet();for(let n=e;n<r.length;n++)r[n].updateYLinePos(this.getNewLinePosition(n)),r[n].fullUpdate(t.textOrigin),r[n].alignText(t.textOrigin,t.maxLineSize,t.horizontalAlignment,t.verticalAlignment,i)}getVerticalAlignmentOffSet(){switch(this.userData.textFrame.verticalAlignment){case 1:return 0;case 2:return this.getRemainingVerticalSpace()/2;case 3:return this.getRemainingVerticalSpace();default:return 0}}getRemainingVerticalSpace(){let e=this.userData.textFrame.textLines;return this.geometry.userData.parameters.height-this.getNewLinePosition(e.length)}getNewLinePosition(e){let t=this.userData.textFrame.textLines,r=0;for(let i=0;i<e;i+=1)r+=t[i].maxCharSize*t[i].lineHeight;return r}updateColor(e){var i;let t=this.userData;t.textFrame.hexColor=e;let r=t.textFrame.textLines;for(let n=0;n<r.length;n++){let s=r[n].message;for(let a=0;a<s.length;a++){let o=s[a].material;(i=o.color)!=null&&i.isColor&&(o.color=e)}}}updateOpacity(e){let t=this.userData;t.textFrame.opacity=e;let r=t.textFrame.textLines;for(let i=0;i<r.length;i++){let n=r[i].message;for(let s=0;s<n.length;s++){let a=n[s].material;a.opacity=e}}}updateVisible(e){let t=this.userData;t.textFrame.visible=e;let r=t.textFrame.textLines;for(let i=0;i<r.length;i++){let n=r[i].message;for(let s=0;s<n.length;s++){let a=n[s].material;a.visible=e}}}async updateFontFamily(e){await Pn.loadFont(e);let t=this.userData.textFrame,r=t.textLines;t.fontFamily=e;for(let i=0;i<r.length;i++){let n=r[i].message;for(let s=0;s<n.length;s++)n[s].updateFontFamily(e)}this.textFullUpdate(),this.checkOverFlow(),this.checkCapacity()}updateFontSize(e){let t=this.userData.textFrame,r=t.textLines,i=t.fontSize;t.fontSize=e;for(let n=0;n<r.length;n++)r[n].updateFontSize(e);this.textFullUpdate(),e>i?this.checkOverFlow():e<i&&this.checkCapacity()}async updateTextTransform(e){let t=this.userData.textFrame;await Pn.loadFont(t.fontFamily);let r=t.textLines;switch(t.textTransform=e,e){case 2:for(let i=0;i<r.length;i++){let n=r[i].message;for(let s=0;s<n.length;s++)r[i].message[s].updateChar(n[s].char.toUpperCase())}break;case 3:for(let i=0;i<r.length;i++){let n=r[i].message;for(let s=0;s<n.length;s++)r[i].message[s].updateChar(n[s].char.toLowerCase())}break;default:for(let i=0;i<r.length;i++){let n=r[i].message;for(let s=0;s<n.length;s++)r[i].message[s].updateChar(n[s].originalChar)}}this.textFullUpdate(),this.checkOverFlow(),this.checkCapacity()}updateLetterSpacing(e){let t=this.userData,r=t.textFrame.textLines;t.textFrame.letterSpacing=e;for(let i=0;i<r.length;i++){let n=r[i].message;for(let s=0;s<n.length;s++)n[s].updateLetterSpacing(e)}this.textFullUpdate(),this.checkOverFlow(),this.checkCapacity()}updateLOD(e){let t=this.userData;t.textFrame.LOD=e;let r=t.textFrame.textLines;for(let i=0;i<r.length;i++);this.textFullUpdate(),this.checkOverFlow(),this.checkCapacity()}updateLineHeight(e){let t=this.userData,r=t.textFrame.textLines;t.textFrame.lineHeight=e;for(let i=0;i<r.length;i++)r[i].updatelineHeight(e);this.textFullUpdate()}updateVerticalAlignment(e){let t=this.userData;t.textFrame.verticalAlignment=e,this.textFullUpdate()}updateHorizontalAlignment(e){let t=this.userData;t.textFrame.horizontalAlignment=e,this.textFullUpdate()}toJSON(e){let t=super.toJSON(e),r=t.object;r.objectType="TextFrame";let i=this.userData.textFrame.textLines.map(n=>{let s=n.message.map(a=>({char:a.char,originalChar:a.originalChar,fontFamily:a.fontFamily,letterSpacing:a.letterSpacing,fontSize:a.fontSize,LOD:a.LOD}));return{align:n.align,endLine:n.endLine,lineHeight:n.lineHeight,maxCharSize:n.maxCharSize,yLinePos:n.yLinePos,message:s}});return r.userData.textFrame.textLinesData=i,t}async fromJSONasync(e){if(super.fromJSON(e),e.userData!==void 0){let t=e.userData.textFrame;await Pn.loadFont(t.fontFamily),t.textOrigin=new F(t.textOrigin.x,t.textOrigin.y,t.textOrigin.z);let r=new Gl({color:t.hexColor,opacity:t.opacity,visible:t.visible,transparent:!0,side:ti});t.textLinesData&&(t.textLines=t.textLinesData.map((i,n)=>{let s=new jp(Number(i.yLinePos),Number(i.lineHeight),Number(i.maxCharSize)),a=i.message.map((o,l)=>{if(o.char===void 0){let c=t.textLines[n].message[l];if("geometries"in c){let d=c.geometries[0].userData.parameters;Object.assign(o,{LOD:d.lod,char:d.char,fontFamily:d.fontFamily,fontSize:d.fontSize,letterSpacing:d.letterSpacing,originalChar:d.char})}}let h={char:o.char,fontFamily:o.fontFamily,letterSpacing:Number(o.letterSpacing),fontSize:Number(o.fontSize),LOD:o.LOD},u=new Pn(h,r.clone());return s.addChar3D(u,t.textOrigin),this.charContainer.add(u),u});return s.message=a,s}),this.userData.textFrame=t),this.textFullUpdate()}return this}fromTextFrameData(e,t){if(e.color!==void 0){let r=Li(e.color,t);this.updateColor(r),this.updateOpacity(r.a)}e.alpha!==void 0&&this.updateOpacity(e.alpha),e.font!==void 0&&this.updateFontFamily(e.font),e.horizontalAlign!==void 0&&this.updateHorizontalAlignment(e.horizontalAlign),e.verticalAlign!==void 0&&this.updateVerticalAlignment(e.verticalAlign),e.textTransform!==void 0&&this.updateTextTransform(e.textTransform),e.fontSize!==void 0&&this.updateFontSize(e.fontSize),e.lineHeight!==void 0&&this.updateLineHeight(e.lineHeight),e.letterSpacing!==void 0&&this.updateLetterSpacing(e.letterSpacing),e.text!==void 0&&e.text!==""&&this.updateText(e.text),(e.width!==void 0||e.height!==void 0)&&this.updateGeometry({parameters:{width:e.width,height:e.height}})}fromState(e,t){return super.fromState(e),this.fromTextFrameData(e,t),this}convertToVector(){let{fontFamily:e,hexColor:t}=this.userData.textFrame,r=new j0;r.name="Text Shape";let i=Pn.fontCache[e];for(let n of this.charContainer.children)n instanceof Pn&&i.generateShapes(n.char,1).forEach(s=>{let a=new yr().fromShape(s);a.applyScale(n.scale.x,n.scale.y);let o=Ka.create({shape:a}),l=new Za({side:ti});l.color=t;let h=new _b(o,l);h.name=n.char,h.position.copy(n.position),h.rotation.copy(n.rotation),r.attach(h)});return r}},Wp=SD;Wp.VerticalAlign=h6,Wp.HorizontalAlign=l6,Wp.TextTransform=u6;var GY=YR(XR()),ux;T6.then(e=>{ux=e});var MD=new wt,VY=new wt,jY=new wt,Kn=new gs,xo=new F,WY=new wt,qY=new wt,Sb=class extends Bi{constructor(e,t,r,i=new Wl){super(r!=null?r:t,i),this.subdivPointer=e,this.originalGeometry=t,this.subdividedGeometry=r,this.objectType="SubdivObject",this.hiddenMatrixOld=new wt,this.smoothShading=!0,this.phongAngle=35,this.matrixWorldRigid=new wt,this.castShadow=!0,this.receiveShadow=!0,this.forceComputeSize=!1}static createFromState(e,t,r){let{subdivPointer:i,originalGeometry:n,subdividedGeometry:s}=as.build(t.geometry,void 0,void 0,!t.flatShading),a=bb(t.material,r),o=new Sb(i,n,s||void 0,a);return t.geometry.phongAngle!==void 0&&(o.phongAngle=t.geometry.phongAngle),o.calcBoundingBox(),o.freeSubdivPointer(),o.uuid=e,o.fromState(t),o}shallowClone(e){return new _D(this.geometry,this.material).shallowCopy(this,e)}toJSON(e){let t=super.toJSON(e);return t.object.objectType="SubdivObject",t}buildFromStore(e,t){var s,a,o;let{originalGeometry:r,subdividedGeometry:i,subdivPointer:n}=as.build(e,t,this.subdivPointer,this.smoothShading,this.shearScale);if(e.phongAngle!==void 0&&(this.phongAngle=e.phongAngle),this.subdivPointer=n,r!==void 0&&((s=this.originalGeometry)==null||s.dispose(),this.originalGeometry=r),i!==void 0&&((a=this.subdividedGeometry)==null||a.dispose(),this.subdividedGeometry=i!=null?i:void 0),this.geometry=(o=this.subdividedGeometry)!=null?o:this.originalGeometry,this.cloner)for(let l of this.cloner.children)l.geometry=this.geometry;e.width&&(this.geometry.userData.parameters={width:e.width,height:e.height,depth:e.depth})}updateMesh(e=!1){as.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e?this.shearScaleInv:void 0),this.subdividedGeometry&&as.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e?this.shearScaleInv:void 0)}updateTopology(){var e;this.originalGeometry.dispose(),this.originalGeometry=as.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=as.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.geometry=(e=this.subdividedGeometry)!=null?e:this.originalGeometry}raycast(e,t){var r;this.geometry=this.originalGeometry,Bi.prototype.raycast.call(this,e,t),this.geometry=(r=this.subdividedGeometry)!=null?r:this.originalGeometry}updateMatrixWorldSVD(){let e=this.matrixWorld.elements,t=[[e[0],e[4],e[8]],[e[1],e[5],e[9]],[e[2],e[6],e[10]]],{u:r,v:i,q:n}=(0,GY.SVD)(t),s=MD.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),a=VY.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),o=jY.copy(a).transpose();this.shearScale=WY.makeScale(n[0],n[1],n[2]).multiply(o).premultiply(a),this.shearScaleInv=qY.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(s,o),n.every(l=>Math.abs(n[0]-l)<.01)&&(this.shearScale=void 0,this.shearScaleInv=void 0)}activateSVDCompensation(){this.shearScale!==void 0&&(this.matrixAutoUpdate=!1,this.matrix.copy(this.matrixWorldRigid).copyPosition(this.matrixWorld),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){this.shearScale!==void 0&&(this.shearScale=void 0,this.shearScaleInv=void 0,this.matrixAutoUpdate=!0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new ha);let t=e.attributes.position,r=e.boundingSphere.center;Kn.setFromBufferAttribute(t),Kn.getCenter(r),e.boundingSphere.radius=r.distanceTo(Kn.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Kn.getSize(xo);let i={width:xo.x,height:xo.y,depth:xo.z};return this.geometry.userData.parameters=i,i}updateBoundingBox(e){let t=this.originalGeometry;Kn.min.set(e[0],e[2],e[4]),Kn.max.set(e[1],e[3],e[5]),this.shearScaleInv&&(Kn.min.applyMatrix4(this.shearScaleInv),Kn.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new ha);let r=t.boundingSphere.center;Kn.getCenter(r),t.boundingSphere.radius=r.distanceTo(Kn.max),isNaN(t.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Kn.getSize(xo);let i={width:xo.x,height:xo.y,depth:xo.z};return this.geometry.userData.parameters=i,i}freeSubdivPointer(){this.subdivPointer&&(ux.free_bvh(this.subdivPointer),ux.free_subdivision_surface(this.subdivPointer),this.subdivPointer=0)}updateGeometry(e){this.geometry.userData.scale||(this.geometry.userData.scale=Array(3)),this.geometry.userData.scale[0]=this.geometry.userData.parameters.width===0?1:e.parameters.width/this.geometry.userData.parameters.width,this.geometry.userData.scale[1]=this.geometry.userData.parameters.height===0?1:e.parameters.height/this.geometry.userData.parameters.height,this.geometry.userData.scale[2]=this.geometry.userData.parameters.depth===0?1:e.parameters.depth/this.geometry.userData.parameters.depth,NA(this.originalGeometry.attributes,...this.geometry.userData.scale),this.originalGeometry.attributes.position.needsUpdate=!0,this.originalGeometry.attributes.normal.needsUpdate=!0,this.subdividedGeometry&&(NA(this.subdividedGeometry.attributes,...this.subdividedGeometry.userData.scale),this.subdividedGeometry.attributes.position.needsUpdate=!0,this.subdividedGeometry.attributes.normal.needsUpdate=!0),this.geometry.userData.parameters=me({},e.parameters)}};function NA(e,t,r,i){let n=e.position.array,s=e.normal.array,a=MD.makeScale(t,r,i).invert().elements,o,l,h;for(var u=0,c=n.length;u<c;u+=3)n[u]*=t,n[u+1]*=r,n[u+2]*=i,o=s[u],l=s[u+1],h=s[u+2],s[u]=a[0]*o+a[4]*l+a[8]*h,s[u+1]=a[1]*o+a[5]*l+a[9]*h,s[u+2]=a[2]*o+a[6]*l+a[10]*h}function BA(e,t){t.flatShading!==void 0&&(e.flatShading=t.flatShading,e.needsUpdate=!0),t.wireframe!==void 0&&(e.wireframe=t.wireframe),t.side!==void 0&&(t.side===0?e.side=Zo:t.side===1?e.side=yi:e.side=ti)}function YY(e,t){if(Array.isArray(e.material))for(let r of e.material)BA(r,t);else{let r=e.material;BA(r,t)}e.objectType==="SubdivObject"&&t.flatShading!==void 0&&(e.material.flatShading=!1,e.smoothShading=!t.flatShading,e.updateMesh())}function XY(e,t,r){let i;if(t.geometry.type==="SubdivGeometry")i=Sb.createFromState(e,t,r);else{let n=t.geometry.type==="BooleanGeometry"?new vt:aD(t.geometry),s="materials"in t?aY(t.materials,r):bb(t.material,r);Jy.is2DParametricMesh(n.userData.type)?i=new wD(n,s):(n==null?void 0:n.userData.type)==="VectorGeometry"?i=new _b(n,s):t.geometry.type==="NonParametricGeometry"?i=new _D(n,s):t.geometry.type==="BooleanGeometry"?(i=new NY(void 0,s),i.booleanOp=t.geometry.operation,t.geometry.phongAngle!==void 0&&(i.phongAngle=t.geometry.phongAngle)):i=new bD(n,s),i.uuid=e,i.fromState(t)}return YY(i,t),i}function QY(e,t,r){return t.type==="Mesh"?XY(e,t,r):t.type==="TextFrame"?Wp.createFromState(e,t,r):t.type==="Empty"?j0.createFromState(e,t):t.type==="PointLight"?yD.createFromState(e,t,r):t.type==="SpotLight"?xD.createFromState(e,t,r):t.type==="DirectionalLight"?vD.createFromState(e,t,r):Rd.is(t.type)?Mu.createFromState(e,t):(console.error(t),new j0)}function JY(e,t){t.uniforms[`f${t.id}_transmissionSamplerMap`].value=e.texture,t.uniforms[`f${t.id}_transmissionDepthMap`].value=e.depthTexture}function kA(e,t,r){if(!r.userData.layers)return!1;let i=!1,n=r.userData.layers.getLayersOfType("transmission");return n.length>0?(t.layers.set(3),i=!0,e!==void 0&&n.forEach(s=>JY(e,s))):t.layers.set(0),i}function KY(e,t){let r=!1;return t.traverseEntity(i=>{if(i instanceof Bi)if(Array.isArray(i.material))for(let n=0;n<i.material.length;n++)kA(e,i,i.material[n])&&(r=!0);else kA(e,i,i.material)&&(r=!0)}),r}function ZY(e,t){"material"in e&&$Y(e.material,t),"geometry"in e&&e.geometry.dispose()}function $Y(e,t){Hj(e).forEach(r=>{t.isSharedMaterial(r)||r.dispose()})}var zA=new F,AD=class extends sD(su){constructor(e,t){super(),this.objectType="Scene",this.alpha=1,this.backupFog=new BT(16777215,.1,2e3),this.fogUseBGColor=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this._needsTransmission=!1,this._color=new Ue(1,0,0),this.bgColor=new Ue(1,1,1),this.entityByUuid={},this.ambientLight=new wy(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.personalCamera=this.createPersonalCamera(),this.activeCamera=this.personalCamera,this.sharedAssetManager=t,this.init(e,t)}needsTransmission(e){return this.needsTransmissionDirty&&(this._needsTransmission=KY(e,this),e!==void 0&&(this.needsTransmissionDirty=!1)),this._needsTransmission}find(e){if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}get color(){return this._color}set color(e){this.fogUseBGColor===!0&&this.backupFog.color.copy(e),this._color.copy(e)}get enableFog(){return this.fog!==null}set enableFog(e){this.fog=e===!0?this.backupFog:null}init(e,t){if(this.createChildrenObjects(e.objects,this,t),this.personalCamera.removeFromParent(),this.add(this.personalCamera),this.ambientLight.removeFromParent(),this.add(this.ambientLight),this.setBackgroundColor(Li(e.backgroundColor,t)),this.updateFog(e.fog,t),this.updateAmbientLight(e.environment.ambientLight,t),this.activeCamera=this.personalCamera,e.publish.playCamera!==null){let r=this.find(e.publish.playCamera);r instanceof Mu&&this.switchActiveCamera(r)}this.traverse(r=>{Mr(r)&&r.recomputeBoolean()})}clearScene(e){this.traverseEntity(t=>{ZY(t,e)});for(let t of this.children)ks(t)&&t.removeFromParent()}resetAfterClear(e,t){this.init(e,t)}createPersonalCamera(){let e=Mu.createFromState(AD.PERSONAL_CAMERA_ID,qe(me({},Ky.defaultData),{name:"Personal Camera"}));return e.enableHelper=!1,e.objectHelper.visible=!1,delete e.isEntity,this.registerObjectCreatedInLegacy(e),e}raycast(e){let t=[],r=i=>{for(let n of i.children)ks(n)&&!n.raycastLock&&n.visible&&((Mi(n)||ef(n)&&n.enableHelper&&n.objectHelper.parent)&&e.intersectObject(n,!1,t),r(n))};return r(this),t}traverseEntity(e){for(let t of this.children)ks(t)&&t.traverseEntity(e)}updateFog(e,t){this.enableFog=e.enabled,this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=Li(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}toJSON(e){return{}}fromJSON(e){return this}dispose(){this.clearScene(this.sharedAssetManager),this.sharedAssetManager.dispose()}updateAmbientLight(e,t){yY(this.ambientLight,e,t),e.groundColor!==void 0&&(this.ambientLight.groundColor=Li(e.groundColor,t)),e.enabled!==void 0&&(this.ambientLight.visible=e.enabled)}switchActiveCamera(e){this.activeCamera!==this.personalCamera&&(this.activeCamera.enableHelper=!0),this.activeCamera=e,e.enableHelper=!1}setBackgroundColor(e){this.bgColor=e,this.alpha=e.a}createChildrenObjects(e,t,r){for(let i of e)this.createChildObject(i.id,i.data,i.children,t,r)}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createChildObject(e,t,r,i,n){let s=QY(e,t,n);return s&&(this.entityByUuid[e]=s,i.add(s),Mr(i)&&Mi(s)&&(s.prevBooleanObjectParent=i),this.createChildrenObjects(r,s,n)),s}getCenter(e){let t=[];for(let i=0,n=e.length;i<n;++i){let{id:s,recursive:a}=e[i],o=this.find(s),l=a?o.recursiveBBox:o.singleBBox;t.push(...l.vertices)}let r=new gs;return r.setFromPoints(t),r.getCenter(zA),zA}copyMatrixWorld(e,t){if(e===null){t.identity();return}let r=this.find(e);r?t.copy(r.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var i;if(e===null){t.identity();return}let r=(i=this.find(e))==null?void 0:i.parent;r?t.copy(r.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof Bi)if(Array.isArray(t.material))for(let r=0;r<t.material.length;r++)e(t.material[r]);else e(t.material)})}updateCanvasSize(e,t){this.activeCamera.setViewplaneSize(e,t);let r,i;e>=t?(r=t/e,i=1):(r=1,i=e/t),this.traverseMaterial(n=>{n.layersList.getLayersOfType("transmission").forEach(s=>{s.uniforms[`f${s.id}_aspectRatio`].value.x=r,s.uniforms[`f${s.id}_aspectRatio`].value.y=i})})}},ED=AD;ED.PERSONAL_CAMERA_ID="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera";var CD={RED:0,GREEN:1,BLUE:2,ALPHA:3},sf="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",eX=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,xp=class extends Gr{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new Ze(null),kernel16:new Ze(null),inputBuffer:new Ze(null),cocBuffer:new Ze(null),texelSize:new Ze(new $),scale:new Ze(1)},blending:ii,depthWrite:!1,depthTest:!1,fragmentShader:eX,vertexShader:sf}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),r=new Float32Array(32),i=0,n=0;for(let o=0;o<80;++o){let l=o*e,h=Math.sqrt(o)/Math.sqrt(80),u=h*Math.cos(l),c=h*Math.sin(l);o%5===0?(r[n++]=u,r[n++]=c):(t[i++]=u,t[i++]=c)}let s=[],a=[];for(let o=0;o<128;)s.push(new Tt(t[o++],t[o++],t[o++],t[o++]));for(let o=0;o<32;)a.push(new Tt(r[o++],r[o++],r[o++],r[o++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=a}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function FA(e,t,r){return e*(t-r)-t}function cx(e,t,r){return Math.min(Math.max((e+t)/(t-r),0),1)}var tX=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,rX=class extends Gr{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Ze(null),focusDistance:new Ze(0),focusRange:new Ze(0),cameraNear:new Ze(.3),cameraFar:new Ze(1e3)},blending:ii,depthWrite:!1,depthTest:!1,fragmentShader:tX,vertexShader:sf}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=io){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-FA(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=cx(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-FA(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=cx(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof gi?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},iX=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,nX="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",UA=class extends Gr{constructor(e=new $){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Ze(null),texelSize:new Ze(new $),halfTexelSize:new Ze(new $),kernel:new Ze(0),scale:new Ze(1)},blending:ii,depthWrite:!1,depthTest:!1,fragmentShader:iX,vertexShader:nX}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.halfTexelSize.value.copy(r.texelSize.value).multiplyScalar(.5)}},sX=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,aX=class extends Gr{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Ze(null),opacity:new Ze(1)},blending:ii,depthWrite:!1,depthTest:!1,fragmentShader:sX,vertexShader:sf}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},oX=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=linearToRelativeLuminance(texture2D(inputBuffer,vUv).rgb);float lLeft=linearToRelativeLuminance(texture2D(inputBuffer,vUv0).rgb);float lTop=linearToRelativeLuminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=linearToRelativeLuminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=linearToRelativeLuminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=linearToRelativeLuminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=linearToRelativeLuminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,lX=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,Mb={DEPTH:0,LUMA:1,COLOR:2},TD={DISABLED:0,DEPTH:1,CUSTOM:2},hX=class extends Gr{constructor(e=new $,t=Mb.COLOR){super({name:"EdgeDetectionMaterial",defines:{LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new Ze(null),depthBuffer:new Ze(null),predicationBuffer:new Ze(null),texelSize:new Ze(e)},blending:ii,depthWrite:!1,depthTest:!1,fragmentShader:oX,vertexShader:lX}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=io){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},uX=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,cX="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",Zn={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},dx=class extends Gr{constructor(e,t,r,i,n=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:Yd.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Ze(null),depthBuffer:new Ze(null),resolution:new Ze(new $),texelSize:new Ze(new $),cameraNear:new Ze(.3),cameraFar:new Ze(1e3),aspect:new Ze(1),time:new Ze(0)},blending:ii,depthWrite:!1,depthTest:!1,dithering:n}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),r&&this.setUniforms(r),this.adoptCameraSettings(i)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=io){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=uX.replace(Zn.FRAGMENT_HEAD,e.get(Zn.FRAGMENT_HEAD)).replace(Zn.FRAGMENT_MAIN_UV,e.get(Zn.FRAGMENT_MAIN_UV)).replace(Zn.FRAGMENT_MAIN_IMAGE,e.get(Zn.FRAGMENT_MAIN_IMAGE)),this.vertexShader=cX.replace(Zn.VERTEX_HEAD,e.get(Zn.VERTEX_HEAD)).replace(Zn.VERTEX_MAIN_SUPPORT,e.get(Zn.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof gi?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let r=this.uniforms;r.resolution.value.set(e,t),r.texelSize.value.set(1/e,1/t),r.aspect.value=e/t}static get Section(){return Zn}},dX=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=linearToRelativeLuminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,fX=class extends Gr{constructor(e=!1,t=null){super({name:"LuminanceMaterial",uniforms:{inputBuffer:new Ze(null),threshold:new Ze(0),smoothing:new Ze(1),range:new Ze(null)},blending:ii,depthWrite:!1,depthTest:!1,fragmentShader:dX,vertexShader:sf}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},pX=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,DD={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},mX=class extends Gr{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new Ze(e),inputBuffer:new Ze(null),strength:new Ze(1)},blending:ii,depthWrite:!1,depthTest:!1,fragmentShader:pX,vertexShader:sf}),this.toneMapped=!1,this.setColorChannel(CD.RED),this.setMaskFunction(DD.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==Si&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},gX=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,vX="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",yX=class extends Gr{constructor(e=new $,t=new $){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new Ze(null),searchTexture:new Ze(null),areaTexture:new Ze(null),resolution:new Ze(t),texelSize:new Ze(e)},blending:ii,depthWrite:!1,depthTest:!1,fragmentShader:gX,vertexShader:vX}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let r=this.uniforms;r.texelSize.value.set(1/e,1/t),r.resolution.value.set(e,t)}},xX=new Bu,wo=null;function wX(){if(wo===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);wo=new vt,wo.setAttribute!==void 0?(wo.setAttribute("position",new Ct(e,3)),wo.setAttribute("uv",new Ct(t,2))):(wo.addAttribute("position",new Ct(e,3)),wo.addAttribute("uv",new Ct(t,2)))}return wo}var no=class{constructor(e="Pass",t=new su,r=xX){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Ji(wX(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new su),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=io){}render(e,t,r,i,n){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof su||t===this.renderer)continue;this[e].dispose()}}}},PD=class extends no{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new aX,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Or(1,1,{minFilter:Wt,magFilter:Wt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,r,i,n){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,r){r!==void 0&&(this.renderTarget.texture.type=r,r!==Si?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===St&&(this.renderTarget.texture.encoding=St))}},bX=class extends no{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,r,i,n){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},Fv=new Ue,Ab=class extends no{constructor(e=!0,t=!0,r=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=r,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,r){this.color=e,this.depth=t,this.stencil=r}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,r,i,n){let s=this.overrideClearColor,a=this.overrideClearAlpha,o=e.getClearAlpha(),l=s!==null,h=a>=0;l?(Fv.copy(e.getClearColor(Fv)),e.setClearColor(s,h?a:o)):h&&e.setClearAlpha(a),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(Fv,o):h&&e.setClearAlpha(o)}},bo=-1,us=class extends nn{constructor(e,t=bo,r=bo,i=1){super(),this.resizable=e,this.base=new $(1,1),this.preferred=new $(t,r),this.target=this.preferred,this.s=i}get width(){let{base:e,preferred:t,scale:r}=this,i;return t.width!==bo?i=t.width:t.height!==bo?i=Math.round(t.height*(e.width/Math.max(e.height,1))):i=Math.round(e.width*r),i}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:r}=this,i;return t.height!==bo?i=t.height:t.width!==bo?i=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):i=Math.round(e.height*r),i}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(bo),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return bo}},Uv=!1,HA=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let r;if(t.material.flatShading)switch(t.material.side){case ti:r=this.materialsFlatShadedDoubleSide;break;case yi:r=this.materialsFlatShadedBackSide;break;default:r=this.materialsFlatShaded;break}else switch(t.material.side){case ti:r=this.materialsDoubleSide;break;case yi:r=this.materialsBackSide;break;default:r=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=r[2]:t.isInstancedMesh?t.material=r[1]:t.material=r[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let r of t)r.uniforms=Object.assign({},e.uniforms),r.side=Zo;t[2].skinning=!0,this.materialsBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=yi,i}),this.materialsDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=ti,i}),this.materialsFlatShaded=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=yi,i}),this.materialsFlatShadedDoubleSide=t.map(r=>{let i=r.clone();return i.uniforms=Object.assign({},e.uniforms),i.flatShading=!0,i.side=ti,i})}}render(e,t,r){let i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,Uv){let n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,r);for(let s of n)s[0].material=s[1];this.meshCount!==n.size&&n.clear()}else{let n=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,r),t.overrideMaterial=n}e.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Uv}static set workaroundEnabled(e){Uv=e}},GA=class extends no{constructor(e,t,r=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new Ab,this.overrideMaterialManager=r===null?null:new HA(r),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new HA(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,h=s.background,u=e.shadowMap.autoUpdate,c=this.renderToScreen?null:t;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(c),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,s,a):e.render(s,a),a.layers.mask=l,s.background=h,e.shadowMap.autoUpdate=u}},Ut={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},_X="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",SX="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",MX="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",AX="float blend(const in float x,const in float y){return(y==0.0)? y : max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",EX="float blend(const in float x,const in float y){return(y==1.0)? y : min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",CX="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",TX="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",DX="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",PX="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",LX="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",RX="float blend(const in float x,const in float y){return(y>0.0)? min(x/y,1.0): 1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",OX="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",IX="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",NX="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",BX="float blend(const in float x,const in float y){return(y==1.0)? y : min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",kX="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",zX="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",FX="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",UX=new Map([[Ut.SKIP,null],[Ut.ADD,_X],[Ut.ALPHA,SX],[Ut.AVERAGE,MX],[Ut.COLOR_BURN,AX],[Ut.COLOR_DODGE,EX],[Ut.DARKEN,CX],[Ut.DIFFERENCE,TX],[Ut.EXCLUSION,DX],[Ut.LIGHTEN,PX],[Ut.MULTIPLY,LX],[Ut.DIVIDE,RX],[Ut.NEGATION,OX],[Ut.NORMAL,IX],[Ut.OVERLAY,NX],[Ut.REFLECT,BX],[Ut.SCREEN,kX],[Ut.SOFT_LIGHT,zX],[Ut.SUBTRACT,FX]]),HX=class extends nn{constructor(e,t=1){super(),this.f=e,this.opacity=new Ze(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return UX.get(this.blendFunction)}},na={NONE:0,DEPTH:1,CONVOLUTION:2},va=class extends nn{constructor(e,t,{attributes:r=na.NONE,blendFunction:i=Ut.SCREEN,defines:n=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=e,this.renderer=null,this.attributes=r,this.fragmentShader=t,this.vertexShader=o,this.defines=n,this.uniforms=s,this.extensions=a,this.blendMode=new HX(i),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=io){}update(e,t,r){}setSize(e,t){}initialize(e,t,r){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof su||t===this.renderer)continue;this[e].dispose()}}}};function VA(e,t,r){for(let i of t){let n="$1"+e+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(let a of r.entries())a[1]!==null&&r.set(a[0],a[1].replace(s,n))}}function GX(e,t,r,i,n,s,a){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=o.get("fragment")!==void 0&&/mainImage/.test(o.get("fragment")),h=o.get("fragment")!==void 0&&/mainUv/.test(o.get("fragment")),u=[],c=[],d=!1,f=!1;if(o.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(h&&(a&na.CONVOLUTION)!==0)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!l&&!h)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{let p=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,m=dx.Section;if(h){let v=`	${e}MainUv(UV);
`;r.set(m.FRAGMENT_MAIN_UV,r.get(m.FRAGMENT_MAIN_UV)+v),d=!0}if(o.get("vertex")!==null&&/mainSupport/.test(o.get("vertex"))){let v=`	${e}MainSupport(`;v+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?`vUv);
`:`);
`,r.set(m.VERTEX_MAIN_SUPPORT,r.get(m.VERTEX_MAIN_SUPPORT)+v),u=u.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(x=>x[1])),c=c.concat(u).concat([...o.get("vertex").matchAll(p)].map(x=>x[1]))}c=c.concat([...o.get("fragment").matchAll(p)].map(v=>v[1])),c=c.concat([...t.defines.keys()].map(v=>v.replace(/\([\w\s,]*\)/g,""))),c=c.concat([...t.uniforms.keys()]),t.uniforms.forEach((v,x)=>s.set(e+x.charAt(0).toUpperCase()+x.slice(1),v)),t.defines.forEach((v,x)=>n.set(e+x.charAt(0).toUpperCase()+x.slice(1),v)),VA(e,c,n),VA(e,c,o);let g=t.blendMode;if(i.set(g.blendFunction,g),l){let v=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,x=`${e}MainImage(color0, UV, `;(a&na.DEPTH)!==0&&v.test(o.get("fragment"))&&(x+="depth, ",f=!0),x+=`color1);
	`;let b=e+"BlendOpacity";s.set(b,g.opacity),x+=`color0 = blend${g.blendFunction}(color0, color1, ${b});

	`,r.set(m.FRAGMENT_MAIN_IMAGE,r.get(m.FRAGMENT_MAIN_IMAGE)+x),x=`uniform float ${b};

`,r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+x)}r.set(m.FRAGMENT_HEAD,r.get(m.FRAGMENT_HEAD)+o.get("fragment")+`
`),o.get("vertex")!==null&&r.set(m.VERTEX_HEAD,r.get(m.VERTEX_HEAD)+o.get("vertex")+`
`)}return{varyings:u,transformedUv:d,readDepth:f}}var Hv=class extends no{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new dx(null,null,null,e),this.effects=t.sort((r,i)=>i.attributes-r.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=dx.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),r=new Map,i=new Map,n=new Map,s=new Set,a=0,o=0,l=0,h=!1,u=!1;for(let d of this.effects)if(d.blendMode.blendFunction===Ut.SKIP)l|=d.getAttributes()&na.DEPTH;else if((l&d.getAttributes()&na.CONVOLUTION)!==0)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let f="e"+a++,p=GX(f,d,t,r,i,n,l);if(o+=p.varyings.length,h=h||p.transformedUv,u=u||p.readDepth,d.extensions!==null)for(let m of d.extensions)s.add(m)}let c=/\bblend\b/g;for(let d of r.values()){let f=d.getShaderCode().replace(c,`blend${d.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+f+`
`)}if((l&na.DEPTH)!==0){if(u){let d=`float depth = readDepth(UV);

	`;t.set(e.FRAGMENT_MAIN_IMAGE,d+t.get(e.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(h){let d=`vec2 transformedUv = vUv;
`;t.set(e.FRAGMENT_MAIN_UV,d+t.get(e.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")}else i.set("UV","vUv");t.forEach((d,f,p)=>p.set(f,d.trim().replace(/^#/,`
#`))),this.uniformCount=n.size,this.varyingCount=o,this.skipRendering=a===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(n).setDefines(i)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=io){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let r of this.effects)r.setDepthTexture(e,t)}render(e,t,r,i,n){for(let s of this.effects)s.update(e,t,i);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,s.time+=i,e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let r of this.effects)r.setSize(e,t)}initialize(e,t,r){this.renderer=e;for(let i of this.effects)i.initialize(e,t,r),i.addEventListener("change",n=>this.handleEvent(n));this.updateMaterial(),this.verifyResources(),r!==void 0&&r!==Si&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},VX=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],LD=class extends no{constructor({resolutionScale:e=.5,width:t=us.AUTO_SIZE,height:r=us.AUTO_SIZE,kernelSize:i=Eb.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new Or(1,1,{minFilter:Wt,magFilter:Wt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let n=this.resolution=new us(this,t,r,e);n.addEventListener("change",s=>this.setSize(n.baseWidth,n.baseHeight)),this.blurMaterial=new UA,this.ditheredBlurMaterial=new UA,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=i}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,r,i,n){let s=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,h=VX[this.kernelSize],u=this.blurMaterial,c=t,d,f;for(this.fullscreenMaterial=u,d=0,f=h.length-1;d<f;++d){let p=(d&1)===0?o:l;u.kernel=h[d],u.inputBuffer=c.texture,e.setRenderTarget(p),e.render(s,a),c=p}this.dithering&&(u=this.ditheredBlurMaterial,this.fullscreenMaterial=u),u.kernel=h[d],u.inputBuffer=c.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(s,a)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height;this.renderTargetA.setSize(i,n),this.renderTargetB.setSize(i,n),this.blurMaterial.setSize(i,n),this.ditheredBlurMaterial.setSize(i,n)}initialize(e,t,r){r!==void 0&&(this.renderTargetA.texture.type=r,this.renderTargetB.texture.type=r,r!==Si?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===St&&(this.renderTargetA.texture.encoding=St,this.renderTargetB.texture.encoding=St))}static get AUTO_SIZE(){return us.AUTO_SIZE}},jX=class extends no{constructor({width:e=us.AUTO_SIZE,height:t=us.AUTO_SIZE,renderTarget:r,luminanceRange:i,colorOutput:n}={}){super("LuminancePass"),this.fullscreenMaterial=new fX(n,i),this.needsSwap=!1,this.renderTarget=r,this.renderTarget===void 0&&(this.renderTarget=new Or(1,1,{minFilter:Wt,magFilter:Wt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new us(this,e,t);s.addEventListener("change",a=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,r,i,n){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height)}initialize(e,t,r){r!==void 0&&r!==Si&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},WX=class extends no{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new Ab(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,r,i,n){let s=e.getContext(),a=e.state.buffers,o=this.scene,l=this.camera,h=this.clearPass,u=this.inverted?0:1,c=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(c),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?h.render(e,null):(h.render(e,t),h.render(e,r))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(r),e.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},Co=class extends no{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,r,i,n){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}initialize(e,t,r){r!==void 0&&r!==Si&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Gv=1/1e3,qX=1e3,YX=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*Gv}getFixedDelta(){return this.fixedDelta*Gv}setFixedDelta(e){return this.fixedDelta=e*qX,this}getElapsed(){return this.elapsed*Gv}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},XX=class{constructor(e=null,{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:i=0,frameBufferType:n}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,r,n,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new PD,this.depthTexture=null,this.passes=[],this.timer=new YX,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){let t=e.getSize(new $),r=e.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===Si&&e.outputEncoding===St&&(this.inputBuffer.texture.encoding=St,this.outputBuffer.texture.encoding=St,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(let n of this.passes)n.initialize(e,r,i)}}replaceRenderer(e,t=!0){let r=this.renderer,i=r.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(r.domElement),i.appendChild(e.domElement)),r}createDepthTexture(){let e=this.depthTexture=new Em;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Ul,e.type=Cl):e.type=Io,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,i){let n=this.renderer,s=n===null?new $:n.getDrawingBufferSize(new $),a={minFilter:Wt,magFilter:Wt,stencilBuffer:t,depthBuffer:e,type:r},o;return i>0?(o=Number(Yd.replace(/\D+/g,""))<138?new oF(s.width,s.height,a):new Or(s.width,s.height,a),o.ignoreDepthForMultisampleCopy=!1,o.samples=i):o=new Or(s.width,s.height,a),r===Si&&n!==null&&n.outputEncoding===St&&(o.texture.encoding=St),o.texture.name="EffectComposer.Buffer",o.texture.generateMipmaps=!1,o}addPass(e,t){let r=this.passes,i=this.renderer,n=i.getDrawingBufferSize(new $),s=i.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(e.setRenderer(i),e.setSize(n.width,n.height),e.initialize(i,s,a),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?r.splice(t,0,e):r.push(e),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let o=this.createDepthTexture();for(e of r)e.setDepthTexture(o)}else e.setDepthTexture(this.depthTexture)}removePass(e){let t=this.passes,r=t.indexOf(e);if(r!==-1&&t.splice(r,1).length>0){if(this.depthTexture!==null){let i=(n,s)=>n||s.needsDepthTexture;t.reduce(i,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,r=this.copyPass,i=this.inputBuffer,n=this.outputBuffer,s=!1,a,o,l;e===void 0&&(e=this.timer.update().getDelta());for(let h of this.passes)h.enabled&&(h.render(t,i,n,e,s),h.needsSwap&&(s&&(r.renderToScreen=h.renderToScreen,a=t.getContext(),o=t.state.buffers.stencil,o.setFunc(a.NOTEQUAL,1,4294967295),r.render(t,i,n,e,s),o.setFunc(a.EQUAL,1,4294967295)),l=i,i=n,n=l),h instanceof WX?s=!0:h instanceof bX&&(s=!1))}setSize(e,t,r){let i=this.renderer;if(e===void 0||t===void 0){let s=i.getSize(new $);e=s.width,t=s.height}i.setSize(e,t,r);let n=i.getDrawingBufferSize(new $);this.inputBuffer.setSize(n.width,n.height),this.outputBuffer.setSize(n.width,n.height);for(let s of this.passes)s.setSize(n.width,n.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},Eb={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},QX=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,JX=class extends va{constructor({blendFunction:e=Ut.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:r=.025,resolutionScale:i=.5,intensity:n=1,width:s=us.AUTO_SIZE,height:a=us.AUTO_SIZE,kernelSize:o=Eb.LARGE}={}){super("BloomEffect",QX,{blendFunction:e,uniforms:new Map([["map",new Ze(null)],["intensity",new Ze(n)]])}),this.renderTarget=new Or(1,1,{minFilter:Wt,magFilter:Wt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new jX({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=r,this.blurPass=new LD({resolutionScale:i,width:s,height:a,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",h=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,r){let i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t),this.renderTarget.setSize(r.width,r.height),this.luminancePass.resolution.copy(r)}initialize(e,t,r){this.blurPass.initialize(e,t,r),r!==void 0&&(this.renderTarget.texture.type=r,e.outputEncoding===St&&(this.renderTarget.texture.encoding=St))}},KX="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",ZX=class extends va{constructor({blendFunction:e=Ut.NORMAL,brightness:t=0,contrast:r=0}={}){super("BrightnessContrastEffect",KX,{blendFunction:e,uniforms:new Map([["brightness",new Ze(t)],["contrast",new Ze(r)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},$X="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",eQ=class extends va{constructor(e=Ut.NORMAL){super("ColorAverageEffect",$X,{blendFunction:e})}},tQ="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",rQ="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",iQ=class extends va{constructor({blendFunction:e=Ut.NORMAL,offset:t=new $(.001,5e-4)}={}){super("ChromaticAberrationEffect",tQ,{vertexShader:rQ,blendFunction:e,attributes:na.CONVOLUTION,uniforms:new Map([["offset",new Ze(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},nQ=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,sQ=class extends va{constructor(e,{blendFunction:t=Ut.NORMAL,worldFocusDistance:r,worldFocusRange:i,focusDistance:n=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,width:l=us.AUTO_SIZE,height:h=us.AUTO_SIZE}={}){super("DepthOfFieldEffect",nQ,{blendFunction:t,attributes:na.DEPTH,uniforms:new Map([["nearColorBuffer",new Ze(null)],["farColorBuffer",new Ze(null)],["nearCoCBuffer",new Ze(null)],["scale",new Ze(1)]])}),this.camera=e,this.renderTarget=new Or(1,1,{minFilter:Wt,magFilter:Wt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Co(new rX(e));let u=this.cocMaterial;u.focusDistance=n,u.focusRange=a,r!==void 0&&(u.worldFocusDistance=r),i!==void 0&&(u.worldFocusRange=i),this.blurPass=new LD({kernelSize:Eb.MEDIUM,width:l,height:h});let c=this.blurPass.getResolution();c.addEventListener("change",f=>this.setSize(c.getBaseWidth(),c.getBaseHeight())),this.maskPass=new Co(new mX(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=DD.MULTIPLY,d.colorChannel=CD.GREEN,this.bokehNearBasePass=new Co(new xp(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Co(new xp(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Co(new xp(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Co(new xp(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let r of t)r.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,r=t.position.distanceTo(e);return cx(-r,t.near,t.far)}setDepthTexture(e,t=io){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,r){let i=this.renderTarget,n=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(this.target!==null){let o=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=o}this.cocPass.render(e,null,n),this.blurPass.render(e,n,s),this.maskPass.render(e,t,a),this.bokehFarBasePass.render(e,a,i),this.bokehFarFillPass.render(e,i,this.renderTargetFar),this.bokehNearBasePass.render(e,t,i),this.bokehNearFillPass.render(e,i,this.renderTargetNear)}setSize(e,t){let r=this.resolution;r.setBaseSize(e,t);let i=r.width,n=r.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(a=>a.setSize(e,t)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(a=>a.setSize(i,n)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(a=>a.fullscreenMaterial.setSize(i,n))}initialize(e,t,r){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(i=>i.initialize(e,t,r)),this.blurPass.initialize(e,t,Si),r!==void 0&&(this.renderTarget.texture.type=r,this.renderTargetNear.texture.type=r,this.renderTargetFar.texture.type=r,this.renderTargetMasked.texture.type=r,e.outputEncoding===St&&(this.renderTarget.texture.encoding=St,this.renderTargetNear.texture.encoding=St,this.renderTargetFar.texture.encoding=St,this.renderTargetMasked.texture.encoding=St))}};new F;new wt;var aQ="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",oQ=class extends va{constructor({blendFunction:e=Ut.NORMAL,hue:t=0,saturation:r=0}={}){super("HueSaturationEffect",aQ,{blendFunction:e,uniforms:new Map([["hue",new Ze(new F)],["saturation",new Ze(r)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),r=Math.cos(e);this.uniforms.get("hue").value.set((2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new Ue;var lQ=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,hQ=class extends va{constructor({blendFunction:e=Ut.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",lQ,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},uQ="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",cQ=class extends va{constructor(e=30){super("PixelationEffect",uQ,{uniforms:new Map([["active",new Ze(!1)],["d",new Ze(new $)]])}),this.resolution=new $,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new F;new F;var jA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",WA="data:image/png;base64,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",dQ="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",fQ="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",Lh={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},pQ=class extends va{constructor({preset:e=Lh.MEDIUM,edgeDetectionMode:t=Mb.COLOR,predicationMode:r=TD.DISABLED}={}){super("SMAAEffect",dQ,{vertexShader:fQ,blendFunction:Ut.NORMAL,attributes:na.CONVOLUTION|na.DEPTH,uniforms:new Map([["weightMap",new Ze(null)]])});let i,n;arguments.length>1&&(i=arguments[0],n=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new Or(1,1,{minFilter:Wt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new Ab(!0,!1,!1),this.clearPass.overrideClearColor=new Ue(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Co(new hX),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=r,this.weightsPass=new Co(new yX);let s=new Uw;s.onLoad=()=>{let a=new Qr(i);a.name="SMAA.Search",a.magFilter=mi,a.minFilter=mi,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!0,this.weightsMaterial.searchTexture=a;let o=new Qr(n);o.name="SMAA.Area",o.magFilter=Wt,o.minFilter=Wt,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!1,this.weightsMaterial.areaTexture=o,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),i!==void 0&&n!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(i=new Image,n=new Image,i.addEventListener("load",()=>s.itemEnd("search")),n.addEventListener("load",()=>s.itemEnd("area")),i.src=jA,n.src=WA),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,r=this.weightsMaterial;switch(e){case Lh.LOW:t.edgeDetectionThreshold=.15,r.orthogonalSearchSteps=4,r.diagonalDetection=!1,r.cornerDetection=!1;break;case Lh.MEDIUM:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=8,r.diagonalDetection=!1,r.cornerDetection=!1;break;case Lh.HIGH:t.edgeDetectionThreshold=.1,r.orthogonalSearchSteps=16,r.diagonalSearchSteps=8,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break;case Lh.ULTRA:t.edgeDetectionThreshold=.05,r.orthogonalSearchSteps=32,r.diagonalSearchSteps=16,r.cornerRounding=25,r.diagonalDetection=!0,r.cornerDetection=!0;break}}setDepthTexture(e,t=io){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,r){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return jA}static get areaImageDataURL(){return WA}},mQ=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,wp={DEFAULT:0,ESKIL:1},gQ=class extends va{constructor({blendFunction:e=Ut.NORMAL,technique:t=wp.DEFAULT,eskil:r=!1,offset:i=.5,darkness:n=.5}={}){super("VignetteEffect",mQ,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new Ze(i)],["darkness",new Ze(n)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===wp.ESKIL}set eskil(e){this.technique=e?wp.ESKIL:wp.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},so=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(r){this.effect.blendMode.opacity.value=r},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(r){this.effect.blendMode.setBlendFunction(Number(r))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Ut.NORMAL}toJSON(){let e=["constructor","effect","subscriptions"],t=me({},this),r=Object.getPrototypeOf(this),i=Object.getOwnPropertyNames(r);for(let n of i){let s=Object.getOwnPropertyDescriptor(r,n);s&&typeof s.get=="function"&&(t[n]=this[n])}return e.forEach(n=>delete t[n]),t}},vQ=class extends so{constructor(){super(JX),this.blendFunction=Ut.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},yQ=class extends so{constructor(){super(ZX)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},xQ=class extends so{constructor(){super(iQ),this.effect.offset=new $(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},wQ=class extends so{constructor(){super(eQ)}},bQ=class extends so{constructor(){super(oQ),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},_Q=class extends so{constructor(){super(hQ),this.blendFunction=Ut.OVERLAY}},SQ=class extends so{constructor(){super(gQ)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},MQ=class extends so{constructor(e){super(sQ,e)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=e}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}},AQ=class extends so{constructor(){super(cQ)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}};function qA(e,t){return t&&t.enabled&&e.push(t.effect),e}var EQ=class extends nn{constructor(){super(),this._scene=new su,this._camera=new Mu,this.effects=new Map,this.loadingManager=new Uw,this.renderPass=new GA,this._renderToScreen=!0,this._hasSmaa=!1,this.clock=new Kz,this.enabled=!1,this.debug=!1,this.effects.set("bloom",new vQ),this.effects.set("chromaticAberration",new xQ),this.effects.set("vignette",new SQ),this.effects.set("noise",new _Q),this.effects.set("colorAverage",new wQ),this.effects.set("hueSaturation",new bQ),this.effects.set("brightnessContrast",new yQ),this.effects.set("depthOfField",new MQ),this.effects.set("pixelation",new AQ)}get scene(){return this._scene}set scene(e){this._scene=e}get camera(){return this._camera}set camera(e){this._camera=e}_initSmaa(){if(!this.effectComposer)return;let e=this.effectComposer.passes.length,t=new pQ({preset:Lh.ULTRA,edgeDetectionMode:Mb.COLOR}),r=()=>{t.removeEventListener("load",r),this.dispatchEvent({type:"smaaloaded"})};t.addEventListener("load",r),t.edgeDetectionMaterial.setPredicationMode(TD.DEPTH),t.edgeDetectionMaterial.setEdgeDetectionThreshold(.05),t.edgeDetectionMaterial.setPredicationThreshold(.002),t.edgeDetectionMaterial.setPredicationScale(1),this.effectComposer.addPass(new Hv(this.camera,t),e),this._hasSmaa=!0}_initPasses(){if(!(!this.effectComposer||!this.renderer))if(this.effectComposer.removeAllPasses(),this._hasSmaa=!1,this.renderPass=new GA(this.scene,this.camera),this.enabled){this.effectComposer.addPass(this.renderPass),this._initSmaa();let e=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(qA,[]),t=[this.effects.get("pixelation")].reduce(qA,[]);t.length>0&&this.effectComposer.addPass(new Hv(this.camera,...t)),this.effectComposer.addPass(new Hv(this.camera,...e))}else this.effectComposer.addPass(this.renderPass),(Fj||I0)&&Uj<15.5&&this._initSmaa()}reinit(){if(!this.renderer)return Promise.all([]);this.effectComposer=new XX(this.renderer),this._initPasses()}init({renderer:e,camera:t,scene:r}){this.renderer=e,this.scene=r,this.camera=t,this._initCopyPass(),this.reinit()}_initCopyPass(){if(this._savePass)return;let e=new $;this.renderer.getDrawingBufferSize(e),this._rt=new Or(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Md,wrapT:Md}),this._rt.samples=this.renderer.capabilities.isWebGL2?4:0,this._savePass=new PD(this._rt,!1),this._savePass.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){var r,i;let t=this.effectComposer;!t||(e===!0?((r=this.renderer)!=null&&r.capabilities.isWebGL2&&(t.multisampling=0),t.removePass(this._savePass),t.passes[t.passes.length-1].renderToScreen=!0,t.autoRenderToScreen=!0):(((i=this.renderer)==null?void 0:i.capabilities.isWebGL2)&&!this._hasSmaa&&(t.multisampling=4),t.autoRenderToScreen=!1,t.passes[t.passes.length-1].renderToScreen=!1,this._savePass.renderToScreen=!1,this.enabled||(this._savePass.needsDepthTexture=!0),t.addPass(this._savePass)),this._renderToScreen=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}fromJSON(e){e&&(Object.keys(e).forEach(t=>{let r=e[t],i=this.effects.get(t);Object.keys(r).forEach(n=>{i[n]=r[n]})}),this.enabled=e.enabled)}toJSON(){let e={};return this.effects.forEach((t,r)=>{e[r]=t.toJSON()},e),me({enabled:this.enabled},e)}render(){var e;(e=this.effectComposer)==null||e.render(this.clock.getDelta())}setScissor(e,t,r,i){if(!this.effectComposer||!this.renderer)return;e instanceof Tt?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,r,i),this.effectComposer.outputBuffer.scissor.set(e,t,r,i));let n=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(n),this.effectComposer.outputBuffer.scissor.multiplyScalar(n),this.renderer.setScissor(e,t,r,i)}setScissorTest(e){!this.effectComposer||!this.renderer||(this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e))}setViewport(e,t,r,i){!this.effectComposer||(e instanceof Tt?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,r,i),this.effectComposer.outputBuffer.viewport.set(e,t,r,i)))}resize(e,t,r){var i,n;if((i=this.effectComposer)==null||i.setSize(e,t,r),this._rt){let s=((n=this.renderer)==null?void 0:n.getPixelRatio())||window.devicePixelRatio;this._rt.setSize(e*s,t*s)}}dispose(){var e;this._listeners=void 0,(e=this.effectComposer)==null||e.dispose()}},CQ=class extends ED{constructor(e,t){super(e,t),this.postprocessing=new EQ,this.initPostprocessing(e.postprocessing)}resetAfterClear(e,t){super.resetAfterClear(e,t),this.initPostprocessing(e.postprocessing)}initPostprocessing(e){let i=e,{enabled:t}=i,r=e2(i,["enabled"]);for(let n of Object.entries(r)){let s=n[1],a=this.postprocessing.effects.get(n[0]);if(a){a.enabled=s.enabled;for(let[o,l]of Object.entries(s))a[o]=l}}this.postprocessing.enabled=t,this.postprocessing.reinit()}dispose(){super.dispose(),this.postprocessing.dispose()}switchActiveCamera(e){super.switchActiveCamera(e),this.postprocessing&&(this.postprocessing.camera=e)}},Vv=new WeakMap,TQ=class extends Dm{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,r,i){let n=new P0(this.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.setRequestHeader(this.requestHeader),n.setWithCredentials(this.withCredentials),n.load(e,s=>{let a={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(s,a).then(t).catch(i)},r,i)}decodeDracoFile(e,t,r,i){let n={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,n).then(t)}decodeGeometry(e,t){for(let o in t.attributeTypes){let l=t.attributeTypes[o];l.BYTES_PER_ELEMENT!==void 0&&(t.attributeTypes[o]=l.name)}let r=JSON.stringify(t);if(Vv.has(e)){let o=Vv.get(e);if(o.key===r)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let i,n=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(n,s).then(o=>(i=o,new Promise((l,h)=>{i._callbacks[n]={resolve:l,reject:h},i.postMessage({type:"decode",id:n,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return a.catch(()=>!0).then(()=>{i&&n&&this._releaseTask(i,n)}),Vv.set(e,{key:r,promise:a}),a}_createGeometry(e){let t=new vt;e.index&&t.setIndex(new Ct(e.index.array,1));for(let r=0;r<e.attributes.length;r++){let i=e.attributes[r],n=i.name,s=i.array,a=i.itemSize;t.setAttribute(n,new Ct(s,a))}return t}_loadLibrary(e,t){let r=new P0(this.manager);return r.setPath(this.decoderPath),r.setResponseType(t),r.setWithCredentials(this.withCredentials),new Promise((i,n)=>{r.load(e,i,void 0,n)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(r=>{let i=r[0];e||(this.decoderConfig.wasmBinary=r[1]);let n=DQ.toString(),s=["/* draco decoder */",i,"","/* worker */",n.substring(n.indexOf("{")+1,n.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let i=new Worker(this.workerSourceURL);i._callbacks={},i._taskCosts={},i._taskLoad=0,i.postMessage({type:"init",decoderConfig:this.decoderConfig}),i.onmessage=function(n){let s=n.data;switch(s.type){case"decode":i._callbacks[s.id].resolve(s);break;case"error":i._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(i)}else this.workerPool.sort(function(i,n){return i._taskLoad>n._taskLoad?-1:1});let r=this.workerPool[this.workerPool.length-1];return r._taskCosts[e]=t,r._taskLoad+=t,r})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}};function DQ(){let e,t;onmessage=function(a){let o=a.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise(function(u){e.onModuleLoaded=function(c){u({draco:c})},DracoDecoderModule(e)});break;case"decode":let l=o.buffer,h=o.taskConfig;t.then(u=>{let c=u.draco,d=new c.Decoder,f=new c.DecoderBuffer;f.Init(new Int8Array(l),l.byteLength);try{let p=r(c,d,f,h),m=p.attributes.map(g=>g.array.buffer);p.index&&m.push(p.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:p},m)}catch(p){console.error(p),self.postMessage({type:"error",id:o.id,error:p.message})}finally{c.destroy(f),c.destroy(d)}});break}};function r(a,o,l,h){let u=h.attributeIDs,c=h.attributeTypes,d,f,p=o.GetEncodedGeometryType(l);if(p===a.TRIANGULAR_MESH)d=new a.Mesh,f=o.DecodeBufferToMesh(l,d);else if(p===a.POINT_CLOUD)d=new a.PointCloud,f=o.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!f.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+f.error_msg());let m={index:null,attributes:[]};for(let g in u){let v=self[c[g]],x,b;if(h.useUniqueIDs)b=u[g],x=o.GetAttributeByUniqueId(d,b);else{if(b=o.GetAttributeId(d,a[u[g]]),b===-1)continue;x=o.GetAttribute(d,b)}m.attributes.push(n(a,o,d,g,v,x))}return p===a.TRIANGULAR_MESH&&(m.index=i(a,o,d)),a.destroy(d),m}function i(a,o,l){let h=l.num_faces()*3,u=h*4,c=a._malloc(u);o.GetTrianglesUInt32Array(l,u,c);let d=new Uint32Array(a.HEAPF32.buffer,c,h).slice();return a._free(c),{array:d,itemSize:1}}function n(a,o,l,h,u,c){let d=c.num_components(),f=l.num_points()*d,p=f*u.BYTES_PER_ELEMENT,m=s(a,u),g=a._malloc(p);o.GetAttributeDataArrayForAllPoints(l,c,m,p,g);let v=new u(a.HEAPF32.buffer,g,f).slice();return a._free(g),{name:h,array:v,itemSize:d}}function s(a,o){switch(o){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}var Fo;function PQ(){return Fo||(Fo=new TQ,Fo.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),Fo.decoderPending}async function LQ(e){if(Fo){let t={attributeIDs:Fo.defaultAttributeIDs,attributeTypes:Fo.defaultAttributeTypes,useUniqueIDs:!1},r;try{r=await Fo.decodeGeometry(new Int8Array(e).buffer,t)}catch(i){console.error(i)}if(r)return{index:r.index?{array:r.index.array}:void 0,attributes:Object.entries(r.attributes).map(([i,n])=>({name:i,itemSize:n.itemSize,array:n.array}))}}return null}async function RQ(e){let[t,r]=Y5(Vy.deserialize(new Uint8Array(e))),i=[];t.scene.objects.traverse((n,s)=>{s.type==="Mesh"&&s.geometry.type==="NonParametricGeometry"&&s.geometry.data.draco!==void 0&&i.push(s)}),i.length&&await PQ();for(let n of i){let s=await LQ(X5(n.geometry.data.draco));if(s){s.index&&(n.geometry.data.index={array:s.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let a={};s.attributes.forEach(({name:o,array:l,itemSize:h})=>{a[o]={array:l,itemSize:h,type:"Float32Array",normalized:!1}}),n.geometry.data.attributes=a,n.geometry.data.draco=void 0}}return r.result().data}var RD={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},Cb={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},OQ=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],W0={CSS:{},springs:{}};function Qs(e,t,r){return Math.min(Math.max(e,t),r)}function rd(e,t){return e.indexOf(t)>-1}function jv(e,t){return e.apply(null,t)}var lt={arr:function(e){return Array.isArray(e)},obj:function(e){return rd(Object.prototype.toString.call(e),"Object")},pth:function(e){return lt.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||lt.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return lt.hex(e)||lt.rgb(e)||lt.hsl(e)},key:function(e){return!RD.hasOwnProperty(e)&&!Cb.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function OD(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(r){return parseFloat(r)}):[]}function ID(e,t){var r=OD(e),i=Qs(lt.und(r[0])?1:r[0],.1,100),n=Qs(lt.und(r[1])?100:r[1],.1,100),s=Qs(lt.und(r[2])?10:r[2],.1,100),a=Qs(lt.und(r[3])?0:r[3],.1,100),o=Math.sqrt(n/i),l=s/(2*Math.sqrt(n*i)),h=l<1?o*Math.sqrt(1-l*l):0,u=1,c=l<1?(l*o+-a)/h:-a+o;function d(p){var m=t?t*p/1e3:p;return l<1?m=Math.exp(-m*l*o)*(u*Math.cos(h*m)+c*Math.sin(h*m)):m=(u+c*m)*Math.exp(-m*o),p===0||p===1?p:1-m}function f(){var p=W0.springs[e];if(p)return p;for(var m=1/6,g=0,v=0;;)if(g+=m,d(g)===1){if(v++,v>=16)break}else v=0;var x=g*m*1e3;return W0.springs[e]=x,x}return t?d:f}function IQ(e){return e===void 0&&(e=10),function(t){return Math.ceil(Qs(t,1e-6,1)*e)*(1/e)}}var NQ=function(){var e=11,t=1/(e-1);function r(u,c){return 1-3*c+3*u}function i(u,c){return 3*c-6*u}function n(u){return 3*u}function s(u,c,d){return((r(c,d)*u+i(c,d))*u+n(c))*u}function a(u,c,d){return 3*r(c,d)*u*u+2*i(c,d)*u+n(c)}function o(u,c,d,f,p){var m,g,v=0;do g=c+(d-c)/2,m=s(g,f,p)-u,m>0?d=g:c=g;while(Math.abs(m)>1e-7&&++v<10);return g}function l(u,c,d,f){for(var p=0;p<4;++p){var m=a(c,d,f);if(m===0)return c;var g=s(c,d,f)-u;c-=g/m}return c}function h(u,c,d,f){if(!(0<=u&&u<=1&&0<=d&&d<=1))return;var p=new Float32Array(e);if(u!==c||d!==f)for(var m=0;m<e;++m)p[m]=s(m*t,u,d);function g(v){for(var x=0,b=1,_=e-1;b!==_&&p[b]<=v;++b)x+=t;--b;var E=(v-p[b])/(p[b+1]-p[b]),S=x+E*t,P=a(S,u,d);return P>=.001?l(v,S,u,d):P===0?S:o(v,x,x+t,u,d)}return function(v){return u===c&&d===f||v===0||v===1?v:s(g(v),c,f)}}return h}(),ND=function(){var e={linear:function(){return function(i){return i}}},t={Sine:function(){return function(i){return 1-Math.cos(i*Math.PI/2)}},Circ:function(){return function(i){return 1-Math.sqrt(1-i*i)}},Back:function(){return function(i){return i*i*(3*i-2)}},Bounce:function(){return function(i){for(var n,s=4;i<((n=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((n*3-2)/22-i,2)}},Elastic:function(i,n){i===void 0&&(i=1),n===void 0&&(n=.5);var s=Qs(i,1,10),a=Qs(n,.1,2);return function(o){return o===0||o===1?o:-s*Math.pow(2,10*(o-1))*Math.sin((o-1-a/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/a)}}},r=["Quad","Cubic","Quart","Quint","Expo"];return r.forEach(function(i,n){t[i]=function(){return function(s){return Math.pow(s,n+2)}}}),Object.keys(t).forEach(function(i){var n=t[i];e["easeIn"+i]=n,e["easeOut"+i]=function(s,a){return function(o){return 1-n(s,a)(1-o)}},e["easeInOut"+i]=function(s,a){return function(o){return o<.5?n(s,a)(o*2)/2:1-n(s,a)(o*-2+2)/2}}}),e}();function Tb(e,t){if(lt.fnc(e))return e;var r=e.split("(")[0],i=ND[r],n=OD(e);switch(r){case"spring":return ID(e,t);case"cubicBezier":return jv(NQ,n);case"steps":return jv(IQ,n);default:return jv(i,n)}}function BD(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function Vm(e,t){for(var r=e.length,i=arguments.length>=2?arguments[1]:void 0,n=[],s=0;s<r;s++)if(s in e){var a=e[s];t.call(i,a,s,e)&&n.push(a)}return n}function jm(e){return e.reduce(function(t,r){return t.concat(lt.arr(r)?jm(r):r)},[])}function YA(e){return lt.arr(e)?e:(lt.str(e)&&(e=BD(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function Db(e,t){return e.some(function(r){return r===t})}function Pb(e){var t={};for(var r in e)t[r]=e[r];return t}function fx(e,t){var r=Pb(e);for(var i in e)r[i]=t.hasOwnProperty(i)?t[i]:e[i];return r}function Wm(e,t){var r=Pb(e);for(var i in t)r[i]=lt.und(e[i])?t[i]:e[i];return r}function BQ(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function kQ(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,r=e.replace(t,function(o,l,h,u){return l+l+h+h+u+u}),i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r),n=parseInt(i[1],16),s=parseInt(i[2],16),a=parseInt(i[3],16);return"rgba("+n+","+s+","+a+",1)"}function zQ(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),r=parseInt(t[1],10)/360,i=parseInt(t[2],10)/100,n=parseInt(t[3],10)/100,s=t[4]||1;function a(d,f,p){return p<0&&(p+=1),p>1&&(p-=1),p<1/6?d+(f-d)*6*p:p<1/2?f:p<2/3?d+(f-d)*(2/3-p)*6:d}var o,l,h;if(i==0)o=l=h=n;else{var u=n<.5?n*(1+i):n+i-n*i,c=2*n-u;o=a(c,u,r+1/3),l=a(c,u,r),h=a(c,u,r-1/3)}return"rgba("+o*255+","+l*255+","+h*255+","+s+")"}function FQ(e){if(lt.rgb(e))return BQ(e);if(lt.hex(e))return kQ(e);if(lt.hsl(e))return zQ(e)}function Wa(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function UQ(e){if(rd(e,"translate")||e==="perspective")return"px";if(rd(e,"rotate")||rd(e,"skew"))return"deg"}function px(e,t){return lt.fnc(e)?e(t.target,t.id,t.total):e}function Js(e,t){return e.getAttribute(t)}function Lb(e,t,r){var i=Wa(t);if(Db([r,"deg","rad","turn"],i))return t;var n=W0.CSS[t+r];if(!lt.und(n))return n;var s=100,a=document.createElement(e.tagName),o=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;o.appendChild(a),a.style.position="absolute",a.style.width=s+r;var l=s/a.offsetWidth;o.removeChild(a);var h=l*parseFloat(t);return W0.CSS[t+r]=h,h}function kD(e,t,r){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return r?Lb(e,n,r):n}}function Rb(e,t){if(lt.dom(e)&&!lt.inp(e)&&(Js(e,t)||lt.svg(e)&&e[t]))return"attribute";if(lt.dom(e)&&Db(OQ,t))return"transform";if(lt.dom(e)&&t!=="transform"&&kD(e,t))return"css";if(e[t]!=null)return"object"}function zD(e){if(lt.dom(e)){for(var t=e.style.transform||"",r=/(\w+)\(([^)]*)\)/g,i=new Map,n;n=r.exec(t);)i.set(n[1],n[2]);return i}}function HQ(e,t,r,i){var n=rd(t,"scale")?1:0+UQ(t),s=zD(e).get(t)||n;return r&&(r.transforms.list.set(t,s),r.transforms.last=t),i?Lb(e,s,i):s}function Ob(e,t,r,i){switch(Rb(e,t)){case"transform":return HQ(e,t,i,r);case"css":return kD(e,t,r);case"attribute":return Js(e,t);default:return e[t]||0}}function Ib(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var i=Wa(e)||0,n=parseFloat(t),s=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return n+s+i;case"-":return n-s+i;case"*":return n*s+i}}function FD(e,t){if(lt.col(e))return FQ(e);if(/\s/g.test(e))return e;var r=Wa(e),i=r?e.substr(0,e.length-r.length):e;return t?i+t:i}function Nb(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function GQ(e){return Math.PI*2*Js(e,"r")}function VQ(e){return Js(e,"width")*2+Js(e,"height")*2}function jQ(e){return Nb({x:Js(e,"x1"),y:Js(e,"y1")},{x:Js(e,"x2"),y:Js(e,"y2")})}function UD(e){for(var t=e.points,r=0,i,n=0;n<t.numberOfItems;n++){var s=t.getItem(n);n>0&&(r+=Nb(i,s)),i=s}return r}function WQ(e){var t=e.points;return UD(e)+Nb(t.getItem(t.numberOfItems-1),t.getItem(0))}function HD(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return GQ(e);case"rect":return VQ(e);case"line":return jQ(e);case"polyline":return UD(e);case"polygon":return WQ(e)}}function qQ(e){var t=HD(e);return e.setAttribute("stroke-dasharray",t),t}function YQ(e){for(var t=e.parentNode;lt.svg(t)&&lt.svg(t.parentNode);)t=t.parentNode;return t}function GD(e,t){var r=t||{},i=r.el||YQ(e),n=i.getBoundingClientRect(),s=Js(i,"viewBox"),a=n.width,o=n.height,l=r.viewBox||(s?s.split(" "):[0,0,a,o]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:a/l[2],h:o/l[3]}}function XQ(e,t){var r=lt.str(e)?BD(e)[0]:e,i=t||100;return function(n){return{property:n,el:r,svg:GD(r),totalLength:HD(r)*(i/100)}}}function QQ(e,t){function r(o){o===void 0&&(o=0);var l=t+o>=1?t+o:0;return e.el.getPointAtLength(l)}var i=GD(e.el,e.svg),n=r(),s=r(-1),a=r(1);switch(e.property){case"x":return(n.x-i.x)*i.w;case"y":return(n.y-i.y)*i.h;case"angle":return Math.atan2(a.y-s.y,a.x-s.x)*180/Math.PI}}function XA(e,t){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=FD(lt.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(r)?i.match(r).map(Number):[0],strings:lt.str(e)||t?i.split(r):[]}}function VD(e){var t=e?jm(lt.arr(e)?e.map(YA):YA(e)):[];return Vm(t,function(r,i,n){return n.indexOf(r)===i})}function jD(e){var t=VD(e);return t.map(function(r,i){return{target:r,id:i,total:t.length,transforms:{list:zD(r)}}})}function JQ(e,t){var r=Pb(t);if(/^spring/.test(r.easing)&&(r.duration=ID(r.easing)),lt.arr(e)){var i=e.length,n=i===2&&!lt.obj(e[0]);n?e={value:e}:lt.fnc(t.duration)||(r.duration=t.duration/i)}var s=lt.arr(e)?e:[e];return s.map(function(a,o){var l=lt.obj(a)&&!lt.pth(a)?a:{value:a};return lt.und(l.delay)&&(l.delay=o?0:t.delay),lt.und(l.endDelay)&&(l.endDelay=o===s.length-1?t.endDelay:0),l}).map(function(a){return Wm(a,r)})}function KQ(e){for(var t=Vm(jm(e.map(function(s){return Object.keys(s)})),function(s){return lt.key(s)}).reduce(function(s,a){return s.indexOf(a)<0&&s.push(a),s},[]),r={},i=function(s){var a=t[s];r[a]=e.map(function(o){var l={};for(var h in o)lt.key(h)?h==a&&(l.value=o[h]):l[h]=o[h];return l})},n=0;n<t.length;n++)i(n);return r}function ZQ(e,t){var r=[],i=t.keyframes;i&&(t=Wm(KQ(i),t));for(var n in t)lt.key(n)&&r.push({name:n,tweens:JQ(t[n],e)});return r}function $Q(e,t){var r={};for(var i in e){var n=px(e[i],t);lt.arr(n)&&(n=n.map(function(s){return px(s,t)}),n.length===1&&(n=n[0])),r[i]=n}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}function eJ(e,t){var r;return e.tweens.map(function(i){var n=$Q(i,t),s=n.value,a=lt.arr(s)?s[1]:s,o=Wa(a),l=Ob(t.target,e.name,o,t),h=r?r.to.original:l,u=lt.arr(s)?s[0]:h,c=Wa(u)||Wa(l),d=o||c;return lt.und(a)&&(a=h),n.from=XA(u,d),n.to=XA(Ib(a,u),d),n.start=r?r.end:0,n.end=n.start+n.delay+n.duration+n.endDelay,n.easing=Tb(n.easing,n.duration),n.isPath=lt.pth(s),n.isColor=lt.col(n.from.original),n.isColor&&(n.round=1),r=n,n})}var WD={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,i,n){if(i.list.set(t,r),t===i.last||n){var s="";i.list.forEach(function(a,o){s+=o+"("+a+") "}),e.style.transform=s}}};function qD(e,t){var r=jD(e);r.forEach(function(i){for(var n in t){var s=px(t[n],i),a=i.target,o=Wa(s),l=Ob(a,n,o,i),h=o||Wa(l),u=Ib(FD(s,h),l),c=Rb(a,n);WD[c](a,n,u,i.transforms,!0)}})}function tJ(e,t){var r=Rb(e.target,t.name);if(r){var i=eJ(t,e),n=i[i.length-1];return{type:r,property:t.name,animatable:e,tweens:i,duration:n.end,delay:i[0].delay,endDelay:n.endDelay}}}function rJ(e,t){return Vm(jm(e.map(function(r){return t.map(function(i){return tJ(r,i)})})),function(r){return!lt.und(r)})}function YD(e,t){var r=e.length,i=function(s){return s.timelineOffset?s.timelineOffset:0},n={};return n.duration=r?Math.max.apply(Math,e.map(function(s){return i(s)+s.duration})):t.duration,n.delay=r?Math.min.apply(Math,e.map(function(s){return i(s)+s.delay})):t.delay,n.endDelay=r?n.duration-Math.max.apply(Math,e.map(function(s){return i(s)+s.duration-s.endDelay})):t.endDelay,n}var QA=0;function iJ(e){var t=fx(RD,e),r=fx(Cb,e),i=ZQ(r,e),n=jD(e.targets),s=rJ(n,i),a=YD(s,r),o=QA;return QA++,Wm(t,{id:o,children:[],animatables:n,animations:s,duration:a.duration,delay:a.delay,endDelay:a.endDelay})}var Yi=[],JA=[],qp,nJ=function(){function e(){qp=requestAnimationFrame(t)}function t(r){var i=Yi.length;if(i){for(var n=0;n<i;){var s=Yi[n];if(!s.paused)s.tick(r);else{var a=Yi.indexOf(s);a>-1&&(Yi.splice(a,1),i=Yi.length)}n++}e()}else qp=cancelAnimationFrame(qp)}return e}();function sJ(){document.hidden?(Yi.forEach(function(e){return e.pause()}),JA=Yi.slice(0),Ir.running=Yi=[]):JA.forEach(function(e){return e.play()})}typeof document<"u"&&document.addEventListener("visibilitychange",sJ);function Ir(e){e===void 0&&(e={});var t=0,r=0,i=0,n,s=0,a=null;function o(x){var b=window.Promise&&new Promise(function(_){return a=_});return x.finished=b,b}var l=iJ(e);o(l);function h(){var x=l.direction;x!=="alternate"&&(l.direction=x!=="normal"?"normal":"reverse"),l.reversed=!l.reversed,n.forEach(function(b){return b.reversed=l.reversed})}function u(x){return l.reversed?l.duration-x:x}function c(){t=0,r=u(l.currentTime)*(1/Ir.speed)}function d(x,b){b&&b.seek(x-b.timelineOffset)}function f(x){if(l.reversePlayback)for(var b=s;b--;)d(x,n[b]);else for(var _=0;_<s;_++)d(x,n[_])}function p(x){var b=0,_=l.animations,E=_.length;for(l.reversePlayback===!0&&l.rewind===!1&&(x=l.duration+l.delay-l.endDelay-x);b<E;){var S=_[b],P=S.animatable,M=S.tweens,B=M.length-1,R=M[B];B&&(R=Vm(M,function(U){return x<U.end})[0]||R);for(var H=Qs(x-R.start-R.delay,0,R.duration)/R.duration,Q=isNaN(H)?1:R.easing(H),z=R.to.strings,y=R.round,A=[],D=R.to.numbers.length,O=void 0,C=0;C<D;C++){var I=void 0;if(l.reversePlayback===!0&&l.rewind===!1)var L=R.to.numbers[C],k=R.from.numbers[C]||0;else var k=R.to.numbers[C],L=R.from.numbers[C]||0;R.isPath?I=QQ(R.value,Q*k):I=L+Q*(k-L),y&&(R.isColor&&C>2||(I=Math.round(I*y)/y)),A.push(I)}var w=z.length;if(!w)O=A[0];else{O=z[0];for(var N=0;N<w;N++){z[N];var X=z[N+1],T=A[N];isNaN(T)||(X?O+=T+X:O+=T+" ")}}WD[S.type](P.target,S.property,O,P.transforms),S.currentValue=O,b++}}function m(x){l[x]&&!l.passThrough&&l[x](l)}function g(){l.remaining&&l.remaining!==!0&&l.remaining--}function v(x){var b=l.duration,_=l.delay,E=b-l.endDelay,S=u(x);l.progress=Qs(S/b*100,0,100),l.reversePlayback=S<l.currentTime,n&&f(S),!l.began&&l.currentTime>=0&&(l.began=!0,m("begin")),!l.loopBegan&&l.currentTime>0&&(l.loopBegan=!0,m("loopBegin")),S<=_&&l.currentTime!==0&&(p(0),m("change")),(S>=E&&l.currentTime!==b||!b)&&(p(b),m("change")),S>_&&S<E?(l.changeBegan||(l.changeBegan=!0,l.changeCompleted=!1,m("changeBegin")),m("change"),p(S)):l.changeBegan?(l.changeCompleted=!0,l.changeBegan=!1,m("change"),m("changeComplete")):l.began&&S>E&&(m("change"),m("changeComplete")),l.currentTime=Qs(S,0,b),l.began&&m("update"),x>=b&&(r=0,g(),l.remaining?(t=i,m("loopComplete"),l.loopBegan=!1,l.direction==="alternate"&&h()):(l.paused=!0,l.completed||(l.completed=!0,m("loopComplete"),m("complete"),!l.passThrough&&"Promise"in window&&(a(),o(l)))))}return l.reset=function(){var x=l.direction;l.passThrough=!1,l.currentTime=0,l.progress=0,l.paused=!0,l.began=!1,l.loopBegan=!1,l.changeBegan=!1,l.completed=!1,l.changeCompleted=!1,l.reversePlayback=!1,l.reversed=x==="reverse",l.remaining=l.loop,n=l.children,s=n.length;for(var b=s;b--;)l.children[b].reset();(l.reversed&&l.loop!==!0||x==="alternate"&&l.loop===1)&&l.remaining++,p(l.reversed?l.duration:0)},l.set=function(x,b){return qD(x,b),l},l.tick=function(x){i=x,t||(t=i),v((i+(r-t))*Ir.speed)},l.seek=function(x){v(u(x))},l.pause=function(){l.paused=!0,c()},l.play=function(){!l.paused||(l.completed&&l.reset(),l.paused=!1,Yi.push(l),c(),qp||nJ())},l.reverse=function(){h(),l.completed=!l.reversed,c()},l.restart=function(){l.reset(),l.play()},l.reset(),l.autoplay&&l.play(),l}function KA(e,t){for(var r=t.length;r--;)Db(e,t[r].animatable.target)&&t.splice(r,1)}function aJ(e){for(var t=VD(e),r=Yi.length;r--;){var i=Yi[r],n=i.animations,s=i.children;KA(t,n);for(var a=s.length;a--;){var o=s[a],l=o.animations;KA(t,l),!l.length&&!o.children.length&&s.splice(a,1)}!n.length&&!s.length&&i.pause()}}function oJ(e,t){t===void 0&&(t={});var r=t.direction||"normal",i=t.easing?Tb(t.easing):null,n=t.grid,s=t.axis,a=t.from||0,o=a==="first",l=a==="center",h=a==="last",u=lt.arr(e),c=parseFloat(u?e[0]:e),d=u?parseFloat(e[1]):0,f=Wa(u?e[1]:e)||0,p=t.start||0+(u?c:0),m=[],g=0;return function(v,x,b){if(o&&(a=0),l&&(a=(b-1)/2),h&&(a=b-1),!m.length){for(var _=0;_<b;_++){if(!n)m.push(Math.abs(a-_));else{var E=l?(n[0]-1)/2:a%n[0],S=l?(n[1]-1)/2:Math.floor(a/n[0]),P=_%n[0],M=Math.floor(_/n[0]),B=E-P,R=S-M,H=Math.sqrt(B*B+R*R);s==="x"&&(H=-B),s==="y"&&(H=-R),m.push(H)}g=Math.max.apply(Math,m)}i&&(m=m.map(function(z){return i(z/g)*g})),r==="reverse"&&(m=m.map(function(z){return s?z<0?z*-1:-z:Math.abs(g-z)}))}var Q=u?(d-c)/g:c;return p+Q*(Math.round(m[x]*100)/100)+f}}function lJ(e){e===void 0&&(e={});var t=Ir(e);return t.duration=0,t.add=function(r,i){var n=Yi.indexOf(t),s=t.children;n>-1&&Yi.splice(n,1);function a(d){d.passThrough=!0}for(var o=0;o<s.length;o++)a(s[o]);var l=Wm(r,fx(Cb,e));l.targets=l.targets||e.targets;var h=t.duration;l.autoplay=!1,l.direction=t.direction,l.timelineOffset=lt.und(i)?h:Ib(i,h),a(t),l.rewind=t.rewind,t.seek(l.timelineOffset);var u=Ir(l);a(u),s.push(u);var c=YD(s,e);return t.delay=c.delay,t.endDelay=c.endDelay,t.duration=c.duration,t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}Ir.version="3.2.0";Ir.speed=1;Ir.running=Yi;Ir.remove=aJ;Ir.get=Ob;Ir.set=qD;Ir.convertPx=Lb;Ir.path=XQ;Ir.setDashoffset=qQ;Ir.stagger=oJ;Ir.timeline=lJ;Ir.easing=Tb;Ir.penner=ND;Ir.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var hJ=Ir;function uJ(e,t,r){var n,s;let i=e.cameraType==="OrthographicCamera"?(n=t.orthographic)==null?void 0:n.zoom:(s=t.perspective)==null?void 0:s.zoom;if(i!==void 0){let a=e.zoom;a!==i&&r.push({change:o=>{e.zoom=kt.lerp(a,i,o),e.updateProjectionMatrix()}})}if(t.targetOffset!==void 0){let a=e.targetOffset,o=t.targetOffset;a!==o&&r.push({change:l=>{e.targetOffset=kt.lerp(a,o,l)}})}}function cJ(e,t,r){if(t.width!==void 0&&t.height!==void 0&&t.depth!==void 0){let{width:i,height:n,depth:s}=e.geometry.userData.parameters,a=[i,n,s],o=[t.width,t.height,t.depth];!wi.isEqual(a,o)&&!Mr(e)&&r.push({change:l=>{let[h,u,c]=wi.lerp(a,o,l);e.updateGeometry({parameters:{width:h,height:u,depth:c}}),e.invalidateDownstreamBooleanData()}})}}function dJ(e,t,r,i){if(t.intensity!==void 0){let n=e.intensity,s=t.intensity;n!==s&&r.push({change:a=>{e.intensity=kt.lerp(n,s,a)}})}if(t.color!==void 0){let n=e.color.clone(),s=typeof t.color=="string"?i.getColor(t.color):t.color;if(!Di.equals(n,s)){let a=n.clone();e.color=a,r.push({change:o=>{let{r:l,g:h,b:u}=Di.lerp(n,s,o);a.setRGB(l,h,u)}})}}}function fJ(e,t,r,i){var s,a;let n=e.layersList.head;for(;n;){let o=t.layers.data(n.uuid);if(o&&((s=n.visible)!=null?s:!0)&&((a=o.visible)!=null?a:!0)){let l=n.getNames().filter(h=>!oW.some(u=>h.includes(u)));for(let h of l)try{let u=n.getValue(h);if(h==="steps")xJ(n,o,h,r);else if(h==="colors")wJ(n,o,h,r);else if(typeof u=="number")pJ(n,o,h,r);else{if(typeof u=="boolean")continue;"isVector2"in u?mJ(n,o,h,r):"isVector3"in u?gJ(n,o,h,r):"isColorA"in u?yJ(n,o,h,r,i):"isColor"in u?vJ(n,o,h,r,i):"isTexture"in u&&bJ(n,o,h,r)}}catch(u){console.error(`animateMaterial: unexpected material layer for ${h}`,u)}}n=n.next}}function pJ(e,t,r,i){if(!e.hasValue(r)||!(r in t))return;let n=e.getValue(r),s=t[r];n!==s&&i.push({change:a=>{e.setValue(r,kt.lerp(n,s,a))}})}function mJ(e,t,r,i){if(!e.hasValue(r)||!(r in t))return;let n=e.getValue(r),s=n.toArray(),a=t[r];Bo.isEqual(s,a)||i.push({change:o=>{n.fromArray(Bo.lerp(s,a,o))}})}function gJ(e,t,r,i){if(!e.hasValue(r)||!(r in t))return;let n=e.getValue(r),s=n.toArray(),a=t[r];wi.isEqual(s,a)||i.push({change:o=>{n.fromArray(wi.lerp(s,a,o))}})}function vJ(e,t,r,i,n){if(!e.hasValue(r)||!(r in t))return;let s=e.getValue(r).clone(),a=t[r],o=typeof a=="string"?n.getColor(a):a;if(Di.equals(s,o))return;let l=s.clone();e.setValue(r,l),i.push({change:h=>{let{r:u,g:c,b:d}=Di.lerp(s,o,h);l.setRGB(u,c,d)}})}function yJ(e,t,r,i,n){if(!e.hasValue(r)||!(r in t))return;let s=e.getValue(r).clone(),a=t[r],o=typeof a=="string"?n.getColor(a):a;if(Va.equals(s,o))return;let l=s.clone();e.setValue(r,l),i.push({change:h=>{let{r:u,g:c,b:d,a:f}=Va.lerp(s,o,h);l.setRGBA(u,c,d,f)}})}function xJ(e,t,r="steps",i){if(!e.hasValue(r)||!(r in t))return;let n=[...e.getValue(r)],s=t[r];for(let a=0;a<n.length;++a){let o=n[a],l=s[a];o!==l&&i.push({change:h=>{n[a]=kt.lerp(o,l,h),e.setValue("steps",n)}})}}function wJ(e,t,r="colors",i){if(!e.hasValue(r)||!(r in t))return;let n=e.getValue(r),s=t[r];for(let a=0;a<n.length;++a){let o=n[a].toArray(),l=s[a];N0.isEqual(o,l)||i.push({change:h=>{n[a].fromArray(N0.lerp(o,l,h))}})}}function bJ(e,t,r="texture",i){if(!e.hasValue(r)||!(r in t))return;let n=e.getValue("texture"),s=t[r],a=n.repeat.toArray(),o=n.offset.toArray(),l=s.repeat,h=s.offset;(!Bo.isEqual(a,l)||!Bo.isEqual(o,h))&&i.push({change:u=>{n.repeat.fromArray(Bo.lerp(a,l,u)),n.offset.fromArray(Bo.lerp(o,h,u)),n.updateMatrix(),n.needsUpdate=!0}})}function _J(e,t,r,i){if(i===0)return r.copy(e);if(i===1)return r.copy(t);let n=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(n>=1)return r.copy(e);let s=1-n*n;if(s<=Number.EPSILON){let u=1-i;return r.w=u*e.w+i*t.w,r.x=u*e.x+i*t.x,r.y=u*e.y+i*t.y,r.z=u*e.z+i*t.z,r.normalize(),r}let a=Math.sqrt(s),o=Math.atan2(a,n),l=Math.sin((1-i)*o)/a,h=Math.sin(i*o)/a;return r.w=e.w*l+t.w*h,r.x=e.x*l+t.x*h,r.y=e.y*l+t.y*h,r.z=e.z*l+t.z*h,r}function SJ(e,t,r=0){let i=Array.isArray(e.material)?e.material[r]:e.material,n;return"materials"in t?n=t.materials[r]:"material"in t&&(n=t.material),[i,n]}var mx=new F,gx=new F,ZA=new yn,MJ=new Hl,AJ=new wt;function EJ(e,t,r,i){if(r.position!==void 0){let n=e.position.toArray(),s=r.position;wi.isEqual(n,s)||i.push({change:a=>{e.position.fromArray(wi.lerp(n,s,a)),e.updateMatrix(),Mi(e)&&Mr(e.parent)&&e.invalidateDownstreamBooleanData(!0)}})}if(r.scale!==void 0){let n=e.scale.toArray(),s=r.scale;wi.isEqual(n,s)||i.push({change:a=>{e.scale.fromArray(wi.lerp(n,s,a)),e.updateMatrix(),Mi(e)&&Mr(e.parent)&&e.invalidateDownstreamBooleanData(!0)}})}CJ(e,t,r,i),TJ(e,r,i)}function CJ(e,t,r,i){if(r.rotation===void 0)return;let n=mx.setFromEuler(e.rotation).toArray(),s=r.rotation;if(!wi.isEqual(n,s))if(wi.sub(r.rotation,t?t.rotation:e.rotation).every(a=>Math.abs(a)<2*Math.PI)){let a=e.quaternion.clone(),o=new yn().setFromEuler(MJ.set(r.rotation[0],r.rotation[1],r.rotation[2]));i.push({change:l=>{_J(a,o,e.quaternion,l),e.updateMatrix(),Mi(e)&&Mr(e.parent)&&e.invalidateDownstreamBooleanData(!0)}})}else i.push({change:a=>{e.rotation.setFromVector3(gx.fromArray(wi.lerp(n,s,a))),e.updateMatrix(),Mi(e)&&Mr(e.parent)&&e.invalidateDownstreamBooleanData(!0)}})}function TJ(e,t,r){if(t.hiddenMatrix!==void 0&&!jl.isEqual(e.hiddenMatrix.toArray(),t.hiddenMatrix)){let i=new F,n=new yn,s=new F;e.hiddenMatrix.decompose(i,n,s);let a=new F,o=new yn,l=new F;AJ.fromArray(t.hiddenMatrix).decompose(a,o,l),r.push({change:h=>{ZA.slerpQuaternions(n,o,h),mx.lerpVectors(i,a,h),gx.lerpVectors(s,l,h),e.hiddenMatrix.compose(mx,ZA,gx),Mi(e)&&Mr(e.parent)&&e.invalidateDownstreamBooleanData(!0)}})}}function DJ(e,t,r,i){let n=[];if((e.visible||Mr(e.parent))&&EJ(e,t==null?void 0:t.objectState,r.objectState,n),Mi(e)){if((e.visible||Mr(e.parent))&&"geometry"in r.objectState&&cJ(e,r.objectState.geometry,n),e.visible&&("material"in r.objectState||"materials"in r.objectState)){let[s,a]=SJ(e,r.objectState,e.selectedMaterial);s&&a&&typeof a!="string"&&fJ(s,a,n,i)}}else e.visible&&gY(e)?dJ(e,r.objectState,n,i):mY(e)&&uJ(e,r.objectState,n);return n.length?{change:s=>{n.forEach(a=>{a.change&&a.change(s)})}}:void 0}function PJ(e,t,r){switch(e){case 0:return"cubicBezier( 0, 0, 1, 1 )";case 1:return"cubicBezier( .25, .1, .25, 1 )";case 2:return"cubicBezier( .42, 0, 1, 1 )";case 3:return"cubicBezier( 0, 0, .58, 1 )";case 4:return"cubicBezier( .42, 0, .58, 1 )";case 5:let{control1:i,control2:n}=t!=null?t:me({},Oy.defaultData);return`cubicBezier( ${i[0]}, ${i[1]}, ${n[0]}, ${n[1]} )`;case 6:let{mass:s,stiffness:a,damping:o,velocity:l}=r!=null?r:me({},Ry.defaultData);return`spring( ${s}, ${a}, ${o}, ${l} )`}}var LJ=class{constructor(e,t){this.object=e,this.sharedAssets=t,this.uuid=kt.generateUUID(),this.states=[],this.events={},this.animatingState=0,this._scrollCounter=null}get fromState(){return this._fromState}get animation(){return this._animation}start(){this._animation!==void 0&&(this._animation.pause(),this._animation=void 0,this._scrollCounter=null),this.states.length>1&&(this.states[0].execute(this.object,this.sharedAssets),this._toState=this.states[0],this._fromState=void 0)}end(){this._animation!==void 0&&(this._animation.pause(),this._animation=void 0),this.states.length>1&&this.states[0].execute(this.object,this.sharedAssets),this._toState=void 0,this._fromState=void 0}seek(e,t,r,i,n){var s;this._scrollCounter===null&&(this.animate(e,i,n),this._scrollCounter=0),this._scrollCounter+=t,this._scrollCounter=Math.min(Math.max(this._scrollCounter,0),r),(s=this._animation)==null||s.seek(this._scrollCounter/r*(i.duration?i.duration:1))}animate(e,t,r){var i,n,s,a,o,l,h;if(this._fromState===e&&((i=this._animation)==null?void 0:i.reversed)){let u=(s=(n=this._animation)==null?void 0:n.currentTime)!=null?s:0;(a=this._animation)==null||a.reset(),(o=this._animation)==null||o.seek(u),(l=this._animation)==null||l.play()}else if(this._toState!==e){this._animation!==void 0&&this._animation.pause(),this.animatingState=0,this._fromState=this._toState,this._toState=e;let u=DJ(this.object,this._fromState,e,this.sharedAssets);if(!u)return;let c={t:0};this._animation=hJ({autoplay:!1,loop:t.repeat?!0:t.cycle?1:!1,direction:t.cycle?"alternate":"normal",rewind:t.rewind,delay:t.startDelay,endDelay:t.endDelay,duration:t.duration,easing:PJ(t.easing,t.cubicControls,t.springParameters),targets:c,t:1,change:()=>{u.change&&u.change(c.t),r!=null&&r.change&&r.change(c.t)},loopBegin:d=>{if(this.animatingState===0){this.animatingState=1;return}d.reversed?(this._toState=this._fromState,this._fromState=e):(this._fromState=this._toState,this._toState=e)}}),t.autoplay?t.startOnceDelay>0?setTimeout(()=>{var d;return(d=this._animation)==null?void 0:d.play()},t.startOnceDelay):(h=this._animation)==null||h.play():this._animation.finished.then(()=>{this._animation=void 0,this.animatingState=0})}}emitEvent(e,t){var r;if(e==="keyDown"||e==="keyUp"||e==="mouseDown"||e==="mouseUp"||e==="mouseHover"||e==="scroll"||e==="start"){let i=this.events[e];if(i){for(let n of i)if("targets"in n)for(let{object:s,state:a,params:o}of n.targets)(r=s.interaction)==null||r.animate(a,o,{change:t})}}}emitEventReverse(e,t){if(e==="keyDown"||e==="keyUp"||e==="mouseDown"||e==="mouseUp"||e==="mouseHover"||e==="scroll"||e==="start"){let r=this.events[e];if(r){for(let i of r)if("targets"in i)for(let{object:n,params:s}of i.targets){let a=n.interaction;(a==null?void 0:a._fromState)!==void 0&&a.animate(a._fromState,s,{change:t})}}}}},XD=class{static create(e,t){var r,i,n,s,a,o;if(e.object){let l=t.find(e.object);if(l!=null&&l.interaction){let h=e.state?l.interaction.states.find(u=>u.uuid===e.state):l.interaction.states[0];if(h){let u=(r=e.delay)!=null?r:0,c={cycle:(i=e.cycle)!=null?i:!1,rewind:(n=e.rewind)!=null?n:!1,repeat:(s=e.repeat)!=null?s:!1,duration:(a=e.duration)!=null?a:1e3,startOnceDelay:e.delayDirection==="start-once"?u:0,startDelay:e.delayDirection==="start"||!e.delayDirection?u:0,endDelay:e.delayDirection==="end"||!e.delayDirection?u:0,easing:(o=e.easing)!=null?o:4,autoplay:!0};if(e.easing===5){let d=e;c.cubicControls={control1:[...d.control1],control2:[...d.control2]}}if(e.easing===6){let d=e;c.springParameters={mass:d.mass,stiffness:d.stiffness,damping:d.damping,velocity:d.velocity}}return new XD(l,h,c)}}}}constructor(e,t,r){this.object=e,this.state=t,this.params=r}},Wv=new Map,id={url:"head",time:0,data:null,next:null,prev:null},Qh={url:"tail",time:1/0,data:null,next:null,prev:null};id.next=Qh;Qh.prev=id;var $A=0;function Nd(e){if(typeof e=="string")return e;let t=Date.now(),r=Wv.get(e);return r===void 0?(r={url:URL.createObjectURL(new Blob([e])),data:e,time:t,next:null,prev:null},Wv.set(e,r)):(r.time=t,r.prev.next=r.next,r.next.prev=r.prev),r.prev=Qh.prev,r.next=Qh,Qh.prev.next=r,Qh.prev=r,t-$A>1e3*10&&($A=t+1e3,setTimeout(()=>{let i=Date.now(),n=id.next;for(;n.time<i-1e3*10;)URL.revokeObjectURL(n.url),Wv.delete(n.data),n=n.next,n.prev=id,id.next=n},900)),r.url}var eE=new Za,q0=class extends ia{},RJ=class{constructor(e){this.materials={},this.images={},this.colors={},this.transmissionRenderTarget=new Or(2048,2048,{generateMipmaps:!0,minFilter:Ou,magFilter:Wt,wrapS:Ti,wrapT:Ti}),this.transmissionRenderTarget.depthTexture=new Em(2048,2048),this.penumbraSizeNode=new Fa(5,e.penumbraSize),this.reset(e)}reset(e){for(let[t,r]of Object.entries(e.images))this.addImage(t,r.data);for(let[t,r]of Object.entries(e.colors))this.addColor(t,r);for(let[t,r]of Object.entries(e.materials))this.addMaterial(t,tD(r,this))}get transmissionSamplerMap(){return this.transmissionRenderTarget.texture}get transmissionDepthMap(){return this.transmissionRenderTarget.depthTexture}addMaterial(e,t){t.uuid=e,this.materials[e]=t}deleteMaterial(e){this.materials[e]&&(this.materials[e].dispose(),delete this.materials[e])}isSharedMaterial(e){return e.uuid in this.materials||e===eE}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){var t;return(t=this.materials[e])!=null?t:eE}getMaterials(){return this.materials}addImage(e,t){if(this.images[e])return this.images[e].onload=()=>{this.onImageLoad&&this.onImageLoad()},this.images[e].src=Nd(t),!0;{let r=new Image;return r.src=Nd(t),r.onload=()=>{this.onImageLoad&&this.onImageLoad()},this.images[e]=r,!1}}deleteImage(e){this.images[e]&&delete this.images[e]}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]}getImages(){return this.images}addColor(e,t){return this.colors[e]?("a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new q0(t.r,t.g,t.b,t.a):this.colors[e]=new q0(t.r,t.g,t.b,1),!1)}updateColor(e,t){var r,i,n,s;if(this.colors[e]){let a=this.colors[e];return this.colors[e].r=(r=t.r)!=null?r:a.r,this.colors[e].g=(i=t.g)!=null?i:a.g,this.colors[e].b=(n=t.b)!=null?n:a.b,this.colors[e].a=(s=t.a)!=null?s:a.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this.transmissionRenderTarget.depthTexture.dispose(),this.transmissionRenderTarget.dispose(),this.onImageLoad=void 0}};function OJ(e,t){switch(e.type){case"noise":return t==="noiseType";case"texture":return t==="projection"||t==="axis"||t==="side";case"displace":return t==="noiseType";case"depth":return t==="num"||t==="smooth"||t==="isWorldSpace"||t==="gradientType";default:return!1}}function tE(e,t,r,i,n){var a;let s=!1;for(let[o,l]of Object.entries(e)){if(!o||l===void 0||eD(o,r,n))continue;r.visible=n.visible;let h=r.uniforms[`f${r.id}_${o}`];if(h)switch(h.constructor){case Rr:if(typeof l=="string"){let u=t.getColor(l);u&&(h.value=u);break}else{let u=l;h.value instanceof q0?h.value=new ia(u.r,u.g,u.b,u.a):h.setRGBA(u);break}case Xh:if(typeof l=="string"){let u=t.getColor(l);u&&(h.value=u);break}else{let u=l;h.value instanceof q0?h.value=new ia(u.r,u.g,u.b,u.a):h.value.setRGBA(u.r,u.g,u.b,u.a);break}case Dn:{let u=l;h.value.setX(u[0]),h.value.setY(u[1]);break}case On:{let u=l;h.value.setX(u[0]),h.value.setY(u[1]),h.value.setZ(u[2]);break}case Vs:{let u=l;if("image"in u){let c=u.image;if(typeof c=="string"){let d=t.getImage(c);d&&(h.value.image=d)}else{let d=new Image;d.src=Nd(c.data),h.value.image=d}}"wrapping"in u&&(h.value.wrapS=h.value.wrapT=u.wrapping),"repeat"in u&&h.value.repeat.fromArray(u.repeat),"offset"in u&&h.value.offset.fromArray(u.offset),h.value.needsUpdate=!0;break}case Ic:{l.forEach((u,c)=>{h.value[c].setX(u[0]),h.value[c].setY(u[1]),h.value[c].setZ(u[2]),h.value[c].setW(u[3])});break}default:{s=s||OJ(r,o),h.value=l;break}}}if(s&&n){let o=Z6({id:"0",fi:0,data:n},t);(a=i.userData.layers)==null||a.changeLayer(r.id,me({},o)),i.dispose(),i.needsUpdate=!0}}var qv=new F,rE=new Ns,iE=new wt,Yp={type:"follow",normal:new F,raycaster:new mb},Y0;(e=>{function t(i){if(i.type===10)return{type:"follow"}}e.create=t;function r({target:i,normal:n,raycaster:s,begin:a,change:o}){!i||!n||!s||(a&&a("follow",i.uuid),rE.setFromNormalAndCoplanarPoint(n,i.getWorldPosition(qv)),s.ray.intersectPlane(rE,qv),i.position.copy(qv),i.parent!==null&&i.position.applyMatrix4(iE.copy(i.parent.matrixWorld).invert()),i.position.applyMatrix4(iE.copy(i.hiddenMatrix).invert()),i.updateMatrix(),Mi(i)&&Mr(i.parent)&&i.invalidateDownstreamBooleanData(!0),o&&o())}e.listener=r})(Y0||(Y0={}));var Yv=new F,nE=new Ns,Xp={type:"lookAt",normal:new F,raycaster:new mb},X0;(e=>{function t(i){if(i.type===9&&i.distance)return{type:"lookAt",distance:i.distance}}e.create=t;function r({target:i,normal:n,raycaster:s,begin:a,change:o}){var h,u,c;if(!((u=(h=i==null?void 0:i.interaction)==null?void 0:h.events.lookAt)!=null&&u.length)||!n||!s)return;a&&a("lookAt",i.uuid);let l=i.interaction.events.lookAt[0].distance;nE.set(n,-l),s.ray.intersectPlane(nE,Yv),i.lookAt(Yv),i.updateMatrix(),(c=i.interaction.animation)==null||c.finished.then(()=>{i.lookAt(Yv),i.updateMatrix(),Mi(i)&&Mr(i.parent)&&i.invalidateDownstreamBooleanData(!0)}),Mi(i)&&Mr(i.parent)&&i.invalidateDownstreamBooleanData(!0),o&&o()}e.listener=r})(X0||(X0={}));var QD={type:"start"},Q0;(e=>{function t(i){if(i.type===7)return{type:"start",targets:[]}}e.create=t;function r({target:i,begin:n,change:s}){var o,l;if(!((l=(o=i==null?void 0:i.interaction)==null?void 0:o.events.start)!=null&&l.length))return;n&&n("start",i.uuid);let a={change:s};i.interaction.events.start.forEach(h=>{h.targets.forEach(({object:u,state:c,params:d})=>{var f;return(f=u.interaction)==null?void 0:f.animate(c,d,a)})})}e.listener=r})(Q0||(Q0={}));var vx={type:"scroll"},J0;(e=>{function t(i){if(!(i.type!==11||i.steps===void 0))return{type:"scroll",targets:[],steps:i.steps}}e.create=t;function r({target:i,deltaY:n,begin:s,change:a}){var h,u;if(!((u=(h=i==null?void 0:i.interaction)==null?void 0:h.events.scroll)!=null&&u.length)||!n)return;s&&s("scroll",i.uuid);let o={change:a},l=n>0?1:-1;i.interaction.events.scroll.forEach(c=>{c.targets.forEach(({object:d,state:f,params:p})=>{var g;let m=qe(me({},p),{autoplay:!1});(g=d.interaction)==null||g.seek(f,l,c.steps,m,o)})})}e.listener=r})(J0||(J0={}));var Bc={type:"mouseHover"},K0;(e=>{function t(i){if(i.type===2)return{type:"mouseHover",targets:[]}}e.create=t;function r({target:i,begin:n,change:s,enter:a}){var l,h;if(!((h=(l=i==null?void 0:i.interaction)==null?void 0:l.events.mouseHover)!=null&&h.length)||a===void 0)return;n&&n("mouseHover",i.uuid);let o={change:s};a?i.interaction.events.mouseHover.forEach(u=>{u.targets.forEach(({object:c,state:d,params:f})=>{var p;(p=c.interaction)==null||p.animate(d,f,o)})}):i.interaction.events.mouseHover.forEach(u=>{u.targets.forEach(({object:c,params:d})=>{let f=c.interaction;(f==null?void 0:f.fromState)!==void 0&&f.animate(f.fromState,d,o)})})}e.listener=r})(K0||(K0={}));var JD={type:"mouseDown"},KD={type:"mouseUp"},yx={type:"keyDown"},xx={type:"keyUp"},Sl;(e=>{function t(i){var a,o;let n,s;if(i.type===0)n={type:"mousedown"},s="mouseDown";else if(i.type===1)n={type:"mouseup"},s="mouseUp";else if(i.type===5){if(!i.key)return;n={type:"keydown",key:i.key},s="keyDown"}else if(i.type===6){if(!i.key)return;n={type:"keyup",key:i.key},s="keyUp"}else return;return{type:s,domEvent:n,targets:[],url:(a=i.url)!=null?a:void 0,toggle:(o=i.toggle)!=null?o:!1,enable:!1}}e.create=t;function r({target:i,interactionEvents:n,type:s,begin:a,change:o}){var h;if(!i)return;n||(n=(h=i.interaction)==null?void 0:h.events[s]),a&&a(s,i.uuid);let l={change:o};n.forEach(u=>{if(u.toggle){u.enable=!u.enable;for(let{object:c,state:d,params:f}of u.targets){let p=c.interaction;if(p!==void 0){let m=qe(me({},f),{cycle:!1,rewind:!1,repeat:!1});u.enable?p.animate(d,m,l):p.fromState!==void 0&&p.animate(p.fromState,m,l)}}}else u.targets.forEach(({object:c,state:d,params:f})=>{var p;return(p=c.interaction)==null?void 0:p.animate(d,f,l)});u.url&&(I0?window.location.assign(u.url):window.open(u.url,"_blank"))})}e.listener=r})(Sl||(Sl={}));function IJ(e){let t,{type:r}=e;return r===10?t=Y0.create(e):r===0||r===1||r===5||r===6?t=Sl.create(e):r===9?t=X0.create(e):r===2?t=K0.create(e):r===11?t=J0.create(e):r===7&&(t=Q0.create(e)),t}function NJ(e,t,r){let i=[];e.objects.traverse((n,s)=>{let a=t.find(n);if(delete a.interaction,!s.visible&&!Mr(a.parent)||s.states===void 0)return;let o=new LJ(a,r),l=o.states;l.push(wx.create(n,s));for(let u of s.states){let c=H0.patch(s,u.data);l.push(wx.create(u.id,c))}let h=o.events;if(s.events)for(let{data:u}of s.events){let c=IJ(u);if(!c)continue;let d=c.type;h[d]?h[d].push(c):h[d]=[c],"targets"in u&&i.push([u,c])}(l.length>0||Object.keys(h).length>0)&&(a.interaction=o)});for(let[n,s]of i)if("targets"in n&&"targets"in s)for(let{data:a}of n.targets){let o=XD.create(a,t);o&&s.targets.push(o)}}function BJ(e,t,r,i,n=!1){if(!n&&t.states.length===0)return;let s=r===null?t:H0.patch(t,t.states.data(r));if(iD(e,s),e instanceof Bi&&s.type==="Mesh"){if(e instanceof Sb?e.buildFromStore(s.geometry):e.updateGeometry({parameters:s.geometry}),e.freeBooleanPointer(),Mr(e.parent)&&e.parent.invalidateDownstreamBooleanData().recomputeBoolean(),"material"in s){if(e.material instanceof Array)return;if(typeof s.material!="string"){let o=s.material.layers;for(let l of o){let h=e.material.userData.layers.getLayerByUuid(l.id);tE(l.data,i,h,e.material,l.data)}}}else if("materials"in s){if(!(e.material instanceof Array))return;var a=0;for(let o of s.materials){if(typeof o!="string"){let l=o.layers;for(let h of l){let u=e.material[a].userData.layers.getLayerByUuid(h.id);tE(h.data,i,u,e.material[a],h.data)}}a++}}}else if(s.type==="DirectionalLight")e.fromDirectionalLightState(s,i);else if(s.type==="PointLight")e.fromPointLightState(s,i);else if(s.type==="SpotLight")e.fromSpotLightState(s,i);else if(e instanceof Mu&&Rd.is(s.type)){let o=s;e.setZoom("PerspectiveCamera",o.perspective.zoom),e.setZoom("OrthographicCamera",o.orthographic.zoom),e.isUpVectorFlipped=o.isUpVectorFlipped,e.targetOffset=o.targetOffset}}var wx=class{constructor(e){this.objectState=e,this.uuid=kt.generateUUID()}static create(e,t){let r=new wx(t);return r.uuid=e,r}execute(e,t){BJ(e,this.objectState,null,t,!0)}},Cs=new mb,En=new F,Xv={follow:Y0.listener,keyDown:Sl.listener,keyUp:Sl.listener,lookAt:X0.listener,mouseDown:Sl.listener,mouseUp:Sl.listener,mouseHover:K0.listener,scroll:J0.listener,start:Q0.listener},sE={follow:Yp,keyDown:yx,keyUp:xx,lookAt:Xp,mouseDown:JD,mouseUp:KD,mouseHover:Bc,scroll:vx,start:QD};function kJ(e){if(e.style.transform!==""){let t=getComputedStyle(e).getPropertyValue("transform");if(t!=="none"){let r=t.replace("matrix(","").split(",");return{x:parseFloat(r[0]),y:parseFloat(r[3])}}}return{x:1,y:1}}function aE(e){let t=e.getViewport(new Tt),r=kJ(e.domElement);return{left:t.x*r.x,top:t.y*r.y,width:t.z*r.x,height:t.w*r.y}}function Qv(e,t){if(Mi(t)){if(!t.raycastLock&&t.visible){let r=e.intersectObject(t,!1);return r.length?r[0]:void 0}}else if(t.objectType==="EmptyObject")return ZD(e,t)}function ZD(e,t){if(Mi(t)&&!t.raycastLock&&t.visible){let r=e.intersectObject(t,!1);if(r.length)return r[0]}for(let r of t.children)if(td(r)){let i=ZD(e,r);if(i)return i}}var zJ=class{constructor(e,t,r,i){this.isEnable=!1,this.splineEvents={},this._map={},this._prevObjects=[],this._onMouseDown=n=>{Cs.setFromCamera(this._getPointer(n.clientX,n.clientY),this._camera),this._camera.getWorldDirection(En),En.negate(),this._handleMouseDownEvent(n)},this._onMouseUp=n=>{Cs.setFromCamera(this._getPointer(n.clientX,n.clientY),this._camera),this._camera.getWorldDirection(En),En.negate(),this._handleMouseUpEvent(n)},this._onMouseMove=n=>{Cs.setFromCamera(this._getPointer(n.clientX,n.clientY),this._camera),this._camera.getWorldDirection(En),En.negate(),this._handleMouseHoverEvent(n),this._handleLookAtEvent(n),this._handleFollowEvent(n)},this._onTouchStart=n=>{n.touches.length===1&&(Cs.setFromCamera(this._getPointer(n.touches[0].clientX,n.touches[0].clientY),this._camera),this._camera.getWorldDirection(En),En.negate(),this._handleMouseDownEvent(n),this._handleMouseHoverEvent(n),this._handleLookAtEvent(n),this._handleFollowEvent(n))},this._onTouchEnd=n=>{this._handleMouseUpEvent(n),this._handleMouseHoverEvent(n,!0)},this._onTouchMove=n=>{n.touches.length===1&&(Cs.setFromCamera(this._getPointer(n.touches[0].clientX,n.touches[0].clientY),this._camera),this._camera.getWorldDirection(En),En.negate(),this._handleMouseHoverEvent(n),this._handleLookAtEvent(n),this._handleFollowEvent(n))},this._onWheel=n=>{this._handleWheelEvent(n)},this._onKeyDown=n=>{this._handleKeyDownEvent(n)},this._onKeyUp=n=>{this._handleKeyUpEvent(n)},this._renderer=e,this._domElement=e.domElement,this._camera=r,this._scene=t,this._app=i,this._domRect=this._domElement.getBoundingClientRect(),this._viewRect=aE(e)}activate(){var e,t,r,i,n,s,a,o,l,h,u,c,d,f,p,m,g,v;this.isEnable=!0,this._map={},this._scene.traverseEntity(x=>{x.interaction!==void 0&&(x.interaction.start(),Object.keys(x.interaction.events).forEach(b=>{let _=b;this._addDOMCustomEvent(_,x),(x.visible||_!=="mouseDown"&&_!=="mouseUp"&&_!=="mouseHover")&&this._addSPEEvent(_,x)}))}),U5?((((e=this._map.mouseDown)==null?void 0:e.length)||((t=this._map.mouseHover)==null?void 0:t.length)||((r=this._map.lookAt)==null?void 0:r.length)||((i=this._map.follow)==null?void 0:i.length))&&this._domElement.addEventListener("touchstart",this._onTouchStart),(((n=this._map.mouseUp)==null?void 0:n.length)||((s=this._map.mouseHover)==null?void 0:s.length))&&this._domElement.addEventListener("touchend",this._onTouchEnd),(((a=this._map.mouseHover)==null?void 0:a.length)||((o=this._map.lookAt)==null?void 0:o.length)||((l=this._map.follow)==null?void 0:l.length))&&this._domElement.addEventListener("touchmove",this._onTouchMove)):((h=this._map.mouseDown)!=null&&h.length&&this._domElement.addEventListener("pointerdown",this._onMouseDown),(u=this._map.mouseUp)!=null&&u.length&&this._domElement.addEventListener("pointerup",this._onMouseUp),(((c=this._map.mouseHover)==null?void 0:c.length)||((d=this._map.lookAt)==null?void 0:d.length)||((f=this._map.follow)==null?void 0:f.length))&&this._domElement.addEventListener("pointermove",this._onMouseMove)),(p=this._map.scroll)!=null&&p.length&&this._domElement.addEventListener("wheel",this._onWheel),(m=this._map.keyDown)!=null&&m.length&&document.addEventListener("keydown",this._onKeyDown),(g=this._map.keyUp)!=null&&g.length&&document.addEventListener("keyup",this._onKeyUp),(v=this._map.start)!=null&&v.length&&this._handleStartEvent(),this.resize()}deactivate(){this._scene.traverseEntity(e=>{if(!e.interaction)return;e.interaction.end();let t=e;Object.keys(Xv).forEach(r=>{let i=r;t.removeEventListener(i,Xv[i])})}),this._domElement.removeEventListener("pointerdown",this._onMouseDown),this._domElement.removeEventListener("pointerup",this._onMouseUp),this._domElement.removeEventListener("pointermove",this._onMouseMove),this._domElement.removeEventListener("touchstart",this._onTouchStart),this._domElement.removeEventListener("touchend",this._onTouchEnd),this._domElement.removeEventListener("touchmove",this._onTouchMove),this._domElement.removeEventListener("wheel",this._onWheel),document.removeEventListener("keydown",this._onKeyDown),document.removeEventListener("keyup",this._onKeyUp),this._map={},this.isEnable=!1}reset(){this._scene.traverseEntity(e=>{var t;(t=e.interaction)==null||t.start()}),this._handleStartEvent()}resize(){this._domRect=this._domElement.getBoundingClientRect(),this._viewRect=aE(this._renderer)}_getPointer(e,t){let r=this._domRect,i=this._viewRect,n=r.height-i.height,s=(e-i.left-r.left)*(r.width/i.width),a=(t-n+i.top-r.top)*(r.height/i.height);return{x:s/r.width*2-1,y:-(a/r.height)*2+1}}_handleStartEvent(){var e;(e=this._map.start)==null||e.forEach(t=>{t.dispatchEvent(QD)})}_handleWheelEvent(e){var t;(t=this._map.scroll)!=null&&t.length&&(vx.deltaY=e.deltaY,this._map.scroll.forEach(r=>{r.dispatchEvent(vx)}))}_handleMouseDownEvent(e){var t;(t=this._map.mouseDown)==null||t.forEach(r=>{Qv(Cs,r)&&r.dispatchEvent(JD)})}_handleMouseUpEvent(e){var t;(t=this._map.mouseUp)==null||t.forEach(r=>{Qv(Cs,r)&&r.dispatchEvent(KD)})}_handleMouseHoverEvent(e,t=!1){var i;let r=[];t||((i=this._map.mouseHover)==null||i.forEach(n=>{Qv(Cs,n)&&r.push(n)})),this._prevObjects.length&&(Bc.enter=!1,this._prevObjects.forEach(n=>{r.includes(n)||n.dispatchEvent(Bc)})),r.length&&(Bc.enter=!0,r.forEach(n=>{n.dispatchEvent(Bc)})),this._prevObjects=r}_handleLookAtEvent(e){var t;(t=this._map.lookAt)!=null&&t.length&&(Xp.normal=En,Xp.raycaster=Cs,this._map.lookAt.forEach(r=>{r.dispatchEvent(Xp)}))}_handleFollowEvent(e){this._map.follow&&(Yp.normal=En,Yp.raycaster=Cs,this._map.follow.forEach(t=>t.dispatchEvent(Yp)))}_handleKeyDownEvent(e){var t;(t=this._map.keyDown)==null||t.forEach(r=>{var i,n,s;yx.interactionEvents=(s=(n=(i=r.interaction)==null?void 0:i.events)==null?void 0:n.keyDown)==null?void 0:s.filter(a=>a.domEvent.type==="keydown"&&a.domEvent.key===e.key),r.dispatchEvent(yx)})}_handleKeyUpEvent(e){var t;(t=this._map.keyUp)==null||t.forEach(r=>{var i,n,s;xx.interactionEvents=(s=(n=(i=r.interaction)==null?void 0:i.events)==null?void 0:n.keyUp)==null?void 0:s.filter(a=>a.domEvent.type==="keyup"&&a.domEvent.key===e.key),r.dispatchEvent(xx)})}_addSPEEvent(e,t){var r;!t.interaction||(sE[e].begin=this._dispatchDOMCustomEvent.bind(this),sE[e].change=this._app.requestRender.bind(this),(r=t.interaction.events[e])!=null&&r.length&&(t.addEventListener(e,Xv[e]),this._map[e]===void 0?this._map[e]=[t]:this._map[e].push(t)))}_addDOMCustomEvent(e,t){if(e){let r=new CustomEvent(e,{bubbles:!0});Object.defineProperty(r,"target",{writable:!1,value:{id:t.uuid,name:t.name}}),this.splineEvents[e]?this.splineEvents[e][t.uuid]=r:this.splineEvents[e]={[t.uuid]:r}}}_dispatchDOMCustomEvent(e,t){var i;let r=(i=this.splineEvents[e])==null?void 0:i[t];r&&this._domElement.dispatchEvent(r)}},FJ=class{constructor(e,t,r,i,n){this._aspect=1,this._renderer=e,this._camera=t,this._frameSize=new $().copy(r),this._editorSize=new $().copy(i),this._aspect=t.aspect,this._fov=n!=null?n:t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y,!1)}updateViewportForImageExport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,r=this._editorSize.x,i=this._editorSize.y;this._aspect=e/t,this._camera.zoom*=Math.min(r/e,i/t),this._renderer.setViewport(0,0,e,t)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,r=this._editorSize.x,i=this._editorSize.y,n=0,s=0,a=e,o=t;e<r&&(n=(r-e)*.5,n=-n,a=r),t<i&&(s=(i-t)*.5,s=-s,o=i),this._aspect=a/o,this._renderer.setViewport(n,s,a,o)}updateCamera(){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let e=this._frameSize.y,t=this._editorSize.y,r=this._fov;if(e>t){let i=UJ(e,1080,2160,1,15)/100;r*=e/t,r*=1-i}this._camera.aspect=this._aspect,this._camera.fov=r,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y)}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t,!1)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t),this._camera.updateProjectionMatrix())}};function UJ(e,t,r,i,n){return(e-t)/(r-t)*(n-i)+i}var HJ=class{constructor(e){this.sharedAssets=new RJ(e.shared),this.scene=new CQ(e.scene,this.sharedAssets),this.scene.switchActiveCamera(this.scene.activeCamera)}reset(e,t){this.scene.clearScene(this.sharedAssets),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}dispose(){this.scene.dispose()}},GJ=class{constructor({x:e=10,y:t=10}){this._startTime=0;let r=document.getElementById("spe-perfs");r?this.element=r:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function VJ(e){let t;if(e.index)for(let r=0;r<e.index.array.length;r+=3)t=e.index.array[r],e.index.array[r]=e.index.array[r+2],e.index.array[r+2]=t}function Jv(e){return e==="SubdivObject"||e==="NonParametric"?e:"Mesh"}function jJ(e,t){let r={};return e.traverseEntity(i=>{var l;if(i.type!=="Mesh"||!("material"in i)||!i.visible||!(i instanceof Bi)||Array.isArray(i.material)||i&&i.interaction&&i.interaction.states.length>0)return;let n=i.parent;for(;n;){if(n instanceof Bi&&n.interaction&&n.interaction.states.length>1)return;n=n.parent}let s=i.material.uuid,a=t.shared.materials[s];if(a){if(!Yo.isMergable(a))return}else{let h=(l=t.scene.objects.get(i.uuid))==null?void 0:l.data;if(h&&"material"in h&&typeof h.material!="string"){if(!Yo.isMergable(h.material))return;s=Yo.getHash(h.material)}}r[s]||(r[s]={});let o=r[s][Jv(i.objectType)];if(o){if(o.push(i),i.cloner)for(let h of i.cloner.children)o.push(h)}else if(r[s][Jv(i.objectType)]=[i],i.cloner)for(let h of i.cloner.children)r[s][Jv(i.objectType)].push(h)}),r}function WJ(e){let t=0;return Object.values(e).forEach(r=>{Object.values(r).forEach(i=>{let n=i.length;n>t&&(t=n)})}),t}function qJ(e,t){let r=jJ(t,e),i=WJ(r),n=new Array(i),s=0,a=new Array(i),o=0,l=new Array(i),h=0,u=new Array(i),c=0;for(let d of Object.values(r))for(let f of Object.values(d)){if(o=0,h=0,f.forEach(m=>{m instanceof Bi&&(a[o++]=m.geometry.clone(),l[h++]=m)}),h<2)continue;for(let m=0;m<h;m++)l[m].updateWorldMatrix(!0,!1),a[m].applyMatrix4(l[m].matrixWorld),l[m].matrixWorld.determinant()<0&&VJ(a[m]);let p=lW(a.slice(0,o),!1);if(p){let m;switch(f[0].objectType){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),m=new Ji(p,l[0].material);break}default:{m=new Ji(p,l[0].material);break}}m.castShadow=l[0].castShadow,m.receiveShadow=l[0].receiveShadow,t.add(m);let g=v=>{c=0;for(let x of v)x.children&&g(x.children),x instanceof Bi&&(Array.isArray(x.material)||r[x.material.uuid]&&r[x.material.uuid][x.objectType]&&r[x.material.uuid][x.objectType].length>1||(u[c++]=x));for(let x=0;x<c;x++)t.attach(u[x])};for(let v=0;v<h;v++){let x=l[v];g(x.children),n[s++]=x}}}for(let d=0;d<s;d++)n[d].removeFromParent()}var YJ=new $,oE="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.",XJ=class{constructor(e,{autoRender:t=!1}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._skipRender=!0,this.autoRender=!1,this.disposed=!1,this.requestRender=()=>{this._skipRender=!1},this.render=()=>{var r,i,n;!this._renderer||(this._rafId=requestAnimationFrame(this.render),(r=this._perfs)==null||r.start(),!(!this.autoRender&&this._skipRender)&&(this._controls&&(this._controls.enableDamping||this._controls.autoRotate)?this._skipRender=!this._controls.update():this._skipRender=!0,this._playmode&&!this._playmode.isEnable&&this._playmode.activate(),this._scene&&this._camera&&(this._renderer.autoClear=!1,this._transmissionRenderTarget&&(this._renderer.setRenderTarget(this._transmissionRenderTarget),this._renderer.clear(),this._camera.layers.enable(0),this._camera.layers.disable(3),this._renderer.render(this._scene,this._camera),this._renderer.setRenderTarget(null),this._camera.layers.enable(3)),(i=this._scene.postprocessing)!=null&&i.enabled?(this._renderer.autoClear=!1,this._scene.postprocessing.render()):(this._renderer.autoClear=!0,this._renderer.render(this._scene,this._camera))),(n=this._perfs)==null||n.end()))},this.resize=z5(()=>{var r,i,n,s,a;!this._renderer||(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=YJ.set(this._viewportWidth,this._viewportHeight)),(r=this._frameView)==null||r.updateRenderer(),(i=this._scene)!=null&&i.postprocessing&&this._scene.postprocessing.resize(this._viewportWidth,this._viewportHeight,!1),this._viewportMode!==1&&((n=this._frameView)==null||n.updateViewport()),this._camera&&((s=this._frameView)==null||s.updateCamera(),this._camera.cameraType==="PerspectiveCamera"&&this._viewportMode===1&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()),(a=this._playmode)==null||a.resize(),this.requestRender())},10),this.canvas=e,this.autoRender=t,rD(),window.location.search.includes("perfs")&&(this._perfs=new GJ({x:10,y:10}))}async load(e){e.endsWith(".spline")?console.warn(oE+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(oE);let t=await(await fetch(e)).arrayBuffer();await this.start(t)}async start(e){var c;if(this.disposed)return;let t=await RQ(e);DA(t)&&await TY();let r=new HJ(t);if(window.location.search.includes("merge-geometries")){let d=performance.now();qJ(t,r.scene);let f=performance.now();console.log("Merged geometries in ",f-d," ms")}this._scene=r.scene,DA(t)&&this._scene.traverse(d=>{Mr(d)&&d.recomputeBoolean()}),this._sharedAssetsManager=r.sharedAssets,this._sharedAssetsManager.onImageLoad=()=>{this.requestRender()},NJ(t.scene,this._scene,this._sharedAssetsManager),this._camera=this._scene.activeCamera;let i=Object.values(t.frames)[0],n,s;if(i)if(i.preset==="fullscreen"){this._viewportMode=1;let{width:d,height:f}=window.getComputedStyle(this.canvas);this.canvas.parentElement&&(d==="300px"||d==="auto")?(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%",n=this.canvas.style.width):this._viewportWidth=this.canvas.clientWidth,this.canvas.parentElement&&(f==="150px"||f==="auto")?(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%",s=this.canvas.style.height):this._viewportHeight=this.canvas.clientHeight}else this._viewportMode=2,this._viewportWidth=i.size[0],this._viewportHeight=i.size[1],n=this._viewportWidth+"px",s=this._viewportHeight+"px";(c=this._scene.postprocessing)!=null&&c.enabled?(this._renderer=new my({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._scene.postprocessing.init({renderer:this._renderer,camera:this._camera,scene:this._scene}),this._scene.postprocessing.addEventListener("smaaloaded",this.requestRender)):this._renderer=new my({canvas:this.canvas,antialias:!0,alpha:!0,stencil:!0,depth:!0,powerPreference:"high-performance"}),n&&(this.canvas.style.width=n),s&&(this.canvas.style.height=s),this._scene.needsTransmission(void 0)&&(this._transmissionRenderTarget=new Or(2048,2048,{generateMipmaps:!0,minFilter:Ou,magFilter:Wt,wrapS:Ti,wrapT:Ti}),this._transmissionRenderTarget.depthTexture=new Em(2048,2048),this._scene.needsTransmission(this._transmissionRenderTarget)),this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._scene.postprocessing&&this._scene.postprocessing.resize(this._viewportWidth,this._viewportHeight,!1),this._renderer.shadowMap.enabled=!0,this._renderer.shadowMap.type=t.scene.environment.ambientLight.softShadows?Tw:vT,pY(t.scene.environment.ambientLight.softShadowQuality),this._renderer.setClearColor(this._scene.bgColor,this._scene.alpha),this._frameView=new FJ(this._renderer,this._camera,new $(this._viewportWidth,this._viewportHeight),new $(window.innerWidth,window.innerHeight)),this._publishData=t.scene.publish;let{enableRotate:a,enablePan:o,enableZoom:l,autoRotate:h,hoverRotatePanMode:u}=this._publishData.orbitControls;if((a||o||l||h||u!==0)&&(this._camera.interaction===void 0||this._camera.interaction.states.length<=1)&&(this._controls=new pW(this._camera,this._renderer.domElement),this._controls.fromJSON(this._publishData.orbitControls),this._controls.useKeyEvents=!1,this._controls.addEventListener("change",this.requestRender),this._controls.addEventListener("start",this.requestRender)),this._playmode=new zJ(this._renderer,this._scene,this._camera,this),this.resize(),this.render(),this.canvas.parentElement){let d=!0;this._resizeObserver=new ResizeObserver(()=>{if(d){d=!1;return}this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this.resize()}),this._resizeObserver.observe(this.canvas.parentElement)}}findObjectById(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){var r;let t=(r=this._scene)==null?void 0:r.getObjectByName(e);return this._createProxyObject(t)}getSplineEvents(){var e;return(e=this._playmode)==null?void 0:e.splineEvents}emitEvent(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEvent(e)}emitEventReverse(e,t){var r;(r=this.findObjectById(t)||this.findObjectByName(t))==null||r.emitEventReverse(e)}addEventListener(e,t){var r;(r=this._renderer)==null||r.domElement.addEventListener(e,t)}removeEventListener(e,t){var r;(r=this._renderer)==null||r.domElement.removeEventListener(e,t)}setZoom(e){var t;(t=this._controls)==null||t.zoomOut(e)}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this.resize()}dispose(){var e,t,r,i,n,s,a;this.disposed=!0,(e=this._playmode)==null||e.deactivate(),(t=this._scene)==null||t.dispose(),this._rafId&&cancelAnimationFrame(this._rafId),this._proxyObjectCache.forEach(o=>{QS.unsubscribe(o)}),(r=this._renderer)==null||r.dispose(),(i=this._transmissionRenderTarget)==null||i.dispose(),(s=(n=this._transmissionRenderTarget)==null?void 0:n.depthTexture)==null||s.dispose(),(a=this._sharedAssetsManager)==null||a.dispose(),this._resizeObserver&&this._resizeObserver.disconnect(),this.canvas.style.width="",this.canvas.style.height=""}_createProxyObject(e){if(e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let{requestRender:t}=this,r={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,emitEvent(n){var s;(s=e.interaction)==null||s.emitEvent(n,t)},emitEventReverse(n){var s;(s=e.interaction)==null||s.emitEventReverse(n,t)}},i=QS(r,(n,s)=>{var a;typeof e[n]!="object"&&((a=Object.getOwnPropertyDescriptor(e,n))==null?void 0:a.writable)&&(e[n]=s),this.requestRender(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,i),i}},QJ=Object.defineProperty,Z0=Object.getOwnPropertySymbols,$D=Object.prototype.hasOwnProperty,eP=Object.prototype.propertyIsEnumerable,lE=(e,t,r)=>t in e?QJ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hE=(e,t)=>{for(var r in t||(t={}))$D.call(t,r)&&lE(e,r,t[r]);if(Z0)for(var r of Z0(t))eP.call(t,r)&&lE(e,r,t[r]);return e},JJ=(e,t)=>{var r={};for(var i in e)$D.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&Z0)for(var i of Z0(e))t.indexOf(i)<0&&eP.call(e,i)&&(r[i]=e[i]);return r};function KJ(e){return function(t){e.forEach(function(r){typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var tP={exports:{}},qm={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZJ=Zs,$J=Symbol.for("react.element"),eK=Symbol.for("react.fragment"),tK=Object.prototype.hasOwnProperty,rK=ZJ.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,iK={key:!0,ref:!0,__self:!0,__source:!0};function rP(e,t,r){var i,n={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(i in t)tK.call(t,i)&&!iK.hasOwnProperty(i)&&(n[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)n[i]===void 0&&(n[i]=t[i]);return{$$typeof:$J,type:e,key:s,ref:a,props:n,_owner:rK.current}}qm.Fragment=eK;qm.jsx=rP;qm.jsxs=rP;tP.exports=qm;const nK=tP.exports.jsx;Yr.exports.forwardRef((e,t)=>{var r=e,{scene:i,style:n,onMouseDown:s,onMouseUp:a,onMouseHover:o,onKeyDown:l,onKeyUp:h,onStart:u,onLookAt:c,onFollow:d,onWheel:f,onLoad:p,autoRender:m=!1}=r,g=JJ(r,["scene","style","onMouseDown","onMouseUp","onMouseHover","onKeyDown","onKeyUp","onStart","onLookAt","onFollow","onWheel","onLoad","autoRender"]);const v=Yr.exports.useRef(null),[x,b]=Yr.exports.useState(!0);return Yr.exports.useEffect(()=>{b(!0);let _;const E=[{name:"mouseDown",cb:s},{name:"mouseUp",cb:a},{name:"mouseHover",cb:o},{name:"keyDown",cb:l},{name:"keyUp",cb:h},{name:"start",cb:u},{name:"lookAt",cb:c},{name:"follow",cb:d},{name:"scroll",cb:f}];if(v.current){_=new XJ(v.current,{autoRender:m});async function S(){await _.load(i);for(let P of E)P.cb&&_.addEventListener(P.name,P.cb);b(!1),p==null||p(_)}S()}return()=>{for(let S of E)S.cb&&_.removeEventListener(S.name,S.cb);_.dispose()}},[i]),nK("canvas",hE({ref:KJ([t,v]),style:hE({display:x?"none":"block"},n)},g))});var Ym={exports:{}},Xm={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sK=Yr.exports,aK=Symbol.for("react.element"),oK=Symbol.for("react.fragment"),lK=Object.prototype.hasOwnProperty,hK=sK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,uK={key:!0,ref:!0,__self:!0,__source:!0};function iP(e,t,r){var i,n={},s=null,a=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(i in t)lK.call(t,i)&&!uK.hasOwnProperty(i)&&(n[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps,t)n[i]===void 0&&(n[i]=t[i]);return{$$typeof:aK,type:e,key:s,ref:a,props:n,_owner:hK.current}}Xm.Fragment=oK;Xm.jsx=iP;Xm.jsxs=iP;Ym.exports=Xm;const nt=Ym.exports.jsx,Dr=Ym.exports.jsxs,cK=Ym.exports.Fragment,dK=()=>nt("div",{className:"-inset-y-5 sm:inset-y-5 absolute mb-48 h-11/12 w-full z-0 overflow-hidden",children:nt("iframe",{className:"h-screen",src:"https://my.spline.design/mymaskcopy-775ec23a01a5ace791cd044020af92d3/",frameborder:"0",width:"100%",height:"100%"})}),fK=()=>nt("div",{className:"flex justify-center items-center py-3",children:nt("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-red-500"})});var nP={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},uE=Zs.createContext&&Zs.createContext(nP),Xo=globalThis&&globalThis.__assign||function(){return Xo=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Xo.apply(this,arguments)},pK=globalThis&&globalThis.__rest||function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};function sP(e){return e&&e.map(function(t,r){return Zs.createElement(t.tag,Xo({key:r},t.attr),sP(t.child))})}function mK(e){return function(t){return Zs.createElement(gK,Xo({attr:Xo({},e.attr)},t),sP(e.child))}}function gK(e){var t=function(r){var i=e.attr,n=e.size,s=e.title,a=pK(e,["attr","size","title"]),o=n||r.size||"1em",l;return r.className&&(l=r.className),e.className&&(l=(l?l+" ":"")+e.className),Zs.createElement("svg",Xo({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,i,a,{className:l,style:Xo(Xo({color:e.color||r.color},r.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&Zs.createElement("title",null,s),e.children)};return uE!==void 0?Zs.createElement(uE.Consumer,null,function(r){return t(r)}):t(nP)}function vK(e){return mK({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"title",attr:{},child:[]},{tag:"path",attr:{d:"M11.944 17.97L4.58 13.62 11.943 24l7.37-10.38-7.372 4.35h.003zM12.056 0L4.69 12.223l7.365 4.354 7.365-4.35L12.056 0z"}}]})(e)}var aP={exports:{}};(function(e){(function(t,r){function i(z,y){if(!z)throw new Error(y||"Assertion failed")}function n(z,y){z.super_=y;var A=function(){};A.prototype=y.prototype,z.prototype=new A,z.prototype.constructor=z}function s(z,y,A){if(s.isBN(z))return z;this.negative=0,this.words=null,this.length=0,this.red=null,z!==null&&((y==="le"||y==="be")&&(A=y,y=10),this._init(z||0,y||10,A||"be"))}typeof t=="object"?t.exports=s:r.BN=s,s.BN=s,s.wordSize=26;var a;try{typeof window!="undefined"&&typeof window.Buffer!="undefined"?a=window.Buffer:a=require("buffer").Buffer}catch{}s.isBN=function(y){return y instanceof s?!0:y!==null&&typeof y=="object"&&y.constructor.wordSize===s.wordSize&&Array.isArray(y.words)},s.max=function(y,A){return y.cmp(A)>0?y:A},s.min=function(y,A){return y.cmp(A)<0?y:A},s.prototype._init=function(y,A,D){if(typeof y=="number")return this._initNumber(y,A,D);if(typeof y=="object")return this._initArray(y,A,D);A==="hex"&&(A=16),i(A===(A|0)&&A>=2&&A<=36),y=y.toString().replace(/\s+/g,"");var O=0;y[0]==="-"&&(O++,this.negative=1),O<y.length&&(A===16?this._parseHex(y,O,D):(this._parseBase(y,A,O),D==="le"&&this._initArray(this.toArray(),A,D)))},s.prototype._initNumber=function(y,A,D){y<0&&(this.negative=1,y=-y),y<67108864?(this.words=[y&67108863],this.length=1):y<4503599627370496?(this.words=[y&67108863,y/67108864&67108863],this.length=2):(i(y<9007199254740992),this.words=[y&67108863,y/67108864&67108863,1],this.length=3),D==="le"&&this._initArray(this.toArray(),A,D)},s.prototype._initArray=function(y,A,D){if(i(typeof y.length=="number"),y.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(y.length/3),this.words=new Array(this.length);for(var O=0;O<this.length;O++)this.words[O]=0;var C,I,k=0;if(D==="be")for(O=y.length-1,C=0;O>=0;O-=3)I=y[O]|y[O-1]<<8|y[O-2]<<16,this.words[C]|=I<<k&67108863,this.words[C+1]=I>>>26-k&67108863,k+=24,k>=26&&(k-=26,C++);else if(D==="le")for(O=0,C=0;O<y.length;O+=3)I=y[O]|y[O+1]<<8|y[O+2]<<16,this.words[C]|=I<<k&67108863,this.words[C+1]=I>>>26-k&67108863,k+=24,k>=26&&(k-=26,C++);return this._strip()};function o(z,y){var A=z.charCodeAt(y);if(A>=48&&A<=57)return A-48;if(A>=65&&A<=70)return A-55;if(A>=97&&A<=102)return A-87;i(!1,"Invalid character in "+z)}function l(z,y,A){var D=o(z,A);return A-1>=y&&(D|=o(z,A-1)<<4),D}s.prototype._parseHex=function(y,A,D){this.length=Math.ceil((y.length-A)/6),this.words=new Array(this.length);for(var O=0;O<this.length;O++)this.words[O]=0;var C=0,I=0,k;if(D==="be")for(O=y.length-1;O>=A;O-=2)k=l(y,A,O)<<C,this.words[I]|=k&67108863,C>=18?(C-=18,I+=1,this.words[I]|=k>>>26):C+=8;else{var L=y.length-A;for(O=L%2===0?A+1:A;O<y.length;O+=2)k=l(y,A,O)<<C,this.words[I]|=k&67108863,C>=18?(C-=18,I+=1,this.words[I]|=k>>>26):C+=8}this._strip()};function h(z,y,A,D){for(var O=0,C=0,I=Math.min(z.length,A),k=y;k<I;k++){var L=z.charCodeAt(k)-48;O*=D,L>=49?C=L-49+10:L>=17?C=L-17+10:C=L,i(L>=0&&C<D,"Invalid character"),O+=C}return O}s.prototype._parseBase=function(y,A,D){this.words=[0],this.length=1;for(var O=0,C=1;C<=67108863;C*=A)O++;O--,C=C/A|0;for(var I=y.length-D,k=I%O,L=Math.min(I,I-k)+D,w=0,N=D;N<L;N+=O)w=h(y,N,N+O,A),this.imuln(C),this.words[0]+w<67108864?this.words[0]+=w:this._iaddn(w);if(k!==0){var X=1;for(w=h(y,N,y.length,A),N=0;N<k;N++)X*=A;this.imuln(X),this.words[0]+w<67108864?this.words[0]+=w:this._iaddn(w)}this._strip()},s.prototype.copy=function(y){y.words=new Array(this.length);for(var A=0;A<this.length;A++)y.words[A]=this.words[A];y.length=this.length,y.negative=this.negative,y.red=this.red};function u(z,y){z.words=y.words,z.length=y.length,z.negative=y.negative,z.red=y.red}if(s.prototype._move=function(y){u(y,this)},s.prototype.clone=function(){var y=new s(null);return this.copy(y),y},s.prototype._expand=function(y){for(;this.length<y;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol!="undefined"&&typeof Symbol.for=="function")try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=c}catch{s.prototype.inspect=c}else s.prototype.inspect=c;function c(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var d=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(y,A){y=y||10,A=A|0||1;var D;if(y===16||y==="hex"){D="";for(var O=0,C=0,I=0;I<this.length;I++){var k=this.words[I],L=((k<<O|C)&16777215).toString(16);C=k>>>24-O&16777215,O+=2,O>=26&&(O-=26,I--),C!==0||I!==this.length-1?D=d[6-L.length]+L+D:D=L+D}for(C!==0&&(D=C.toString(16)+D);D.length%A!==0;)D="0"+D;return this.negative!==0&&(D="-"+D),D}if(y===(y|0)&&y>=2&&y<=36){var w=f[y],N=p[y];D="";var X=this.clone();for(X.negative=0;!X.isZero();){var T=X.modrn(N).toString(y);X=X.idivn(N),X.isZero()?D=T+D:D=d[w-T.length]+T+D}for(this.isZero()&&(D="0"+D);D.length%A!==0;)D="0"+D;return this.negative!==0&&(D="-"+D),D}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var y=this.words[0];return this.length===2?y+=this.words[1]*67108864:this.length===3&&this.words[2]===1?y+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-y:y},s.prototype.toJSON=function(){return this.toString(16,2)},a&&(s.prototype.toBuffer=function(y,A){return this.toArrayLike(a,y,A)}),s.prototype.toArray=function(y,A){return this.toArrayLike(Array,y,A)};var m=function(y,A){return y.allocUnsafe?y.allocUnsafe(A):new y(A)};s.prototype.toArrayLike=function(y,A,D){this._strip();var O=this.byteLength(),C=D||Math.max(1,O);i(O<=C,"byte array longer than desired length"),i(C>0,"Requested array length <= 0");var I=m(y,C),k=A==="le"?"LE":"BE";return this["_toArrayLike"+k](I,O),I},s.prototype._toArrayLikeLE=function(y,A){for(var D=0,O=0,C=0,I=0;C<this.length;C++){var k=this.words[C]<<I|O;y[D++]=k&255,D<y.length&&(y[D++]=k>>8&255),D<y.length&&(y[D++]=k>>16&255),I===6?(D<y.length&&(y[D++]=k>>24&255),O=0,I=0):(O=k>>>24,I+=2)}if(D<y.length)for(y[D++]=O;D<y.length;)y[D++]=0},s.prototype._toArrayLikeBE=function(y,A){for(var D=y.length-1,O=0,C=0,I=0;C<this.length;C++){var k=this.words[C]<<I|O;y[D--]=k&255,D>=0&&(y[D--]=k>>8&255),D>=0&&(y[D--]=k>>16&255),I===6?(D>=0&&(y[D--]=k>>24&255),O=0,I=0):(O=k>>>24,I+=2)}if(D>=0)for(y[D--]=O;D>=0;)y[D--]=0},Math.clz32?s.prototype._countBits=function(y){return 32-Math.clz32(y)}:s.prototype._countBits=function(y){var A=y,D=0;return A>=4096&&(D+=13,A>>>=13),A>=64&&(D+=7,A>>>=7),A>=8&&(D+=4,A>>>=4),A>=2&&(D+=2,A>>>=2),D+A},s.prototype._zeroBits=function(y){if(y===0)return 26;var A=y,D=0;return(A&8191)===0&&(D+=13,A>>>=13),(A&127)===0&&(D+=7,A>>>=7),(A&15)===0&&(D+=4,A>>>=4),(A&3)===0&&(D+=2,A>>>=2),(A&1)===0&&D++,D},s.prototype.bitLength=function(){var y=this.words[this.length-1],A=this._countBits(y);return(this.length-1)*26+A};function g(z){for(var y=new Array(z.bitLength()),A=0;A<y.length;A++){var D=A/26|0,O=A%26;y[A]=z.words[D]>>>O&1}return y}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var y=0,A=0;A<this.length;A++){var D=this._zeroBits(this.words[A]);if(y+=D,D!==26)break}return y},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(y){return this.negative!==0?this.abs().inotn(y).iaddn(1):this.clone()},s.prototype.fromTwos=function(y){return this.testn(y-1)?this.notn(y).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(y){for(;this.length<y.length;)this.words[this.length++]=0;for(var A=0;A<y.length;A++)this.words[A]=this.words[A]|y.words[A];return this._strip()},s.prototype.ior=function(y){return i((this.negative|y.negative)===0),this.iuor(y)},s.prototype.or=function(y){return this.length>y.length?this.clone().ior(y):y.clone().ior(this)},s.prototype.uor=function(y){return this.length>y.length?this.clone().iuor(y):y.clone().iuor(this)},s.prototype.iuand=function(y){var A;this.length>y.length?A=y:A=this;for(var D=0;D<A.length;D++)this.words[D]=this.words[D]&y.words[D];return this.length=A.length,this._strip()},s.prototype.iand=function(y){return i((this.negative|y.negative)===0),this.iuand(y)},s.prototype.and=function(y){return this.length>y.length?this.clone().iand(y):y.clone().iand(this)},s.prototype.uand=function(y){return this.length>y.length?this.clone().iuand(y):y.clone().iuand(this)},s.prototype.iuxor=function(y){var A,D;this.length>y.length?(A=this,D=y):(A=y,D=this);for(var O=0;O<D.length;O++)this.words[O]=A.words[O]^D.words[O];if(this!==A)for(;O<A.length;O++)this.words[O]=A.words[O];return this.length=A.length,this._strip()},s.prototype.ixor=function(y){return i((this.negative|y.negative)===0),this.iuxor(y)},s.prototype.xor=function(y){return this.length>y.length?this.clone().ixor(y):y.clone().ixor(this)},s.prototype.uxor=function(y){return this.length>y.length?this.clone().iuxor(y):y.clone().iuxor(this)},s.prototype.inotn=function(y){i(typeof y=="number"&&y>=0);var A=Math.ceil(y/26)|0,D=y%26;this._expand(A),D>0&&A--;for(var O=0;O<A;O++)this.words[O]=~this.words[O]&67108863;return D>0&&(this.words[O]=~this.words[O]&67108863>>26-D),this._strip()},s.prototype.notn=function(y){return this.clone().inotn(y)},s.prototype.setn=function(y,A){i(typeof y=="number"&&y>=0);var D=y/26|0,O=y%26;return this._expand(D+1),A?this.words[D]=this.words[D]|1<<O:this.words[D]=this.words[D]&~(1<<O),this._strip()},s.prototype.iadd=function(y){var A;if(this.negative!==0&&y.negative===0)return this.negative=0,A=this.isub(y),this.negative^=1,this._normSign();if(this.negative===0&&y.negative!==0)return y.negative=0,A=this.isub(y),y.negative=1,A._normSign();var D,O;this.length>y.length?(D=this,O=y):(D=y,O=this);for(var C=0,I=0;I<O.length;I++)A=(D.words[I]|0)+(O.words[I]|0)+C,this.words[I]=A&67108863,C=A>>>26;for(;C!==0&&I<D.length;I++)A=(D.words[I]|0)+C,this.words[I]=A&67108863,C=A>>>26;if(this.length=D.length,C!==0)this.words[this.length]=C,this.length++;else if(D!==this)for(;I<D.length;I++)this.words[I]=D.words[I];return this},s.prototype.add=function(y){var A;return y.negative!==0&&this.negative===0?(y.negative=0,A=this.sub(y),y.negative^=1,A):y.negative===0&&this.negative!==0?(this.negative=0,A=y.sub(this),this.negative=1,A):this.length>y.length?this.clone().iadd(y):y.clone().iadd(this)},s.prototype.isub=function(y){if(y.negative!==0){y.negative=0;var A=this.iadd(y);return y.negative=1,A._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(y),this.negative=1,this._normSign();var D=this.cmp(y);if(D===0)return this.negative=0,this.length=1,this.words[0]=0,this;var O,C;D>0?(O=this,C=y):(O=y,C=this);for(var I=0,k=0;k<C.length;k++)A=(O.words[k]|0)-(C.words[k]|0)+I,I=A>>26,this.words[k]=A&67108863;for(;I!==0&&k<O.length;k++)A=(O.words[k]|0)+I,I=A>>26,this.words[k]=A&67108863;if(I===0&&k<O.length&&O!==this)for(;k<O.length;k++)this.words[k]=O.words[k];return this.length=Math.max(this.length,k),O!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(y){return this.clone().isub(y)};function v(z,y,A){A.negative=y.negative^z.negative;var D=z.length+y.length|0;A.length=D,D=D-1|0;var O=z.words[0]|0,C=y.words[0]|0,I=O*C,k=I&67108863,L=I/67108864|0;A.words[0]=k;for(var w=1;w<D;w++){for(var N=L>>>26,X=L&67108863,T=Math.min(w,y.length-1),U=Math.max(0,w-z.length+1);U<=T;U++){var q=w-U|0;O=z.words[q]|0,C=y.words[U]|0,I=O*C+X,N+=I/67108864|0,X=I&67108863}A.words[w]=X|0,L=N|0}return L!==0?A.words[w]=L|0:A.length--,A._strip()}var x=function(y,A,D){var O=y.words,C=A.words,I=D.words,k=0,L,w,N,X=O[0]|0,T=X&8191,U=X>>>13,q=O[1]|0,W=q&8191,J=q>>>13,K=O[2]|0,ie=K&8191,Z=K>>>13,ue=O[3]|0,le=ue&8191,ce=ue>>>13,ke=O[4]|0,be=ke&8191,_e=ke>>>13,ze=O[5]|0,Be=ze&8191,Ve=ze>>>13,j=O[6]|0,G=j&8191,se=j>>>13,ye=O[7]|0,ge=ye&8191,we=ye>>>13,et=O[8]|0,oe=et&8191,De=et>>>13,Me=O[9]|0,xe=Me&8191,Y=Me>>>13,Ee=C[0]|0,ve=Ee&8191,Le=Ee>>>13,Oe=C[1]|0,Ie=Oe&8191,pe=Oe>>>13,Xe=C[2]|0,He=Xe&8191,je=Xe>>>13,qt=C[3]|0,Mt=qt&8191,Dt=qt>>>13,at=C[4]|0,Fe=at&8191,We=at>>>13,dt=C[5]|0,Je=dt&8191,it=dt>>>13,It=C[6]|0,st=It&8191,V=It>>>13,ee=C[7]|0,re=ee&8191,te=ee>>>13,de=C[8]|0,Ce=de&8191,Re=de>>>13,ft=C[9]|0,Ke=ft&8191,pt=ft>>>13;D.negative=y.negative^A.negative,D.length=19,L=Math.imul(T,ve),w=Math.imul(T,Le),w=w+Math.imul(U,ve)|0,N=Math.imul(U,Le);var yt=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(yt>>>26)|0,yt&=67108863,L=Math.imul(W,ve),w=Math.imul(W,Le),w=w+Math.imul(J,ve)|0,N=Math.imul(J,Le),L=L+Math.imul(T,Ie)|0,w=w+Math.imul(T,pe)|0,w=w+Math.imul(U,Ie)|0,N=N+Math.imul(U,pe)|0;var bt=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(bt>>>26)|0,bt&=67108863,L=Math.imul(ie,ve),w=Math.imul(ie,Le),w=w+Math.imul(Z,ve)|0,N=Math.imul(Z,Le),L=L+Math.imul(W,Ie)|0,w=w+Math.imul(W,pe)|0,w=w+Math.imul(J,Ie)|0,N=N+Math.imul(J,pe)|0,L=L+Math.imul(T,He)|0,w=w+Math.imul(T,je)|0,w=w+Math.imul(U,He)|0,N=N+Math.imul(U,je)|0;var Kt=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,L=Math.imul(le,ve),w=Math.imul(le,Le),w=w+Math.imul(ce,ve)|0,N=Math.imul(ce,Le),L=L+Math.imul(ie,Ie)|0,w=w+Math.imul(ie,pe)|0,w=w+Math.imul(Z,Ie)|0,N=N+Math.imul(Z,pe)|0,L=L+Math.imul(W,He)|0,w=w+Math.imul(W,je)|0,w=w+Math.imul(J,He)|0,N=N+Math.imul(J,je)|0,L=L+Math.imul(T,Mt)|0,w=w+Math.imul(T,Dt)|0,w=w+Math.imul(U,Mt)|0,N=N+Math.imul(U,Dt)|0;var li=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(li>>>26)|0,li&=67108863,L=Math.imul(be,ve),w=Math.imul(be,Le),w=w+Math.imul(_e,ve)|0,N=Math.imul(_e,Le),L=L+Math.imul(le,Ie)|0,w=w+Math.imul(le,pe)|0,w=w+Math.imul(ce,Ie)|0,N=N+Math.imul(ce,pe)|0,L=L+Math.imul(ie,He)|0,w=w+Math.imul(ie,je)|0,w=w+Math.imul(Z,He)|0,N=N+Math.imul(Z,je)|0,L=L+Math.imul(W,Mt)|0,w=w+Math.imul(W,Dt)|0,w=w+Math.imul(J,Mt)|0,N=N+Math.imul(J,Dt)|0,L=L+Math.imul(T,Fe)|0,w=w+Math.imul(T,We)|0,w=w+Math.imul(U,Fe)|0,N=N+Math.imul(U,We)|0;var Ai=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(Ai>>>26)|0,Ai&=67108863,L=Math.imul(Be,ve),w=Math.imul(Be,Le),w=w+Math.imul(Ve,ve)|0,N=Math.imul(Ve,Le),L=L+Math.imul(be,Ie)|0,w=w+Math.imul(be,pe)|0,w=w+Math.imul(_e,Ie)|0,N=N+Math.imul(_e,pe)|0,L=L+Math.imul(le,He)|0,w=w+Math.imul(le,je)|0,w=w+Math.imul(ce,He)|0,N=N+Math.imul(ce,je)|0,L=L+Math.imul(ie,Mt)|0,w=w+Math.imul(ie,Dt)|0,w=w+Math.imul(Z,Mt)|0,N=N+Math.imul(Z,Dt)|0,L=L+Math.imul(W,Fe)|0,w=w+Math.imul(W,We)|0,w=w+Math.imul(J,Fe)|0,N=N+Math.imul(J,We)|0,L=L+Math.imul(T,Je)|0,w=w+Math.imul(T,it)|0,w=w+Math.imul(U,Je)|0,N=N+Math.imul(U,it)|0;var xs=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(xs>>>26)|0,xs&=67108863,L=Math.imul(G,ve),w=Math.imul(G,Le),w=w+Math.imul(se,ve)|0,N=Math.imul(se,Le),L=L+Math.imul(Be,Ie)|0,w=w+Math.imul(Be,pe)|0,w=w+Math.imul(Ve,Ie)|0,N=N+Math.imul(Ve,pe)|0,L=L+Math.imul(be,He)|0,w=w+Math.imul(be,je)|0,w=w+Math.imul(_e,He)|0,N=N+Math.imul(_e,je)|0,L=L+Math.imul(le,Mt)|0,w=w+Math.imul(le,Dt)|0,w=w+Math.imul(ce,Mt)|0,N=N+Math.imul(ce,Dt)|0,L=L+Math.imul(ie,Fe)|0,w=w+Math.imul(ie,We)|0,w=w+Math.imul(Z,Fe)|0,N=N+Math.imul(Z,We)|0,L=L+Math.imul(W,Je)|0,w=w+Math.imul(W,it)|0,w=w+Math.imul(J,Je)|0,N=N+Math.imul(J,it)|0,L=L+Math.imul(T,st)|0,w=w+Math.imul(T,V)|0,w=w+Math.imul(U,st)|0,N=N+Math.imul(U,V)|0;var Fi=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(Fi>>>26)|0,Fi&=67108863,L=Math.imul(ge,ve),w=Math.imul(ge,Le),w=w+Math.imul(we,ve)|0,N=Math.imul(we,Le),L=L+Math.imul(G,Ie)|0,w=w+Math.imul(G,pe)|0,w=w+Math.imul(se,Ie)|0,N=N+Math.imul(se,pe)|0,L=L+Math.imul(Be,He)|0,w=w+Math.imul(Be,je)|0,w=w+Math.imul(Ve,He)|0,N=N+Math.imul(Ve,je)|0,L=L+Math.imul(be,Mt)|0,w=w+Math.imul(be,Dt)|0,w=w+Math.imul(_e,Mt)|0,N=N+Math.imul(_e,Dt)|0,L=L+Math.imul(le,Fe)|0,w=w+Math.imul(le,We)|0,w=w+Math.imul(ce,Fe)|0,N=N+Math.imul(ce,We)|0,L=L+Math.imul(ie,Je)|0,w=w+Math.imul(ie,it)|0,w=w+Math.imul(Z,Je)|0,N=N+Math.imul(Z,it)|0,L=L+Math.imul(W,st)|0,w=w+Math.imul(W,V)|0,w=w+Math.imul(J,st)|0,N=N+Math.imul(J,V)|0,L=L+Math.imul(T,re)|0,w=w+Math.imul(T,te)|0,w=w+Math.imul(U,re)|0,N=N+Math.imul(U,te)|0;var Bt=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,L=Math.imul(oe,ve),w=Math.imul(oe,Le),w=w+Math.imul(De,ve)|0,N=Math.imul(De,Le),L=L+Math.imul(ge,Ie)|0,w=w+Math.imul(ge,pe)|0,w=w+Math.imul(we,Ie)|0,N=N+Math.imul(we,pe)|0,L=L+Math.imul(G,He)|0,w=w+Math.imul(G,je)|0,w=w+Math.imul(se,He)|0,N=N+Math.imul(se,je)|0,L=L+Math.imul(Be,Mt)|0,w=w+Math.imul(Be,Dt)|0,w=w+Math.imul(Ve,Mt)|0,N=N+Math.imul(Ve,Dt)|0,L=L+Math.imul(be,Fe)|0,w=w+Math.imul(be,We)|0,w=w+Math.imul(_e,Fe)|0,N=N+Math.imul(_e,We)|0,L=L+Math.imul(le,Je)|0,w=w+Math.imul(le,it)|0,w=w+Math.imul(ce,Je)|0,N=N+Math.imul(ce,it)|0,L=L+Math.imul(ie,st)|0,w=w+Math.imul(ie,V)|0,w=w+Math.imul(Z,st)|0,N=N+Math.imul(Z,V)|0,L=L+Math.imul(W,re)|0,w=w+Math.imul(W,te)|0,w=w+Math.imul(J,re)|0,N=N+Math.imul(J,te)|0,L=L+Math.imul(T,Ce)|0,w=w+Math.imul(T,Re)|0,w=w+Math.imul(U,Ce)|0,N=N+Math.imul(U,Re)|0;var ws=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(ws>>>26)|0,ws&=67108863,L=Math.imul(xe,ve),w=Math.imul(xe,Le),w=w+Math.imul(Y,ve)|0,N=Math.imul(Y,Le),L=L+Math.imul(oe,Ie)|0,w=w+Math.imul(oe,pe)|0,w=w+Math.imul(De,Ie)|0,N=N+Math.imul(De,pe)|0,L=L+Math.imul(ge,He)|0,w=w+Math.imul(ge,je)|0,w=w+Math.imul(we,He)|0,N=N+Math.imul(we,je)|0,L=L+Math.imul(G,Mt)|0,w=w+Math.imul(G,Dt)|0,w=w+Math.imul(se,Mt)|0,N=N+Math.imul(se,Dt)|0,L=L+Math.imul(Be,Fe)|0,w=w+Math.imul(Be,We)|0,w=w+Math.imul(Ve,Fe)|0,N=N+Math.imul(Ve,We)|0,L=L+Math.imul(be,Je)|0,w=w+Math.imul(be,it)|0,w=w+Math.imul(_e,Je)|0,N=N+Math.imul(_e,it)|0,L=L+Math.imul(le,st)|0,w=w+Math.imul(le,V)|0,w=w+Math.imul(ce,st)|0,N=N+Math.imul(ce,V)|0,L=L+Math.imul(ie,re)|0,w=w+Math.imul(ie,te)|0,w=w+Math.imul(Z,re)|0,N=N+Math.imul(Z,te)|0,L=L+Math.imul(W,Ce)|0,w=w+Math.imul(W,Re)|0,w=w+Math.imul(J,Ce)|0,N=N+Math.imul(J,Re)|0,L=L+Math.imul(T,Ke)|0,w=w+Math.imul(T,pt)|0,w=w+Math.imul(U,Ke)|0,N=N+Math.imul(U,pt)|0;var xa=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(xa>>>26)|0,xa&=67108863,L=Math.imul(xe,Ie),w=Math.imul(xe,pe),w=w+Math.imul(Y,Ie)|0,N=Math.imul(Y,pe),L=L+Math.imul(oe,He)|0,w=w+Math.imul(oe,je)|0,w=w+Math.imul(De,He)|0,N=N+Math.imul(De,je)|0,L=L+Math.imul(ge,Mt)|0,w=w+Math.imul(ge,Dt)|0,w=w+Math.imul(we,Mt)|0,N=N+Math.imul(we,Dt)|0,L=L+Math.imul(G,Fe)|0,w=w+Math.imul(G,We)|0,w=w+Math.imul(se,Fe)|0,N=N+Math.imul(se,We)|0,L=L+Math.imul(Be,Je)|0,w=w+Math.imul(Be,it)|0,w=w+Math.imul(Ve,Je)|0,N=N+Math.imul(Ve,it)|0,L=L+Math.imul(be,st)|0,w=w+Math.imul(be,V)|0,w=w+Math.imul(_e,st)|0,N=N+Math.imul(_e,V)|0,L=L+Math.imul(le,re)|0,w=w+Math.imul(le,te)|0,w=w+Math.imul(ce,re)|0,N=N+Math.imul(ce,te)|0,L=L+Math.imul(ie,Ce)|0,w=w+Math.imul(ie,Re)|0,w=w+Math.imul(Z,Ce)|0,N=N+Math.imul(Z,Re)|0,L=L+Math.imul(W,Ke)|0,w=w+Math.imul(W,pt)|0,w=w+Math.imul(J,Ke)|0,N=N+Math.imul(J,pt)|0;var Ui=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(Ui>>>26)|0,Ui&=67108863,L=Math.imul(xe,He),w=Math.imul(xe,je),w=w+Math.imul(Y,He)|0,N=Math.imul(Y,je),L=L+Math.imul(oe,Mt)|0,w=w+Math.imul(oe,Dt)|0,w=w+Math.imul(De,Mt)|0,N=N+Math.imul(De,Dt)|0,L=L+Math.imul(ge,Fe)|0,w=w+Math.imul(ge,We)|0,w=w+Math.imul(we,Fe)|0,N=N+Math.imul(we,We)|0,L=L+Math.imul(G,Je)|0,w=w+Math.imul(G,it)|0,w=w+Math.imul(se,Je)|0,N=N+Math.imul(se,it)|0,L=L+Math.imul(Be,st)|0,w=w+Math.imul(Be,V)|0,w=w+Math.imul(Ve,st)|0,N=N+Math.imul(Ve,V)|0,L=L+Math.imul(be,re)|0,w=w+Math.imul(be,te)|0,w=w+Math.imul(_e,re)|0,N=N+Math.imul(_e,te)|0,L=L+Math.imul(le,Ce)|0,w=w+Math.imul(le,Re)|0,w=w+Math.imul(ce,Ce)|0,N=N+Math.imul(ce,Re)|0,L=L+Math.imul(ie,Ke)|0,w=w+Math.imul(ie,pt)|0,w=w+Math.imul(Z,Ke)|0,N=N+Math.imul(Z,pt)|0;var _n=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(_n>>>26)|0,_n&=67108863,L=Math.imul(xe,Mt),w=Math.imul(xe,Dt),w=w+Math.imul(Y,Mt)|0,N=Math.imul(Y,Dt),L=L+Math.imul(oe,Fe)|0,w=w+Math.imul(oe,We)|0,w=w+Math.imul(De,Fe)|0,N=N+Math.imul(De,We)|0,L=L+Math.imul(ge,Je)|0,w=w+Math.imul(ge,it)|0,w=w+Math.imul(we,Je)|0,N=N+Math.imul(we,it)|0,L=L+Math.imul(G,st)|0,w=w+Math.imul(G,V)|0,w=w+Math.imul(se,st)|0,N=N+Math.imul(se,V)|0,L=L+Math.imul(Be,re)|0,w=w+Math.imul(Be,te)|0,w=w+Math.imul(Ve,re)|0,N=N+Math.imul(Ve,te)|0,L=L+Math.imul(be,Ce)|0,w=w+Math.imul(be,Re)|0,w=w+Math.imul(_e,Ce)|0,N=N+Math.imul(_e,Re)|0,L=L+Math.imul(le,Ke)|0,w=w+Math.imul(le,pt)|0,w=w+Math.imul(ce,Ke)|0,N=N+Math.imul(ce,pt)|0;var wa=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(wa>>>26)|0,wa&=67108863,L=Math.imul(xe,Fe),w=Math.imul(xe,We),w=w+Math.imul(Y,Fe)|0,N=Math.imul(Y,We),L=L+Math.imul(oe,Je)|0,w=w+Math.imul(oe,it)|0,w=w+Math.imul(De,Je)|0,N=N+Math.imul(De,it)|0,L=L+Math.imul(ge,st)|0,w=w+Math.imul(ge,V)|0,w=w+Math.imul(we,st)|0,N=N+Math.imul(we,V)|0,L=L+Math.imul(G,re)|0,w=w+Math.imul(G,te)|0,w=w+Math.imul(se,re)|0,N=N+Math.imul(se,te)|0,L=L+Math.imul(Be,Ce)|0,w=w+Math.imul(Be,Re)|0,w=w+Math.imul(Ve,Ce)|0,N=N+Math.imul(Ve,Re)|0,L=L+Math.imul(be,Ke)|0,w=w+Math.imul(be,pt)|0,w=w+Math.imul(_e,Ke)|0,N=N+Math.imul(_e,pt)|0;var ll=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(ll>>>26)|0,ll&=67108863,L=Math.imul(xe,Je),w=Math.imul(xe,it),w=w+Math.imul(Y,Je)|0,N=Math.imul(Y,it),L=L+Math.imul(oe,st)|0,w=w+Math.imul(oe,V)|0,w=w+Math.imul(De,st)|0,N=N+Math.imul(De,V)|0,L=L+Math.imul(ge,re)|0,w=w+Math.imul(ge,te)|0,w=w+Math.imul(we,re)|0,N=N+Math.imul(we,te)|0,L=L+Math.imul(G,Ce)|0,w=w+Math.imul(G,Re)|0,w=w+Math.imul(se,Ce)|0,N=N+Math.imul(se,Re)|0,L=L+Math.imul(Be,Ke)|0,w=w+Math.imul(Be,pt)|0,w=w+Math.imul(Ve,Ke)|0,N=N+Math.imul(Ve,pt)|0;var Nr=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,L=Math.imul(xe,st),w=Math.imul(xe,V),w=w+Math.imul(Y,st)|0,N=Math.imul(Y,V),L=L+Math.imul(oe,re)|0,w=w+Math.imul(oe,te)|0,w=w+Math.imul(De,re)|0,N=N+Math.imul(De,te)|0,L=L+Math.imul(ge,Ce)|0,w=w+Math.imul(ge,Re)|0,w=w+Math.imul(we,Ce)|0,N=N+Math.imul(we,Re)|0,L=L+Math.imul(G,Ke)|0,w=w+Math.imul(G,pt)|0,w=w+Math.imul(se,Ke)|0,N=N+Math.imul(se,pt)|0;var ba=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(ba>>>26)|0,ba&=67108863,L=Math.imul(xe,re),w=Math.imul(xe,te),w=w+Math.imul(Y,re)|0,N=Math.imul(Y,te),L=L+Math.imul(oe,Ce)|0,w=w+Math.imul(oe,Re)|0,w=w+Math.imul(De,Ce)|0,N=N+Math.imul(De,Re)|0,L=L+Math.imul(ge,Ke)|0,w=w+Math.imul(ge,pt)|0,w=w+Math.imul(we,Ke)|0,N=N+Math.imul(we,pt)|0;var hl=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(hl>>>26)|0,hl&=67108863,L=Math.imul(xe,Ce),w=Math.imul(xe,Re),w=w+Math.imul(Y,Ce)|0,N=Math.imul(Y,Re),L=L+Math.imul(oe,Ke)|0,w=w+Math.imul(oe,pt)|0,w=w+Math.imul(De,Ke)|0,N=N+Math.imul(De,pt)|0;var Hi=(k+L|0)+((w&8191)<<13)|0;k=(N+(w>>>13)|0)+(Hi>>>26)|0,Hi&=67108863,L=Math.imul(xe,Ke),w=Math.imul(xe,pt),w=w+Math.imul(Y,Ke)|0,N=Math.imul(Y,pt);var ng=(k+L|0)+((w&8191)<<13)|0;return k=(N+(w>>>13)|0)+(ng>>>26)|0,ng&=67108863,I[0]=yt,I[1]=bt,I[2]=Kt,I[3]=li,I[4]=Ai,I[5]=xs,I[6]=Fi,I[7]=Bt,I[8]=ws,I[9]=xa,I[10]=Ui,I[11]=_n,I[12]=wa,I[13]=ll,I[14]=Nr,I[15]=ba,I[16]=hl,I[17]=Hi,I[18]=ng,k!==0&&(I[19]=k,D.length++),D};Math.imul||(x=v);function b(z,y,A){A.negative=y.negative^z.negative,A.length=z.length+y.length;for(var D=0,O=0,C=0;C<A.length-1;C++){var I=O;O=0;for(var k=D&67108863,L=Math.min(C,y.length-1),w=Math.max(0,C-z.length+1);w<=L;w++){var N=C-w,X=z.words[N]|0,T=y.words[w]|0,U=X*T,q=U&67108863;I=I+(U/67108864|0)|0,q=q+k|0,k=q&67108863,I=I+(q>>>26)|0,O+=I>>>26,I&=67108863}A.words[C]=k,D=I,I=O}return D!==0?A.words[C]=D:A.length--,A._strip()}function _(z,y,A){return b(z,y,A)}s.prototype.mulTo=function(y,A){var D,O=this.length+y.length;return this.length===10&&y.length===10?D=x(this,y,A):O<63?D=v(this,y,A):O<1024?D=b(this,y,A):D=_(this,y,A),D},s.prototype.mul=function(y){var A=new s(null);return A.words=new Array(this.length+y.length),this.mulTo(y,A)},s.prototype.mulf=function(y){var A=new s(null);return A.words=new Array(this.length+y.length),_(this,y,A)},s.prototype.imul=function(y){return this.clone().mulTo(y,this)},s.prototype.imuln=function(y){var A=y<0;A&&(y=-y),i(typeof y=="number"),i(y<67108864);for(var D=0,O=0;O<this.length;O++){var C=(this.words[O]|0)*y,I=(C&67108863)+(D&67108863);D>>=26,D+=C/67108864|0,D+=I>>>26,this.words[O]=I&67108863}return D!==0&&(this.words[O]=D,this.length++),A?this.ineg():this},s.prototype.muln=function(y){return this.clone().imuln(y)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(y){var A=g(y);if(A.length===0)return new s(1);for(var D=this,O=0;O<A.length&&A[O]===0;O++,D=D.sqr());if(++O<A.length)for(var C=D.sqr();O<A.length;O++,C=C.sqr())A[O]!==0&&(D=D.mul(C));return D},s.prototype.iushln=function(y){i(typeof y=="number"&&y>=0);var A=y%26,D=(y-A)/26,O=67108863>>>26-A<<26-A,C;if(A!==0){var I=0;for(C=0;C<this.length;C++){var k=this.words[C]&O,L=(this.words[C]|0)-k<<A;this.words[C]=L|I,I=k>>>26-A}I&&(this.words[C]=I,this.length++)}if(D!==0){for(C=this.length-1;C>=0;C--)this.words[C+D]=this.words[C];for(C=0;C<D;C++)this.words[C]=0;this.length+=D}return this._strip()},s.prototype.ishln=function(y){return i(this.negative===0),this.iushln(y)},s.prototype.iushrn=function(y,A,D){i(typeof y=="number"&&y>=0);var O;A?O=(A-A%26)/26:O=0;var C=y%26,I=Math.min((y-C)/26,this.length),k=67108863^67108863>>>C<<C,L=D;if(O-=I,O=Math.max(0,O),L){for(var w=0;w<I;w++)L.words[w]=this.words[w];L.length=I}if(I!==0)if(this.length>I)for(this.length-=I,w=0;w<this.length;w++)this.words[w]=this.words[w+I];else this.words[0]=0,this.length=1;var N=0;for(w=this.length-1;w>=0&&(N!==0||w>=O);w--){var X=this.words[w]|0;this.words[w]=N<<26-C|X>>>C,N=X&k}return L&&N!==0&&(L.words[L.length++]=N),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(y,A,D){return i(this.negative===0),this.iushrn(y,A,D)},s.prototype.shln=function(y){return this.clone().ishln(y)},s.prototype.ushln=function(y){return this.clone().iushln(y)},s.prototype.shrn=function(y){return this.clone().ishrn(y)},s.prototype.ushrn=function(y){return this.clone().iushrn(y)},s.prototype.testn=function(y){i(typeof y=="number"&&y>=0);var A=y%26,D=(y-A)/26,O=1<<A;if(this.length<=D)return!1;var C=this.words[D];return!!(C&O)},s.prototype.imaskn=function(y){i(typeof y=="number"&&y>=0);var A=y%26,D=(y-A)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=D)return this;if(A!==0&&D++,this.length=Math.min(D,this.length),A!==0){var O=67108863^67108863>>>A<<A;this.words[this.length-1]&=O}return this._strip()},s.prototype.maskn=function(y){return this.clone().imaskn(y)},s.prototype.iaddn=function(y){return i(typeof y=="number"),i(y<67108864),y<0?this.isubn(-y):this.negative!==0?this.length===1&&(this.words[0]|0)<=y?(this.words[0]=y-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(y),this.negative=1,this):this._iaddn(y)},s.prototype._iaddn=function(y){this.words[0]+=y;for(var A=0;A<this.length&&this.words[A]>=67108864;A++)this.words[A]-=67108864,A===this.length-1?this.words[A+1]=1:this.words[A+1]++;return this.length=Math.max(this.length,A+1),this},s.prototype.isubn=function(y){if(i(typeof y=="number"),i(y<67108864),y<0)return this.iaddn(-y);if(this.negative!==0)return this.negative=0,this.iaddn(y),this.negative=1,this;if(this.words[0]-=y,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var A=0;A<this.length&&this.words[A]<0;A++)this.words[A]+=67108864,this.words[A+1]-=1;return this._strip()},s.prototype.addn=function(y){return this.clone().iaddn(y)},s.prototype.subn=function(y){return this.clone().isubn(y)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(y,A,D){var O=y.length+D,C;this._expand(O);var I,k=0;for(C=0;C<y.length;C++){I=(this.words[C+D]|0)+k;var L=(y.words[C]|0)*A;I-=L&67108863,k=(I>>26)-(L/67108864|0),this.words[C+D]=I&67108863}for(;C<this.length-D;C++)I=(this.words[C+D]|0)+k,k=I>>26,this.words[C+D]=I&67108863;if(k===0)return this._strip();for(i(k===-1),k=0,C=0;C<this.length;C++)I=-(this.words[C]|0)+k,k=I>>26,this.words[C]=I&67108863;return this.negative=1,this._strip()},s.prototype._wordDiv=function(y,A){var D=this.length-y.length,O=this.clone(),C=y,I=C.words[C.length-1]|0,k=this._countBits(I);D=26-k,D!==0&&(C=C.ushln(D),O.iushln(D),I=C.words[C.length-1]|0);var L=O.length-C.length,w;if(A!=="mod"){w=new s(null),w.length=L+1,w.words=new Array(w.length);for(var N=0;N<w.length;N++)w.words[N]=0}var X=O.clone()._ishlnsubmul(C,1,L);X.negative===0&&(O=X,w&&(w.words[L]=1));for(var T=L-1;T>=0;T--){var U=(O.words[C.length+T]|0)*67108864+(O.words[C.length+T-1]|0);for(U=Math.min(U/I|0,67108863),O._ishlnsubmul(C,U,T);O.negative!==0;)U--,O.negative=0,O._ishlnsubmul(C,1,T),O.isZero()||(O.negative^=1);w&&(w.words[T]=U)}return w&&w._strip(),O._strip(),A!=="div"&&D!==0&&O.iushrn(D),{div:w||null,mod:O}},s.prototype.divmod=function(y,A,D){if(i(!y.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var O,C,I;return this.negative!==0&&y.negative===0?(I=this.neg().divmod(y,A),A!=="mod"&&(O=I.div.neg()),A!=="div"&&(C=I.mod.neg(),D&&C.negative!==0&&C.iadd(y)),{div:O,mod:C}):this.negative===0&&y.negative!==0?(I=this.divmod(y.neg(),A),A!=="mod"&&(O=I.div.neg()),{div:O,mod:I.mod}):(this.negative&y.negative)!==0?(I=this.neg().divmod(y.neg(),A),A!=="div"&&(C=I.mod.neg(),D&&C.negative!==0&&C.isub(y)),{div:I.div,mod:C}):y.length>this.length||this.cmp(y)<0?{div:new s(0),mod:this}:y.length===1?A==="div"?{div:this.divn(y.words[0]),mod:null}:A==="mod"?{div:null,mod:new s(this.modrn(y.words[0]))}:{div:this.divn(y.words[0]),mod:new s(this.modrn(y.words[0]))}:this._wordDiv(y,A)},s.prototype.div=function(y){return this.divmod(y,"div",!1).div},s.prototype.mod=function(y){return this.divmod(y,"mod",!1).mod},s.prototype.umod=function(y){return this.divmod(y,"mod",!0).mod},s.prototype.divRound=function(y){var A=this.divmod(y);if(A.mod.isZero())return A.div;var D=A.div.negative!==0?A.mod.isub(y):A.mod,O=y.ushrn(1),C=y.andln(1),I=D.cmp(O);return I<0||C===1&&I===0?A.div:A.div.negative!==0?A.div.isubn(1):A.div.iaddn(1)},s.prototype.modrn=function(y){var A=y<0;A&&(y=-y),i(y<=67108863);for(var D=(1<<26)%y,O=0,C=this.length-1;C>=0;C--)O=(D*O+(this.words[C]|0))%y;return A?-O:O},s.prototype.modn=function(y){return this.modrn(y)},s.prototype.idivn=function(y){var A=y<0;A&&(y=-y),i(y<=67108863);for(var D=0,O=this.length-1;O>=0;O--){var C=(this.words[O]|0)+D*67108864;this.words[O]=C/y|0,D=C%y}return this._strip(),A?this.ineg():this},s.prototype.divn=function(y){return this.clone().idivn(y)},s.prototype.egcd=function(y){i(y.negative===0),i(!y.isZero());var A=this,D=y.clone();A.negative!==0?A=A.umod(y):A=A.clone();for(var O=new s(1),C=new s(0),I=new s(0),k=new s(1),L=0;A.isEven()&&D.isEven();)A.iushrn(1),D.iushrn(1),++L;for(var w=D.clone(),N=A.clone();!A.isZero();){for(var X=0,T=1;(A.words[0]&T)===0&&X<26;++X,T<<=1);if(X>0)for(A.iushrn(X);X-- >0;)(O.isOdd()||C.isOdd())&&(O.iadd(w),C.isub(N)),O.iushrn(1),C.iushrn(1);for(var U=0,q=1;(D.words[0]&q)===0&&U<26;++U,q<<=1);if(U>0)for(D.iushrn(U);U-- >0;)(I.isOdd()||k.isOdd())&&(I.iadd(w),k.isub(N)),I.iushrn(1),k.iushrn(1);A.cmp(D)>=0?(A.isub(D),O.isub(I),C.isub(k)):(D.isub(A),I.isub(O),k.isub(C))}return{a:I,b:k,gcd:D.iushln(L)}},s.prototype._invmp=function(y){i(y.negative===0),i(!y.isZero());var A=this,D=y.clone();A.negative!==0?A=A.umod(y):A=A.clone();for(var O=new s(1),C=new s(0),I=D.clone();A.cmpn(1)>0&&D.cmpn(1)>0;){for(var k=0,L=1;(A.words[0]&L)===0&&k<26;++k,L<<=1);if(k>0)for(A.iushrn(k);k-- >0;)O.isOdd()&&O.iadd(I),O.iushrn(1);for(var w=0,N=1;(D.words[0]&N)===0&&w<26;++w,N<<=1);if(w>0)for(D.iushrn(w);w-- >0;)C.isOdd()&&C.iadd(I),C.iushrn(1);A.cmp(D)>=0?(A.isub(D),O.isub(C)):(D.isub(A),C.isub(O))}var X;return A.cmpn(1)===0?X=O:X=C,X.cmpn(0)<0&&X.iadd(y),X},s.prototype.gcd=function(y){if(this.isZero())return y.abs();if(y.isZero())return this.abs();var A=this.clone(),D=y.clone();A.negative=0,D.negative=0;for(var O=0;A.isEven()&&D.isEven();O++)A.iushrn(1),D.iushrn(1);do{for(;A.isEven();)A.iushrn(1);for(;D.isEven();)D.iushrn(1);var C=A.cmp(D);if(C<0){var I=A;A=D,D=I}else if(C===0||D.cmpn(1)===0)break;A.isub(D)}while(!0);return D.iushln(O)},s.prototype.invm=function(y){return this.egcd(y).a.umod(y)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(y){return this.words[0]&y},s.prototype.bincn=function(y){i(typeof y=="number");var A=y%26,D=(y-A)/26,O=1<<A;if(this.length<=D)return this._expand(D+1),this.words[D]|=O,this;for(var C=O,I=D;C!==0&&I<this.length;I++){var k=this.words[I]|0;k+=C,C=k>>>26,k&=67108863,this.words[I]=k}return C!==0&&(this.words[I]=C,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(y){var A=y<0;if(this.negative!==0&&!A)return-1;if(this.negative===0&&A)return 1;this._strip();var D;if(this.length>1)D=1;else{A&&(y=-y),i(y<=67108863,"Number is too big");var O=this.words[0]|0;D=O===y?0:O<y?-1:1}return this.negative!==0?-D|0:D},s.prototype.cmp=function(y){if(this.negative!==0&&y.negative===0)return-1;if(this.negative===0&&y.negative!==0)return 1;var A=this.ucmp(y);return this.negative!==0?-A|0:A},s.prototype.ucmp=function(y){if(this.length>y.length)return 1;if(this.length<y.length)return-1;for(var A=0,D=this.length-1;D>=0;D--){var O=this.words[D]|0,C=y.words[D]|0;if(O!==C){O<C?A=-1:O>C&&(A=1);break}}return A},s.prototype.gtn=function(y){return this.cmpn(y)===1},s.prototype.gt=function(y){return this.cmp(y)===1},s.prototype.gten=function(y){return this.cmpn(y)>=0},s.prototype.gte=function(y){return this.cmp(y)>=0},s.prototype.ltn=function(y){return this.cmpn(y)===-1},s.prototype.lt=function(y){return this.cmp(y)===-1},s.prototype.lten=function(y){return this.cmpn(y)<=0},s.prototype.lte=function(y){return this.cmp(y)<=0},s.prototype.eqn=function(y){return this.cmpn(y)===0},s.prototype.eq=function(y){return this.cmp(y)===0},s.red=function(y){return new H(y)},s.prototype.toRed=function(y){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),y.convertTo(this)._forceRed(y)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(y){return this.red=y,this},s.prototype.forceRed=function(y){return i(!this.red,"Already a number in reduction context"),this._forceRed(y)},s.prototype.redAdd=function(y){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,y)},s.prototype.redIAdd=function(y){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,y)},s.prototype.redSub=function(y){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,y)},s.prototype.redISub=function(y){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,y)},s.prototype.redShl=function(y){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,y)},s.prototype.redMul=function(y){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,y),this.red.mul(this,y)},s.prototype.redIMul=function(y){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,y),this.red.imul(this,y)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(y){return i(this.red&&!y.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,y)};var E={k256:null,p224:null,p192:null,p25519:null};function S(z,y){this.name=z,this.p=new s(y,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}S.prototype._tmp=function(){var y=new s(null);return y.words=new Array(Math.ceil(this.n/13)),y},S.prototype.ireduce=function(y){var A=y,D;do this.split(A,this.tmp),A=this.imulK(A),A=A.iadd(this.tmp),D=A.bitLength();while(D>this.n);var O=D<this.n?-1:A.ucmp(this.p);return O===0?(A.words[0]=0,A.length=1):O>0?A.isub(this.p):A.strip!==void 0?A.strip():A._strip(),A},S.prototype.split=function(y,A){y.iushrn(this.n,0,A)},S.prototype.imulK=function(y){return y.imul(this.k)};function P(){S.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(P,S),P.prototype.split=function(y,A){for(var D=4194303,O=Math.min(y.length,9),C=0;C<O;C++)A.words[C]=y.words[C];if(A.length=O,y.length<=9){y.words[0]=0,y.length=1;return}var I=y.words[9];for(A.words[A.length++]=I&D,C=10;C<y.length;C++){var k=y.words[C]|0;y.words[C-10]=(k&D)<<4|I>>>22,I=k}I>>>=22,y.words[C-10]=I,I===0&&y.length>10?y.length-=10:y.length-=9},P.prototype.imulK=function(y){y.words[y.length]=0,y.words[y.length+1]=0,y.length+=2;for(var A=0,D=0;D<y.length;D++){var O=y.words[D]|0;A+=O*977,y.words[D]=A&67108863,A=O*64+(A/67108864|0)}return y.words[y.length-1]===0&&(y.length--,y.words[y.length-1]===0&&y.length--),y};function M(){S.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(M,S);function B(){S.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(B,S);function R(){S.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(R,S),R.prototype.imulK=function(y){for(var A=0,D=0;D<y.length;D++){var O=(y.words[D]|0)*19+A,C=O&67108863;O>>>=26,y.words[D]=C,A=O}return A!==0&&(y.words[y.length++]=A),y},s._prime=function(y){if(E[y])return E[y];var A;if(y==="k256")A=new P;else if(y==="p224")A=new M;else if(y==="p192")A=new B;else if(y==="p25519")A=new R;else throw new Error("Unknown prime "+y);return E[y]=A,A};function H(z){if(typeof z=="string"){var y=s._prime(z);this.m=y.p,this.prime=y}else i(z.gtn(1),"modulus must be greater than 1"),this.m=z,this.prime=null}H.prototype._verify1=function(y){i(y.negative===0,"red works only with positives"),i(y.red,"red works only with red numbers")},H.prototype._verify2=function(y,A){i((y.negative|A.negative)===0,"red works only with positives"),i(y.red&&y.red===A.red,"red works only with red numbers")},H.prototype.imod=function(y){return this.prime?this.prime.ireduce(y)._forceRed(this):(u(y,y.umod(this.m)._forceRed(this)),y)},H.prototype.neg=function(y){return y.isZero()?y.clone():this.m.sub(y)._forceRed(this)},H.prototype.add=function(y,A){this._verify2(y,A);var D=y.add(A);return D.cmp(this.m)>=0&&D.isub(this.m),D._forceRed(this)},H.prototype.iadd=function(y,A){this._verify2(y,A);var D=y.iadd(A);return D.cmp(this.m)>=0&&D.isub(this.m),D},H.prototype.sub=function(y,A){this._verify2(y,A);var D=y.sub(A);return D.cmpn(0)<0&&D.iadd(this.m),D._forceRed(this)},H.prototype.isub=function(y,A){this._verify2(y,A);var D=y.isub(A);return D.cmpn(0)<0&&D.iadd(this.m),D},H.prototype.shl=function(y,A){return this._verify1(y),this.imod(y.ushln(A))},H.prototype.imul=function(y,A){return this._verify2(y,A),this.imod(y.imul(A))},H.prototype.mul=function(y,A){return this._verify2(y,A),this.imod(y.mul(A))},H.prototype.isqr=function(y){return this.imul(y,y.clone())},H.prototype.sqr=function(y){return this.mul(y,y)},H.prototype.sqrt=function(y){if(y.isZero())return y.clone();var A=this.m.andln(3);if(i(A%2===1),A===3){var D=this.m.add(new s(1)).iushrn(2);return this.pow(y,D)}for(var O=this.m.subn(1),C=0;!O.isZero()&&O.andln(1)===0;)C++,O.iushrn(1);i(!O.isZero());var I=new s(1).toRed(this),k=I.redNeg(),L=this.m.subn(1).iushrn(1),w=this.m.bitLength();for(w=new s(2*w*w).toRed(this);this.pow(w,L).cmp(k)!==0;)w.redIAdd(k);for(var N=this.pow(w,O),X=this.pow(y,O.addn(1).iushrn(1)),T=this.pow(y,O),U=C;T.cmp(I)!==0;){for(var q=T,W=0;q.cmp(I)!==0;W++)q=q.redSqr();i(W<U);var J=this.pow(N,new s(1).iushln(U-W-1));X=X.redMul(J),N=J.redSqr(),T=T.redMul(N),U=W}return X},H.prototype.invm=function(y){var A=y._invmp(this.m);return A.negative!==0?(A.negative=0,this.imod(A).redNeg()):this.imod(A)},H.prototype.pow=function(y,A){if(A.isZero())return new s(1).toRed(this);if(A.cmpn(1)===0)return y.clone();var D=4,O=new Array(1<<D);O[0]=new s(1).toRed(this),O[1]=y;for(var C=2;C<O.length;C++)O[C]=this.mul(O[C-1],y);var I=O[0],k=0,L=0,w=A.bitLength()%26;for(w===0&&(w=26),C=A.length-1;C>=0;C--){for(var N=A.words[C],X=w-1;X>=0;X--){var T=N>>X&1;if(I!==O[0]&&(I=this.sqr(I)),T===0&&k===0){L=0;continue}k<<=1,k|=T,L++,!(L!==D&&(C!==0||X!==0))&&(I=this.mul(I,O[k]),L=0,k=0)}w=26}return I},H.prototype.convertTo=function(y){var A=y.umod(this.m);return A===y?A.clone():A},H.prototype.convertFrom=function(y){var A=y.clone();return A.red=null,A},s.mont=function(y){return new Q(y)};function Q(z){H.call(this,z),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(Q,H),Q.prototype.convertTo=function(y){return this.imod(y.ushln(this.shift))},Q.prototype.convertFrom=function(y){var A=this.imod(y.mul(this.rinv));return A.red=null,A},Q.prototype.imul=function(y,A){if(y.isZero()||A.isZero())return y.words[0]=0,y.length=1,y;var D=y.imul(A),O=D.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),C=D.isub(O).iushrn(this.shift),I=C;return C.cmp(this.m)>=0?I=C.isub(this.m):C.cmpn(0)<0&&(I=C.iadd(this.m)),I._forceRed(this)},Q.prototype.mul=function(y,A){if(y.isZero()||A.isZero())return new s(0)._forceRed(this);var D=y.mul(A),O=D.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),C=D.isub(O).iushrn(this.shift),I=C;return C.cmp(this.m)>=0?I=C.isub(this.m):C.cmpn(0)<0&&(I=C.iadd(this.m)),I._forceRed(this)},Q.prototype.invm=function(y){var A=this.imod(y._invmp(this.m).mul(this.r2));return A._forceRed(this)}})(e,a3)})(aP);var xt=aP.exports;const yK="logger/5.6.0";let cE=!1,dE=!1;const Qp={debug:1,default:2,info:2,warning:3,error:4,off:5};let fE=Qp.default,Kv=null;function xK(){try{const e=[];if(["NFD","NFC","NFKD","NFKC"].forEach(t=>{try{if("test".normalize(t)!=="test")throw new Error("bad normalize")}catch{e.push(t)}}),e.length)throw new Error("missing "+e.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(e){return e.message}return null}const pE=xK();var bx;(function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR",e.OFF="OFF"})(bx||(bx={}));var is;(function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.NOT_IMPLEMENTED="NOT_IMPLEMENTED",e.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.TIMEOUT="TIMEOUT",e.BUFFER_OVERRUN="BUFFER_OVERRUN",e.NUMERIC_FAULT="NUMERIC_FAULT",e.MISSING_NEW="MISSING_NEW",e.INVALID_ARGUMENT="INVALID_ARGUMENT",e.MISSING_ARGUMENT="MISSING_ARGUMENT",e.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",e.CALL_EXCEPTION="CALL_EXCEPTION",e.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",e.NONCE_EXPIRED="NONCE_EXPIRED",e.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",e.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",e.TRANSACTION_REPLACED="TRANSACTION_REPLACED"})(is||(is={}));const mE="0123456789abcdef";class ae{constructor(t){Object.defineProperty(this,"version",{enumerable:!0,value:t,writable:!1})}_log(t,r){const i=t.toLowerCase();Qp[i]==null&&this.throwArgumentError("invalid log level name","logLevel",t),!(fE>Qp[i])&&console.log.apply(console,r)}debug(...t){this._log(ae.levels.DEBUG,t)}info(...t){this._log(ae.levels.INFO,t)}warn(...t){this._log(ae.levels.WARNING,t)}makeError(t,r,i){if(dE)return this.makeError("censored error",r,{});r||(r=ae.errors.UNKNOWN_ERROR),i||(i={});const n=[];Object.keys(i).forEach(l=>{const h=i[l];try{if(h instanceof Uint8Array){let u="";for(let c=0;c<h.length;c++)u+=mE[h[c]>>4],u+=mE[h[c]&15];n.push(l+"=Uint8Array(0x"+u+")")}else n.push(l+"="+JSON.stringify(h))}catch{n.push(l+"="+JSON.stringify(i[l].toString()))}}),n.push(`code=${r}`),n.push(`version=${this.version}`);const s=t;let a="";switch(r){case is.NUMERIC_FAULT:{a="NUMERIC_FAULT";const l=t;switch(l){case"overflow":case"underflow":case"division-by-zero":a+="-"+l;break;case"negative-power":case"negative-width":a+="-unsupported";break;case"unbound-bitwise-result":a+="-unbound-result";break}break}case is.CALL_EXCEPTION:case is.INSUFFICIENT_FUNDS:case is.MISSING_NEW:case is.NONCE_EXPIRED:case is.REPLACEMENT_UNDERPRICED:case is.TRANSACTION_REPLACED:case is.UNPREDICTABLE_GAS_LIMIT:a=r;break}a&&(t+=" [ See: https://links.ethers.org/v5-errors-"+a+" ]"),n.length&&(t+=" ("+n.join(", ")+")");const o=new Error(t);return o.reason=s,o.code=r,Object.keys(i).forEach(function(l){o[l]=i[l]}),o}throwError(t,r,i){throw this.makeError(t,r,i)}throwArgumentError(t,r,i){return this.throwError(t,ae.errors.INVALID_ARGUMENT,{argument:r,value:i})}assert(t,r,i,n){t||this.throwError(r,i,n)}assertArgument(t,r,i,n){t||this.throwArgumentError(r,i,n)}checkNormalize(t){pE&&this.throwError("platform missing String.prototype.normalize",ae.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:pE})}checkSafeUint53(t,r){typeof t=="number"&&(r==null&&(r="value not safe"),(t<0||t>=9007199254740991)&&this.throwError(r,ae.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:t}),t%1&&this.throwError(r,ae.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:t}))}checkArgumentCount(t,r,i){i?i=": "+i:i="",t<r&&this.throwError("missing argument"+i,ae.errors.MISSING_ARGUMENT,{count:t,expectedCount:r}),t>r&&this.throwError("too many arguments"+i,ae.errors.UNEXPECTED_ARGUMENT,{count:t,expectedCount:r})}checkNew(t,r){(t===Object||t==null)&&this.throwError("missing new",ae.errors.MISSING_NEW,{name:r.name})}checkAbstract(t,r){t===r?this.throwError("cannot instantiate abstract class "+JSON.stringify(r.name)+" directly; use a sub-class",ae.errors.UNSUPPORTED_OPERATION,{name:t.name,operation:"new"}):(t===Object||t==null)&&this.throwError("missing new",ae.errors.MISSING_NEW,{name:r.name})}static globalLogger(){return Kv||(Kv=new ae(yK)),Kv}static setCensorship(t,r){if(!t&&r&&this.globalLogger().throwError("cannot permanently disable censorship",ae.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),cE){if(!t)return;this.globalLogger().throwError("error censorship permanent",ae.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}dE=!!t,cE=!!r}static setLogLevel(t){const r=Qp[t.toLowerCase()];if(r==null){ae.globalLogger().warn("invalid log level - "+t);return}fE=r}static from(t){return new ae(t)}}ae.errors=is;ae.levels=bx;const wK="bytes/5.6.1",mr=new ae(wK);function oP(e){return!!e.toHexString}function cu(e){return e.slice||(e.slice=function(){const t=Array.prototype.slice.call(arguments);return cu(new Uint8Array(Array.prototype.slice.apply(e,t)))}),e}function Bb(e){return jt(e)&&!(e.length%2)||qu(e)}function gE(e){return typeof e=="number"&&e==e&&e%1===0}function qu(e){if(e==null)return!1;if(e.constructor===Uint8Array)return!0;if(typeof e=="string"||!gE(e.length)||e.length<0)return!1;for(let t=0;t<e.length;t++){const r=e[t];if(!gE(r)||r<0||r>=256)return!1}return!0}function ct(e,t){if(t||(t={}),typeof e=="number"){mr.checkSafeUint53(e,"invalid arrayify value");const r=[];for(;e;)r.unshift(e&255),e=parseInt(String(e/256));return r.length===0&&r.push(0),cu(new Uint8Array(r))}if(t.allowMissingPrefix&&typeof e=="string"&&e.substring(0,2)!=="0x"&&(e="0x"+e),oP(e)&&(e=e.toHexString()),jt(e)){let r=e.substring(2);r.length%2&&(t.hexPad==="left"?r="0"+r:t.hexPad==="right"?r+="0":mr.throwArgumentError("hex data is odd-length","value",e));const i=[];for(let n=0;n<r.length;n+=2)i.push(parseInt(r.substring(n,n+2),16));return cu(new Uint8Array(i))}return qu(e)?cu(new Uint8Array(e)):mr.throwArgumentError("invalid arrayify value","value",e)}function fn(e){const t=e.map(n=>ct(n)),r=t.reduce((n,s)=>n+s.length,0),i=new Uint8Array(r);return t.reduce((n,s)=>(i.set(s,n),n+s.length),0),cu(i)}function Au(e){let t=ct(e);if(t.length===0)return t;let r=0;for(;r<t.length&&t[r]===0;)r++;return r&&(t=t.slice(r)),t}function bK(e,t){e=ct(e),e.length>t&&mr.throwArgumentError("value out of range","value",arguments[0]);const r=new Uint8Array(t);return r.set(e,t-e.length),cu(r)}function jt(e,t){return!(typeof e!="string"||!e.match(/^0x[0-9A-Fa-f]*$/)||t&&e.length!==2+2*t)}const Zv="0123456789abcdef";function tt(e,t){if(t||(t={}),typeof e=="number"){mr.checkSafeUint53(e,"invalid hexlify value");let r="";for(;e;)r=Zv[e&15]+r,e=Math.floor(e/16);return r.length?(r.length%2&&(r="0"+r),"0x"+r):"0x00"}if(typeof e=="bigint")return e=e.toString(16),e.length%2?"0x0"+e:"0x"+e;if(t.allowMissingPrefix&&typeof e=="string"&&e.substring(0,2)!=="0x"&&(e="0x"+e),oP(e))return e.toHexString();if(jt(e))return e.length%2&&(t.hexPad==="left"?e="0x0"+e.substring(2):t.hexPad==="right"?e+="0":mr.throwArgumentError("hex data is odd-length","value",e)),e.toLowerCase();if(qu(e)){let r="0x";for(let i=0;i<e.length;i++){let n=e[i];r+=Zv[(n&240)>>4]+Zv[n&15]}return r}return mr.throwArgumentError("invalid hexlify value","value",e)}function ql(e){if(typeof e!="string")e=tt(e);else if(!jt(e)||e.length%2)return null;return(e.length-2)/2}function di(e,t,r){return typeof e!="string"?e=tt(e):(!jt(e)||e.length%2)&&mr.throwArgumentError("invalid hexData","value",e),t=2+2*t,r!=null?"0x"+e.substring(t,2+2*r):"0x"+e.substring(t)}function Xi(e){let t="0x";return e.forEach(r=>{t+=tt(r).substring(2)}),t}function kb(e){const t=_K(tt(e,{hexPad:"left"}));return t==="0x"?"0x0":t}function _K(e){typeof e!="string"&&(e=tt(e)),jt(e)||mr.throwArgumentError("invalid hex string","value",e),e=e.substring(2);let t=0;for(;t<e.length&&e[t]==="0";)t++;return"0x"+e.substring(t)}function ar(e,t){for(typeof e!="string"?e=tt(e):jt(e)||mr.throwArgumentError("invalid hex string","value",e),e.length>2*t+2&&mr.throwArgumentError("value out of range","value",arguments[1]);e.length<2*t+2;)e="0x0"+e.substring(2);return e}function Qm(e){const t={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(Bb(e)){let r=ct(e);r.length===64?(t.v=27+(r[32]>>7),r[32]&=127,t.r=tt(r.slice(0,32)),t.s=tt(r.slice(32,64))):r.length===65?(t.r=tt(r.slice(0,32)),t.s=tt(r.slice(32,64)),t.v=r[64]):mr.throwArgumentError("invalid signature string","signature",e),t.v<27&&(t.v===0||t.v===1?t.v+=27:mr.throwArgumentError("signature invalid v byte","signature",e)),t.recoveryParam=1-t.v%2,t.recoveryParam&&(r[32]|=128),t._vs=tt(r.slice(32,64))}else{if(t.r=e.r,t.s=e.s,t.v=e.v,t.recoveryParam=e.recoveryParam,t._vs=e._vs,t._vs!=null){const n=bK(ct(t._vs),32);t._vs=tt(n);const s=n[0]>=128?1:0;t.recoveryParam==null?t.recoveryParam=s:t.recoveryParam!==s&&mr.throwArgumentError("signature recoveryParam mismatch _vs","signature",e),n[0]&=127;const a=tt(n);t.s==null?t.s=a:t.s!==a&&mr.throwArgumentError("signature v mismatch _vs","signature",e)}if(t.recoveryParam==null)t.v==null?mr.throwArgumentError("signature missing v and recoveryParam","signature",e):t.v===0||t.v===1?t.recoveryParam=t.v:t.recoveryParam=1-t.v%2;else if(t.v==null)t.v=27+t.recoveryParam;else{const n=t.v===0||t.v===1?t.v:1-t.v%2;t.recoveryParam!==n&&mr.throwArgumentError("signature recoveryParam mismatch v","signature",e)}t.r==null||!jt(t.r)?mr.throwArgumentError("signature missing or invalid r","signature",e):t.r=ar(t.r,32),t.s==null||!jt(t.s)?mr.throwArgumentError("signature missing or invalid s","signature",e):t.s=ar(t.s,32);const r=ct(t.s);r[0]>=128&&mr.throwArgumentError("signature s out of range","signature",e),t.recoveryParam&&(r[0]|=128);const i=tt(r);t._vs&&(jt(t._vs)||mr.throwArgumentError("signature invalid _vs","signature",e),t._vs=ar(t._vs,32)),t._vs==null?t._vs=i:t._vs!==i&&mr.throwArgumentError("signature _vs mismatch v and s","signature",e)}return t.yParityAndS=t._vs,t.compact=t.r+t.yParityAndS.substring(2),t}const lP="bignumber/5.6.2";var $0=xt.BN;const Ra=new ae(lP),$v={},vE=9007199254740991;function SK(e){return e!=null&&(Te.isBigNumber(e)||typeof e=="number"&&e%1===0||typeof e=="string"&&!!e.match(/^-?[0-9]+$/)||jt(e)||typeof e=="bigint"||qu(e))}let yE=!1;class Te{constructor(t,r){t!==$v&&Ra.throwError("cannot call constructor directly; use BigNumber.from",ae.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=r,this._isBigNumber=!0,Object.freeze(this)}fromTwos(t){return Gi(Pt(this).fromTwos(t))}toTwos(t){return Gi(Pt(this).toTwos(t))}abs(){return this._hex[0]==="-"?Te.from(this._hex.substring(1)):this}add(t){return Gi(Pt(this).add(Pt(t)))}sub(t){return Gi(Pt(this).sub(Pt(t)))}div(t){return Te.from(t).isZero()&&Cn("division-by-zero","div"),Gi(Pt(this).div(Pt(t)))}mul(t){return Gi(Pt(this).mul(Pt(t)))}mod(t){const r=Pt(t);return r.isNeg()&&Cn("division-by-zero","mod"),Gi(Pt(this).umod(r))}pow(t){const r=Pt(t);return r.isNeg()&&Cn("negative-power","pow"),Gi(Pt(this).pow(r))}and(t){const r=Pt(t);return(this.isNegative()||r.isNeg())&&Cn("unbound-bitwise-result","and"),Gi(Pt(this).and(r))}or(t){const r=Pt(t);return(this.isNegative()||r.isNeg())&&Cn("unbound-bitwise-result","or"),Gi(Pt(this).or(r))}xor(t){const r=Pt(t);return(this.isNegative()||r.isNeg())&&Cn("unbound-bitwise-result","xor"),Gi(Pt(this).xor(r))}mask(t){return(this.isNegative()||t<0)&&Cn("negative-width","mask"),Gi(Pt(this).maskn(t))}shl(t){return(this.isNegative()||t<0)&&Cn("negative-width","shl"),Gi(Pt(this).shln(t))}shr(t){return(this.isNegative()||t<0)&&Cn("negative-width","shr"),Gi(Pt(this).shrn(t))}eq(t){return Pt(this).eq(Pt(t))}lt(t){return Pt(this).lt(Pt(t))}lte(t){return Pt(this).lte(Pt(t))}gt(t){return Pt(this).gt(Pt(t))}gte(t){return Pt(this).gte(Pt(t))}isNegative(){return this._hex[0]==="-"}isZero(){return Pt(this).isZero()}toNumber(){try{return Pt(this).toNumber()}catch{Cn("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return Ra.throwError("this platform does not support BigInt",ae.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?yE||(yE=!0,Ra.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?Ra.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",ae.errors.UNEXPECTED_ARGUMENT,{}):Ra.throwError("BigNumber.toString does not accept parameters",ae.errors.UNEXPECTED_ARGUMENT,{})),Pt(this).toString(10)}toHexString(){return this._hex}toJSON(t){return{type:"BigNumber",hex:this.toHexString()}}static from(t){if(t instanceof Te)return t;if(typeof t=="string")return t.match(/^-?0x[0-9a-f]+$/i)?new Te($v,Bd(t)):t.match(/^-?[0-9]+$/)?new Te($v,Bd(new $0(t))):Ra.throwArgumentError("invalid BigNumber string","value",t);if(typeof t=="number")return t%1&&Cn("underflow","BigNumber.from",t),(t>=vE||t<=-vE)&&Cn("overflow","BigNumber.from",t),Te.from(String(t));const r=t;if(typeof r=="bigint")return Te.from(r.toString());if(qu(r))return Te.from(tt(r));if(r)if(r.toHexString){const i=r.toHexString();if(typeof i=="string")return Te.from(i)}else{let i=r._hex;if(i==null&&r.type==="BigNumber"&&(i=r.hex),typeof i=="string"&&(jt(i)||i[0]==="-"&&jt(i.substring(1))))return Te.from(i)}return Ra.throwArgumentError("invalid BigNumber value","value",t)}static isBigNumber(t){return!!(t&&t._isBigNumber)}}function Bd(e){if(typeof e!="string")return Bd(e.toString(16));if(e[0]==="-")return e=e.substring(1),e[0]==="-"&&Ra.throwArgumentError("invalid hex","value",e),e=Bd(e),e==="0x00"?e:"-"+e;if(e.substring(0,2)!=="0x"&&(e="0x"+e),e==="0x")return"0x00";for(e.length%2&&(e="0x0"+e.substring(2));e.length>4&&e.substring(0,4)==="0x00";)e="0x"+e.substring(4);return e}function Gi(e){return Te.from(Bd(e))}function Pt(e){const t=Te.from(e).toHexString();return t[0]==="-"?new $0("-"+t.substring(3),16):new $0(t.substring(2),16)}function Cn(e,t,r){const i={fault:e,operation:t};return r!=null&&(i.value=r),Ra.throwError(e,ae.errors.NUMERIC_FAULT,i)}function MK(e){return new $0(e,36).toString(16)}const Pi=new ae(lP),nd={},hP=Te.from(0),uP=Te.from(-1);function cP(e,t,r,i){const n={fault:t,operation:r};return i!==void 0&&(n.value=i),Pi.throwError(e,ae.errors.NUMERIC_FAULT,n)}let sd="0";for(;sd.length<256;)sd+=sd;function zb(e){if(typeof e!="number")try{e=Te.from(e).toNumber()}catch{}return typeof e=="number"&&e>=0&&e<=256&&!(e%1)?"1"+sd.substring(0,e):Pi.throwArgumentError("invalid decimal size","decimals",e)}function e1(e,t){t==null&&(t=0);const r=zb(t);e=Te.from(e);const i=e.lt(hP);i&&(e=e.mul(uP));let n=e.mod(r).toString();for(;n.length<r.length-1;)n="0"+n;n=n.match(/^([0-9]*[1-9]|0)(0*)/)[1];const s=e.div(r).toString();return r.length===1?e=s:e=s+"."+n,i&&(e="-"+e),e}function Ds(e,t){t==null&&(t=0);const r=zb(t);(typeof e!="string"||!e.match(/^-?[0-9.]+$/))&&Pi.throwArgumentError("invalid decimal value","value",e);const i=e.substring(0,1)==="-";i&&(e=e.substring(1)),e==="."&&Pi.throwArgumentError("missing value","value",e);const n=e.split(".");n.length>2&&Pi.throwArgumentError("too many decimal points","value",e);let s=n[0],a=n[1];for(s||(s="0"),a||(a="0");a[a.length-1]==="0";)a=a.substring(0,a.length-1);for(a.length>r.length-1&&cP("fractional component exceeds decimals","underflow","parseFixed"),a===""&&(a="0");a.length<r.length-1;)a+="0";const o=Te.from(s),l=Te.from(a);let h=o.mul(r).add(l);return i&&(h=h.mul(uP)),h}class du{constructor(t,r,i,n){t!==nd&&Pi.throwError("cannot use FixedFormat constructor; use FixedFormat.from",ae.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=r,this.width=i,this.decimals=n,this.name=(r?"":"u")+"fixed"+String(i)+"x"+String(n),this._multiplier=zb(n),Object.freeze(this)}static from(t){if(t instanceof du)return t;typeof t=="number"&&(t=`fixed128x${t}`);let r=!0,i=128,n=18;if(typeof t=="string"){if(t!=="fixed")if(t==="ufixed")r=!1;else{const s=t.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);s||Pi.throwArgumentError("invalid fixed format","format",t),r=s[1]!=="u",i=parseInt(s[2]),n=parseInt(s[3])}}else if(t){const s=(a,o,l)=>t[a]==null?l:(typeof t[a]!==o&&Pi.throwArgumentError("invalid fixed format ("+a+" not "+o+")","format."+a,t[a]),t[a]);r=s("signed","boolean",r),i=s("width","number",i),n=s("decimals","number",n)}return i%8&&Pi.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",i),n>80&&Pi.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",n),new du(nd,r,i,n)}}class Zr{constructor(t,r,i,n){t!==nd&&Pi.throwError("cannot use FixedNumber constructor; use FixedNumber.from",ae.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=n,this._hex=r,this._value=i,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(t){this.format.name!==t.format.name&&Pi.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",t)}addUnsafe(t){this._checkFormat(t);const r=Ds(this._value,this.format.decimals),i=Ds(t._value,t.format.decimals);return Zr.fromValue(r.add(i),this.format.decimals,this.format)}subUnsafe(t){this._checkFormat(t);const r=Ds(this._value,this.format.decimals),i=Ds(t._value,t.format.decimals);return Zr.fromValue(r.sub(i),this.format.decimals,this.format)}mulUnsafe(t){this._checkFormat(t);const r=Ds(this._value,this.format.decimals),i=Ds(t._value,t.format.decimals);return Zr.fromValue(r.mul(i).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(t){this._checkFormat(t);const r=Ds(this._value,this.format.decimals),i=Ds(t._value,t.format.decimals);return Zr.fromValue(r.mul(this.format._multiplier).div(i),this.format.decimals,this.format)}floor(){const t=this.toString().split(".");t.length===1&&t.push("0");let r=Zr.from(t[0],this.format);const i=!t[1].match(/^(0*)$/);return this.isNegative()&&i&&(r=r.subUnsafe(xE.toFormat(r.format))),r}ceiling(){const t=this.toString().split(".");t.length===1&&t.push("0");let r=Zr.from(t[0],this.format);const i=!t[1].match(/^(0*)$/);return!this.isNegative()&&i&&(r=r.addUnsafe(xE.toFormat(r.format))),r}round(t){t==null&&(t=0);const r=this.toString().split(".");if(r.length===1&&r.push("0"),(t<0||t>80||t%1)&&Pi.throwArgumentError("invalid decimal count","decimals",t),r[1].length<=t)return this;const i=Zr.from("1"+sd.substring(0,t),this.format),n=AK.toFormat(this.format);return this.mulUnsafe(i).addUnsafe(n).floor().divUnsafe(i)}isZero(){return this._value==="0.0"||this._value==="0"}isNegative(){return this._value[0]==="-"}toString(){return this._value}toHexString(t){if(t==null)return this._hex;t%8&&Pi.throwArgumentError("invalid byte width","width",t);const r=Te.from(this._hex).fromTwos(this.format.width).toTwos(t).toHexString();return ar(r,t/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(t){return Zr.fromString(this._value,t)}static fromValue(t,r,i){return i==null&&r!=null&&!SK(r)&&(i=r,r=null),r==null&&(r=0),i==null&&(i="fixed"),Zr.fromString(e1(t,r),du.from(i))}static fromString(t,r){r==null&&(r="fixed");const i=du.from(r),n=Ds(t,i.decimals);!i.signed&&n.lt(hP)&&cP("unsigned value cannot be negative","overflow","value",t);let s=null;i.signed?s=n.toTwos(i.width).toHexString():(s=n.toHexString(),s=ar(s,i.width/8));const a=e1(n,i.decimals);return new Zr(nd,s,a,i)}static fromBytes(t,r){r==null&&(r="fixed");const i=du.from(r);if(ct(t).length>i.width/8)throw new Error("overflow");let n=Te.from(t);i.signed&&(n=n.fromTwos(i.width));const s=n.toTwos((i.signed?0:1)+i.width).toHexString(),a=e1(n,i.decimals);return new Zr(nd,s,a,i)}static from(t,r){if(typeof t=="string")return Zr.fromString(t,r);if(qu(t))return Zr.fromBytes(t,r);try{return Zr.fromValue(t,0,r)}catch(i){if(i.code!==ae.errors.INVALID_ARGUMENT)throw i}return Pi.throwArgumentError("invalid FixedNumber value","value",t)}static isFixedNumber(t){return!!(t&&t._isFixedNumber)}}const xE=Zr.from(1),AK=Zr.from("0.5"),EK="properties/5.6.0";var CK=globalThis&&globalThis.__awaiter||function(e,t,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{h(i.next(u))}catch(c){a(c)}}function l(u){try{h(i.throw(u))}catch(c){a(c)}}function h(u){u.done?s(u.value):n(u.value).then(o,l)}h((i=i.apply(e,t||[])).next())})};const em=new ae(EK);function Ae(e,t,r){Object.defineProperty(e,t,{enumerable:!0,value:r,writable:!1})}function Ks(e,t){for(let r=0;r<32;r++){if(e[t])return e[t];if(!e.prototype||typeof e.prototype!="object")break;e=Object.getPrototypeOf(e.prototype).constructor}return null}function Tr(e){return CK(this,void 0,void 0,function*(){const t=Object.keys(e).map(i=>{const n=e[i];return Promise.resolve(n).then(s=>({key:i,value:s}))});return(yield Promise.all(t)).reduce((i,n)=>(i[n.key]=n.value,i),{})})}function TK(e,t){(!e||typeof e!="object")&&em.throwArgumentError("invalid object","object",e),Object.keys(e).forEach(r=>{t[r]||em.throwArgumentError("invalid object key - "+r,"transaction:"+r,e)})}function Xr(e){const t={};for(const r in e)t[r]=e[r];return t}const DK={bigint:!0,boolean:!0,function:!0,number:!0,string:!0};function dP(e){if(e==null||DK[typeof e])return!0;if(Array.isArray(e)||typeof e=="object"){if(!Object.isFrozen(e))return!1;const t=Object.keys(e);for(let r=0;r<t.length;r++){let i=null;try{i=e[t[r]]}catch{continue}if(!dP(i))return!1}return!0}return em.throwArgumentError(`Cannot deepCopy ${typeof e}`,"object",e)}function PK(e){if(dP(e))return e;if(Array.isArray(e))return Object.freeze(e.map(t=>$a(t)));if(typeof e=="object"){const t={};for(const r in e){const i=e[r];i!==void 0&&Ae(t,r,$a(i))}return t}return em.throwArgumentError(`Cannot deepCopy ${typeof e}`,"object",e)}function $a(e){return PK(e)}class af{constructor(t){for(const r in t)this[r]=$a(t[r])}}const of="abi/5.6.3",Nt=new ae(of),Yl={};let wE={calldata:!0,memory:!0,storage:!0},LK={calldata:!0,memory:!0};function bp(e,t){if(e==="bytes"||e==="string"){if(wE[t])return!0}else if(e==="address"){if(t==="payable")return!0}else if((e.indexOf("[")>=0||e==="tuple")&&LK[t])return!0;return(wE[t]||t==="payable")&&Nt.throwArgumentError("invalid modifier","name",t),!1}function RK(e,t){let r=e;function i(o){Nt.throwArgumentError(`unexpected character at position ${o}`,"param",e)}e=e.replace(/\s/g," ");function n(o){let l={type:"",name:"",parent:o,state:{allowType:!0}};return t&&(l.indexed=!1),l}let s={type:"",name:"",state:{allowType:!0}},a=s;for(let o=0;o<e.length;o++){let l=e[o];switch(l){case"(":a.state.allowType&&a.type===""?a.type="tuple":a.state.allowParams||i(o),a.state.allowType=!1,a.type=Rh(a.type),a.components=[n(a)],a=a.components[0];break;case")":delete a.state,a.name==="indexed"&&(t||i(o),a.indexed=!0,a.name=""),bp(a.type,a.name)&&(a.name=""),a.type=Rh(a.type);let h=a;a=a.parent,a||i(o),delete h.parent,a.state.allowParams=!1,a.state.allowName=!0,a.state.allowArray=!0;break;case",":delete a.state,a.name==="indexed"&&(t||i(o),a.indexed=!0,a.name=""),bp(a.type,a.name)&&(a.name=""),a.type=Rh(a.type);let u=n(a.parent);a.parent.components.push(u),delete a.parent,a=u;break;case" ":a.state.allowType&&a.type!==""&&(a.type=Rh(a.type),delete a.state.allowType,a.state.allowName=!0,a.state.allowParams=!0),a.state.allowName&&a.name!==""&&(a.name==="indexed"?(t||i(o),a.indexed&&i(o),a.indexed=!0,a.name=""):bp(a.type,a.name)?a.name="":a.state.allowName=!1);break;case"[":a.state.allowArray||i(o),a.type+=l,a.state.allowArray=!1,a.state.allowName=!1,a.state.readArray=!0;break;case"]":a.state.readArray||i(o),a.type+=l,a.state.readArray=!1,a.state.allowArray=!0,a.state.allowName=!0;break;default:a.state.allowType?(a.type+=l,a.state.allowParams=!0,a.state.allowArray=!0):a.state.allowName?(a.name+=l,delete a.state.allowArray):a.state.readArray?a.type+=l:i(o)}}return a.parent&&Nt.throwArgumentError("unexpected eof","param",e),delete s.state,a.name==="indexed"?(t||i(r.length-7),a.indexed&&i(r.length-7),a.indexed=!0,a.name=""):bp(a.type,a.name)&&(a.name=""),s.type=Rh(s.type),s}function Jp(e,t){for(let r in t)Ae(e,r,t[r])}const Vt=Object.freeze({sighash:"sighash",minimal:"minimal",full:"full",json:"json"}),OK=new RegExp(/^(.*)\[([0-9]*)\]$/);class qr{constructor(t,r){t!==Yl&&Nt.throwError("use fromString",ae.errors.UNSUPPORTED_OPERATION,{operation:"new ParamType()"}),Jp(this,r);let i=this.type.match(OK);i?Jp(this,{arrayLength:parseInt(i[2]||"-1"),arrayChildren:qr.fromObject({type:i[1],components:this.components}),baseType:"array"}):Jp(this,{arrayLength:null,arrayChildren:null,baseType:this.components!=null?"tuple":this.type}),this._isParamType=!0,Object.freeze(this)}format(t){if(t||(t=Vt.sighash),Vt[t]||Nt.throwArgumentError("invalid format type","format",t),t===Vt.json){let i={type:this.baseType==="tuple"?"tuple":this.type,name:this.name||void 0};return typeof this.indexed=="boolean"&&(i.indexed=this.indexed),this.components&&(i.components=this.components.map(n=>JSON.parse(n.format(t)))),JSON.stringify(i)}let r="";return this.baseType==="array"?(r+=this.arrayChildren.format(t),r+="["+(this.arrayLength<0?"":String(this.arrayLength))+"]"):this.baseType==="tuple"?(t!==Vt.sighash&&(r+=this.type),r+="("+this.components.map(i=>i.format(t)).join(t===Vt.full?", ":",")+")"):r+=this.type,t!==Vt.sighash&&(this.indexed===!0&&(r+=" indexed"),t===Vt.full&&this.name&&(r+=" "+this.name)),r}static from(t,r){return typeof t=="string"?qr.fromString(t,r):qr.fromObject(t)}static fromObject(t){return qr.isParamType(t)?t:new qr(Yl,{name:t.name||null,type:Rh(t.type),indexed:t.indexed==null?null:!!t.indexed,components:t.components?t.components.map(qr.fromObject):null})}static fromString(t,r){function i(n){return qr.fromObject({name:n.name,type:n.type,indexed:n.indexed,components:n.components})}return i(RK(t,!!r))}static isParamType(t){return!!(t!=null&&t._isParamType)}}function kd(e,t){return NK(e).map(r=>qr.fromString(r,t))}class Ua{constructor(t,r){t!==Yl&&Nt.throwError("use a static from method",ae.errors.UNSUPPORTED_OPERATION,{operation:"new Fragment()"}),Jp(this,r),this._isFragment=!0,Object.freeze(this)}static from(t){return Ua.isFragment(t)?t:typeof t=="string"?Ua.fromString(t):Ua.fromObject(t)}static fromObject(t){if(Ua.isFragment(t))return t;switch(t.type){case"function":return Ws.fromObject(t);case"event":return Na.fromObject(t);case"constructor":return js.fromObject(t);case"error":return Po.fromObject(t);case"fallback":case"receive":return null}return Nt.throwArgumentError("invalid fragment object","value",t)}static fromString(t){return t=t.replace(/\s/g," "),t=t.replace(/\(/g," (").replace(/\)/g,") ").replace(/\s+/g," "),t=t.trim(),t.split(" ")[0]==="event"?Na.fromString(t.substring(5).trim()):t.split(" ")[0]==="function"?Ws.fromString(t.substring(8).trim()):t.split("(")[0].trim()==="constructor"?js.fromString(t.trim()):t.split(" ")[0]==="error"?Po.fromString(t.substring(5).trim()):Nt.throwArgumentError("unsupported fragment","value",t)}static isFragment(t){return!!(t&&t._isFragment)}}class Na extends Ua{format(t){if(t||(t=Vt.sighash),Vt[t]||Nt.throwArgumentError("invalid format type","format",t),t===Vt.json)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(i=>JSON.parse(i.format(t)))});let r="";return t!==Vt.sighash&&(r+="event "),r+=this.name+"("+this.inputs.map(i=>i.format(t)).join(t===Vt.full?", ":",")+") ",t!==Vt.sighash&&this.anonymous&&(r+="anonymous "),r.trim()}static from(t){return typeof t=="string"?Na.fromString(t):Na.fromObject(t)}static fromObject(t){if(Na.isEventFragment(t))return t;t.type!=="event"&&Nt.throwArgumentError("invalid event object","value",t);const r={name:zd(t.name),anonymous:t.anonymous,inputs:t.inputs?t.inputs.map(qr.fromObject):[],type:"event"};return new Na(Yl,r)}static fromString(t){let r=t.match(Fd);r||Nt.throwArgumentError("invalid event string","value",t);let i=!1;return r[3].split(" ").forEach(n=>{switch(n.trim()){case"anonymous":i=!0;break;case"":break;default:Nt.warn("unknown modifier: "+n)}}),Na.fromObject({name:r[1].trim(),anonymous:i,inputs:kd(r[2],!0),type:"event"})}static isEventFragment(t){return t&&t._isFragment&&t.type==="event"}}function fP(e,t){t.gas=null;let r=e.split("@");return r.length!==1?(r.length>2&&Nt.throwArgumentError("invalid human-readable ABI signature","value",e),r[1].match(/^[0-9]+$/)||Nt.throwArgumentError("invalid human-readable ABI signature gas","value",e),t.gas=Te.from(r[1]),r[0]):e}function pP(e,t){t.constant=!1,t.payable=!1,t.stateMutability="nonpayable",e.split(" ").forEach(r=>{switch(r.trim()){case"constant":t.constant=!0;break;case"payable":t.payable=!0,t.stateMutability="payable";break;case"nonpayable":t.payable=!1,t.stateMutability="nonpayable";break;case"pure":t.constant=!0,t.stateMutability="pure";break;case"view":t.constant=!0,t.stateMutability="view";break;case"external":case"public":case"":break;default:console.log("unknown modifier: "+r)}})}function mP(e){let t={constant:!1,payable:!0,stateMutability:"payable"};return e.stateMutability!=null?(t.stateMutability=e.stateMutability,t.constant=t.stateMutability==="view"||t.stateMutability==="pure",e.constant!=null&&!!e.constant!==t.constant&&Nt.throwArgumentError("cannot have constant function with mutability "+t.stateMutability,"value",e),t.payable=t.stateMutability==="payable",e.payable!=null&&!!e.payable!==t.payable&&Nt.throwArgumentError("cannot have payable function with mutability "+t.stateMutability,"value",e)):e.payable!=null?(t.payable=!!e.payable,e.constant==null&&!t.payable&&e.type!=="constructor"&&Nt.throwArgumentError("unable to determine stateMutability","value",e),t.constant=!!e.constant,t.constant?t.stateMutability="view":t.stateMutability=t.payable?"payable":"nonpayable",t.payable&&t.constant&&Nt.throwArgumentError("cannot have constant payable function","value",e)):e.constant!=null?(t.constant=!!e.constant,t.payable=!t.constant,t.stateMutability=t.constant?"view":"payable"):e.type!=="constructor"&&Nt.throwArgumentError("unable to determine stateMutability","value",e),t}class js extends Ua{format(t){if(t||(t=Vt.sighash),Vt[t]||Nt.throwArgumentError("invalid format type","format",t),t===Vt.json)return JSON.stringify({type:"constructor",stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map(i=>JSON.parse(i.format(t)))});t===Vt.sighash&&Nt.throwError("cannot format a constructor for sighash",ae.errors.UNSUPPORTED_OPERATION,{operation:"format(sighash)"});let r="constructor("+this.inputs.map(i=>i.format(t)).join(t===Vt.full?", ":",")+") ";return this.stateMutability&&this.stateMutability!=="nonpayable"&&(r+=this.stateMutability+" "),r.trim()}static from(t){return typeof t=="string"?js.fromString(t):js.fromObject(t)}static fromObject(t){if(js.isConstructorFragment(t))return t;t.type!=="constructor"&&Nt.throwArgumentError("invalid constructor object","value",t);let r=mP(t);r.constant&&Nt.throwArgumentError("constructor cannot be constant","value",t);const i={name:null,type:t.type,inputs:t.inputs?t.inputs.map(qr.fromObject):[],payable:r.payable,stateMutability:r.stateMutability,gas:t.gas?Te.from(t.gas):null};return new js(Yl,i)}static fromString(t){let r={type:"constructor"};t=fP(t,r);let i=t.match(Fd);return(!i||i[1].trim()!=="constructor")&&Nt.throwArgumentError("invalid constructor string","value",t),r.inputs=kd(i[2].trim(),!1),pP(i[3].trim(),r),js.fromObject(r)}static isConstructorFragment(t){return t&&t._isFragment&&t.type==="constructor"}}class Ws extends js{format(t){if(t||(t=Vt.sighash),Vt[t]||Nt.throwArgumentError("invalid format type","format",t),t===Vt.json)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:this.stateMutability!=="nonpayable"?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map(i=>JSON.parse(i.format(t))),outputs:this.outputs.map(i=>JSON.parse(i.format(t)))});let r="";return t!==Vt.sighash&&(r+="function "),r+=this.name+"("+this.inputs.map(i=>i.format(t)).join(t===Vt.full?", ":",")+") ",t!==Vt.sighash&&(this.stateMutability?this.stateMutability!=="nonpayable"&&(r+=this.stateMutability+" "):this.constant&&(r+="view "),this.outputs&&this.outputs.length&&(r+="returns ("+this.outputs.map(i=>i.format(t)).join(", ")+") "),this.gas!=null&&(r+="@"+this.gas.toString()+" ")),r.trim()}static from(t){return typeof t=="string"?Ws.fromString(t):Ws.fromObject(t)}static fromObject(t){if(Ws.isFunctionFragment(t))return t;t.type!=="function"&&Nt.throwArgumentError("invalid function object","value",t);let r=mP(t);const i={type:t.type,name:zd(t.name),constant:r.constant,inputs:t.inputs?t.inputs.map(qr.fromObject):[],outputs:t.outputs?t.outputs.map(qr.fromObject):[],payable:r.payable,stateMutability:r.stateMutability,gas:t.gas?Te.from(t.gas):null};return new Ws(Yl,i)}static fromString(t){let r={type:"function"};t=fP(t,r);let i=t.split(" returns ");i.length>2&&Nt.throwArgumentError("invalid function string","value",t);let n=i[0].match(Fd);if(n||Nt.throwArgumentError("invalid function signature","value",t),r.name=n[1].trim(),r.name&&zd(r.name),r.inputs=kd(n[2],!1),pP(n[3].trim(),r),i.length>1){let s=i[1].match(Fd);(s[1].trim()!=""||s[3].trim()!="")&&Nt.throwArgumentError("unexpected tokens","value",t),r.outputs=kd(s[2],!1)}else r.outputs=[];return Ws.fromObject(r)}static isFunctionFragment(t){return t&&t._isFragment&&t.type==="function"}}function bE(e){const t=e.format();return(t==="Error(string)"||t==="Panic(uint256)")&&Nt.throwArgumentError(`cannot specify user defined ${t} error`,"fragment",e),e}class Po extends Ua{format(t){if(t||(t=Vt.sighash),Vt[t]||Nt.throwArgumentError("invalid format type","format",t),t===Vt.json)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(i=>JSON.parse(i.format(t)))});let r="";return t!==Vt.sighash&&(r+="error "),r+=this.name+"("+this.inputs.map(i=>i.format(t)).join(t===Vt.full?", ":",")+") ",r.trim()}static from(t){return typeof t=="string"?Po.fromString(t):Po.fromObject(t)}static fromObject(t){if(Po.isErrorFragment(t))return t;t.type!=="error"&&Nt.throwArgumentError("invalid error object","value",t);const r={type:t.type,name:zd(t.name),inputs:t.inputs?t.inputs.map(qr.fromObject):[]};return bE(new Po(Yl,r))}static fromString(t){let r={type:"error"},i=t.match(Fd);return i||Nt.throwArgumentError("invalid error signature","value",t),r.name=i[1].trim(),r.name&&zd(r.name),r.inputs=kd(i[2],!1),bE(Po.fromObject(r))}static isErrorFragment(t){return t&&t._isFragment&&t.type==="error"}}function Rh(e){return e.match(/^uint($|[^1-9])/)?e="uint256"+e.substring(4):e.match(/^int($|[^1-9])/)&&(e="int256"+e.substring(3)),e}const IK=new RegExp("^[a-zA-Z$_][a-zA-Z0-9$_]*$");function zd(e){return(!e||!e.match(IK))&&Nt.throwArgumentError(`invalid identifier "${e}"`,"value",e),e}const Fd=new RegExp("^([^)(]*)\\((.*)\\)([^)(]*)$");function NK(e){e=e.trim();let t=[],r="",i=0;for(let n=0;n<e.length;n++){let s=e[n];s===","&&i===0?(t.push(r),r=""):(r+=s,s==="("?i++:s===")"&&(i--,i===-1&&Nt.throwArgumentError("unbalanced parenthesis","value",e)))}return r&&t.push(r),t}const Fb=new ae(of);function BK(e){const t=[],r=function(i,n){if(!!Array.isArray(n))for(let s in n){const a=i.slice();a.push(s);try{r(a,n[s])}catch(o){t.push({path:a,error:o})}}};return r([],e),t}class ao{constructor(t,r,i,n){this.name=t,this.type=r,this.localName=i,this.dynamic=n}_throwError(t,r){Fb.throwArgumentError(t,this.localName,r)}}class _x{constructor(t){Ae(this,"wordSize",t||32),this._data=[],this._dataLength=0,this._padding=new Uint8Array(t)}get data(){return Xi(this._data)}get length(){return this._dataLength}_writeData(t){return this._data.push(t),this._dataLength+=t.length,t.length}appendWriter(t){return this._writeData(fn(t._data))}writeBytes(t){let r=ct(t);const i=r.length%this.wordSize;return i&&(r=fn([r,this._padding.slice(i)])),this._writeData(r)}_getValue(t){let r=ct(Te.from(t));return r.length>this.wordSize&&Fb.throwError("value out-of-bounds",ae.errors.BUFFER_OVERRUN,{length:this.wordSize,offset:r.length}),r.length%this.wordSize&&(r=fn([this._padding.slice(r.length%this.wordSize),r])),r}writeValue(t){return this._writeData(this._getValue(t))}writeUpdatableValue(){const t=this._data.length;return this._data.push(this._padding),this._dataLength+=this.wordSize,r=>{this._data[t]=this._getValue(r)}}}class tm{constructor(t,r,i,n){Ae(this,"_data",ct(t)),Ae(this,"wordSize",r||32),Ae(this,"_coerceFunc",i),Ae(this,"allowLoose",n),this._offset=0}get data(){return tt(this._data)}get consumed(){return this._offset}static coerce(t,r){let i=t.match("^u?int([0-9]+)$");return i&&parseInt(i[1])<=48&&(r=r.toNumber()),r}coerce(t,r){return this._coerceFunc?this._coerceFunc(t,r):tm.coerce(t,r)}_peekBytes(t,r,i){let n=Math.ceil(r/this.wordSize)*this.wordSize;return this._offset+n>this._data.length&&(this.allowLoose&&i&&this._offset+r<=this._data.length?n=r:Fb.throwError("data out-of-bounds",ae.errors.BUFFER_OVERRUN,{length:this._data.length,offset:this._offset+n})),this._data.slice(this._offset,this._offset+n)}subReader(t){return new tm(this._data.slice(this._offset+t),this.wordSize,this._coerceFunc,this.allowLoose)}readBytes(t,r){let i=this._peekBytes(0,t,!!r);return this._offset+=i.length,i.slice(0,t)}readValue(){return Te.from(this.readBytes(this.wordSize))}}var gP={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(e){(function(){var t="input is invalid type",r="finalize already called",i=typeof window=="object",n=i?window:{};n.JS_SHA3_NO_WINDOW&&(i=!1);var s=!i&&typeof self=="object",a=!n.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;a?n=a3:s&&(n=self);var o=!n.JS_SHA3_NO_COMMON_JS&&!0&&e.exports,l=!n.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",h="0123456789abcdef".split(""),u=[31,7936,2031616,520093696],c=[4,1024,262144,67108864],d=[1,256,65536,16777216],f=[6,1536,393216,100663296],p=[0,8,16,24],m=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],g=[224,256,384,512],v=[128,256],x=["hex","buffer","arrayBuffer","array","digest"],b={128:168,256:136};(n.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(T){return Object.prototype.toString.call(T)==="[object Array]"}),l&&(n.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(T){return typeof T=="object"&&T.buffer&&T.buffer.constructor===ArrayBuffer});for(var _=function(T,U,q){return function(W){return new w(T,U,T).update(W)[q]()}},E=function(T,U,q){return function(W,J){return new w(T,U,J).update(W)[q]()}},S=function(T,U,q){return function(W,J,K,ie){return y["cshake"+T].update(W,J,K,ie)[q]()}},P=function(T,U,q){return function(W,J,K,ie){return y["kmac"+T].update(W,J,K,ie)[q]()}},M=function(T,U,q,W){for(var J=0;J<x.length;++J){var K=x[J];T[K]=U(q,W,K)}return T},B=function(T,U){var q=_(T,U,"hex");return q.create=function(){return new w(T,U,T)},q.update=function(W){return q.create().update(W)},M(q,_,T,U)},R=function(T,U){var q=E(T,U,"hex");return q.create=function(W){return new w(T,U,W)},q.update=function(W,J){return q.create(J).update(W)},M(q,E,T,U)},H=function(T,U){var q=b[T],W=S(T,U,"hex");return W.create=function(J,K,ie){return!K&&!ie?y["shake"+T].create(J):new w(T,U,J).bytepad([K,ie],q)},W.update=function(J,K,ie,Z){return W.create(K,ie,Z).update(J)},M(W,S,T,U)},Q=function(T,U){var q=b[T],W=P(T,U,"hex");return W.create=function(J,K,ie){return new N(T,U,K).bytepad(["KMAC",ie],q).bytepad([J],q)},W.update=function(J,K,ie,Z){return W.create(J,ie,Z).update(K)},M(W,P,T,U)},z=[{name:"keccak",padding:d,bits:g,createMethod:B},{name:"sha3",padding:f,bits:g,createMethod:B},{name:"shake",padding:u,bits:v,createMethod:R},{name:"cshake",padding:c,bits:v,createMethod:H},{name:"kmac",padding:c,bits:v,createMethod:Q}],y={},A=[],D=0;D<z.length;++D)for(var O=z[D],C=O.bits,I=0;I<C.length;++I){var k=O.name+"_"+C[I];if(A.push(k),y[k]=O.createMethod(C[I],O.padding),O.name!=="sha3"){var L=O.name+C[I];A.push(L),y[L]=y[k]}}function w(T,U,q){this.blocks=[],this.s=[],this.padding=U,this.outputBits=q,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(T<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=q>>5,this.extraBytes=(q&31)>>3;for(var W=0;W<50;++W)this.s[W]=0}w.prototype.update=function(T){if(this.finalized)throw new Error(r);var U,q=typeof T;if(q!=="string"){if(q==="object"){if(T===null)throw new Error(t);if(l&&T.constructor===ArrayBuffer)T=new Uint8Array(T);else if(!Array.isArray(T)&&(!l||!ArrayBuffer.isView(T)))throw new Error(t)}else throw new Error(t);U=!0}for(var W=this.blocks,J=this.byteCount,K=T.length,ie=this.blockCount,Z=0,ue=this.s,le,ce;Z<K;){if(this.reset)for(this.reset=!1,W[0]=this.block,le=1;le<ie+1;++le)W[le]=0;if(U)for(le=this.start;Z<K&&le<J;++Z)W[le>>2]|=T[Z]<<p[le++&3];else for(le=this.start;Z<K&&le<J;++Z)ce=T.charCodeAt(Z),ce<128?W[le>>2]|=ce<<p[le++&3]:ce<2048?(W[le>>2]|=(192|ce>>6)<<p[le++&3],W[le>>2]|=(128|ce&63)<<p[le++&3]):ce<55296||ce>=57344?(W[le>>2]|=(224|ce>>12)<<p[le++&3],W[le>>2]|=(128|ce>>6&63)<<p[le++&3],W[le>>2]|=(128|ce&63)<<p[le++&3]):(ce=65536+((ce&1023)<<10|T.charCodeAt(++Z)&1023),W[le>>2]|=(240|ce>>18)<<p[le++&3],W[le>>2]|=(128|ce>>12&63)<<p[le++&3],W[le>>2]|=(128|ce>>6&63)<<p[le++&3],W[le>>2]|=(128|ce&63)<<p[le++&3]);if(this.lastByteIndex=le,le>=J){for(this.start=le-J,this.block=W[ie],le=0;le<ie;++le)ue[le]^=W[le];X(ue),this.reset=!0}else this.start=le}return this},w.prototype.encode=function(T,U){var q=T&255,W=1,J=[q];for(T=T>>8,q=T&255;q>0;)J.unshift(q),T=T>>8,q=T&255,++W;return U?J.push(W):J.unshift(W),this.update(J),J.length},w.prototype.encodeString=function(T){var U,q=typeof T;if(q!=="string"){if(q==="object"){if(T===null)throw new Error(t);if(l&&T.constructor===ArrayBuffer)T=new Uint8Array(T);else if(!Array.isArray(T)&&(!l||!ArrayBuffer.isView(T)))throw new Error(t)}else throw new Error(t);U=!0}var W=0,J=T.length;if(U)W=J;else for(var K=0;K<T.length;++K){var ie=T.charCodeAt(K);ie<128?W+=1:ie<2048?W+=2:ie<55296||ie>=57344?W+=3:(ie=65536+((ie&1023)<<10|T.charCodeAt(++K)&1023),W+=4)}return W+=this.encode(W*8),this.update(T),W},w.prototype.bytepad=function(T,U){for(var q=this.encode(U),W=0;W<T.length;++W)q+=this.encodeString(T[W]);var J=U-q%U,K=[];return K.length=J,this.update(K),this},w.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var T=this.blocks,U=this.lastByteIndex,q=this.blockCount,W=this.s;if(T[U>>2]|=this.padding[U&3],this.lastByteIndex===this.byteCount)for(T[0]=T[q],U=1;U<q+1;++U)T[U]=0;for(T[q-1]|=2147483648,U=0;U<q;++U)W[U]^=T[U];X(W)}},w.prototype.toString=w.prototype.hex=function(){this.finalize();for(var T=this.blockCount,U=this.s,q=this.outputBlocks,W=this.extraBytes,J=0,K=0,ie="",Z;K<q;){for(J=0;J<T&&K<q;++J,++K)Z=U[J],ie+=h[Z>>4&15]+h[Z&15]+h[Z>>12&15]+h[Z>>8&15]+h[Z>>20&15]+h[Z>>16&15]+h[Z>>28&15]+h[Z>>24&15];K%T===0&&(X(U),J=0)}return W&&(Z=U[J],ie+=h[Z>>4&15]+h[Z&15],W>1&&(ie+=h[Z>>12&15]+h[Z>>8&15]),W>2&&(ie+=h[Z>>20&15]+h[Z>>16&15])),ie},w.prototype.arrayBuffer=function(){this.finalize();var T=this.blockCount,U=this.s,q=this.outputBlocks,W=this.extraBytes,J=0,K=0,ie=this.outputBits>>3,Z;W?Z=new ArrayBuffer(q+1<<2):Z=new ArrayBuffer(ie);for(var ue=new Uint32Array(Z);K<q;){for(J=0;J<T&&K<q;++J,++K)ue[K]=U[J];K%T===0&&X(U)}return W&&(ue[J]=U[J],Z=Z.slice(0,ie)),Z},w.prototype.buffer=w.prototype.arrayBuffer,w.prototype.digest=w.prototype.array=function(){this.finalize();for(var T=this.blockCount,U=this.s,q=this.outputBlocks,W=this.extraBytes,J=0,K=0,ie=[],Z,ue;K<q;){for(J=0;J<T&&K<q;++J,++K)Z=K<<2,ue=U[J],ie[Z]=ue&255,ie[Z+1]=ue>>8&255,ie[Z+2]=ue>>16&255,ie[Z+3]=ue>>24&255;K%T===0&&X(U)}return W&&(Z=K<<2,ue=U[J],ie[Z]=ue&255,W>1&&(ie[Z+1]=ue>>8&255),W>2&&(ie[Z+2]=ue>>16&255)),ie};function N(T,U,q){w.call(this,T,U,q)}N.prototype=new w,N.prototype.finalize=function(){return this.encode(this.outputBits,!0),w.prototype.finalize.call(this)};var X=function(T){var U,q,W,J,K,ie,Z,ue,le,ce,ke,be,_e,ze,Be,Ve,j,G,se,ye,ge,we,et,oe,De,Me,xe,Y,Ee,ve,Le,Oe,Ie,pe,Xe,He,je,qt,Mt,Dt,at,Fe,We,dt,Je,it,It,st,V,ee,re,te,de,Ce,Re,ft,Ke,pt,yt,bt,Kt,li,Ai;for(W=0;W<48;W+=2)J=T[0]^T[10]^T[20]^T[30]^T[40],K=T[1]^T[11]^T[21]^T[31]^T[41],ie=T[2]^T[12]^T[22]^T[32]^T[42],Z=T[3]^T[13]^T[23]^T[33]^T[43],ue=T[4]^T[14]^T[24]^T[34]^T[44],le=T[5]^T[15]^T[25]^T[35]^T[45],ce=T[6]^T[16]^T[26]^T[36]^T[46],ke=T[7]^T[17]^T[27]^T[37]^T[47],be=T[8]^T[18]^T[28]^T[38]^T[48],_e=T[9]^T[19]^T[29]^T[39]^T[49],U=be^(ie<<1|Z>>>31),q=_e^(Z<<1|ie>>>31),T[0]^=U,T[1]^=q,T[10]^=U,T[11]^=q,T[20]^=U,T[21]^=q,T[30]^=U,T[31]^=q,T[40]^=U,T[41]^=q,U=J^(ue<<1|le>>>31),q=K^(le<<1|ue>>>31),T[2]^=U,T[3]^=q,T[12]^=U,T[13]^=q,T[22]^=U,T[23]^=q,T[32]^=U,T[33]^=q,T[42]^=U,T[43]^=q,U=ie^(ce<<1|ke>>>31),q=Z^(ke<<1|ce>>>31),T[4]^=U,T[5]^=q,T[14]^=U,T[15]^=q,T[24]^=U,T[25]^=q,T[34]^=U,T[35]^=q,T[44]^=U,T[45]^=q,U=ue^(be<<1|_e>>>31),q=le^(_e<<1|be>>>31),T[6]^=U,T[7]^=q,T[16]^=U,T[17]^=q,T[26]^=U,T[27]^=q,T[36]^=U,T[37]^=q,T[46]^=U,T[47]^=q,U=ce^(J<<1|K>>>31),q=ke^(K<<1|J>>>31),T[8]^=U,T[9]^=q,T[18]^=U,T[19]^=q,T[28]^=U,T[29]^=q,T[38]^=U,T[39]^=q,T[48]^=U,T[49]^=q,ze=T[0],Be=T[1],it=T[11]<<4|T[10]>>>28,It=T[10]<<4|T[11]>>>28,Y=T[20]<<3|T[21]>>>29,Ee=T[21]<<3|T[20]>>>29,bt=T[31]<<9|T[30]>>>23,Kt=T[30]<<9|T[31]>>>23,Fe=T[40]<<18|T[41]>>>14,We=T[41]<<18|T[40]>>>14,pe=T[2]<<1|T[3]>>>31,Xe=T[3]<<1|T[2]>>>31,Ve=T[13]<<12|T[12]>>>20,j=T[12]<<12|T[13]>>>20,st=T[22]<<10|T[23]>>>22,V=T[23]<<10|T[22]>>>22,ve=T[33]<<13|T[32]>>>19,Le=T[32]<<13|T[33]>>>19,li=T[42]<<2|T[43]>>>30,Ai=T[43]<<2|T[42]>>>30,Ce=T[5]<<30|T[4]>>>2,Re=T[4]<<30|T[5]>>>2,He=T[14]<<6|T[15]>>>26,je=T[15]<<6|T[14]>>>26,G=T[25]<<11|T[24]>>>21,se=T[24]<<11|T[25]>>>21,ee=T[34]<<15|T[35]>>>17,re=T[35]<<15|T[34]>>>17,Oe=T[45]<<29|T[44]>>>3,Ie=T[44]<<29|T[45]>>>3,oe=T[6]<<28|T[7]>>>4,De=T[7]<<28|T[6]>>>4,ft=T[17]<<23|T[16]>>>9,Ke=T[16]<<23|T[17]>>>9,qt=T[26]<<25|T[27]>>>7,Mt=T[27]<<25|T[26]>>>7,ye=T[36]<<21|T[37]>>>11,ge=T[37]<<21|T[36]>>>11,te=T[47]<<24|T[46]>>>8,de=T[46]<<24|T[47]>>>8,dt=T[8]<<27|T[9]>>>5,Je=T[9]<<27|T[8]>>>5,Me=T[18]<<20|T[19]>>>12,xe=T[19]<<20|T[18]>>>12,pt=T[29]<<7|T[28]>>>25,yt=T[28]<<7|T[29]>>>25,Dt=T[38]<<8|T[39]>>>24,at=T[39]<<8|T[38]>>>24,we=T[48]<<14|T[49]>>>18,et=T[49]<<14|T[48]>>>18,T[0]=ze^~Ve&G,T[1]=Be^~j&se,T[10]=oe^~Me&Y,T[11]=De^~xe&Ee,T[20]=pe^~He&qt,T[21]=Xe^~je&Mt,T[30]=dt^~it&st,T[31]=Je^~It&V,T[40]=Ce^~ft&pt,T[41]=Re^~Ke&yt,T[2]=Ve^~G&ye,T[3]=j^~se&ge,T[12]=Me^~Y&ve,T[13]=xe^~Ee&Le,T[22]=He^~qt&Dt,T[23]=je^~Mt&at,T[32]=it^~st&ee,T[33]=It^~V&re,T[42]=ft^~pt&bt,T[43]=Ke^~yt&Kt,T[4]=G^~ye&we,T[5]=se^~ge&et,T[14]=Y^~ve&Oe,T[15]=Ee^~Le&Ie,T[24]=qt^~Dt&Fe,T[25]=Mt^~at&We,T[34]=st^~ee&te,T[35]=V^~re&de,T[44]=pt^~bt&li,T[45]=yt^~Kt&Ai,T[6]=ye^~we&ze,T[7]=ge^~et&Be,T[16]=ve^~Oe&oe,T[17]=Le^~Ie&De,T[26]=Dt^~Fe&pe,T[27]=at^~We&Xe,T[36]=ee^~te&dt,T[37]=re^~de&Je,T[46]=bt^~li&Ce,T[47]=Kt^~Ai&Re,T[8]=we^~ze&Ve,T[9]=et^~Be&j,T[18]=Oe^~oe&Me,T[19]=Ie^~De&xe,T[28]=Fe^~pe&He,T[29]=We^~Xe&je,T[38]=te^~dt&it,T[39]=de^~Je&It,T[48]=li^~Ce&ft,T[49]=Ai^~Re&Ke,T[0]^=m[W],T[1]^=m[W+1]};if(o)e.exports=y;else for(D=0;D<A.length;++D)n[A[D]]=y[A[D]]})()})(gP);var kK=gP.exports;function Fr(e){return"0x"+kK.keccak_256(ct(e))}const zK="rlp/5.6.1",Is=new ae(zK);function _E(e){const t=[];for(;e;)t.unshift(e&255),e>>=8;return t}function SE(e,t,r){let i=0;for(let n=0;n<r;n++)i=i*256+e[t+n];return i}function vP(e){if(Array.isArray(e)){let i=[];if(e.forEach(function(s){i=i.concat(vP(s))}),i.length<=55)return i.unshift(192+i.length),i;const n=_E(i.length);return n.unshift(247+n.length),n.concat(i)}Bb(e)||Is.throwArgumentError("RLP object must be BytesLike","object",e);const t=Array.prototype.slice.call(ct(e));if(t.length===1&&t[0]<=127)return t;if(t.length<=55)return t.unshift(128+t.length),t;const r=_E(t.length);return r.unshift(183+r.length),r.concat(t)}function Jm(e){return tt(vP(e))}function ME(e,t,r,i){const n=[];for(;r<t+1+i;){const s=yP(e,r);n.push(s.result),r+=s.consumed,r>t+1+i&&Is.throwError("child data too short",ae.errors.BUFFER_OVERRUN,{})}return{consumed:1+i,result:n}}function yP(e,t){if(e.length===0&&Is.throwError("data too short",ae.errors.BUFFER_OVERRUN,{}),e[t]>=248){const r=e[t]-247;t+1+r>e.length&&Is.throwError("data short segment too short",ae.errors.BUFFER_OVERRUN,{});const i=SE(e,t+1,r);return t+1+r+i>e.length&&Is.throwError("data long segment too short",ae.errors.BUFFER_OVERRUN,{}),ME(e,t,t+1+r,r+i)}else if(e[t]>=192){const r=e[t]-192;return t+1+r>e.length&&Is.throwError("data array too short",ae.errors.BUFFER_OVERRUN,{}),ME(e,t,t+1,r)}else if(e[t]>=184){const r=e[t]-183;t+1+r>e.length&&Is.throwError("data array too short",ae.errors.BUFFER_OVERRUN,{});const i=SE(e,t+1,r);t+1+r+i>e.length&&Is.throwError("data array too short",ae.errors.BUFFER_OVERRUN,{});const n=tt(e.slice(t+1+r,t+1+r+i));return{consumed:1+r+i,result:n}}else if(e[t]>=128){const r=e[t]-128;t+1+r>e.length&&Is.throwError("data too short",ae.errors.BUFFER_OVERRUN,{});const i=tt(e.slice(t+1,t+1+r));return{consumed:1+r,result:i}}return{consumed:1,result:tt(e[t])}}function Ub(e){const t=ct(e),r=yP(t,0);return r.consumed!==t.length&&Is.throwArgumentError("invalid rlp data","data",e),r.result}const FK="address/5.6.1",Jh=new ae(FK);function AE(e){jt(e,20)||Jh.throwArgumentError("invalid address","address",e),e=e.toLowerCase();const t=e.substring(2).split(""),r=new Uint8Array(40);for(let n=0;n<40;n++)r[n]=t[n].charCodeAt(0);const i=ct(Fr(r));for(let n=0;n<40;n+=2)i[n>>1]>>4>=8&&(t[n]=t[n].toUpperCase()),(i[n>>1]&15)>=8&&(t[n+1]=t[n+1].toUpperCase());return"0x"+t.join("")}const UK=9007199254740991;function HK(e){return Math.log10?Math.log10(e):Math.log(e)/Math.LN10}const Hb={};for(let e=0;e<10;e++)Hb[String(e)]=String(e);for(let e=0;e<26;e++)Hb[String.fromCharCode(65+e)]=String(10+e);const EE=Math.floor(HK(UK));function GK(e){e=e.toUpperCase(),e=e.substring(4)+e.substring(0,2)+"00";let t=e.split("").map(i=>Hb[i]).join("");for(;t.length>=EE;){let i=t.substring(0,EE);t=parseInt(i,10)%97+t.substring(i.length)}let r=String(98-parseInt(t,10)%97);for(;r.length<2;)r="0"+r;return r}function si(e){let t=null;if(typeof e!="string"&&Jh.throwArgumentError("invalid address","address",e),e.match(/^(0x)?[0-9a-fA-F]{40}$/))e.substring(0,2)!=="0x"&&(e="0x"+e),t=AE(e),e.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&t!==e&&Jh.throwArgumentError("bad address checksum","address",e);else if(e.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(e.substring(2,4)!==GK(e)&&Jh.throwArgumentError("bad icap checksum","address",e),t=MK(e.substring(4));t.length<40;)t="0"+t;t=AE("0x"+t)}else Jh.throwArgumentError("invalid address","address",e);return t}function xP(e){let t=null;try{t=si(e.from)}catch{Jh.throwArgumentError("missing from address","transaction",e)}const r=Au(ct(Te.from(e.nonce).toHexString()));return si(di(Fr(Jm([t,r])),12))}class VK extends ao{constructor(t){super("address","address",t,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(t,r){try{r=si(r)}catch(i){this._throwError(i.message,r)}return t.writeValue(r)}decode(t){return si(ar(t.readValue().toHexString(),20))}}class jK extends ao{constructor(t){super(t.name,t.type,void 0,t.dynamic),this.coder=t}defaultValue(){return this.coder.defaultValue()}encode(t,r){return this.coder.encode(t,r)}decode(t){return this.coder.decode(t)}}const Kh=new ae(of);function wP(e,t,r){let i=null;if(Array.isArray(r))i=r;else if(r&&typeof r=="object"){let l={};i=t.map(h=>{const u=h.localName;return u||Kh.throwError("cannot encode object for signature with missing names",ae.errors.INVALID_ARGUMENT,{argument:"values",coder:h,value:r}),l[u]&&Kh.throwError("cannot encode object for signature with duplicate names",ae.errors.INVALID_ARGUMENT,{argument:"values",coder:h,value:r}),l[u]=!0,r[u]})}else Kh.throwArgumentError("invalid tuple value","tuple",r);t.length!==i.length&&Kh.throwArgumentError("types/value length mismatch","tuple",r);let n=new _x(e.wordSize),s=new _x(e.wordSize),a=[];t.forEach((l,h)=>{let u=i[h];if(l.dynamic){let c=s.length;l.encode(s,u);let d=n.writeUpdatableValue();a.push(f=>{d(f+c)})}else l.encode(n,u)}),a.forEach(l=>{l(n.length)});let o=e.appendWriter(n);return o+=e.appendWriter(s),o}function bP(e,t){let r=[],i=e.subReader(0);t.forEach(s=>{let a=null;if(s.dynamic){let o=e.readValue(),l=i.subReader(o.toNumber());try{a=s.decode(l)}catch(h){if(h.code===ae.errors.BUFFER_OVERRUN)throw h;a=h,a.baseType=s.name,a.name=s.localName,a.type=s.type}}else try{a=s.decode(e)}catch(o){if(o.code===ae.errors.BUFFER_OVERRUN)throw o;a=o,a.baseType=s.name,a.name=s.localName,a.type=s.type}a!=null&&r.push(a)});const n=t.reduce((s,a)=>{const o=a.localName;return o&&(s[o]||(s[o]=0),s[o]++),s},{});t.forEach((s,a)=>{let o=s.localName;if(!o||n[o]!==1||(o==="length"&&(o="_length"),r[o]!=null))return;const l=r[a];l instanceof Error?Object.defineProperty(r,o,{enumerable:!0,get:()=>{throw l}}):r[o]=l});for(let s=0;s<r.length;s++){const a=r[s];a instanceof Error&&Object.defineProperty(r,s,{enumerable:!0,get:()=>{throw a}})}return Object.freeze(r)}class WK extends ao{constructor(t,r,i){const n=t.type+"["+(r>=0?r:"")+"]",s=r===-1||t.dynamic;super("array",n,i,s),this.coder=t,this.length=r}defaultValue(){const t=this.coder.defaultValue(),r=[];for(let i=0;i<this.length;i++)r.push(t);return r}encode(t,r){Array.isArray(r)||this._throwError("expected array value",r);let i=this.length;i===-1&&(i=r.length,t.writeValue(r.length)),Kh.checkArgumentCount(r.length,i,"coder array"+(this.localName?" "+this.localName:""));let n=[];for(let s=0;s<r.length;s++)n.push(this.coder);return wP(t,n,r)}decode(t){let r=this.length;r===-1&&(r=t.readValue().toNumber(),r*32>t._data.length&&Kh.throwError("insufficient data length",ae.errors.BUFFER_OVERRUN,{length:t._data.length,count:r}));let i=[];for(let n=0;n<r;n++)i.push(new jK(this.coder));return t.coerce(this.name,bP(t,i))}}class qK extends ao{constructor(t){super("bool","bool",t,!1)}defaultValue(){return!1}encode(t,r){return t.writeValue(r?1:0)}decode(t){return t.coerce(this.type,!t.readValue().isZero())}}class _P extends ao{constructor(t,r){super(t,t,r,!0)}defaultValue(){return"0x"}encode(t,r){r=ct(r);let i=t.writeValue(r.length);return i+=t.writeBytes(r),i}decode(t){return t.readBytes(t.readValue().toNumber(),!0)}}class YK extends _P{constructor(t){super("bytes",t)}decode(t){return t.coerce(this.name,tt(super.decode(t)))}}class XK extends ao{constructor(t,r){let i="bytes"+String(t);super(i,i,r,!1),this.size=t}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+this.size*2)}encode(t,r){let i=ct(r);return i.length!==this.size&&this._throwError("incorrect data length",r),t.writeBytes(i)}decode(t){return t.coerce(this.name,tt(t.readBytes(this.size)))}}class QK extends ao{constructor(t){super("null","",t,!1)}defaultValue(){return null}encode(t,r){return r!=null&&this._throwError("not null",r),t.writeBytes([])}decode(t){return t.readBytes(0),t.coerce(this.name,null)}}const JK="0x0000000000000000000000000000000000000000",KK=Te.from(-1),SP=Te.from(0),ZK=Te.from(1),$K=Te.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),eZ="0x0000000000000000000000000000000000000000000000000000000000000000";class tZ extends ao{constructor(t,r,i){const n=(r?"int":"uint")+t*8;super(n,n,i,!1),this.size=t,this.signed=r}defaultValue(){return 0}encode(t,r){let i=Te.from(r),n=$K.mask(t.wordSize*8);if(this.signed){let s=n.mask(this.size*8-1);(i.gt(s)||i.lt(s.add(ZK).mul(KK)))&&this._throwError("value out-of-bounds",r)}else(i.lt(SP)||i.gt(n.mask(this.size*8)))&&this._throwError("value out-of-bounds",r);return i=i.toTwos(this.size*8).mask(this.size*8),this.signed&&(i=i.fromTwos(this.size*8).toTwos(8*t.wordSize)),t.writeValue(i)}decode(t){let r=t.readValue().mask(this.size*8);return this.signed&&(r=r.fromTwos(this.size*8)),t.coerce(this.name,r)}}const rZ="strings/5.6.1",MP=new ae(rZ);var Eu;(function(e){e.current="",e.NFC="NFC",e.NFD="NFD",e.NFKC="NFKC",e.NFKD="NFKD"})(Eu||(Eu={}));var un;(function(e){e.UNEXPECTED_CONTINUE="unexpected continuation byte",e.BAD_PREFIX="bad codepoint prefix",e.OVERRUN="string overrun",e.MISSING_CONTINUE="missing continuation byte",e.OUT_OF_RANGE="out of UTF-8 range",e.UTF16_SURROGATE="UTF-16 surrogate",e.OVERLONG="overlong representation"})(un||(un={}));function iZ(e,t,r,i,n){return MP.throwArgumentError(`invalid codepoint at offset ${t}; ${e}`,"bytes",r)}function AP(e,t,r,i,n){if(e===un.BAD_PREFIX||e===un.UNEXPECTED_CONTINUE){let s=0;for(let a=t+1;a<r.length&&r[a]>>6===2;a++)s++;return s}return e===un.OVERRUN?r.length-t-1:0}function nZ(e,t,r,i,n){return e===un.OVERLONG?(i.push(n),0):(i.push(65533),AP(e,t,r))}const sZ=Object.freeze({error:iZ,ignore:AP,replace:nZ});function EP(e,t){t==null&&(t=sZ.error),e=ct(e);const r=[];let i=0;for(;i<e.length;){const n=e[i++];if(n>>7===0){r.push(n);continue}let s=null,a=null;if((n&224)===192)s=1,a=127;else if((n&240)===224)s=2,a=2047;else if((n&248)===240)s=3,a=65535;else{(n&192)===128?i+=t(un.UNEXPECTED_CONTINUE,i-1,e,r):i+=t(un.BAD_PREFIX,i-1,e,r);continue}if(i-1+s>=e.length){i+=t(un.OVERRUN,i-1,e,r);continue}let o=n&(1<<8-s-1)-1;for(let l=0;l<s;l++){let h=e[i];if((h&192)!=128){i+=t(un.MISSING_CONTINUE,i,e,r),o=null;break}o=o<<6|h&63,i++}if(o!==null){if(o>1114111){i+=t(un.OUT_OF_RANGE,i-1-s,e,r,o);continue}if(o>=55296&&o<=57343){i+=t(un.UTF16_SURROGATE,i-1-s,e,r,o);continue}if(o<=a){i+=t(un.OVERLONG,i-1-s,e,r,o);continue}r.push(o)}}return r}function ca(e,t=Eu.current){t!=Eu.current&&(MP.checkNormalize(),e=e.normalize(t));let r=[];for(let i=0;i<e.length;i++){const n=e.charCodeAt(i);if(n<128)r.push(n);else if(n<2048)r.push(n>>6|192),r.push(n&63|128);else if((n&64512)==55296){i++;const s=e.charCodeAt(i);if(i>=e.length||(s&64512)!==56320)throw new Error("invalid utf-8 string");const a=65536+((n&1023)<<10)+(s&1023);r.push(a>>18|240),r.push(a>>12&63|128),r.push(a>>6&63|128),r.push(a&63|128)}else r.push(n>>12|224),r.push(n>>6&63|128),r.push(n&63|128)}return ct(r)}function Sx(e){return e.map(t=>t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10&1023)+55296,(t&1023)+56320))).join("")}function lf(e,t){return Sx(EP(e,t))}function CE(e,t=Eu.current){return EP(ca(e,t))}function aZ(e){if(e.length%4!==0)throw new Error("bad data");let t=[];for(let r=0;r<e.length;r+=4)t.push(parseInt(e.substring(r,r+4),16));return t}function Gb(e,t){t||(t=function(n){return[parseInt(n,16)]});let r=0,i={};return e.split(",").forEach(n=>{let s=n.split(":");r+=parseInt(s[0],16),i[r]=t(s[1])}),i}function CP(e){let t=0;return e.split(",").map(r=>{let i=r.split("-");i.length===1?i[1]="0":i[1]===""&&(i[1]="1");let n=t+parseInt(i[0],16);return t=parseInt(i[1],16),{l:n,h:t}})}function Vb(e,t){let r=0;for(let i=0;i<t.length;i++){let n=t[i];if(r+=n.l,e>=r&&e<=r+n.h&&(e-r)%(n.d||1)===0){if(n.e&&n.e.indexOf(e-r)!==-1)continue;return n}}return null}const oZ=CP("221,13-1b,5f-,40-10,51-f,11-3,3-3,2-2,2-4,8,2,15,2d,28-8,88,48,27-,3-5,11-20,27-,8,28,3-5,12,18,b-a,1c-4,6-16,2-d,2-2,2,1b-4,17-9,8f-,10,f,1f-2,1c-34,33-14e,4,36-,13-,6-2,1a-f,4,9-,3-,17,8,2-2,5-,2,8-,3-,4-8,2-3,3,6-,16-6,2-,7-3,3-,17,8,3,3,3-,2,6-3,3-,4-a,5,2-6,10-b,4,8,2,4,17,8,3,6-,b,4,4-,2-e,2-4,b-10,4,9-,3-,17,8,3-,5-,9-2,3-,4-7,3-3,3,4-3,c-10,3,7-2,4,5-2,3,2,3-2,3-2,4-2,9,4-3,6-2,4,5-8,2-e,d-d,4,9,4,18,b,6-3,8,4,5-6,3-8,3-3,b-11,3,9,4,18,b,6-3,8,4,5-6,3-6,2,3-3,b-11,3,9,4,18,11-3,7-,4,5-8,2-7,3-3,b-11,3,13-2,19,a,2-,8-2,2-3,7,2,9-11,4-b,3b-3,1e-24,3,2-,3,2-,2-5,5,8,4,2,2-,3,e,4-,6,2,7-,b-,3-21,49,23-5,1c-3,9,25,10-,2-2f,23,6,3,8-2,5-5,1b-45,27-9,2a-,2-3,5b-4,45-4,53-5,8,40,2,5-,8,2,5-,28,2,5-,20,2,5-,8,2,5-,8,8,18,20,2,5-,8,28,14-5,1d-22,56-b,277-8,1e-2,52-e,e,8-a,18-8,15-b,e,4,3-b,5e-2,b-15,10,b-5,59-7,2b-555,9d-3,5b-5,17-,7-,27-,7-,9,2,2,2,20-,36,10,f-,7,14-,4,a,54-3,2-6,6-5,9-,1c-10,13-1d,1c-14,3c-,10-6,32-b,240-30,28-18,c-14,a0,115-,3,66-,b-76,5,5-,1d,24,2,5-2,2,8-,35-2,19,f-10,1d-3,311-37f,1b,5a-b,d7-19,d-3,41,57-,68-4,29-3,5f,29-37,2e-2,25-c,2c-2,4e-3,30,78-3,64-,20,19b7-49,51a7-59,48e-2,38-738,2ba5-5b,222f-,3c-94,8-b,6-4,1b,6,2,3,3,6d-20,16e-f,41-,37-7,2e-2,11-f,5-b,18-,b,14,5-3,6,88-,2,bf-2,7-,7-,7-,4-2,8,8-9,8-2ff,20,5-b,1c-b4,27-,27-cbb1,f7-9,28-2,b5-221,56,48,3-,2-,3-,5,d,2,5,3,42,5-,9,8,1d,5,6,2-2,8,153-3,123-3,33-27fd,a6da-5128,21f-5df,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3,2-1d,61-ff7d"),lZ="ad,34f,1806,180b,180c,180d,200b,200c,200d,2060,feff".split(",").map(e=>parseInt(e,16)),hZ=[{h:25,s:32,l:65},{h:30,s:32,e:[23],l:127},{h:54,s:1,e:[48],l:64,d:2},{h:14,s:1,l:57,d:2},{h:44,s:1,l:17,d:2},{h:10,s:1,e:[2,6,8],l:61,d:2},{h:16,s:1,l:68,d:2},{h:84,s:1,e:[18,24,66],l:19,d:2},{h:26,s:32,e:[17],l:435},{h:22,s:1,l:71,d:2},{h:15,s:80,l:40},{h:31,s:32,l:16},{h:32,s:1,l:80,d:2},{h:52,s:1,l:42,d:2},{h:12,s:1,l:55,d:2},{h:40,s:1,e:[38],l:15,d:2},{h:14,s:1,l:48,d:2},{h:37,s:48,l:49},{h:148,s:1,l:6351,d:2},{h:88,s:1,l:160,d:2},{h:15,s:16,l:704},{h:25,s:26,l:854},{h:25,s:32,l:55915},{h:37,s:40,l:1247},{h:25,s:-119711,l:53248},{h:25,s:-119763,l:52},{h:25,s:-119815,l:52},{h:25,s:-119867,e:[1,4,5,7,8,11,12,17],l:52},{h:25,s:-119919,l:52},{h:24,s:-119971,e:[2,7,8,17],l:52},{h:24,s:-120023,e:[2,7,13,15,16,17],l:52},{h:25,s:-120075,l:52},{h:25,s:-120127,l:52},{h:25,s:-120179,l:52},{h:25,s:-120231,l:52},{h:25,s:-120283,l:52},{h:25,s:-120335,l:52},{h:24,s:-119543,e:[17],l:56},{h:24,s:-119601,e:[17],l:58},{h:24,s:-119659,e:[17],l:58},{h:24,s:-119717,e:[17],l:58},{h:24,s:-119775,e:[17],l:58}],uZ=Gb("b5:3bc,c3:ff,7:73,2:253,5:254,3:256,1:257,5:259,1:25b,3:260,1:263,2:269,1:268,5:26f,1:272,2:275,7:280,3:283,5:288,3:28a,1:28b,5:292,3f:195,1:1bf,29:19e,125:3b9,8b:3b2,1:3b8,1:3c5,3:3c6,1:3c0,1a:3ba,1:3c1,1:3c3,2:3b8,1:3b5,1bc9:3b9,1c:1f76,1:1f77,f:1f7a,1:1f7b,d:1f78,1:1f79,1:1f7c,1:1f7d,107:63,5:25b,4:68,1:68,1:68,3:69,1:69,1:6c,3:6e,4:70,1:71,1:72,1:72,1:72,7:7a,2:3c9,2:7a,2:6b,1:e5,1:62,1:63,3:65,1:66,2:6d,b:3b3,1:3c0,6:64,1b574:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3"),cZ=Gb("179:1,2:1,2:1,5:1,2:1,a:4f,a:1,8:1,2:1,2:1,3:1,5:1,3:1,4:1,2:1,3:1,4:1,8:2,1:1,2:2,1:1,2:2,27:2,195:26,2:25,1:25,1:25,2:40,2:3f,1:3f,33:1,11:-6,1:-9,1ac7:-3a,6d:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,b:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,c:-8,2:-8,2:-8,2:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,49:-8,1:-8,1:-4a,1:-4a,d:-56,1:-56,1:-56,1:-56,d:-8,1:-8,f:-8,1:-8,3:-7"),dZ=Gb("df:00730073,51:00690307,19:02BC006E,a7:006A030C,18a:002003B9,16:03B903080301,20:03C503080301,1d7:05650582,190f:00680331,1:00740308,1:0077030A,1:0079030A,1:006102BE,b6:03C50313,2:03C503130300,2:03C503130301,2:03C503130342,2a:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,3:1F7003B9,1:03B103B9,1:03AC03B9,2:03B10342,1:03B1034203B9,5:03B103B9,6:1F7403B9,1:03B703B9,1:03AE03B9,2:03B70342,1:03B7034203B9,5:03B703B9,6:03B903080300,1:03B903080301,3:03B90342,1:03B903080342,b:03C503080300,1:03C503080301,1:03C10313,2:03C50342,1:03C503080342,b:1F7C03B9,1:03C903B9,1:03CE03B9,2:03C90342,1:03C9034203B9,5:03C903B9,ac:00720073,5b:00B00063,6:00B00066,d:006E006F,a:0073006D,1:00740065006C,1:0074006D,124f:006800700061,2:00610075,2:006F0076,b:00700061,1:006E0061,1:03BC0061,1:006D0061,1:006B0061,1:006B0062,1:006D0062,1:00670062,3:00700066,1:006E0066,1:03BC0066,4:0068007A,1:006B0068007A,1:006D0068007A,1:00670068007A,1:00740068007A,15:00700061,1:006B00700061,1:006D00700061,1:006700700061,8:00700076,1:006E0076,1:03BC0076,1:006D0076,1:006B0076,1:006D0076,1:00700077,1:006E0077,1:03BC0077,1:006D0077,1:006B0077,1:006D0077,1:006B03C9,1:006D03C9,2:00620071,3:00632215006B0067,1:0063006F002E,1:00640062,1:00670079,2:00680070,2:006B006B,1:006B006D,9:00700068,2:00700070006D,1:00700072,2:00730076,1:00770062,c723:00660066,1:00660069,1:0066006C,1:006600660069,1:00660066006C,1:00730074,1:00730074,d:05740576,1:05740565,1:0574056B,1:057E0576,1:0574056D",aZ),fZ=CP("80-20,2a0-,39c,32,f71,18e,7f2-f,19-7,30-4,7-5,f81-b,5,a800-20ff,4d1-1f,110,fa-6,d174-7,2e84-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,2,1f-5f,ff7f-20001");function pZ(e){return e.reduce((t,r)=>(r.forEach(i=>{t.push(i)}),t),[])}function mZ(e){return!!Vb(e,oZ)}function gZ(e){let t=Vb(e,hZ);if(t)return[e+t.s];let r=uZ[e];if(r)return r;let i=cZ[e];if(i)return[e+i[0]];let n=dZ[e];return n||null}function vZ(e){return!!Vb(e,fZ)}function TP(e){if(e.match(/^[a-z0-9-]*$/i)&&e.length<=59)return e.toLowerCase();let t=CE(e);t=pZ(t.map(i=>{if(lZ.indexOf(i)>=0)return[];if(i>=65024&&i<=65039)return[];let n=gZ(i);return n||[i]})),t=CE(Sx(t),Eu.NFKC),t.forEach(i=>{if(vZ(i))throw new Error("STRINGPREP_CONTAINS_PROHIBITED")}),t.forEach(i=>{if(mZ(i))throw new Error("STRINGPREP_CONTAINS_UNASSIGNED")});let r=Sx(t);if(r.substring(0,1)==="-"||r.substring(2,4)==="--"||r.substring(r.length-1)==="-")throw new Error("invalid hyphen");if(r.length>63)throw new Error("too long");return r}class yZ extends _P{constructor(t){super("string",t)}defaultValue(){return""}encode(t,r){return super.encode(t,ca(r))}decode(t){return lf(super.decode(t))}}class _p extends ao{constructor(t,r){let i=!1;const n=[];t.forEach(a=>{a.dynamic&&(i=!0),n.push(a.type)});const s="tuple("+n.join(",")+")";super("tuple",s,r,i),this.coders=t}defaultValue(){const t=[];this.coders.forEach(i=>{t.push(i.defaultValue())});const r=this.coders.reduce((i,n)=>{const s=n.localName;return s&&(i[s]||(i[s]=0),i[s]++),i},{});return this.coders.forEach((i,n)=>{let s=i.localName;!s||r[s]!==1||(s==="length"&&(s="_length"),t[s]==null&&(t[s]=t[n]))}),Object.freeze(t)}encode(t,r){return wP(t,this.coders,r)}decode(t){return t.coerce(this.name,bP(t,this.coders))}}const Sp=new ae(of),xZ=new RegExp(/^bytes([0-9]*)$/),wZ=new RegExp(/^(u?int)([0-9]*)$/);class bZ{constructor(t){Ae(this,"coerceFunc",t||null)}_getCoder(t){switch(t.baseType){case"address":return new VK(t.name);case"bool":return new qK(t.name);case"string":return new yZ(t.name);case"bytes":return new YK(t.name);case"array":return new WK(this._getCoder(t.arrayChildren),t.arrayLength,t.name);case"tuple":return new _p((t.components||[]).map(i=>this._getCoder(i)),t.name);case"":return new QK(t.name)}let r=t.type.match(wZ);if(r){let i=parseInt(r[2]||"256");return(i===0||i>256||i%8!==0)&&Sp.throwArgumentError("invalid "+r[1]+" bit length","param",t),new tZ(i/8,r[1]==="int",t.name)}if(r=t.type.match(xZ),r){let i=parseInt(r[1]);return(i===0||i>32)&&Sp.throwArgumentError("invalid bytes length","param",t),new XK(i,t.name)}return Sp.throwArgumentError("invalid type","type",t.type)}_getWordSize(){return 32}_getReader(t,r){return new tm(t,this._getWordSize(),this.coerceFunc,r)}_getWriter(){return new _x(this._getWordSize())}getDefaultValue(t){const r=t.map(n=>this._getCoder(qr.from(n)));return new _p(r,"_").defaultValue()}encode(t,r){t.length!==r.length&&Sp.throwError("types/values length mismatch",ae.errors.INVALID_ARGUMENT,{count:{types:t.length,values:r.length},value:{types:t,values:r}});const i=t.map(a=>this._getCoder(qr.from(a))),n=new _p(i,"_"),s=this._getWriter();return n.encode(s,r),s.data}decode(t,r,i){const n=t.map(a=>this._getCoder(qr.from(a)));return new _p(n,"_").decode(this._getReader(ct(r),i))}}const _Z=new bZ;function Zh(e){return Fr(ca(e))}const DP="hash/5.6.1",TE=new ae(DP),PP=new Uint8Array(32);PP.fill(0);const SZ=new RegExp("^((.*)\\.)?([^.]+)$");function Kp(e){typeof e!="string"&&TE.throwArgumentError("invalid ENS name; not a string","name",e);let t=e,r=PP;for(;t.length;){const i=t.match(SZ);(i==null||i[2]==="")&&TE.throwArgumentError("invalid ENS address; missing component","name",e);const n=ca(TP(i[3]));r=Fr(fn([r,Fr(n)])),t=i[2]||""}return tt(r)}function MZ(e){return tt(fn(e.split(".").map(t=>{const r=ca("_"+TP(t));return r[0]=r.length-1,r})))+"00"}var AZ=globalThis&&globalThis.__awaiter||function(e,t,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{h(i.next(u))}catch(c){a(c)}}function l(u){try{h(i.throw(u))}catch(c){a(c)}}function h(u){u.done?s(u.value):n(u.value).then(o,l)}h((i=i.apply(e,t||[])).next())})};const lr=new ae(DP),LP=new Uint8Array(32);LP.fill(0);const EZ=Te.from(-1),RP=Te.from(0),OP=Te.from(1),CZ=Te.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function TZ(e){const t=ct(e),r=t.length%32;return r?Xi([t,LP.slice(r)]):tt(t)}const DZ=ar(OP.toHexString(),32),PZ=ar(RP.toHexString(),32),DE={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},t1=["name","version","chainId","verifyingContract","salt"];function PE(e){return function(t){return typeof t!="string"&&lr.throwArgumentError(`invalid domain value for ${JSON.stringify(e)}`,`domain.${e}`,t),t}}const LZ={name:PE("name"),version:PE("version"),chainId:function(e){try{return Te.from(e).toString()}catch{}return lr.throwArgumentError('invalid domain value for "chainId"',"domain.chainId",e)},verifyingContract:function(e){try{return si(e).toLowerCase()}catch{}return lr.throwArgumentError('invalid domain value "verifyingContract"',"domain.verifyingContract",e)},salt:function(e){try{const t=ct(e);if(t.length!==32)throw new Error("bad length");return tt(t)}catch{}return lr.throwArgumentError('invalid domain value "salt"',"domain.salt",e)}};function r1(e){{const t=e.match(/^(u?)int(\d*)$/);if(t){const r=t[1]==="",i=parseInt(t[2]||"256");(i%8!==0||i>256||t[2]&&t[2]!==String(i))&&lr.throwArgumentError("invalid numeric width","type",e);const n=CZ.mask(r?i-1:i),s=r?n.add(OP).mul(EZ):RP;return function(a){const o=Te.from(a);return(o.lt(s)||o.gt(n))&&lr.throwArgumentError(`value out-of-bounds for ${e}`,"value",a),ar(o.toTwos(256).toHexString(),32)}}}{const t=e.match(/^bytes(\d+)$/);if(t){const r=parseInt(t[1]);return(r===0||r>32||t[1]!==String(r))&&lr.throwArgumentError("invalid bytes width","type",e),function(i){return ct(i).length!==r&&lr.throwArgumentError(`invalid length for ${e}`,"value",i),TZ(i)}}}switch(e){case"address":return function(t){return ar(si(t),32)};case"bool":return function(t){return t?DZ:PZ};case"bytes":return function(t){return Fr(t)};case"string":return function(t){return Zh(t)}}return null}function LE(e,t){return`${e}(${t.map(({name:r,type:i})=>i+" "+r).join(",")})`}class on{constructor(t){Ae(this,"types",Object.freeze($a(t))),Ae(this,"_encoderCache",{}),Ae(this,"_types",{});const r={},i={},n={};Object.keys(t).forEach(o=>{r[o]={},i[o]=[],n[o]={}});for(const o in t){const l={};t[o].forEach(h=>{l[h.name]&&lr.throwArgumentError(`duplicate variable name ${JSON.stringify(h.name)} in ${JSON.stringify(o)}`,"types",t),l[h.name]=!0;const u=h.type.match(/^([^\x5b]*)(\x5b|$)/)[1];u===o&&lr.throwArgumentError(`circular type reference to ${JSON.stringify(u)}`,"types",t),!r1(u)&&(i[u]||lr.throwArgumentError(`unknown type ${JSON.stringify(u)}`,"types",t),i[u].push(o),r[o][u]=!0)})}const s=Object.keys(i).filter(o=>i[o].length===0);s.length===0?lr.throwArgumentError("missing primary type","types",t):s.length>1&&lr.throwArgumentError(`ambiguous primary types or unused types: ${s.map(o=>JSON.stringify(o)).join(", ")}`,"types",t),Ae(this,"primaryType",s[0]);function a(o,l){l[o]&&lr.throwArgumentError(`circular type reference to ${JSON.stringify(o)}`,"types",t),l[o]=!0,Object.keys(r[o]).forEach(h=>{!i[h]||(a(h,l),Object.keys(l).forEach(u=>{n[u][h]=!0}))}),delete l[o]}a(this.primaryType,{});for(const o in n){const l=Object.keys(n[o]);l.sort(),this._types[o]=LE(o,t[o])+l.map(h=>LE(h,t[h])).join("")}}getEncoder(t){let r=this._encoderCache[t];return r||(r=this._encoderCache[t]=this._getEncoder(t)),r}_getEncoder(t){{const n=r1(t);if(n)return n}const r=t.match(/^(.*)(\x5b(\d*)\x5d)$/);if(r){const n=r[1],s=this.getEncoder(n),a=parseInt(r[3]);return o=>{a>=0&&o.length!==a&&lr.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",o);let l=o.map(s);return this._types[n]&&(l=l.map(Fr)),Fr(Xi(l))}}const i=this.types[t];if(i){const n=Zh(this._types[t]);return s=>{const a=i.map(({name:o,type:l})=>{const h=this.getEncoder(l)(s[o]);return this._types[l]?Fr(h):h});return a.unshift(n),Xi(a)}}return lr.throwArgumentError(`unknown type: ${t}`,"type",t)}encodeType(t){const r=this._types[t];return r||lr.throwArgumentError(`unknown type: ${JSON.stringify(t)}`,"name",t),r}encodeData(t,r){return this.getEncoder(t)(r)}hashStruct(t,r){return Fr(this.encodeData(t,r))}encode(t){return this.encodeData(this.primaryType,t)}hash(t){return this.hashStruct(this.primaryType,t)}_visit(t,r,i){if(r1(t))return i(t,r);const n=t.match(/^(.*)(\x5b(\d*)\x5d)$/);if(n){const a=n[1],o=parseInt(n[3]);return o>=0&&r.length!==o&&lr.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",r),r.map(l=>this._visit(a,l,i))}const s=this.types[t];return s?s.reduce((a,{name:o,type:l})=>(a[o]=this._visit(l,r[o],i),a),{}):lr.throwArgumentError(`unknown type: ${t}`,"type",t)}visit(t,r){return this._visit(this.primaryType,t,r)}static from(t){return new on(t)}static getPrimaryType(t){return on.from(t).primaryType}static hashStruct(t,r,i){return on.from(r).hashStruct(t,i)}static hashDomain(t){const r=[];for(const i in t){const n=DE[i];n||lr.throwArgumentError(`invalid typed-data domain key: ${JSON.stringify(i)}`,"domain",t),r.push({name:i,type:n})}return r.sort((i,n)=>t1.indexOf(i.name)-t1.indexOf(n.name)),on.hashStruct("EIP712Domain",{EIP712Domain:r},t)}static encode(t,r,i){return Xi(["0x1901",on.hashDomain(t),on.from(r).hash(i)])}static hash(t,r,i){return Fr(on.encode(t,r,i))}static resolveNames(t,r,i,n){return AZ(this,void 0,void 0,function*(){t=Xr(t);const s={};t.verifyingContract&&!jt(t.verifyingContract,20)&&(s[t.verifyingContract]="0x");const a=on.from(r);a.visit(i,(o,l)=>(o==="address"&&!jt(l,20)&&(s[l]="0x"),l));for(const o in s)s[o]=yield n(o);return t.verifyingContract&&s[t.verifyingContract]&&(t.verifyingContract=s[t.verifyingContract]),i=a.visit(i,(o,l)=>o==="address"&&s[l]?s[l]:l),{domain:t,value:i}})}static getPayload(t,r,i){on.hashDomain(t);const n={},s=[];t1.forEach(l=>{const h=t[l];h!=null&&(n[l]=LZ[l](h),s.push({name:l,type:DE[l]}))});const a=on.from(r),o=Xr(r);return o.EIP712Domain?lr.throwArgumentError("types must not contain EIP712Domain type","types.EIP712Domain",r):o.EIP712Domain=s,a.encode(i),{types:o,domain:n,primaryType:a.primaryType,message:a.visit(i,(l,h)=>{if(l.match(/^bytes(\d*)/))return tt(ct(h));if(l.match(/^u?int/))return Te.from(h).toString();switch(l){case"address":return h.toLowerCase();case"bool":return!!h;case"string":return typeof h!="string"&&lr.throwArgumentError("invalid string","value",h),h}return lr.throwArgumentError("unsupported type","type",l)})}}}const or=new ae(of);class RZ extends af{}class OZ extends af{}class IZ extends af{}class Mx extends af{static isIndexed(t){return!!(t&&t._isIndexed)}}const NZ={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:!0},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"]}};function RE(e,t){const r=new Error(`deferred error during ABI decoding triggered accessing ${e}`);return r.error=t,r}class OE{constructor(t){let r=[];typeof t=="string"?r=JSON.parse(t):r=t,Ae(this,"fragments",r.map(i=>Ua.from(i)).filter(i=>i!=null)),Ae(this,"_abiCoder",Ks(new.target,"getAbiCoder")()),Ae(this,"functions",{}),Ae(this,"errors",{}),Ae(this,"events",{}),Ae(this,"structs",{}),this.fragments.forEach(i=>{let n=null;switch(i.type){case"constructor":if(this.deploy){or.warn("duplicate definition - constructor");return}Ae(this,"deploy",i);return;case"function":n=this.functions;break;case"event":n=this.events;break;case"error":n=this.errors;break;default:return}let s=i.format();if(n[s]){or.warn("duplicate definition - "+s);return}n[s]=i}),this.deploy||Ae(this,"deploy",js.from({payable:!1,type:"constructor"})),Ae(this,"_isInterface",!0)}format(t){t||(t=Vt.full),t===Vt.sighash&&or.throwArgumentError("interface does not support formatting sighash","format",t);const r=this.fragments.map(i=>i.format(t));return t===Vt.json?JSON.stringify(r.map(i=>JSON.parse(i))):r}static getAbiCoder(){return _Z}static getAddress(t){return si(t)}static getSighash(t){return di(Zh(t.format()),0,4)}static getEventTopic(t){return Zh(t.format())}getFunction(t){if(jt(t)){for(const i in this.functions)if(t===this.getSighash(i))return this.functions[i];or.throwArgumentError("no matching function","sighash",t)}if(t.indexOf("(")===-1){const i=t.trim(),n=Object.keys(this.functions).filter(s=>s.split("(")[0]===i);return n.length===0?or.throwArgumentError("no matching function","name",i):n.length>1&&or.throwArgumentError("multiple matching functions","name",i),this.functions[n[0]]}const r=this.functions[Ws.fromString(t).format()];return r||or.throwArgumentError("no matching function","signature",t),r}getEvent(t){if(jt(t)){const i=t.toLowerCase();for(const n in this.events)if(i===this.getEventTopic(n))return this.events[n];or.throwArgumentError("no matching event","topichash",i)}if(t.indexOf("(")===-1){const i=t.trim(),n=Object.keys(this.events).filter(s=>s.split("(")[0]===i);return n.length===0?or.throwArgumentError("no matching event","name",i):n.length>1&&or.throwArgumentError("multiple matching events","name",i),this.events[n[0]]}const r=this.events[Na.fromString(t).format()];return r||or.throwArgumentError("no matching event","signature",t),r}getError(t){if(jt(t)){const i=Ks(this.constructor,"getSighash");for(const n in this.errors){const s=this.errors[n];if(t===i(s))return this.errors[n]}or.throwArgumentError("no matching error","sighash",t)}if(t.indexOf("(")===-1){const i=t.trim(),n=Object.keys(this.errors).filter(s=>s.split("(")[0]===i);return n.length===0?or.throwArgumentError("no matching error","name",i):n.length>1&&or.throwArgumentError("multiple matching errors","name",i),this.errors[n[0]]}const r=this.errors[Ws.fromString(t).format()];return r||or.throwArgumentError("no matching error","signature",t),r}getSighash(t){if(typeof t=="string")try{t=this.getFunction(t)}catch(r){try{t=this.getError(t)}catch{throw r}}return Ks(this.constructor,"getSighash")(t)}getEventTopic(t){return typeof t=="string"&&(t=this.getEvent(t)),Ks(this.constructor,"getEventTopic")(t)}_decodeParams(t,r){return this._abiCoder.decode(t,r)}_encodeParams(t,r){return this._abiCoder.encode(t,r)}encodeDeploy(t){return this._encodeParams(this.deploy.inputs,t||[])}decodeErrorResult(t,r){typeof t=="string"&&(t=this.getError(t));const i=ct(r);return tt(i.slice(0,4))!==this.getSighash(t)&&or.throwArgumentError(`data signature does not match error ${t.name}.`,"data",tt(i)),this._decodeParams(t.inputs,i.slice(4))}encodeErrorResult(t,r){return typeof t=="string"&&(t=this.getError(t)),tt(fn([this.getSighash(t),this._encodeParams(t.inputs,r||[])]))}decodeFunctionData(t,r){typeof t=="string"&&(t=this.getFunction(t));const i=ct(r);return tt(i.slice(0,4))!==this.getSighash(t)&&or.throwArgumentError(`data signature does not match function ${t.name}.`,"data",tt(i)),this._decodeParams(t.inputs,i.slice(4))}encodeFunctionData(t,r){return typeof t=="string"&&(t=this.getFunction(t)),tt(fn([this.getSighash(t),this._encodeParams(t.inputs,r||[])]))}decodeFunctionResult(t,r){typeof t=="string"&&(t=this.getFunction(t));let i=ct(r),n=null,s="",a=null,o=null,l=null;switch(i.length%this._abiCoder._getWordSize()){case 0:try{return this._abiCoder.decode(t.outputs,i)}catch{}break;case 4:{const h=tt(i.slice(0,4)),u=NZ[h];if(u)a=this._abiCoder.decode(u.inputs,i.slice(4)),o=u.name,l=u.signature,u.reason&&(n=a[0]),o==="Error"?s=`; VM Exception while processing transaction: reverted with reason string ${JSON.stringify(a[0])}`:o==="Panic"&&(s=`; VM Exception while processing transaction: reverted with panic code ${a[0]}`);else try{const c=this.getError(h);a=this._abiCoder.decode(c.inputs,i.slice(4)),o=c.name,l=c.format()}catch{}break}}return or.throwError("call revert exception"+s,ae.errors.CALL_EXCEPTION,{method:t.format(),data:tt(r),errorArgs:a,errorName:o,errorSignature:l,reason:n})}encodeFunctionResult(t,r){return typeof t=="string"&&(t=this.getFunction(t)),tt(this._abiCoder.encode(t.outputs,r||[]))}encodeFilterTopics(t,r){typeof t=="string"&&(t=this.getEvent(t)),r.length>t.inputs.length&&or.throwError("too many arguments for "+t.format(),ae.errors.UNEXPECTED_ARGUMENT,{argument:"values",value:r});let i=[];t.anonymous||i.push(this.getEventTopic(t));const n=(s,a)=>s.type==="string"?Zh(a):s.type==="bytes"?Fr(tt(a)):(s.type==="address"&&this._abiCoder.encode(["address"],[a]),ar(tt(a),32));for(r.forEach((s,a)=>{let o=t.inputs[a];if(!o.indexed){s!=null&&or.throwArgumentError("cannot filter non-indexed parameters; must be null","contract."+o.name,s);return}s==null?i.push(null):o.baseType==="array"||o.baseType==="tuple"?or.throwArgumentError("filtering with tuples or arrays not supported","contract."+o.name,s):Array.isArray(s)?i.push(s.map(l=>n(o,l))):i.push(n(o,s))});i.length&&i[i.length-1]===null;)i.pop();return i}encodeEventLog(t,r){typeof t=="string"&&(t=this.getEvent(t));const i=[],n=[],s=[];return t.anonymous||i.push(this.getEventTopic(t)),r.length!==t.inputs.length&&or.throwArgumentError("event arguments/values mismatch","values",r),t.inputs.forEach((a,o)=>{const l=r[o];if(a.indexed)if(a.type==="string")i.push(Zh(l));else if(a.type==="bytes")i.push(Fr(l));else{if(a.baseType==="tuple"||a.baseType==="array")throw new Error("not implemented");i.push(this._abiCoder.encode([a.type],[l]))}else n.push(a),s.push(l)}),{data:this._abiCoder.encode(n,s),topics:i}}decodeEventLog(t,r,i){if(typeof t=="string"&&(t=this.getEvent(t)),i!=null&&!t.anonymous){let d=this.getEventTopic(t);(!jt(i[0],32)||i[0].toLowerCase()!==d)&&or.throwError("fragment/topic mismatch",ae.errors.INVALID_ARGUMENT,{argument:"topics[0]",expected:d,value:i[0]}),i=i.slice(1)}let n=[],s=[],a=[];t.inputs.forEach((d,f)=>{d.indexed?d.type==="string"||d.type==="bytes"||d.baseType==="tuple"||d.baseType==="array"?(n.push(qr.fromObject({type:"bytes32",name:d.name})),a.push(!0)):(n.push(d),a.push(!1)):(s.push(d),a.push(!1))});let o=i!=null?this._abiCoder.decode(n,fn(i)):null,l=this._abiCoder.decode(s,r,!0),h=[],u=0,c=0;t.inputs.forEach((d,f)=>{if(d.indexed)if(o==null)h[f]=new Mx({_isIndexed:!0,hash:null});else if(a[f])h[f]=new Mx({_isIndexed:!0,hash:o[c++]});else try{h[f]=o[c++]}catch(p){h[f]=p}else try{h[f]=l[u++]}catch(p){h[f]=p}if(d.name&&h[d.name]==null){const p=h[f];p instanceof Error?Object.defineProperty(h,d.name,{enumerable:!0,get:()=>{throw RE(`property ${JSON.stringify(d.name)}`,p)}}):h[d.name]=p}});for(let d=0;d<h.length;d++){const f=h[d];f instanceof Error&&Object.defineProperty(h,d,{enumerable:!0,get:()=>{throw RE(`index ${d}`,f)}})}return Object.freeze(h)}parseTransaction(t){let r=this.getFunction(t.data.substring(0,10).toLowerCase());return r?new OZ({args:this._abiCoder.decode(r.inputs,"0x"+t.data.substring(10)),functionFragment:r,name:r.name,signature:r.format(),sighash:this.getSighash(r),value:Te.from(t.value||"0")}):null}parseLog(t){let r=this.getEvent(t.topics[0]);return!r||r.anonymous?null:new RZ({eventFragment:r,name:r.name,signature:r.format(),topic:this.getEventTopic(r),args:this.decodeEventLog(r,t.data,t.topics)})}parseError(t){const r=tt(t);let i=this.getError(r.substring(0,10).toLowerCase());return i?new IZ({args:this._abiCoder.decode(i.inputs,"0x"+r.substring(10)),errorFragment:i,name:i.name,signature:i.format(),sighash:this.getSighash(i)}):null}static isInterface(t){return!!(t&&t._isInterface)}}const BZ="abstract-provider/5.6.1";var kZ=globalThis&&globalThis.__awaiter||function(e,t,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{h(i.next(u))}catch(c){a(c)}}function l(u){try{h(i.throw(u))}catch(c){a(c)}}function h(u){u.done?s(u.value):n(u.value).then(o,l)}h((i=i.apply(e,t||[])).next())})};const zZ=new ae(BZ);class FZ extends af{static isForkEvent(t){return!!(t&&t._isForkEvent)}}class Km{constructor(){zZ.checkAbstract(new.target,Km),Ae(this,"_isProvider",!0)}getFeeData(){return kZ(this,void 0,void 0,function*(){const{block:t,gasPrice:r}=yield Tr({block:this.getBlock("latest"),gasPrice:this.getGasPrice().catch(s=>null)});let i=null,n=null;return t&&t.baseFeePerGas&&(n=Te.from("1500000000"),i=t.baseFeePerGas.mul(2).add(n)),{maxFeePerGas:i,maxPriorityFeePerGas:n,gasPrice:r}})}addListener(t,r){return this.on(t,r)}removeListener(t,r){return this.off(t,r)}static isProvider(t){return!!(t&&t._isProvider)}}const UZ="abstract-signer/5.6.2";var $n=globalThis&&globalThis.__awaiter||function(e,t,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{h(i.next(u))}catch(c){a(c)}}function l(u){try{h(i.throw(u))}catch(c){a(c)}}function h(u){u.done?s(u.value):n(u.value).then(o,l)}h((i=i.apply(e,t||[])).next())})};const Tn=new ae(UZ),HZ=["accessList","ccipReadEnabled","chainId","customData","data","from","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","nonce","to","type","value"],GZ=[ae.errors.INSUFFICIENT_FUNDS,ae.errors.NONCE_EXPIRED,ae.errors.REPLACEMENT_UNDERPRICED];class hf{constructor(){Tn.checkAbstract(new.target,hf),Ae(this,"_isSigner",!0)}getBalance(t){return $n(this,void 0,void 0,function*(){return this._checkProvider("getBalance"),yield this.provider.getBalance(this.getAddress(),t)})}getTransactionCount(t){return $n(this,void 0,void 0,function*(){return this._checkProvider("getTransactionCount"),yield this.provider.getTransactionCount(this.getAddress(),t)})}estimateGas(t){return $n(this,void 0,void 0,function*(){this._checkProvider("estimateGas");const r=yield Tr(this.checkTransaction(t));return yield this.provider.estimateGas(r)})}call(t,r){return $n(this,void 0,void 0,function*(){this._checkProvider("call");const i=yield Tr(this.checkTransaction(t));return yield this.provider.call(i,r)})}sendTransaction(t){return $n(this,void 0,void 0,function*(){this._checkProvider("sendTransaction");const r=yield this.populateTransaction(t),i=yield this.signTransaction(r);return yield this.provider.sendTransaction(i)})}getChainId(){return $n(this,void 0,void 0,function*(){return this._checkProvider("getChainId"),(yield this.provider.getNetwork()).chainId})}getGasPrice(){return $n(this,void 0,void 0,function*(){return this._checkProvider("getGasPrice"),yield this.provider.getGasPrice()})}getFeeData(){return $n(this,void 0,void 0,function*(){return this._checkProvider("getFeeData"),yield this.provider.getFeeData()})}resolveName(t){return $n(this,void 0,void 0,function*(){return this._checkProvider("resolveName"),yield this.provider.resolveName(t)})}checkTransaction(t){for(const i in t)HZ.indexOf(i)===-1&&Tn.throwArgumentError("invalid transaction key: "+i,"transaction",t);const r=Xr(t);return r.from==null?r.from=this.getAddress():r.from=Promise.all([Promise.resolve(r.from),this.getAddress()]).then(i=>(i[0].toLowerCase()!==i[1].toLowerCase()&&Tn.throwArgumentError("from address mismatch","transaction",t),i[0])),r}populateTransaction(t){return $n(this,void 0,void 0,function*(){const r=yield Tr(this.checkTransaction(t));r.to!=null&&(r.to=Promise.resolve(r.to).then(n=>$n(this,void 0,void 0,function*(){if(n==null)return null;const s=yield this.resolveName(n);return s==null&&Tn.throwArgumentError("provided ENS name resolves to null","tx.to",n),s})),r.to.catch(n=>{}));const i=r.maxFeePerGas!=null||r.maxPriorityFeePerGas!=null;if(r.gasPrice!=null&&(r.type===2||i)?Tn.throwArgumentError("eip-1559 transaction do not support gasPrice","transaction",t):(r.type===0||r.type===1)&&i&&Tn.throwArgumentError("pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","transaction",t),(r.type===2||r.type==null)&&r.maxFeePerGas!=null&&r.maxPriorityFeePerGas!=null)r.type=2;else if(r.type===0||r.type===1)r.gasPrice==null&&(r.gasPrice=this.getGasPrice());else{const n=yield this.getFeeData();if(r.type==null)if(n.maxFeePerGas!=null&&n.maxPriorityFeePerGas!=null)if(r.type=2,r.gasPrice!=null){const s=r.gasPrice;delete r.gasPrice,r.maxFeePerGas=s,r.maxPriorityFeePerGas=s}else r.maxFeePerGas==null&&(r.maxFeePerGas=n.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=n.maxPriorityFeePerGas);else n.gasPrice!=null?(i&&Tn.throwError("network does not support EIP-1559",ae.errors.UNSUPPORTED_OPERATION,{operation:"populateTransaction"}),r.gasPrice==null&&(r.gasPrice=n.gasPrice),r.type=0):Tn.throwError("failed to get consistent fee data",ae.errors.UNSUPPORTED_OPERATION,{operation:"signer.getFeeData"});else r.type===2&&(r.maxFeePerGas==null&&(r.maxFeePerGas=n.maxFeePerGas),r.maxPriorityFeePerGas==null&&(r.maxPriorityFeePerGas=n.maxPriorityFeePerGas))}return r.nonce==null&&(r.nonce=this.getTransactionCount("pending")),r.gasLimit==null&&(r.gasLimit=this.estimateGas(r).catch(n=>{if(GZ.indexOf(n.code)>=0)throw n;return Tn.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",ae.errors.UNPREDICTABLE_GAS_LIMIT,{error:n,tx:r})})),r.chainId==null?r.chainId=this.getChainId():r.chainId=Promise.all([Promise.resolve(r.chainId),this.getChainId()]).then(n=>(n[1]!==0&&n[0]!==n[1]&&Tn.throwArgumentError("chainId address mismatch","transaction",t),n[0])),yield Tr(r)})}_checkProvider(t){this.provider||Tn.throwError("missing provider",ae.errors.UNSUPPORTED_OPERATION,{operation:t||"_checkProvider"})}static isSigner(t){return!!(t&&t._isSigner)}}class jb extends hf{constructor(t,r){super(),Ae(this,"address",t),Ae(this,"provider",r||null)}getAddress(){return Promise.resolve(this.address)}_fail(t,r){return Promise.resolve().then(()=>{Tn.throwError(t,ae.errors.UNSUPPORTED_OPERATION,{operation:r})})}signMessage(t){return this._fail("VoidSigner cannot sign messages","signMessage")}signTransaction(t){return this._fail("VoidSigner cannot sign transactions","signTransaction")}_signTypedData(t,r,i){return this._fail("VoidSigner cannot sign typed data","signTypedData")}connect(t){return new jb(this.address,t)}}var IP={},Ot={},uf=NP;function NP(e,t){if(!e)throw new Error(t||"Assertion failed")}NP.equal=function(t,r,i){if(t!=r)throw new Error(i||"Assertion failed: "+t+" != "+r)};var Ax={exports:{}};typeof Object.create=="function"?Ax.exports=function(t,r){r&&(t.super_=r,t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Ax.exports=function(t,r){if(r){t.super_=r;var i=function(){};i.prototype=r.prototype,t.prototype=new i,t.prototype.constructor=t}};var VZ=uf,jZ=Ax.exports;Ot.inherits=jZ;function WZ(e,t){return(e.charCodeAt(t)&64512)!==55296||t<0||t+1>=e.length?!1:(e.charCodeAt(t+1)&64512)===56320}function qZ(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if(typeof e=="string")if(t){if(t==="hex")for(e=e.replace(/[^a-z0-9]+/ig,""),e.length%2!==0&&(e="0"+e),n=0;n<e.length;n+=2)r.push(parseInt(e[n]+e[n+1],16))}else for(var i=0,n=0;n<e.length;n++){var s=e.charCodeAt(n);s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):WZ(e,n)?(s=65536+((s&1023)<<10)+(e.charCodeAt(++n)&1023),r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128)}else for(n=0;n<e.length;n++)r[n]=e[n]|0;return r}Ot.toArray=qZ;function YZ(e){for(var t="",r=0;r<e.length;r++)t+=kP(e[r].toString(16));return t}Ot.toHex=YZ;function BP(e){var t=e>>>24|e>>>8&65280|e<<8&16711680|(e&255)<<24;return t>>>0}Ot.htonl=BP;function XZ(e,t){for(var r="",i=0;i<e.length;i++){var n=e[i];t==="little"&&(n=BP(n)),r+=zP(n.toString(16))}return r}Ot.toHex32=XZ;function kP(e){return e.length===1?"0"+e:e}Ot.zero2=kP;function zP(e){return e.length===7?"0"+e:e.length===6?"00"+e:e.length===5?"000"+e:e.length===4?"0000"+e:e.length===3?"00000"+e:e.length===2?"000000"+e:e.length===1?"0000000"+e:e}Ot.zero8=zP;function QZ(e,t,r,i){var n=r-t;VZ(n%4===0);for(var s=new Array(n/4),a=0,o=t;a<s.length;a++,o+=4){var l;i==="big"?l=e[o]<<24|e[o+1]<<16|e[o+2]<<8|e[o+3]:l=e[o+3]<<24|e[o+2]<<16|e[o+1]<<8|e[o],s[a]=l>>>0}return s}Ot.join32=QZ;function JZ(e,t){for(var r=new Array(e.length*4),i=0,n=0;i<e.length;i++,n+=4){var s=e[i];t==="big"?(r[n]=s>>>24,r[n+1]=s>>>16&255,r[n+2]=s>>>8&255,r[n+3]=s&255):(r[n+3]=s>>>24,r[n+2]=s>>>16&255,r[n+1]=s>>>8&255,r[n]=s&255)}return r}Ot.split32=JZ;function KZ(e,t){return e>>>t|e<<32-t}Ot.rotr32=KZ;function ZZ(e,t){return e<<t|e>>>32-t}Ot.rotl32=ZZ;function $Z(e,t){return e+t>>>0}Ot.sum32=$Z;function e$(e,t,r){return e+t+r>>>0}Ot.sum32_3=e$;function t$(e,t,r,i){return e+t+r+i>>>0}Ot.sum32_4=t$;function r$(e,t,r,i,n){return e+t+r+i+n>>>0}Ot.sum32_5=r$;function i$(e,t,r,i){var n=e[t],s=e[t+1],a=i+s>>>0,o=(a<i?1:0)+r+n;e[t]=o>>>0,e[t+1]=a}Ot.sum64=i$;function n$(e,t,r,i){var n=t+i>>>0,s=(n<t?1:0)+e+r;return s>>>0}Ot.sum64_hi=n$;function s$(e,t,r,i){var n=t+i;return n>>>0}Ot.sum64_lo=s$;function a$(e,t,r,i,n,s,a,o){var l=0,h=t;h=h+i>>>0,l+=h<t?1:0,h=h+s>>>0,l+=h<s?1:0,h=h+o>>>0,l+=h<o?1:0;var u=e+r+n+a+l;return u>>>0}Ot.sum64_4_hi=a$;function o$(e,t,r,i,n,s,a,o){var l=t+i+s+o;return l>>>0}Ot.sum64_4_lo=o$;function l$(e,t,r,i,n,s,a,o,l,h){var u=0,c=t;c=c+i>>>0,u+=c<t?1:0,c=c+s>>>0,u+=c<s?1:0,c=c+o>>>0,u+=c<o?1:0,c=c+h>>>0,u+=c<h?1:0;var d=e+r+n+a+l+u;return d>>>0}Ot.sum64_5_hi=l$;function h$(e,t,r,i,n,s,a,o,l,h){var u=t+i+s+o+h;return u>>>0}Ot.sum64_5_lo=h$;function u$(e,t,r){var i=t<<32-r|e>>>r;return i>>>0}Ot.rotr64_hi=u$;function c$(e,t,r){var i=e<<32-r|t>>>r;return i>>>0}Ot.rotr64_lo=c$;function d$(e,t,r){return e>>>r}Ot.shr64_hi=d$;function f$(e,t,r){var i=e<<32-r|t>>>r;return i>>>0}Ot.shr64_lo=f$;var Yu={},IE=Ot,p$=uf;function Zm(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}Yu.BlockHash=Zm;Zm.prototype.update=function(t,r){if(t=IE.toArray(t,r),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){t=this.pending;var i=t.length%this._delta8;this.pending=t.slice(t.length-i,t.length),this.pending.length===0&&(this.pending=null),t=IE.join32(t,0,t.length-i,this.endian);for(var n=0;n<t.length;n+=this._delta32)this._update(t,n,n+this._delta32)}return this};Zm.prototype.digest=function(t){return this.update(this._pad()),p$(this.pending===null),this._digest(t)};Zm.prototype._pad=function(){var t=this.pendingTotal,r=this._delta8,i=r-(t+this.padLength)%r,n=new Array(i+this.padLength);n[0]=128;for(var s=1;s<i;s++)n[s]=0;if(t<<=3,this.endian==="big"){for(var a=8;a<this.padLength;a++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=t>>>24&255,n[s++]=t>>>16&255,n[s++]=t>>>8&255,n[s++]=t&255}else for(n[s++]=t&255,n[s++]=t>>>8&255,n[s++]=t>>>16&255,n[s++]=t>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,a=8;a<this.padLength;a++)n[s++]=0;return n};var Xu={},ya={},m$=Ot,sa=m$.rotr32;function g$(e,t,r,i){if(e===0)return FP(t,r,i);if(e===1||e===3)return HP(t,r,i);if(e===2)return UP(t,r,i)}ya.ft_1=g$;function FP(e,t,r){return e&t^~e&r}ya.ch32=FP;function UP(e,t,r){return e&t^e&r^t&r}ya.maj32=UP;function HP(e,t,r){return e^t^r}ya.p32=HP;function v$(e){return sa(e,2)^sa(e,13)^sa(e,22)}ya.s0_256=v$;function y$(e){return sa(e,6)^sa(e,11)^sa(e,25)}ya.s1_256=y$;function x$(e){return sa(e,7)^sa(e,18)^e>>>3}ya.g0_256=x$;function w$(e){return sa(e,17)^sa(e,19)^e>>>10}ya.g1_256=w$;var Cu=Ot,b$=Yu,_$=ya,i1=Cu.rotl32,xc=Cu.sum32,S$=Cu.sum32_5,M$=_$.ft_1,GP=b$.BlockHash,A$=[1518500249,1859775393,2400959708,3395469782];function da(){if(!(this instanceof da))return new da;GP.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}Cu.inherits(da,GP);var E$=da;da.blockSize=512;da.outSize=160;da.hmacStrength=80;da.padLength=64;da.prototype._update=function(t,r){for(var i=this.W,n=0;n<16;n++)i[n]=t[r+n];for(;n<i.length;n++)i[n]=i1(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var s=this.h[0],a=this.h[1],o=this.h[2],l=this.h[3],h=this.h[4];for(n=0;n<i.length;n++){var u=~~(n/20),c=S$(i1(s,5),M$(u,a,o,l),h,i[n],A$[u]);h=l,l=o,o=i1(a,30),a=s,s=c}this.h[0]=xc(this.h[0],s),this.h[1]=xc(this.h[1],a),this.h[2]=xc(this.h[2],o),this.h[3]=xc(this.h[3],l),this.h[4]=xc(this.h[4],h)};da.prototype._digest=function(t){return t==="hex"?Cu.toHex32(this.h,"big"):Cu.split32(this.h,"big")};var Tu=Ot,C$=Yu,Qu=ya,T$=uf,es=Tu.sum32,D$=Tu.sum32_4,P$=Tu.sum32_5,L$=Qu.ch32,R$=Qu.maj32,O$=Qu.s0_256,I$=Qu.s1_256,N$=Qu.g0_256,B$=Qu.g1_256,VP=C$.BlockHash,k$=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function fa(){if(!(this instanceof fa))return new fa;VP.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=k$,this.W=new Array(64)}Tu.inherits(fa,VP);var jP=fa;fa.blockSize=512;fa.outSize=256;fa.hmacStrength=192;fa.padLength=64;fa.prototype._update=function(t,r){for(var i=this.W,n=0;n<16;n++)i[n]=t[r+n];for(;n<i.length;n++)i[n]=D$(B$(i[n-2]),i[n-7],N$(i[n-15]),i[n-16]);var s=this.h[0],a=this.h[1],o=this.h[2],l=this.h[3],h=this.h[4],u=this.h[5],c=this.h[6],d=this.h[7];for(T$(this.k.length===i.length),n=0;n<i.length;n++){var f=P$(d,I$(h),L$(h,u,c),this.k[n],i[n]),p=es(O$(s),R$(s,a,o));d=c,c=u,u=h,h=es(l,f),l=o,o=a,a=s,s=es(f,p)}this.h[0]=es(this.h[0],s),this.h[1]=es(this.h[1],a),this.h[2]=es(this.h[2],o),this.h[3]=es(this.h[3],l),this.h[4]=es(this.h[4],h),this.h[5]=es(this.h[5],u),this.h[6]=es(this.h[6],c),this.h[7]=es(this.h[7],d)};fa.prototype._digest=function(t){return t==="hex"?Tu.toHex32(this.h,"big"):Tu.split32(this.h,"big")};var Ex=Ot,WP=jP;function eo(){if(!(this instanceof eo))return new eo;WP.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}Ex.inherits(eo,WP);var z$=eo;eo.blockSize=512;eo.outSize=224;eo.hmacStrength=192;eo.padLength=64;eo.prototype._digest=function(t){return t==="hex"?Ex.toHex32(this.h.slice(0,7),"big"):Ex.split32(this.h.slice(0,7),"big")};var rn=Ot,F$=Yu,U$=uf,aa=rn.rotr64_hi,oa=rn.rotr64_lo,qP=rn.shr64_hi,YP=rn.shr64_lo,_o=rn.sum64,n1=rn.sum64_hi,s1=rn.sum64_lo,H$=rn.sum64_4_hi,G$=rn.sum64_4_lo,V$=rn.sum64_5_hi,j$=rn.sum64_5_lo,XP=F$.BlockHash,W$=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function ms(){if(!(this instanceof ms))return new ms;XP.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=W$,this.W=new Array(160)}rn.inherits(ms,XP);var QP=ms;ms.blockSize=1024;ms.outSize=512;ms.hmacStrength=192;ms.padLength=128;ms.prototype._prepareBlock=function(t,r){for(var i=this.W,n=0;n<32;n++)i[n]=t[r+n];for(;n<i.length;n+=2){var s=ree(i[n-4],i[n-3]),a=iee(i[n-4],i[n-3]),o=i[n-14],l=i[n-13],h=eee(i[n-30],i[n-29]),u=tee(i[n-30],i[n-29]),c=i[n-32],d=i[n-31];i[n]=H$(s,a,o,l,h,u,c,d),i[n+1]=G$(s,a,o,l,h,u,c,d)}};ms.prototype._update=function(t,r){this._prepareBlock(t,r);var i=this.W,n=this.h[0],s=this.h[1],a=this.h[2],o=this.h[3],l=this.h[4],h=this.h[5],u=this.h[6],c=this.h[7],d=this.h[8],f=this.h[9],p=this.h[10],m=this.h[11],g=this.h[12],v=this.h[13],x=this.h[14],b=this.h[15];U$(this.k.length===i.length);for(var _=0;_<i.length;_+=2){var E=x,S=b,P=Z$(d,f),M=$$(d,f),B=q$(d,f,p,m,g),R=Y$(d,f,p,m,g,v),H=this.k[_],Q=this.k[_+1],z=i[_],y=i[_+1],A=V$(E,S,P,M,B,R,H,Q,z,y),D=j$(E,S,P,M,B,R,H,Q,z,y);E=J$(n,s),S=K$(n,s),P=X$(n,s,a,o,l),M=Q$(n,s,a,o,l,h);var O=n1(E,S,P,M),C=s1(E,S,P,M);x=g,b=v,g=p,v=m,p=d,m=f,d=n1(u,c,A,D),f=s1(c,c,A,D),u=l,c=h,l=a,h=o,a=n,o=s,n=n1(A,D,O,C),s=s1(A,D,O,C)}_o(this.h,0,n,s),_o(this.h,2,a,o),_o(this.h,4,l,h),_o(this.h,6,u,c),_o(this.h,8,d,f),_o(this.h,10,p,m),_o(this.h,12,g,v),_o(this.h,14,x,b)};ms.prototype._digest=function(t){return t==="hex"?rn.toHex32(this.h,"big"):rn.split32(this.h,"big")};function q$(e,t,r,i,n){var s=e&r^~e&n;return s<0&&(s+=4294967296),s}function Y$(e,t,r,i,n,s){var a=t&i^~t&s;return a<0&&(a+=4294967296),a}function X$(e,t,r,i,n){var s=e&r^e&n^r&n;return s<0&&(s+=4294967296),s}function Q$(e,t,r,i,n,s){var a=t&i^t&s^i&s;return a<0&&(a+=4294967296),a}function J$(e,t){var r=aa(e,t,28),i=aa(t,e,2),n=aa(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function K$(e,t){var r=oa(e,t,28),i=oa(t,e,2),n=oa(t,e,7),s=r^i^n;return s<0&&(s+=4294967296),s}function Z$(e,t){var r=aa(e,t,14),i=aa(e,t,18),n=aa(t,e,9),s=r^i^n;return s<0&&(s+=4294967296),s}function $$(e,t){var r=oa(e,t,14),i=oa(e,t,18),n=oa(t,e,9),s=r^i^n;return s<0&&(s+=4294967296),s}function eee(e,t){var r=aa(e,t,1),i=aa(e,t,8),n=qP(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function tee(e,t){var r=oa(e,t,1),i=oa(e,t,8),n=YP(e,t,7),s=r^i^n;return s<0&&(s+=4294967296),s}function ree(e,t){var r=aa(e,t,19),i=aa(t,e,29),n=qP(e,t,6),s=r^i^n;return s<0&&(s+=4294967296),s}function iee(e,t){var r=oa(e,t,19),i=oa(t,e,29),n=YP(e,t,6),s=r^i^n;return s<0&&(s+=4294967296),s}var Cx=Ot,JP=QP;function to(){if(!(this instanceof to))return new to;JP.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}Cx.inherits(to,JP);var nee=to;to.blockSize=1024;to.outSize=384;to.hmacStrength=192;to.padLength=128;to.prototype._digest=function(t){return t==="hex"?Cx.toHex32(this.h.slice(0,12),"big"):Cx.split32(this.h.slice(0,12),"big")};Xu.sha1=E$;Xu.sha224=z$;Xu.sha256=jP;Xu.sha384=nee;Xu.sha512=QP;var KP={},Xl=Ot,see=Yu,Mp=Xl.rotl32,NE=Xl.sum32,wc=Xl.sum32_3,BE=Xl.sum32_4,ZP=see.BlockHash;function pa(){if(!(this instanceof pa))return new pa;ZP.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Xl.inherits(pa,ZP);KP.ripemd160=pa;pa.blockSize=512;pa.outSize=160;pa.hmacStrength=192;pa.padLength=64;pa.prototype._update=function(t,r){for(var i=this.h[0],n=this.h[1],s=this.h[2],a=this.h[3],o=this.h[4],l=i,h=n,u=s,c=a,d=o,f=0;f<80;f++){var p=NE(Mp(BE(i,kE(f,n,s,a),t[lee[f]+r],aee(f)),uee[f]),o);i=o,o=a,a=Mp(s,10),s=n,n=p,p=NE(Mp(BE(l,kE(79-f,h,u,c),t[hee[f]+r],oee(f)),cee[f]),d),l=d,d=c,c=Mp(u,10),u=h,h=p}p=wc(this.h[1],s,c),this.h[1]=wc(this.h[2],a,d),this.h[2]=wc(this.h[3],o,l),this.h[3]=wc(this.h[4],i,h),this.h[4]=wc(this.h[0],n,u),this.h[0]=p};pa.prototype._digest=function(t){return t==="hex"?Xl.toHex32(this.h,"little"):Xl.split32(this.h,"little")};function kE(e,t,r,i){return e<=15?t^r^i:e<=31?t&r|~t&i:e<=47?(t|~r)^i:e<=63?t&i|r&~i:t^(r|~i)}function aee(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function oee(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}var lee=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],hee=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],uee=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],cee=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],dee=Ot,fee=uf;function Du(e,t,r){if(!(this instanceof Du))return new Du(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(dee.toArray(t,r))}var pee=Du;Du.prototype._init=function(t){t.length>this.blockSize&&(t=new this.Hash().update(t).digest()),fee(t.length<=this.blockSize);for(var r=t.length;r<this.blockSize;r++)t.push(0);for(r=0;r<t.length;r++)t[r]^=54;for(this.inner=new this.Hash().update(t),r=0;r<t.length;r++)t[r]^=106;this.outer=new this.Hash().update(t)};Du.prototype.update=function(t,r){return this.inner.update(t,r),this};Du.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)};(function(e){var t=e;t.utils=Ot,t.common=Yu,t.sha=Xu,t.ripemd=KP,t.hmac=pee,t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160})(IP);var Os=IP;function Ju(e,t,r){return r={path:t,exports:{},require:function(i,n){return mee(i,n==null?r.path:n)}},e(r,r.exports),r.exports}function mee(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Wb=$P;function $P(e,t){if(!e)throw new Error(t||"Assertion failed")}$P.equal=function(t,r,i){if(t!=r)throw new Error(i||"Assertion failed: "+t+" != "+r)};var cs=Ju(function(e,t){var r=t;function i(a,o){if(Array.isArray(a))return a.slice();if(!a)return[];var l=[];if(typeof a!="string"){for(var h=0;h<a.length;h++)l[h]=a[h]|0;return l}if(o==="hex"){a=a.replace(/[^a-z0-9]+/ig,""),a.length%2!==0&&(a="0"+a);for(var h=0;h<a.length;h+=2)l.push(parseInt(a[h]+a[h+1],16))}else for(var h=0;h<a.length;h++){var u=a.charCodeAt(h),c=u>>8,d=u&255;c?l.push(c,d):l.push(d)}return l}r.toArray=i;function n(a){return a.length===1?"0"+a:a}r.zero2=n;function s(a){for(var o="",l=0;l<a.length;l++)o+=n(a[l].toString(16));return o}r.toHex=s,r.encode=function(o,l){return l==="hex"?s(o):o}}),bn=Ju(function(e,t){var r=t;r.assert=Wb,r.toArray=cs.toArray,r.zero2=cs.zero2,r.toHex=cs.toHex,r.encode=cs.encode;function i(l,h,u){var c=new Array(Math.max(l.bitLength(),u)+1);c.fill(0);for(var d=1<<h+1,f=l.clone(),p=0;p<c.length;p++){var m,g=f.andln(d-1);f.isOdd()?(g>(d>>1)-1?m=(d>>1)-g:m=g,f.isubn(m)):m=0,c[p]=m,f.iushrn(1)}return c}r.getNAF=i;function n(l,h){var u=[[],[]];l=l.clone(),h=h.clone();for(var c=0,d=0,f;l.cmpn(-c)>0||h.cmpn(-d)>0;){var p=l.andln(3)+c&3,m=h.andln(3)+d&3;p===3&&(p=-1),m===3&&(m=-1);var g;(p&1)===0?g=0:(f=l.andln(7)+c&7,(f===3||f===5)&&m===2?g=-p:g=p),u[0].push(g);var v;(m&1)===0?v=0:(f=h.andln(7)+d&7,(f===3||f===5)&&p===2?v=-m:v=m),u[1].push(v),2*c===g+1&&(c=1-c),2*d===v+1&&(d=1-d),l.iushrn(1),h.iushrn(1)}return u}r.getJSF=n;function s(l,h,u){var c="_"+h;l.prototype[h]=function(){return this[c]!==void 0?this[c]:this[c]=u.call(this)}}r.cachedProperty=s;function a(l){return typeof l=="string"?r.toArray(l,"hex"):l}r.parseBytes=a;function o(l){return new xt(l,"hex","le")}r.intFromLE=o}),rm=bn.getNAF,gee=bn.getJSF,im=bn.assert;function ol(e,t){this.type=e,this.p=new xt(t.p,16),this.red=t.prime?xt.red(t.prime):xt.mont(this.p),this.zero=new xt(0).toRed(this.red),this.one=new xt(1).toRed(this.red),this.two=new xt(2).toRed(this.red),this.n=t.n&&new xt(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var rh=ol;ol.prototype.point=function(){throw new Error("Not implemented")};ol.prototype.validate=function(){throw new Error("Not implemented")};ol.prototype._fixedNafMul=function(t,r){im(t.precomputed);var i=t._getDoubles(),n=rm(r,1,this._bitLength),s=(1<<i.step+1)-(i.step%2===0?2:1);s/=3;var a=[],o,l;for(o=0;o<n.length;o+=i.step){l=0;for(var h=o+i.step-1;h>=o;h--)l=(l<<1)+n[h];a.push(l)}for(var u=this.jpoint(null,null,null),c=this.jpoint(null,null,null),d=s;d>0;d--){for(o=0;o<a.length;o++)l=a[o],l===d?c=c.mixedAdd(i.points[o]):l===-d&&(c=c.mixedAdd(i.points[o].neg()));u=u.add(c)}return u.toP()};ol.prototype._wnafMul=function(t,r){var i=4,n=t._getNAFPoints(i);i=n.wnd;for(var s=n.points,a=rm(r,i,this._bitLength),o=this.jpoint(null,null,null),l=a.length-1;l>=0;l--){for(var h=0;l>=0&&a[l]===0;l--)h++;if(l>=0&&h++,o=o.dblp(h),l<0)break;var u=a[l];im(u!==0),t.type==="affine"?u>0?o=o.mixedAdd(s[u-1>>1]):o=o.mixedAdd(s[-u-1>>1].neg()):u>0?o=o.add(s[u-1>>1]):o=o.add(s[-u-1>>1].neg())}return t.type==="affine"?o.toP():o};ol.prototype._wnafMulAdd=function(t,r,i,n,s){var a=this._wnafT1,o=this._wnafT2,l=this._wnafT3,h=0,u,c,d;for(u=0;u<n;u++){d=r[u];var f=d._getNAFPoints(t);a[u]=f.wnd,o[u]=f.points}for(u=n-1;u>=1;u-=2){var p=u-1,m=u;if(a[p]!==1||a[m]!==1){l[p]=rm(i[p],a[p],this._bitLength),l[m]=rm(i[m],a[m],this._bitLength),h=Math.max(l[p].length,h),h=Math.max(l[m].length,h);continue}var g=[r[p],null,null,r[m]];r[p].y.cmp(r[m].y)===0?(g[1]=r[p].add(r[m]),g[2]=r[p].toJ().mixedAdd(r[m].neg())):r[p].y.cmp(r[m].y.redNeg())===0?(g[1]=r[p].toJ().mixedAdd(r[m]),g[2]=r[p].add(r[m].neg())):(g[1]=r[p].toJ().mixedAdd(r[m]),g[2]=r[p].toJ().mixedAdd(r[m].neg()));var v=[-3,-1,-5,-7,0,7,5,1,3],x=gee(i[p],i[m]);for(h=Math.max(x[0].length,h),l[p]=new Array(h),l[m]=new Array(h),c=0;c<h;c++){var b=x[0][c]|0,_=x[1][c]|0;l[p][c]=v[(b+1)*3+(_+1)],l[m][c]=0,o[p]=g}}var E=this.jpoint(null,null,null),S=this._wnafT4;for(u=h;u>=0;u--){for(var P=0;u>=0;){var M=!0;for(c=0;c<n;c++)S[c]=l[c][u]|0,S[c]!==0&&(M=!1);if(!M)break;P++,u--}if(u>=0&&P++,E=E.dblp(P),u<0)break;for(c=0;c<n;c++){var B=S[c];B!==0&&(B>0?d=o[c][B-1>>1]:B<0&&(d=o[c][-B-1>>1].neg()),d.type==="affine"?E=E.mixedAdd(d):E=E.add(d))}}for(u=0;u<n;u++)o[u]=null;return s?E:E.toP()};function Vn(e,t){this.curve=e,this.type=t,this.precomputed=null}ol.BasePoint=Vn;Vn.prototype.eq=function(){throw new Error("Not implemented")};Vn.prototype.validate=function(){return this.curve.validate(this)};ol.prototype.decodePoint=function(t,r){t=bn.toArray(t,r);var i=this.p.byteLength();if((t[0]===4||t[0]===6||t[0]===7)&&t.length-1===2*i){t[0]===6?im(t[t.length-1]%2===0):t[0]===7&&im(t[t.length-1]%2===1);var n=this.point(t.slice(1,1+i),t.slice(1+i,1+2*i));return n}else if((t[0]===2||t[0]===3)&&t.length-1===i)return this.pointFromX(t.slice(1,1+i),t[0]===3);throw new Error("Unknown point format")};Vn.prototype.encodeCompressed=function(t){return this.encode(t,!0)};Vn.prototype._encode=function(t){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return t?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))};Vn.prototype.encode=function(t,r){return bn.encode(this._encode(r),t)};Vn.prototype.precompute=function(t){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,t),r.beta=this._getBeta(),this.precomputed=r,this};Vn.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((t.bitLength()+1)/r.step):!1};Vn.prototype._getDoubles=function(t,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<r;s+=t){for(var a=0;a<t;a++)n=n.dbl();i.push(n)}return{step:t,points:i}};Vn.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<t)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)r[s]=r[s-1].add(n);return{wnd:t,points:r}};Vn.prototype._getBeta=function(){return null};Vn.prototype.dblp=function(t){for(var r=this,i=0;i<t;i++)r=r.dbl();return r};var qb=Ju(function(e){typeof Object.create=="function"?e.exports=function(r,i){i&&(r.super_=i,r.prototype=Object.create(i.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(r,i){if(i){r.super_=i;var n=function(){};n.prototype=i.prototype,r.prototype=new n,r.prototype.constructor=r}}}),vee=bn.assert;function jn(e){rh.call(this,"short",e),this.a=new xt(e.a,16).toRed(this.red),this.b=new xt(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}qb(jn,rh);var yee=jn;jn.prototype._getEndomorphism=function(t){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(t.beta)r=new xt(t.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);r=n[0].cmp(n[1])<0?n[0]:n[1],r=r.toRed(this.red)}if(t.lambda)i=new xt(t.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?i=s[0]:(i=s[1],vee(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var a;return t.basis?a=t.basis.map(function(o){return{a:new xt(o.a,16),b:new xt(o.b,16)}}):a=this._getEndoBasis(i),{beta:r,lambda:i,basis:a}}};jn.prototype._getEndoRoots=function(t){var r=t===this.p?this.red:xt.mont(t),i=new xt(2).toRed(r).redInvm(),n=i.redNeg(),s=new xt(3).toRed(r).redNeg().redSqrt().redMul(i),a=n.redAdd(s).fromRed(),o=n.redSub(s).fromRed();return[a,o]};jn.prototype._getEndoBasis=function(t){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=t,n=this.n.clone(),s=new xt(1),a=new xt(0),o=new xt(0),l=new xt(1),h,u,c,d,f,p,m,g=0,v,x;i.cmpn(0)!==0;){var b=n.div(i);v=n.sub(b.mul(i)),x=o.sub(b.mul(s));var _=l.sub(b.mul(a));if(!c&&v.cmp(r)<0)h=m.neg(),u=s,c=v.neg(),d=x;else if(c&&++g===2)break;m=v,n=i,i=v,o=s,s=x,l=a,a=_}f=v.neg(),p=x;var E=c.sqr().add(d.sqr()),S=f.sqr().add(p.sqr());return S.cmp(E)>=0&&(f=h,p=u),c.negative&&(c=c.neg(),d=d.neg()),f.negative&&(f=f.neg(),p=p.neg()),[{a:c,b:d},{a:f,b:p}]};jn.prototype._endoSplit=function(t){var r=this.endo.basis,i=r[0],n=r[1],s=n.b.mul(t).divRound(this.n),a=i.b.neg().mul(t).divRound(this.n),o=s.mul(i.a),l=a.mul(n.a),h=s.mul(i.b),u=a.mul(n.b),c=t.sub(o).sub(l),d=h.add(u).neg();return{k1:c,k2:d}};jn.prototype.pointFromX=function(t,r){t=new xt(t,16),t.red||(t=t.toRed(this.red));var i=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(r&&!s||!r&&s)&&(n=n.redNeg()),this.point(t,n)};jn.prototype.validate=function(t){if(t.inf)return!0;var r=t.x,i=t.y,n=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};jn.prototype._endoWnafMulAdd=function(t,r,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,a=0;a<t.length;a++){var o=this._endoSplit(r[a]),l=t[a],h=l._getBeta();o.k1.negative&&(o.k1.ineg(),l=l.neg(!0)),o.k2.negative&&(o.k2.ineg(),h=h.neg(!0)),n[a*2]=l,n[a*2+1]=h,s[a*2]=o.k1,s[a*2+1]=o.k2}for(var u=this._wnafMulAdd(1,n,s,a*2,i),c=0;c<a*2;c++)n[c]=null,s[c]=null;return u};function Jr(e,t,r,i){rh.BasePoint.call(this,e,"affine"),t===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new xt(t,16),this.y=new xt(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}qb(Jr,rh.BasePoint);jn.prototype.point=function(t,r,i){return new Jr(this,t,r,i)};jn.prototype.pointFromJSON=function(t,r){return Jr.fromJSON(this,t,r)};Jr.prototype._getBeta=function(){if(!!this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};t.beta=r,r.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(n)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(n)}}}return r}};Jr.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Jr.fromJSON=function(t,r,i){typeof r=="string"&&(r=JSON.parse(r));var n=t.point(r[0],r[1],i);if(!r[2])return n;function s(o){return t.point(o[0],o[1],i)}var a=r[2];return n.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[n].concat(a.doubles.points.map(s))},naf:a.naf&&{wnd:a.naf.wnd,points:[n].concat(a.naf.points.map(s))}},n};Jr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Jr.prototype.isInfinity=function(){return this.inf};Jr.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(this.x.cmp(t.x)===0)return this.curve.point(null,null);var r=this.y.redSub(t.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(t.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(t.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};Jr.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(t.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),n=t.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(n),a=s.redSqr().redISub(this.x.redAdd(this.x)),o=s.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,o)};Jr.prototype.getX=function(){return this.x.fromRed()};Jr.prototype.getY=function(){return this.y.fromRed()};Jr.prototype.mul=function(t){return t=new xt(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)};Jr.prototype.mulAdd=function(t,r,i){var n=[this,r],s=[t,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};Jr.prototype.jmulAdd=function(t,r,i){var n=[this,r],s=[t,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};Jr.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||this.x.cmp(t.x)===0&&this.y.cmp(t.y)===0)};Jr.prototype.neg=function(t){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return r};Jr.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t};function oi(e,t,r,i){rh.BasePoint.call(this,e,"jacobian"),t===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new xt(0)):(this.x=new xt(t,16),this.y=new xt(r,16),this.z=new xt(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}qb(oi,rh.BasePoint);jn.prototype.jpoint=function(t,r,i){return new oi(this,t,r,i)};oi.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),r=t.redSqr(),i=this.x.redMul(r),n=this.y.redMul(r).redMul(t);return this.curve.point(i,n)};oi.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};oi.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var r=t.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(r),s=t.x.redMul(i),a=this.y.redMul(r.redMul(t.z)),o=t.y.redMul(i.redMul(this.z)),l=n.redSub(s),h=a.redSub(o);if(l.cmpn(0)===0)return h.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=l.redSqr(),c=u.redMul(l),d=n.redMul(u),f=h.redSqr().redIAdd(c).redISub(d).redISub(d),p=h.redMul(d.redISub(f)).redISub(a.redMul(c)),m=this.z.redMul(t.z).redMul(l);return this.curve.jpoint(f,p,m)};oi.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var r=this.z.redSqr(),i=this.x,n=t.x.redMul(r),s=this.y,a=t.y.redMul(r).redMul(this.z),o=i.redSub(n),l=s.redSub(a);if(o.cmpn(0)===0)return l.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var h=o.redSqr(),u=h.redMul(o),c=i.redMul(h),d=l.redSqr().redIAdd(u).redISub(c).redISub(c),f=l.redMul(c.redISub(d)).redISub(s.redMul(u)),p=this.z.redMul(o);return this.curve.jpoint(d,f,p)};oi.prototype.dblp=function(t){if(t===0)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<t;r++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,a=this.x,o=this.y,l=this.z,h=l.redSqr().redSqr(),u=o.redAdd(o);for(r=0;r<t;r++){var c=a.redSqr(),d=u.redSqr(),f=d.redSqr(),p=c.redAdd(c).redIAdd(c).redIAdd(n.redMul(h)),m=a.redMul(d),g=p.redSqr().redISub(m.redAdd(m)),v=m.redISub(g),x=p.redMul(v);x=x.redIAdd(x).redISub(f);var b=u.redMul(l);r+1<t&&(h=h.redMul(f)),a=g,l=b,u=x}return this.curve.jpoint(a,u.redMul(s),l)};oi.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};oi.prototype._zeroDbl=function(){var t,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(n).redISub(a);o=o.redIAdd(o);var l=n.redAdd(n).redIAdd(n),h=l.redSqr().redISub(o).redISub(o),u=a.redIAdd(a);u=u.redIAdd(u),u=u.redIAdd(u),t=h,r=l.redMul(o.redISub(h)).redISub(u),i=this.y.redAdd(this.y)}else{var c=this.x.redSqr(),d=this.y.redSqr(),f=d.redSqr(),p=this.x.redAdd(d).redSqr().redISub(c).redISub(f);p=p.redIAdd(p);var m=c.redAdd(c).redIAdd(c),g=m.redSqr(),v=f.redIAdd(f);v=v.redIAdd(v),v=v.redIAdd(v),t=g.redISub(p).redISub(p),r=m.redMul(p.redISub(t)).redISub(v),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(t,r,i)};oi.prototype._threeDbl=function(){var t,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(n).redISub(a);o=o.redIAdd(o);var l=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),h=l.redSqr().redISub(o).redISub(o);t=h;var u=a.redIAdd(a);u=u.redIAdd(u),u=u.redIAdd(u),r=l.redMul(o.redISub(h)).redISub(u),i=this.y.redAdd(this.y)}else{var c=this.z.redSqr(),d=this.y.redSqr(),f=this.x.redMul(d),p=this.x.redSub(c).redMul(this.x.redAdd(c));p=p.redAdd(p).redIAdd(p);var m=f.redIAdd(f);m=m.redIAdd(m);var g=m.redAdd(m);t=p.redSqr().redISub(g),i=this.y.redAdd(this.z).redSqr().redISub(d).redISub(c);var v=d.redSqr();v=v.redIAdd(v),v=v.redIAdd(v),v=v.redIAdd(v),r=p.redMul(m.redISub(t)).redISub(v)}return this.curve.jpoint(t,r,i)};oi.prototype._dbl=function(){var t=this.curve.a,r=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),a=r.redSqr(),o=i.redSqr(),l=a.redAdd(a).redIAdd(a).redIAdd(t.redMul(s)),h=r.redAdd(r);h=h.redIAdd(h);var u=h.redMul(o),c=l.redSqr().redISub(u.redAdd(u)),d=u.redISub(c),f=o.redSqr();f=f.redIAdd(f),f=f.redIAdd(f),f=f.redIAdd(f);var p=l.redMul(d).redISub(f),m=i.redAdd(i).redMul(n);return this.curve.jpoint(c,p,m)};oi.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),n=r.redSqr(),s=t.redAdd(t).redIAdd(t),a=s.redSqr(),o=this.x.redAdd(r).redSqr().redISub(t).redISub(n);o=o.redIAdd(o),o=o.redAdd(o).redIAdd(o),o=o.redISub(a);var l=o.redSqr(),h=n.redIAdd(n);h=h.redIAdd(h),h=h.redIAdd(h),h=h.redIAdd(h);var u=s.redIAdd(o).redSqr().redISub(a).redISub(l).redISub(h),c=r.redMul(u);c=c.redIAdd(c),c=c.redIAdd(c);var d=this.x.redMul(l).redISub(c);d=d.redIAdd(d),d=d.redIAdd(d);var f=this.y.redMul(u.redMul(h.redISub(u)).redISub(o.redMul(l)));f=f.redIAdd(f),f=f.redIAdd(f),f=f.redIAdd(f);var p=this.z.redAdd(o).redSqr().redISub(i).redISub(l);return this.curve.jpoint(d,f,p)};oi.prototype.mul=function(t,r){return t=new xt(t,r),this.curve._wnafMul(this,t)};oi.prototype.eq=function(t){if(t.type==="affine")return this.eq(t.toJ());if(this===t)return!0;var r=this.z.redSqr(),i=t.z.redSqr();if(this.x.redMul(i).redISub(t.x.redMul(r)).cmpn(0)!==0)return!1;var n=r.redMul(this.z),s=i.redMul(t.z);return this.y.redMul(s).redISub(t.y.redMul(n)).cmpn(0)===0};oi.prototype.eqXToP=function(t){var r=this.z.redSqr(),i=t.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var n=t.clone(),s=this.curve.redN.redMul(r);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};oi.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};oi.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Zp=Ju(function(e,t){var r=t;r.base=rh,r.short=yee,r.mont=null,r.edwards=null}),$p=Ju(function(e,t){var r=t,i=bn.assert;function n(o){o.type==="short"?this.curve=new Zp.short(o):o.type==="edwards"?this.curve=new Zp.edwards(o):this.curve=new Zp.mont(o),this.g=this.curve.g,this.n=this.curve.n,this.hash=o.hash,i(this.g.validate(),"Invalid curve"),i(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}r.PresetCurve=n;function s(o,l){Object.defineProperty(r,o,{configurable:!0,enumerable:!0,get:function(){var h=new n(l);return Object.defineProperty(r,o,{configurable:!0,enumerable:!0,value:h}),h}})}s("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Os.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),s("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Os.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),s("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Os.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),s("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Os.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),s("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Os.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),s("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Os.sha256,gRed:!1,g:["9"]}),s("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Os.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var a;try{a=null.crash()}catch{a=void 0}s("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Os.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",a]})});function rl(e){if(!(this instanceof rl))return new rl(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=cs.toArray(e.entropy,e.entropyEnc||"hex"),r=cs.toArray(e.nonce,e.nonceEnc||"hex"),i=cs.toArray(e.pers,e.persEnc||"hex");Wb(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,i)}var e4=rl;rl.prototype._init=function(t,r,i){var n=t.concat(r).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656};rl.prototype._hmac=function(){return new Os.hmac(this.hash,this.K)};rl.prototype._update=function(t){var r=this._hmac().update(this.V).update([0]);t&&(r=r.update(t)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())};rl.prototype.reseed=function(t,r,i,n){typeof r!="string"&&(n=i,i=r,r=null),t=cs.toArray(t,r),i=cs.toArray(i,n),Wb(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(i||[])),this._reseed=1};rl.prototype.generate=function(t,r,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(n=i,i=r,r=null),i&&(i=cs.toArray(i,n||"hex"),this._update(i));for(var s=[];s.length<t;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var a=s.slice(0,t);return this._update(i),this._reseed++,cs.encode(a,r)};var Tx=bn.assert;function bi(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var Yb=bi;bi.fromPublic=function(t,r,i){return r instanceof bi?r:new bi(t,{pub:r,pubEnc:i})};bi.fromPrivate=function(t,r,i){return r instanceof bi?r:new bi(t,{priv:r,privEnc:i})};bi.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};bi.prototype.getPublic=function(t,r){return typeof t=="string"&&(r=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,t):this.pub};bi.prototype.getPrivate=function(t){return t==="hex"?this.priv.toString(16,2):this.priv};bi.prototype._importPrivate=function(t,r){this.priv=new xt(t,r||16),this.priv=this.priv.umod(this.ec.curve.n)};bi.prototype._importPublic=function(t,r){if(t.x||t.y){this.ec.curve.type==="mont"?Tx(t.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Tx(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,r)};bi.prototype.derive=function(t){return t.validate()||Tx(t.validate(),"public point not validated"),t.mul(this.priv).getX()};bi.prototype.sign=function(t,r,i){return this.ec.sign(t,this,r,i)};bi.prototype.verify=function(t,r){return this.ec.verify(t,r,this)};bi.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var xee=bn.assert;function $m(e,t){if(e instanceof $m)return e;this._importDER(e,t)||(xee(e.r&&e.s,"Signature without r or s"),this.r=new xt(e.r,16),this.s=new xt(e.s,16),e.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}var eg=$m;function wee(){this.place=0}function a1(e,t){var r=e[t.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4)return!1;for(var n=0,s=0,a=t.place;s<i;s++,a++)n<<=8,n|=e[a],n>>>=0;return n<=127?!1:(t.place=a,n)}function zE(e){for(var t=0,r=e.length-1;!e[t]&&!(e[t+1]&128)&&t<r;)t++;return t===0?e:e.slice(t)}$m.prototype._importDER=function(t,r){t=bn.toArray(t,r);var i=new wee;if(t[i.place++]!==48)return!1;var n=a1(t,i);if(n===!1||n+i.place!==t.length||t[i.place++]!==2)return!1;var s=a1(t,i);if(s===!1)return!1;var a=t.slice(i.place,s+i.place);if(i.place+=s,t[i.place++]!==2)return!1;var o=a1(t,i);if(o===!1||t.length!==o+i.place)return!1;var l=t.slice(i.place,o+i.place);if(a[0]===0)if(a[1]&128)a=a.slice(1);else return!1;if(l[0]===0)if(l[1]&128)l=l.slice(1);else return!1;return this.r=new xt(a),this.s=new xt(l),this.recoveryParam=null,!0};function o1(e,t){if(t<128){e.push(t);return}var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(r|128);--r;)e.push(t>>>(r<<3)&255);e.push(t)}$m.prototype.toDER=function(t){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=zE(r),i=zE(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];o1(n,r.length),n=n.concat(r),n.push(2),o1(n,i.length);var s=n.concat(i),a=[48];return o1(a,s.length),a=a.concat(s),bn.encode(a,t)};var bee=function(){throw new Error("unsupported")},t4=bn.assert;function Hn(e){if(!(this instanceof Hn))return new Hn(e);typeof e=="string"&&(t4(Object.prototype.hasOwnProperty.call($p,e),"Unknown curve "+e),e=$p[e]),e instanceof $p.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}var _ee=Hn;Hn.prototype.keyPair=function(t){return new Yb(this,t)};Hn.prototype.keyFromPrivate=function(t,r){return Yb.fromPrivate(this,t,r)};Hn.prototype.keyFromPublic=function(t,r){return Yb.fromPublic(this,t,r)};Hn.prototype.genKeyPair=function(t){t||(t={});for(var r=new e4({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||bee(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new xt(2));;){var s=new xt(r.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Hn.prototype._truncateToN=function(t,r){var i=t.byteLength()*8-this.n.bitLength();return i>0&&(t=t.ushrn(i)),!r&&t.cmp(this.n)>=0?t.sub(this.n):t};Hn.prototype.sign=function(t,r,i,n){typeof i=="object"&&(n=i,i=null),n||(n={}),r=this.keyFromPrivate(r,i),t=this._truncateToN(new xt(t,16));for(var s=this.n.byteLength(),a=r.getPrivate().toArray("be",s),o=t.toArray("be",s),l=new e4({hash:this.hash,entropy:a,nonce:o,pers:n.pers,persEnc:n.persEnc||"utf8"}),h=this.n.sub(new xt(1)),u=0;;u++){var c=n.k?n.k(u):new xt(l.generate(this.n.byteLength()));if(c=this._truncateToN(c,!0),!(c.cmpn(1)<=0||c.cmp(h)>=0)){var d=this.g.mul(c);if(!d.isInfinity()){var f=d.getX(),p=f.umod(this.n);if(p.cmpn(0)!==0){var m=c.invm(this.n).mul(p.mul(r.getPrivate()).iadd(t));if(m=m.umod(this.n),m.cmpn(0)!==0){var g=(d.getY().isOdd()?1:0)|(f.cmp(p)!==0?2:0);return n.canonical&&m.cmp(this.nh)>0&&(m=this.n.sub(m),g^=1),new eg({r:p,s:m,recoveryParam:g})}}}}}};Hn.prototype.verify=function(t,r,i,n){t=this._truncateToN(new xt(t,16)),i=this.keyFromPublic(i,n),r=new eg(r,"hex");var s=r.r,a=r.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var o=a.invm(this.n),l=o.mul(t).umod(this.n),h=o.mul(s).umod(this.n),u;return this.curve._maxwellTrick?(u=this.g.jmulAdd(l,i.getPublic(),h),u.isInfinity()?!1:u.eqXToP(s)):(u=this.g.mulAdd(l,i.getPublic(),h),u.isInfinity()?!1:u.getX().umod(this.n).cmp(s)===0)};Hn.prototype.recoverPubKey=function(e,t,r,i){t4((3&r)===r,"The recovery param is more than two bits"),t=new eg(t,i);var n=this.n,s=new xt(e),a=t.r,o=t.s,l=r&1,h=r>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&h)throw new Error("Unable to find sencond key candinate");h?a=this.curve.pointFromX(a.add(this.curve.n),l):a=this.curve.pointFromX(a,l);var u=t.r.invm(n),c=n.sub(s).mul(u).umod(n),d=o.mul(u).umod(n);return this.g.mulAdd(c,a,d)};Hn.prototype.getKeyRecoveryParam=function(e,t,r,i){if(t=new eg(t,i),t.recoveryParam!==null)return t.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(e,t,n)}catch{continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")};var See=Ju(function(e,t){var r=t;r.version="6.5.4",r.utils=bn,r.rand=function(){throw new Error("unsupported")},r.curve=Zp,r.curves=$p,r.ec=_ee,r.eddsa=null}),Mee=See.ec;const Aee="signing-key/5.6.2",Dx=new ae(Aee);let l1=null;function zs(){return l1||(l1=new Mee("secp256k1")),l1}class Eee{constructor(t){Ae(this,"curve","secp256k1"),Ae(this,"privateKey",tt(t)),ql(this.privateKey)!==32&&Dx.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const r=zs().keyFromPrivate(ct(this.privateKey));Ae(this,"publicKey","0x"+r.getPublic(!1,"hex")),Ae(this,"compressedPublicKey","0x"+r.getPublic(!0,"hex")),Ae(this,"_isSigningKey",!0)}_addPoint(t){const r=zs().keyFromPublic(ct(this.publicKey)),i=zs().keyFromPublic(ct(t));return"0x"+r.pub.add(i.pub).encodeCompressed("hex")}signDigest(t){const r=zs().keyFromPrivate(ct(this.privateKey)),i=ct(t);i.length!==32&&Dx.throwArgumentError("bad digest length","digest",t);const n=r.sign(i,{canonical:!0});return Qm({recoveryParam:n.recoveryParam,r:ar("0x"+n.r.toString(16),32),s:ar("0x"+n.s.toString(16),32)})}computeSharedSecret(t){const r=zs().keyFromPrivate(ct(this.privateKey)),i=zs().keyFromPublic(ct(r4(t)));return ar("0x"+r.derive(i.getPublic()).toString(16),32)}static isSigningKey(t){return!!(t&&t._isSigningKey)}}function Cee(e,t){const r=Qm(t),i={r:ct(r.r),s:ct(r.s)};return"0x"+zs().recoverPubKey(ct(e),i,r.recoveryParam).encode("hex",!1)}function r4(e,t){const r=ct(e);if(r.length===32){const i=new Eee(r);return t?"0x"+zs().keyFromPrivate(r).getPublic(!0,"hex"):i.publicKey}else{if(r.length===33)return t?tt(r):"0x"+zs().keyFromPublic(r).getPublic(!1,"hex");if(r.length===65)return t?"0x"+zs().keyFromPublic(r).getPublic(!0,"hex"):tt(r)}return Dx.throwArgumentError("invalid public or private key","key","[REDACTED]")}const Tee="transactions/5.6.2",oo=new ae(Tee);var FE;(function(e){e[e.legacy=0]="legacy",e[e.eip2930=1]="eip2930",e[e.eip1559=2]="eip1559"})(FE||(FE={}));function Xb(e){return e==="0x"?null:si(e)}function vi(e){return e==="0x"?SP:Te.from(e)}function Dee(e){const t=r4(e);return si(di(Fr(di(t,1)),12))}function i4(e,t){return Dee(Cee(ct(e),t))}function cn(e,t){const r=Au(Te.from(e).toHexString());return r.length>32&&oo.throwArgumentError("invalid length for "+t,"transaction:"+t,e),r}function h1(e,t){return{address:si(e),storageKeys:(t||[]).map((r,i)=>(ql(r)!==32&&oo.throwArgumentError("invalid access list storageKey",`accessList[${e}:${i}]`,r),r.toLowerCase()))}}function Ku(e){if(Array.isArray(e))return e.map((r,i)=>Array.isArray(r)?(r.length>2&&oo.throwArgumentError("access list expected to be [ address, storageKeys[] ]",`value[${i}]`,r),h1(r[0],r[1])):h1(r.address,r.storageKeys));const t=Object.keys(e).map(r=>{const i=e[r].reduce((n,s)=>(n[s]=!0,n),{});return h1(r,Object.keys(i).sort())});return t.sort((r,i)=>r.address.localeCompare(i.address)),t}function n4(e){return Ku(e).map(t=>[t.address,t.storageKeys])}function Pee(e,t){if(e.gasPrice!=null){const i=Te.from(e.gasPrice),n=Te.from(e.maxFeePerGas||0);i.eq(n)||oo.throwArgumentError("mismatch EIP-1559 gasPrice != maxFeePerGas","tx",{gasPrice:i,maxFeePerGas:n})}const r=[cn(e.chainId||0,"chainId"),cn(e.nonce||0,"nonce"),cn(e.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),cn(e.maxFeePerGas||0,"maxFeePerGas"),cn(e.gasLimit||0,"gasLimit"),e.to!=null?si(e.to):"0x",cn(e.value||0,"value"),e.data||"0x",n4(e.accessList||[])];if(t){const i=Qm(t);r.push(cn(i.recoveryParam,"recoveryParam")),r.push(Au(i.r)),r.push(Au(i.s))}return Xi(["0x02",Jm(r)])}function Lee(e,t){const r=[cn(e.chainId||0,"chainId"),cn(e.nonce||0,"nonce"),cn(e.gasPrice||0,"gasPrice"),cn(e.gasLimit||0,"gasLimit"),e.to!=null?si(e.to):"0x",cn(e.value||0,"value"),e.data||"0x",n4(e.accessList||[])];if(t){const i=Qm(t);r.push(cn(i.recoveryParam,"recoveryParam")),r.push(Au(i.r)),r.push(Au(i.s))}return Xi(["0x01",Jm(r)])}function s4(e,t,r){try{const i=vi(t[0]).toNumber();if(i!==0&&i!==1)throw new Error("bad recid");e.v=i}catch{oo.throwArgumentError("invalid v for transaction type: 1","v",t[0])}e.r=ar(t[1],32),e.s=ar(t[2],32);try{const i=Fr(r(e));e.from=i4(i,{r:e.r,s:e.s,recoveryParam:e.v})}catch{}}function Ree(e){const t=Ub(e.slice(1));t.length!==9&&t.length!==12&&oo.throwArgumentError("invalid component count for transaction type: 2","payload",tt(e));const r=vi(t[2]),i=vi(t[3]),n={type:2,chainId:vi(t[0]).toNumber(),nonce:vi(t[1]).toNumber(),maxPriorityFeePerGas:r,maxFeePerGas:i,gasPrice:null,gasLimit:vi(t[4]),to:Xb(t[5]),value:vi(t[6]),data:t[7],accessList:Ku(t[8])};return t.length===9||(n.hash=Fr(e),s4(n,t.slice(9),Pee)),n}function Oee(e){const t=Ub(e.slice(1));t.length!==8&&t.length!==11&&oo.throwArgumentError("invalid component count for transaction type: 1","payload",tt(e));const r={type:1,chainId:vi(t[0]).toNumber(),nonce:vi(t[1]).toNumber(),gasPrice:vi(t[2]),gasLimit:vi(t[3]),to:Xb(t[4]),value:vi(t[5]),data:t[6],accessList:Ku(t[7])};return t.length===8||(r.hash=Fr(e),s4(r,t.slice(8),Lee)),r}function Iee(e){const t=Ub(e);t.length!==9&&t.length!==6&&oo.throwArgumentError("invalid raw transaction","rawTransaction",e);const r={nonce:vi(t[0]).toNumber(),gasPrice:vi(t[1]),gasLimit:vi(t[2]),to:Xb(t[3]),value:vi(t[4]),data:t[5],chainId:0};if(t.length===6)return r;try{r.v=Te.from(t[6]).toNumber()}catch{return r}if(r.r=ar(t[7],32),r.s=ar(t[8],32),Te.from(r.r).isZero()&&Te.from(r.s).isZero())r.chainId=r.v,r.v=0;else{r.chainId=Math.floor((r.v-35)/2),r.chainId<0&&(r.chainId=0);let i=r.v-27;const n=t.slice(0,6);r.chainId!==0&&(n.push(tt(r.chainId)),n.push("0x"),n.push("0x"),i-=r.chainId*2+8);const s=Fr(Jm(n));try{r.from=i4(s,{r:tt(r.r),s:tt(r.s),recoveryParam:i})}catch{}r.hash=Fr(e)}return r.type=null,r}function Nee(e){const t=ct(e);if(t[0]>127)return Iee(t);switch(t[0]){case 1:return Oee(t);case 2:return Ree(t)}return oo.throwError(`unsupported transaction type: ${t[0]}`,ae.errors.UNSUPPORTED_OPERATION,{operation:"parseTransaction",transactionType:t[0]})}const Bee="contracts/5.6.2";var Ql=globalThis&&globalThis.__awaiter||function(e,t,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{h(i.next(u))}catch(c){a(c)}}function l(u){try{h(i.throw(u))}catch(c){a(c)}}function h(u){u.done?s(u.value):n(u.value).then(o,l)}h((i=i.apply(e,t||[])).next())})};const _r=new ae(Bee);function nm(e,t){return Ql(this,void 0,void 0,function*(){const r=yield t;typeof r!="string"&&_r.throwArgumentError("invalid address or ENS name","name",r);try{return si(r)}catch{}e||_r.throwError("a provider or signer is needed to resolve ENS names",ae.errors.UNSUPPORTED_OPERATION,{operation:"resolveName"});const i=yield e.resolveName(r);return i==null&&_r.throwArgumentError("resolver or addr is not configured for ENS name","name",r),i})}function e0(e,t,r){return Ql(this,void 0,void 0,function*(){return Array.isArray(r)?yield Promise.all(r.map((i,n)=>e0(e,Array.isArray(t)?t[n]:t[i.name],i))):r.type==="address"?yield nm(e,t):r.type==="tuple"?yield e0(e,t,r.components):r.baseType==="array"?Array.isArray(t)?yield Promise.all(t.map(i=>e0(e,i,r.arrayChildren))):Promise.reject(_r.makeError("invalid value for array",ae.errors.INVALID_ARGUMENT,{argument:"value",value:t})):t})}function tg(e,t,r){return Ql(this,void 0,void 0,function*(){let i={};r.length===t.inputs.length+1&&typeof r[r.length-1]=="object"&&(i=Xr(r.pop())),_r.checkArgumentCount(r.length,t.inputs.length,"passed to contract"),e.signer?i.from?i.from=Tr({override:nm(e.signer,i.from),signer:e.signer.getAddress()}).then(h=>Ql(this,void 0,void 0,function*(){return si(h.signer)!==h.override&&_r.throwError("Contract with a Signer cannot override from",ae.errors.UNSUPPORTED_OPERATION,{operation:"overrides.from"}),h.override})):i.from=e.signer.getAddress():i.from&&(i.from=nm(e.provider,i.from));const n=yield Tr({args:e0(e.signer||e.provider,r,t.inputs),address:e.resolvedAddress,overrides:Tr(i)||{}}),s=e.interface.encodeFunctionData(t,n.args),a={data:s,to:n.address},o=n.overrides;if(o.nonce!=null&&(a.nonce=Te.from(o.nonce).toNumber()),o.gasLimit!=null&&(a.gasLimit=Te.from(o.gasLimit)),o.gasPrice!=null&&(a.gasPrice=Te.from(o.gasPrice)),o.maxFeePerGas!=null&&(a.maxFeePerGas=Te.from(o.maxFeePerGas)),o.maxPriorityFeePerGas!=null&&(a.maxPriorityFeePerGas=Te.from(o.maxPriorityFeePerGas)),o.from!=null&&(a.from=o.from),o.type!=null&&(a.type=o.type),o.accessList!=null&&(a.accessList=Ku(o.accessList)),a.gasLimit==null&&t.gas!=null){let h=21e3;const u=ct(s);for(let c=0;c<u.length;c++)h+=4,u[c]&&(h+=64);a.gasLimit=Te.from(t.gas).add(h)}if(o.value){const h=Te.from(o.value);!h.isZero()&&!t.payable&&_r.throwError("non-payable method cannot override value",ae.errors.UNSUPPORTED_OPERATION,{operation:"overrides.value",value:i.value}),a.value=h}o.customData&&(a.customData=Xr(o.customData)),o.ccipReadEnabled&&(a.ccipReadEnabled=!!o.ccipReadEnabled),delete i.nonce,delete i.gasLimit,delete i.gasPrice,delete i.from,delete i.value,delete i.type,delete i.accessList,delete i.maxFeePerGas,delete i.maxPriorityFeePerGas,delete i.customData,delete i.ccipReadEnabled;const l=Object.keys(i).filter(h=>i[h]!=null);return l.length&&_r.throwError(`cannot override ${l.map(h=>JSON.stringify(h)).join(",")}`,ae.errors.UNSUPPORTED_OPERATION,{operation:"overrides",overrides:l}),a})}function kee(e,t){return function(...r){return tg(e,t,r)}}function zee(e,t){const r=e.signer||e.provider;return function(...i){return Ql(this,void 0,void 0,function*(){r||_r.throwError("estimate require a provider or signer",ae.errors.UNSUPPORTED_OPERATION,{operation:"estimateGas"});const n=yield tg(e,t,i);return yield r.estimateGas(n)})}}function Fee(e,t){const r=t.wait.bind(t);t.wait=i=>r(i).then(n=>(n.events=n.logs.map(s=>{let a=$a(s),o=null;try{o=e.interface.parseLog(s)}catch{}return o&&(a.args=o.args,a.decode=(l,h)=>e.interface.decodeEventLog(o.eventFragment,l,h),a.event=o.name,a.eventSignature=o.signature),a.removeListener=()=>e.provider,a.getBlock=()=>e.provider.getBlock(n.blockHash),a.getTransaction=()=>e.provider.getTransaction(n.transactionHash),a.getTransactionReceipt=()=>Promise.resolve(n),a}),n))}function a4(e,t,r){const i=e.signer||e.provider;return function(...n){return Ql(this,void 0,void 0,function*(){let s;if(n.length===t.inputs.length+1&&typeof n[n.length-1]=="object"){const l=Xr(n.pop());l.blockTag!=null&&(s=yield l.blockTag),delete l.blockTag,n.push(l)}e.deployTransaction!=null&&(yield e._deployed(s));const a=yield tg(e,t,n),o=yield i.call(a,s);try{let l=e.interface.decodeFunctionResult(t,o);return r&&t.outputs.length===1&&(l=l[0]),l}catch(l){throw l.code===ae.errors.CALL_EXCEPTION&&(l.address=e.address,l.args=n,l.transaction=a),l}})}}function Uee(e,t){return function(...r){return Ql(this,void 0,void 0,function*(){e.signer||_r.throwError("sending a transaction requires a signer",ae.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction"}),e.deployTransaction!=null&&(yield e._deployed());const i=yield tg(e,t,r),n=yield e.signer.sendTransaction(i);return Fee(e,n),n})}}function UE(e,t,r){return t.constant?a4(e,t,r):Uee(e,t)}function o4(e){return e.address&&(e.topics==null||e.topics.length===0)?"*":(e.address||"*")+"@"+(e.topics?e.topics.map(t=>Array.isArray(t)?t.join("|"):t).join(":"):"")}class Ud{constructor(t,r){Ae(this,"tag",t),Ae(this,"filter",r),this._listeners=[]}addListener(t,r){this._listeners.push({listener:t,once:r})}removeListener(t){let r=!1;this._listeners=this._listeners.filter(i=>r||i.listener!==t?!0:(r=!0,!1))}removeAllListeners(){this._listeners=[]}listeners(){return this._listeners.map(t=>t.listener)}listenerCount(){return this._listeners.length}run(t){const r=this.listenerCount();return this._listeners=this._listeners.filter(i=>{const n=t.slice();return setTimeout(()=>{i.listener.apply(this,n)},0),!i.once}),r}prepareEvent(t){}getEmit(t){return[t]}}class Hee extends Ud{constructor(){super("error",null)}}class HE extends Ud{constructor(t,r,i,n){const s={address:t};let a=r.getEventTopic(i);n?(a!==n[0]&&_r.throwArgumentError("topic mismatch","topics",n),s.topics=n.slice()):s.topics=[a],super(o4(s),s),Ae(this,"address",t),Ae(this,"interface",r),Ae(this,"fragment",i)}prepareEvent(t){super.prepareEvent(t),t.event=this.fragment.name,t.eventSignature=this.fragment.format(),t.decode=(r,i)=>this.interface.decodeEventLog(this.fragment,r,i);try{t.args=this.interface.decodeEventLog(this.fragment,t.data,t.topics)}catch(r){t.args=null,t.decodeError=r}}getEmit(t){const r=BK(t.args);if(r.length)throw r[0].error;const i=(t.args||[]).slice();return i.push(t),i}}class GE extends Ud{constructor(t,r){super("*",{address:t}),Ae(this,"address",t),Ae(this,"interface",r)}prepareEvent(t){super.prepareEvent(t);try{const r=this.interface.parseLog(t);t.event=r.name,t.eventSignature=r.signature,t.decode=(i,n)=>this.interface.decodeEventLog(r.eventFragment,i,n),t.args=r.args}catch{}}}class Gee{constructor(t,r,i){Ae(this,"interface",Ks(new.target,"getInterface")(r)),i==null?(Ae(this,"provider",null),Ae(this,"signer",null)):hf.isSigner(i)?(Ae(this,"provider",i.provider||null),Ae(this,"signer",i)):Km.isProvider(i)?(Ae(this,"provider",i),Ae(this,"signer",null)):_r.throwArgumentError("invalid signer or provider","signerOrProvider",i),Ae(this,"callStatic",{}),Ae(this,"estimateGas",{}),Ae(this,"functions",{}),Ae(this,"populateTransaction",{}),Ae(this,"filters",{});{const a={};Object.keys(this.interface.events).forEach(o=>{const l=this.interface.events[o];Ae(this.filters,o,(...h)=>({address:this.address,topics:this.interface.encodeFilterTopics(l,h)})),a[l.name]||(a[l.name]=[]),a[l.name].push(o)}),Object.keys(a).forEach(o=>{const l=a[o];l.length===1?Ae(this.filters,o,this.filters[l[0]]):_r.warn(`Duplicate definition of ${o} (${l.join(", ")})`)})}if(Ae(this,"_runningEvents",{}),Ae(this,"_wrappedEmits",{}),t==null&&_r.throwArgumentError("invalid contract address or ENS name","addressOrName",t),Ae(this,"address",t),this.provider)Ae(this,"resolvedAddress",nm(this.provider,t));else try{Ae(this,"resolvedAddress",Promise.resolve(si(t)))}catch{_r.throwError("provider is required to use ENS name as contract address",ae.errors.UNSUPPORTED_OPERATION,{operation:"new Contract"})}this.resolvedAddress.catch(a=>{});const n={},s={};Object.keys(this.interface.functions).forEach(a=>{const o=this.interface.functions[a];if(s[a]){_r.warn(`Duplicate ABI entry for ${JSON.stringify(a)}`);return}s[a]=!0;{const l=o.name;n[`%${l}`]||(n[`%${l}`]=[]),n[`%${l}`].push(a)}this[a]==null&&Ae(this,a,UE(this,o,!0)),this.functions[a]==null&&Ae(this.functions,a,UE(this,o,!1)),this.callStatic[a]==null&&Ae(this.callStatic,a,a4(this,o,!0)),this.populateTransaction[a]==null&&Ae(this.populateTransaction,a,kee(this,o)),this.estimateGas[a]==null&&Ae(this.estimateGas,a,zee(this,o))}),Object.keys(n).forEach(a=>{const o=n[a];if(o.length>1)return;a=a.substring(1);const l=o[0];try{this[a]==null&&Ae(this,a,this[l])}catch{}this.functions[a]==null&&Ae(this.functions,a,this.functions[l]),this.callStatic[a]==null&&Ae(this.callStatic,a,this.callStatic[l]),this.populateTransaction[a]==null&&Ae(this.populateTransaction,a,this.populateTransaction[l]),this.estimateGas[a]==null&&Ae(this.estimateGas,a,this.estimateGas[l])})}static getContractAddress(t){return xP(t)}static getInterface(t){return OE.isInterface(t)?t:new OE(t)}deployed(){return this._deployed()}_deployed(t){return this._deployedPromise||(this.deployTransaction?this._deployedPromise=this.deployTransaction.wait().then(()=>this):this._deployedPromise=this.provider.getCode(this.address,t).then(r=>(r==="0x"&&_r.throwError("contract not deployed",ae.errors.UNSUPPORTED_OPERATION,{contractAddress:this.address,operation:"getDeployed"}),this))),this._deployedPromise}fallback(t){this.signer||_r.throwError("sending a transactions require a signer",ae.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction(fallback)"});const r=Xr(t||{});return["from","to"].forEach(function(i){r[i]!=null&&_r.throwError("cannot override "+i,ae.errors.UNSUPPORTED_OPERATION,{operation:i})}),r.to=this.resolvedAddress,this.deployed().then(()=>this.signer.sendTransaction(r))}connect(t){typeof t=="string"&&(t=new jb(t,this.provider));const r=new this.constructor(this.address,this.interface,t);return this.deployTransaction&&Ae(r,"deployTransaction",this.deployTransaction),r}attach(t){return new this.constructor(t,this.interface,this.signer||this.provider)}static isIndexed(t){return Mx.isIndexed(t)}_normalizeRunningEvent(t){return this._runningEvents[t.tag]?this._runningEvents[t.tag]:t}_getRunningEvent(t){if(typeof t=="string"){if(t==="error")return this._normalizeRunningEvent(new Hee);if(t==="event")return this._normalizeRunningEvent(new Ud("event",null));if(t==="*")return this._normalizeRunningEvent(new GE(this.address,this.interface));const r=this.interface.getEvent(t);return this._normalizeRunningEvent(new HE(this.address,this.interface,r))}if(t.topics&&t.topics.length>0){try{const i=t.topics[0];if(typeof i!="string")throw new Error("invalid topic");const n=this.interface.getEvent(i);return this._normalizeRunningEvent(new HE(this.address,this.interface,n,t.topics))}catch{}const r={address:this.address,topics:t.topics};return this._normalizeRunningEvent(new Ud(o4(r),r))}return this._normalizeRunningEvent(new GE(this.address,this.interface))}_checkRunningEvents(t){if(t.listenerCount()===0){delete this._runningEvents[t.tag];const r=this._wrappedEmits[t.tag];r&&t.filter&&(this.provider.off(t.filter,r),delete this._wrappedEmits[t.tag])}}_wrapEvent(t,r,i){const n=$a(r);return n.removeListener=()=>{!i||(t.removeListener(i),this._checkRunningEvents(t))},n.getBlock=()=>this.provider.getBlock(r.blockHash),n.getTransaction=()=>this.provider.getTransaction(r.transactionHash),n.getTransactionReceipt=()=>this.provider.getTransactionReceipt(r.transactionHash),t.prepareEvent(n),n}_addEventListener(t,r,i){if(this.provider||_r.throwError("events require a provider or a signer with a provider",ae.errors.UNSUPPORTED_OPERATION,{operation:"once"}),t.addListener(r,i),this._runningEvents[t.tag]=t,!this._wrappedEmits[t.tag]){const n=s=>{let a=this._wrapEvent(t,s,r);if(a.decodeError==null)try{const o=t.getEmit(a);this.emit(t.filter,...o)}catch(o){a.decodeError=o.error}t.filter!=null&&this.emit("event",a),a.decodeError!=null&&this.emit("error",a.decodeError,a)};this._wrappedEmits[t.tag]=n,t.filter!=null&&this.provider.on(t.filter,n)}}queryFilter(t,r,i){const n=this._getRunningEvent(t),s=Xr(n.filter);return typeof r=="string"&&jt(r,32)?(i!=null&&_r.throwArgumentError("cannot specify toBlock with blockhash","toBlock",i),s.blockHash=r):(s.fromBlock=r!=null?r:0,s.toBlock=i!=null?i:"latest"),this.provider.getLogs(s).then(a=>a.map(o=>this._wrapEvent(n,o,null)))}on(t,r){return this._addEventListener(this._getRunningEvent(t),r,!1),this}once(t,r){return this._addEventListener(this._getRunningEvent(t),r,!0),this}emit(t,...r){if(!this.provider)return!1;const i=this._getRunningEvent(t),n=i.run(r)>0;return this._checkRunningEvents(i),n}listenerCount(t){return this.provider?t==null?Object.keys(this._runningEvents).reduce((r,i)=>r+this._runningEvents[i].listenerCount(),0):this._getRunningEvent(t).listenerCount():0}listeners(t){if(!this.provider)return[];if(t==null){const r=[];for(let i in this._runningEvents)this._runningEvents[i].listeners().forEach(n=>{r.push(n)});return r}return this._getRunningEvent(t).listeners()}removeAllListeners(t){if(!this.provider)return this;if(t==null){for(const i in this._runningEvents){const n=this._runningEvents[i];n.removeAllListeners(),this._checkRunningEvents(n)}return this}const r=this._getRunningEvent(t);return r.removeAllListeners(),this._checkRunningEvents(r),this}off(t,r){if(!this.provider)return this;const i=this._getRunningEvent(t);return i.removeListener(r),this._checkRunningEvents(i),this}removeListener(t,r){return this.off(t,r)}}class Vee extends Gee{}class l4{constructor(t){Ae(this,"alphabet",t),Ae(this,"base",t.length),Ae(this,"_alphabetMap",{}),Ae(this,"_leader",t.charAt(0));for(let r=0;r<t.length;r++)this._alphabetMap[t.charAt(r)]=r}encode(t){let r=ct(t);if(r.length===0)return"";let i=[0];for(let s=0;s<r.length;++s){let a=r[s];for(let o=0;o<i.length;++o)a+=i[o]<<8,i[o]=a%this.base,a=a/this.base|0;for(;a>0;)i.push(a%this.base),a=a/this.base|0}let n="";for(let s=0;r[s]===0&&s<r.length-1;++s)n+=this._leader;for(let s=i.length-1;s>=0;--s)n+=this.alphabet[i[s]];return n}decode(t){if(typeof t!="string")throw new TypeError("Expected String");let r=[];if(t.length===0)return new Uint8Array(r);r.push(0);for(let i=0;i<t.length;i++){let n=this._alphabetMap[t[i]];if(n===void 0)throw new Error("Non-base"+this.base+" character");let s=n;for(let a=0;a<r.length;++a)s+=r[a]*this.base,r[a]=s&255,s>>=8;for(;s>0;)r.push(s&255),s>>=8}for(let i=0;t[i]===this._leader&&i<t.length-1;++i)r.push(0);return ct(new Uint8Array(r.reverse()))}}new l4("abcdefghijklmnopqrstuvwxyz234567");const Px=new l4("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),jee="sha2/5.6.1";new ae(jee);function VE(e){return"0x"+Os.sha256().update(ct(e)).digest("hex")}const Wee="networks/5.6.3",jE=new ae(Wee);function qee(e){return e&&typeof e.renetwork=="function"}function Lo(e){const t=function(r,i){i==null&&(i={});const n=[];if(r.InfuraProvider&&i.infura!=="-")try{n.push(new r.InfuraProvider(e,i.infura))}catch{}if(r.EtherscanProvider&&i.etherscan!=="-")try{n.push(new r.EtherscanProvider(e,i.etherscan))}catch{}if(r.AlchemyProvider&&i.alchemy!=="-")try{n.push(new r.AlchemyProvider(e,i.alchemy))}catch{}if(r.PocketProvider&&i.pocket!=="-"){const s=["goerli","ropsten","rinkeby"];try{const a=new r.PocketProvider(e,i.pocket);a.network&&s.indexOf(a.network.name)===-1&&n.push(a)}catch{}}if(r.CloudflareProvider&&i.cloudflare!=="-")try{n.push(new r.CloudflareProvider(e))}catch{}if(r.AnkrProvider&&i.ankr!=="-")try{n.push(new r.AnkrProvider(e,i.ankr))}catch{}if(n.length===0)return null;if(r.FallbackProvider){let s=1;return i.quorum!=null?s=i.quorum:e==="homestead"&&(s=2),new r.FallbackProvider(n,s)}return n[0]};return t.renetwork=function(r){return Lo(r)},t}function sm(e,t){const r=function(i,n){return i.JsonRpcProvider?new i.JsonRpcProvider(e,t):null};return r.renetwork=function(i){return sm(e,i)},r}const WE={chainId:1,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"homestead",_defaultProvider:Lo("homestead")},qE={chainId:3,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"ropsten",_defaultProvider:Lo("ropsten")},YE={chainId:63,name:"classicMordor",_defaultProvider:sm("https://www.ethercluster.com/mordor","classicMordor")},Ap={unspecified:{chainId:0,name:"unspecified"},homestead:WE,mainnet:WE,morden:{chainId:2,name:"morden"},ropsten:qE,testnet:qE,rinkeby:{chainId:4,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"rinkeby",_defaultProvider:Lo("rinkeby")},kovan:{chainId:42,name:"kovan",_defaultProvider:Lo("kovan")},goerli:{chainId:5,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"goerli",_defaultProvider:Lo("goerli")},kintsugi:{chainId:1337702,name:"kintsugi"},classic:{chainId:61,name:"classic",_defaultProvider:sm("https://www.ethercluster.com/etc","classic")},classicMorden:{chainId:62,name:"classicMorden"},classicMordor:YE,classicTestnet:YE,classicKotti:{chainId:6,name:"classicKotti",_defaultProvider:sm("https://www.ethercluster.com/kotti","classicKotti")},xdai:{chainId:100,name:"xdai"},matic:{chainId:137,name:"matic",_defaultProvider:Lo("matic")},maticmum:{chainId:80001,name:"maticmum"},optimism:{chainId:10,name:"optimism",_defaultProvider:Lo("optimism")},"optimism-kovan":{chainId:69,name:"optimism-kovan"},"optimism-goerli":{chainId:420,name:"optimism-goerli"},arbitrum:{chainId:42161,name:"arbitrum"},"arbitrum-rinkeby":{chainId:421611,name:"arbitrum-rinkeby"},bnb:{chainId:56,name:"bnb"},bnbt:{chainId:97,name:"bnbt"}};function Yee(e){if(e==null)return null;if(typeof e=="number"){for(const i in Ap){const n=Ap[i];if(n.chainId===e)return{name:n.name,chainId:n.chainId,ensAddress:n.ensAddress||null,_defaultProvider:n._defaultProvider||null}}return{chainId:e,name:"unknown"}}if(typeof e=="string"){const i=Ap[e];return i==null?null:{name:i.name,chainId:i.chainId,ensAddress:i.ensAddress,_defaultProvider:i._defaultProvider||null}}const t=Ap[e.name];if(!t)return typeof e.chainId!="number"&&jE.throwArgumentError("invalid network chainId","network",e),e;e.chainId!==0&&e.chainId!==t.chainId&&jE.throwArgumentError("network chainId mismatch","network",e);let r=e._defaultProvider||null;return r==null&&t._defaultProvider&&(qee(t._defaultProvider)?r=t._defaultProvider.renetwork(e):r=t._defaultProvider),{name:e.name,chainId:t.chainId,ensAddress:e.ensAddress||t.ensAddress||null,_defaultProvider:r}}function Xee(e){e=atob(e);const t=[];for(let r=0;r<e.length;r++)t.push(e.charCodeAt(r));return ct(t)}function h4(e){e=ct(e);let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}const Qee="web/5.6.1";var Jee=globalThis&&globalThis.__awaiter||function(e,t,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{h(i.next(u))}catch(c){a(c)}}function l(u){try{h(i.throw(u))}catch(c){a(c)}}function h(u){u.done?s(u.value):n(u.value).then(o,l)}h((i=i.apply(e,t||[])).next())})};function Kee(e,t){return Jee(this,void 0,void 0,function*(){t==null&&(t={});const r={method:t.method||"GET",headers:t.headers||{},body:t.body||void 0};t.skipFetchSetup!==!0&&(r.mode="cors",r.cache="no-cache",r.credentials="same-origin",r.redirect="follow",r.referrer="client");const i=yield fetch(e,r),n=yield i.arrayBuffer(),s={};return i.headers.forEach?i.headers.forEach((a,o)=>{s[o.toLowerCase()]=a}):i.headers.keys().forEach(a=>{s[a.toLowerCase()]=i.headers.get(a)}),{headers:s,statusCode:i.status,statusMessage:i.statusText,body:ct(new Uint8Array(n))}})}var Zee=globalThis&&globalThis.__awaiter||function(e,t,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{h(i.next(u))}catch(c){a(c)}}function l(u){try{h(i.throw(u))}catch(c){a(c)}}function h(u){u.done?s(u.value):n(u.value).then(o,l)}h((i=i.apply(e,t||[])).next())})};const ts=new ae(Qee);function XE(e){return new Promise(t=>{setTimeout(t,e)})}function So(e,t){if(e==null)return null;if(typeof e=="string")return e;if(Bb(e)){if(t&&(t.split("/")[0]==="text"||t.split(";")[0].trim()==="application/json"))try{return lf(e)}catch{}return tt(e)}return e}function $ee(e,t,r){const i=typeof e=="object"&&e.throttleLimit!=null?e.throttleLimit:12;ts.assertArgument(i>0&&i%1===0,"invalid connection throttle limit","connection.throttleLimit",i);const n=typeof e=="object"?e.throttleCallback:null,s=typeof e=="object"&&typeof e.throttleSlotInterval=="number"?e.throttleSlotInterval:100;ts.assertArgument(s>0&&s%1===0,"invalid connection throttle slot interval","connection.throttleSlotInterval",s);const a=typeof e=="object"?!!e.errorPassThrough:!1,o={};let l=null;const h={method:"GET"};let u=!1,c=2*60*1e3;if(typeof e=="string")l=e;else if(typeof e=="object"){if((e==null||e.url==null)&&ts.throwArgumentError("missing URL","connection.url",e),l=e.url,typeof e.timeout=="number"&&e.timeout>0&&(c=e.timeout),e.headers)for(const v in e.headers)o[v.toLowerCase()]={key:v,value:String(e.headers[v])},["if-none-match","if-modified-since"].indexOf(v.toLowerCase())>=0&&(u=!0);if(h.allowGzip=!!e.allowGzip,e.user!=null&&e.password!=null){l.substring(0,6)!=="https:"&&e.allowInsecureAuthentication!==!0&&ts.throwError("basic authentication requires a secure https url",ae.errors.INVALID_ARGUMENT,{argument:"url",url:l,user:e.user,password:"[REDACTED]"});const v=e.user+":"+e.password;o.authorization={key:"Authorization",value:"Basic "+h4(ca(v))}}e.skipFetchSetup!=null&&(h.skipFetchSetup=!!e.skipFetchSetup)}const d=new RegExp("^data:([a-z0-9-]+/[a-z0-9-]+);base64,(.*)$","i"),f=l?l.match(d):null;if(f)try{const v={statusCode:200,statusMessage:"OK",headers:{"content-type":f[1]},body:Xee(f[2])};let x=v.body;return r&&(x=r(v.body,v)),Promise.resolve(x)}catch(v){ts.throwError("processing response error",ae.errors.SERVER_ERROR,{body:So(f[1],f[2]),error:v,requestBody:null,requestMethod:"GET",url:l})}t&&(h.method="POST",h.body=t,o["content-type"]==null&&(o["content-type"]={key:"Content-Type",value:"application/octet-stream"}),o["content-length"]==null&&(o["content-length"]={key:"Content-Length",value:String(t.length)}));const p={};Object.keys(o).forEach(v=>{const x=o[v];p[x.key]=x.value}),h.headers=p;const m=function(){let v=null;return{promise:new Promise(function(_,E){c&&(v=setTimeout(()=>{v!=null&&(v=null,E(ts.makeError("timeout",ae.errors.TIMEOUT,{requestBody:So(h.body,p["content-type"]),requestMethod:h.method,timeout:c,url:l})))},c))}),cancel:function(){v!=null&&(clearTimeout(v),v=null)}}}(),g=function(){return Zee(this,void 0,void 0,function*(){for(let v=0;v<i;v++){let x=null;try{if(x=yield Kee(l,h),v<i){if(x.statusCode===301||x.statusCode===302){const _=x.headers.location||"";if(h.method==="GET"&&_.match(/^https:/)){l=x.headers.location;continue}}else if(x.statusCode===429){let _=!0;if(n&&(_=yield n(v,l)),_){let E=0;const S=x.headers["retry-after"];typeof S=="string"&&S.match(/^[1-9][0-9]*$/)?E=parseInt(S)*1e3:E=s*parseInt(String(Math.random()*Math.pow(2,v))),yield XE(E);continue}}}}catch(_){x=_.response,x==null&&(m.cancel(),ts.throwError("missing response",ae.errors.SERVER_ERROR,{requestBody:So(h.body,p["content-type"]),requestMethod:h.method,serverError:_,url:l}))}let b=x.body;if(u&&x.statusCode===304?b=null:!a&&(x.statusCode<200||x.statusCode>=300)&&(m.cancel(),ts.throwError("bad response",ae.errors.SERVER_ERROR,{status:x.statusCode,headers:x.headers,body:So(b,x.headers?x.headers["content-type"]:null),requestBody:So(h.body,p["content-type"]),requestMethod:h.method,url:l})),r)try{const _=yield r(b,x);return m.cancel(),_}catch(_){if(_.throttleRetry&&v<i){let E=!0;if(n&&(E=yield n(v,l)),E){const S=s*parseInt(String(Math.random()*Math.pow(2,v)));yield XE(S);continue}}m.cancel(),ts.throwError("processing response error",ae.errors.SERVER_ERROR,{body:So(b,x.headers?x.headers["content-type"]:null),error:_,requestBody:So(h.body,p["content-type"]),requestMethod:h.method,url:l})}return m.cancel(),b}return ts.throwError("failed response",ae.errors.SERVER_ERROR,{requestBody:So(h.body,p["content-type"]),requestMethod:h.method,url:l})})}();return Promise.race([m.promise,g])}function Qb(e,t,r){let i=(s,a)=>{let o=null;if(s!=null)try{o=JSON.parse(lf(s))}catch(l){ts.throwError("invalid JSON",ae.errors.SERVER_ERROR,{body:s,error:l})}return r&&(o=r(o,a)),o},n=null;if(t!=null){n=ca(t);const s=typeof e=="string"?{url:e}:Xr(e);s.headers?Object.keys(s.headers).filter(o=>o.toLowerCase()==="content-type").length!==0||(s.headers=Xr(s.headers),s.headers["content-type"]="application/json"):s.headers={"content-type":"application/json"},e=s}return $ee(e,n,i)}function kc(e,t){return t||(t={}),t=Xr(t),t.floor==null&&(t.floor=0),t.ceiling==null&&(t.ceiling=1e4),t.interval==null&&(t.interval=250),new Promise(function(r,i){let n=null,s=!1;const a=()=>s?!1:(s=!0,n&&clearTimeout(n),!0);t.timeout&&(n=setTimeout(()=>{a()&&i(new Error("timeout"))},t.timeout));const o=t.retryLimit;let l=0;function h(){return e().then(function(u){if(u!==void 0)a()&&r(u);else if(t.oncePoll)t.oncePoll.once("poll",h);else if(t.onceBlock)t.onceBlock.once("block",h);else if(!s){if(l++,l>o){a()&&i(new Error("retry limit reached"));return}let c=t.interval*parseInt(String(Math.random()*Math.pow(2,l)));c<t.floor&&(c=t.floor),c>t.ceiling&&(c=t.ceiling),setTimeout(h,c)}return null},function(u){a()&&i(u)})}h()})}var am="qpzry9x8gf2tvdw0s3jn54khce6mua7l",Lx={};for(var Ep=0;Ep<am.length;Ep++){var u1=am.charAt(Ep);if(Lx[u1]!==void 0)throw new TypeError(u1+" is ambiguous");Lx[u1]=Ep}function fu(e){var t=e>>25;return(e&33554431)<<5^-(t>>0&1)&996825010^-(t>>1&1)&642813549^-(t>>2&1)&513874426^-(t>>3&1)&1027748829^-(t>>4&1)&705979059}function u4(e){for(var t=1,r=0;r<e.length;++r){var i=e.charCodeAt(r);if(i<33||i>126)return"Invalid prefix ("+e+")";t=fu(t)^i>>5}for(t=fu(t),r=0;r<e.length;++r){var n=e.charCodeAt(r);t=fu(t)^n&31}return t}function ete(e,t,r){if(r=r||90,e.length+7+t.length>r)throw new TypeError("Exceeds length limit");e=e.toLowerCase();var i=u4(e);if(typeof i=="string")throw new Error(i);for(var n=e+"1",s=0;s<t.length;++s){var a=t[s];if(a>>5!==0)throw new Error("Non 5-bit word");i=fu(i)^a,n+=am.charAt(a)}for(s=0;s<6;++s)i=fu(i);for(i^=1,s=0;s<6;++s){var o=i>>(5-s)*5&31;n+=am.charAt(o)}return n}function c4(e,t){if(t=t||90,e.length<8)return e+" too short";if(e.length>t)return"Exceeds length limit";var r=e.toLowerCase(),i=e.toUpperCase();if(e!==r&&e!==i)return"Mixed-case string "+e;e=r;var n=e.lastIndexOf("1");if(n===-1)return"No separator character for "+e;if(n===0)return"Missing prefix for "+e;var s=e.slice(0,n),a=e.slice(n+1);if(a.length<6)return"Data too short";var o=u4(s);if(typeof o=="string")return o;for(var l=[],h=0;h<a.length;++h){var u=a.charAt(h),c=Lx[u];if(c===void 0)return"Unknown character "+u;o=fu(o)^c,!(h+6>=a.length)&&l.push(c)}return o!==1?"Invalid checksum for "+e:{prefix:s,words:l}}function tte(){var e=c4.apply(null,arguments);if(typeof e=="object")return e}function rte(e){var t=c4.apply(null,arguments);if(typeof t=="object")return t;throw new Error(t)}function rg(e,t,r,i){for(var n=0,s=0,a=(1<<r)-1,o=[],l=0;l<e.length;++l)for(n=n<<t|e[l],s+=t;s>=r;)s-=r,o.push(n>>s&a);if(i)s>0&&o.push(n<<r-s&a);else{if(s>=t)return"Excess padding";if(n<<r-s&a)return"Non-zero padding"}return o}function ite(e){var t=rg(e,8,5,!0);if(Array.isArray(t))return t}function nte(e){var t=rg(e,8,5,!0);if(Array.isArray(t))return t;throw new Error(t)}function ste(e){var t=rg(e,5,8,!1);if(Array.isArray(t))return t}function ate(e){var t=rg(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}var QE={decodeUnsafe:tte,decode:rte,encode:ete,toWordsUnsafe:ite,toWords:nte,fromWordsUnsafe:ste,fromWords:ate};const ig="providers/5.6.8",bc=new ae(ig);class Qe{constructor(){this.formats=this.getDefaultFormats()}getDefaultFormats(){const t={},r=this.address.bind(this),i=this.bigNumber.bind(this),n=this.blockTag.bind(this),s=this.data.bind(this),a=this.hash.bind(this),o=this.hex.bind(this),l=this.number.bind(this),h=this.type.bind(this),u=c=>this.data(c,!0);return t.transaction={hash:a,type:h,accessList:Qe.allowNull(this.accessList.bind(this),null),blockHash:Qe.allowNull(a,null),blockNumber:Qe.allowNull(l,null),transactionIndex:Qe.allowNull(l,null),confirmations:Qe.allowNull(l,null),from:r,gasPrice:Qe.allowNull(i),maxPriorityFeePerGas:Qe.allowNull(i),maxFeePerGas:Qe.allowNull(i),gasLimit:i,to:Qe.allowNull(r,null),value:i,nonce:l,data:s,r:Qe.allowNull(this.uint256),s:Qe.allowNull(this.uint256),v:Qe.allowNull(l),creates:Qe.allowNull(r,null),raw:Qe.allowNull(s)},t.transactionRequest={from:Qe.allowNull(r),nonce:Qe.allowNull(l),gasLimit:Qe.allowNull(i),gasPrice:Qe.allowNull(i),maxPriorityFeePerGas:Qe.allowNull(i),maxFeePerGas:Qe.allowNull(i),to:Qe.allowNull(r),value:Qe.allowNull(i),data:Qe.allowNull(u),type:Qe.allowNull(l),accessList:Qe.allowNull(this.accessList.bind(this),null)},t.receiptLog={transactionIndex:l,blockNumber:l,transactionHash:a,address:r,topics:Qe.arrayOf(a),data:s,logIndex:l,blockHash:a},t.receipt={to:Qe.allowNull(this.address,null),from:Qe.allowNull(this.address,null),contractAddress:Qe.allowNull(r,null),transactionIndex:l,root:Qe.allowNull(o),gasUsed:i,logsBloom:Qe.allowNull(s),blockHash:a,transactionHash:a,logs:Qe.arrayOf(this.receiptLog.bind(this)),blockNumber:l,confirmations:Qe.allowNull(l,null),cumulativeGasUsed:i,effectiveGasPrice:Qe.allowNull(i),status:Qe.allowNull(l),type:h},t.block={hash:Qe.allowNull(a),parentHash:a,number:l,timestamp:l,nonce:Qe.allowNull(o),difficulty:this.difficulty.bind(this),gasLimit:i,gasUsed:i,miner:Qe.allowNull(r),extraData:s,transactions:Qe.allowNull(Qe.arrayOf(a)),baseFeePerGas:Qe.allowNull(i)},t.blockWithTransactions=Xr(t.block),t.blockWithTransactions.transactions=Qe.allowNull(Qe.arrayOf(this.transactionResponse.bind(this))),t.filter={fromBlock:Qe.allowNull(n,void 0),toBlock:Qe.allowNull(n,void 0),blockHash:Qe.allowNull(a,void 0),address:Qe.allowNull(r,void 0),topics:Qe.allowNull(this.topics.bind(this),void 0)},t.filterLog={blockNumber:Qe.allowNull(l),blockHash:Qe.allowNull(a),transactionIndex:l,removed:Qe.allowNull(this.boolean.bind(this)),address:r,data:Qe.allowFalsish(s,"0x"),topics:Qe.arrayOf(a),transactionHash:a,logIndex:l},t}accessList(t){return Ku(t||[])}number(t){return t==="0x"?0:Te.from(t).toNumber()}type(t){return t==="0x"||t==null?0:Te.from(t).toNumber()}bigNumber(t){return Te.from(t)}boolean(t){if(typeof t=="boolean")return t;if(typeof t=="string"){if(t=t.toLowerCase(),t==="true")return!0;if(t==="false")return!1}throw new Error("invalid boolean - "+t)}hex(t,r){return typeof t=="string"&&(!r&&t.substring(0,2)!=="0x"&&(t="0x"+t),jt(t))?t.toLowerCase():bc.throwArgumentError("invalid hash","value",t)}data(t,r){const i=this.hex(t,r);if(i.length%2!==0)throw new Error("invalid data; odd-length - "+t);return i}address(t){return si(t)}callAddress(t){if(!jt(t,32))return null;const r=si(di(t,12));return r===JK?null:r}contractAddress(t){return xP(t)}blockTag(t){if(t==null)return"latest";if(t==="earliest")return"0x0";if(t==="latest"||t==="pending")return t;if(typeof t=="number"||jt(t))return kb(t);throw new Error("invalid blockTag")}hash(t,r){const i=this.hex(t,r);return ql(i)!==32?bc.throwArgumentError("invalid hash","value",t):i}difficulty(t){if(t==null)return null;const r=Te.from(t);try{return r.toNumber()}catch{}return null}uint256(t){if(!jt(t))throw new Error("invalid uint256");return ar(t,32)}_block(t,r){t.author!=null&&t.miner==null&&(t.miner=t.author);const i=t._difficulty!=null?t._difficulty:t.difficulty,n=Qe.check(r,t);return n._difficulty=i==null?null:Te.from(i),n}block(t){return this._block(t,this.formats.block)}blockWithTransactions(t){return this._block(t,this.formats.blockWithTransactions)}transactionRequest(t){return Qe.check(this.formats.transactionRequest,t)}transactionResponse(t){t.gas!=null&&t.gasLimit==null&&(t.gasLimit=t.gas),t.to&&Te.from(t.to).isZero()&&(t.to="0x0000000000000000000000000000000000000000"),t.input!=null&&t.data==null&&(t.data=t.input),t.to==null&&t.creates==null&&(t.creates=this.contractAddress(t)),(t.type===1||t.type===2)&&t.accessList==null&&(t.accessList=[]);const r=Qe.check(this.formats.transaction,t);if(t.chainId!=null){let i=t.chainId;jt(i)&&(i=Te.from(i).toNumber()),r.chainId=i}else{let i=t.networkId;i==null&&r.v==null&&(i=t.chainId),jt(i)&&(i=Te.from(i).toNumber()),typeof i!="number"&&r.v!=null&&(i=(r.v-35)/2,i<0&&(i=0),i=parseInt(i)),typeof i!="number"&&(i=0),r.chainId=i}return r.blockHash&&r.blockHash.replace(/0/g,"")==="x"&&(r.blockHash=null),r}transaction(t){return Nee(t)}receiptLog(t){return Qe.check(this.formats.receiptLog,t)}receipt(t){const r=Qe.check(this.formats.receipt,t);if(r.root!=null)if(r.root.length<=4){const i=Te.from(r.root).toNumber();i===0||i===1?(r.status!=null&&r.status!==i&&bc.throwArgumentError("alt-root-status/status mismatch","value",{root:r.root,status:r.status}),r.status=i,delete r.root):bc.throwArgumentError("invalid alt-root-status","value.root",r.root)}else r.root.length!==66&&bc.throwArgumentError("invalid root hash","value.root",r.root);return r.status!=null&&(r.byzantium=!0),r}topics(t){return Array.isArray(t)?t.map(r=>this.topics(r)):t!=null?this.hash(t,!0):null}filter(t){return Qe.check(this.formats.filter,t)}filterLog(t){return Qe.check(this.formats.filterLog,t)}static check(t,r){const i={};for(const n in t)try{const s=t[n](r[n]);s!==void 0&&(i[n]=s)}catch(s){throw s.checkKey=n,s.checkValue=r[n],s}return i}static allowNull(t,r){return function(i){return i==null?r:t(i)}}static allowFalsish(t,r){return function(i){return i?t(i):r}}static arrayOf(t){return function(r){if(!Array.isArray(r))throw new Error("not an array");const i=[];return r.forEach(function(n){i.push(t(n))}),i}}}var gt=globalThis&&globalThis.__awaiter||function(e,t,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{h(i.next(u))}catch(c){a(c)}}function l(u){try{h(i.throw(u))}catch(c){a(c)}}function h(u){u.done?s(u.value):n(u.value).then(o,l)}h((i=i.apply(e,t||[])).next())})};const At=new ae(ig),ote=10;function JE(e){return e==null?"null":(ql(e)!==32&&At.throwArgumentError("invalid topic","topic",e),e.toLowerCase())}function KE(e){for(e=e.slice();e.length>0&&e[e.length-1]==null;)e.pop();return e.map(t=>{if(Array.isArray(t)){const r={};t.forEach(n=>{r[JE(n)]=!0});const i=Object.keys(r);return i.sort(),i.join("|")}else return JE(t)}).join("&")}function lte(e){return e===""?[]:e.split(/&/g).map(t=>{if(t==="")return[];const r=t.split("|").map(i=>i==="null"?null:i);return r.length===1?r[0]:r})}function Mh(e){if(typeof e=="string"){if(e=e.toLowerCase(),ql(e)===32)return"tx:"+e;if(e.indexOf(":")===-1)return e}else{if(Array.isArray(e))return"filter:*:"+KE(e);if(FZ.isForkEvent(e))throw At.warn("not implemented"),new Error("not implemented");if(e&&typeof e=="object")return"filter:"+(e.address||"*")+":"+KE(e.topics||[])}throw new Error("invalid event - "+e)}function _c(){return new Date().getTime()}function ZE(e){return new Promise(t=>{setTimeout(t,e)})}const hte=["block","network","pending","poll"];class ute{constructor(t,r,i){Ae(this,"tag",t),Ae(this,"listener",r),Ae(this,"once",i),this._lastBlockNumber=-2,this._inflight=!1}get event(){switch(this.type){case"tx":return this.hash;case"filter":return this.filter}return this.tag}get type(){return this.tag.split(":")[0]}get hash(){const t=this.tag.split(":");return t[0]!=="tx"?null:t[1]}get filter(){const t=this.tag.split(":");if(t[0]!=="filter")return null;const r=t[1],i=lte(t[2]),n={};return i.length>0&&(n.topics=i),r&&r!=="*"&&(n.address=r),n}pollable(){return this.tag.indexOf(":")>=0||hte.indexOf(this.tag)>=0}}const cte={0:{symbol:"btc",p2pkh:0,p2sh:5,prefix:"bc"},2:{symbol:"ltc",p2pkh:48,p2sh:50,prefix:"ltc"},3:{symbol:"doge",p2pkh:30,p2sh:22},60:{symbol:"eth",ilk:"eth"},61:{symbol:"etc",ilk:"eth"},700:{symbol:"xdai",ilk:"eth"}};function c1(e){return ar(Te.from(e).toHexString(),32)}function $E(e){return Px.encode(fn([e,di(VE(VE(e)),0,4)]))}const d4=new RegExp("^(ipfs)://(.*)$","i"),e3=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),d4,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];function t0(e,t){try{return lf(Hd(e,t))}catch{}return null}function Hd(e,t){if(e==="0x")return null;const r=Te.from(di(e,t,t+32)).toNumber(),i=Te.from(di(e,r,r+32)).toNumber();return di(e,r+32,r+32+i)}function d1(e){return e.match(/^ipfs:\/\/ipfs\//i)?e=e.substring(12):e.match(/^ipfs:\/\//i)?e=e.substring(7):At.throwArgumentError("unsupported IPFS format","link",e),`https://gateway.ipfs.io/ipfs/${e}`}function t3(e){const t=ct(e);if(t.length>32)throw new Error("internal; should not happen");const r=new Uint8Array(32);return r.set(t,32-t.length),r}function dte(e){if(e.length%32===0)return e;const t=new Uint8Array(Math.ceil(e.length/32)*32);return t.set(e),t}function f4(e){const t=[];let r=0;for(let i=0;i<e.length;i++)t.push(null),r+=32;for(let i=0;i<e.length;i++){const n=ct(e[i]);t[i]=t3(r),t.push(t3(n.length)),t.push(dte(n)),r+=32+Math.ceil(n.length/32)*32}return Xi(t)}class r3{constructor(t,r,i,n){Ae(this,"provider",t),Ae(this,"name",i),Ae(this,"address",t.formatter.address(r)),Ae(this,"_resolvedAddress",n)}supportsWildcard(){return this._supportsEip2544||(this._supportsEip2544=this.provider.call({to:this.address,data:"0x01ffc9a79061b92300000000000000000000000000000000000000000000000000000000"}).then(t=>Te.from(t).eq(1)).catch(t=>{if(t.code===ae.errors.CALL_EXCEPTION)return!1;throw this._supportsEip2544=null,t})),this._supportsEip2544}_fetch(t,r){return gt(this,void 0,void 0,function*(){const i={to:this.address,ccipReadEnabled:!0,data:Xi([t,Kp(this.name),r||"0x"])};let n=!1;(yield this.supportsWildcard())&&(n=!0,i.data=Xi(["0x9061b923",f4([MZ(this.name),i.data])]));try{let s=yield this.provider.call(i);return ct(s).length%32===4&&At.throwError("resolver threw error",ae.errors.CALL_EXCEPTION,{transaction:i,data:s}),n&&(s=Hd(s,0)),s}catch(s){if(s.code===ae.errors.CALL_EXCEPTION)return null;throw s}})}_fetchBytes(t,r){return gt(this,void 0,void 0,function*(){const i=yield this._fetch(t,r);return i!=null?Hd(i,0):null})}_getAddress(t,r){const i=cte[String(t)];if(i==null&&At.throwError(`unsupported coin type: ${t}`,ae.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${t})`}),i.ilk==="eth")return this.provider.formatter.address(r);const n=ct(r);if(i.p2pkh!=null){const s=r.match(/^0x76a9([0-9a-f][0-9a-f])([0-9a-f]*)88ac$/);if(s){const a=parseInt(s[1],16);if(s[2].length===a*2&&a>=1&&a<=75)return $E(fn([[i.p2pkh],"0x"+s[2]]))}}if(i.p2sh!=null){const s=r.match(/^0xa9([0-9a-f][0-9a-f])([0-9a-f]*)87$/);if(s){const a=parseInt(s[1],16);if(s[2].length===a*2&&a>=1&&a<=75)return $E(fn([[i.p2sh],"0x"+s[2]]))}}if(i.prefix!=null){const s=n[1];let a=n[0];if(a===0?s!==20&&s!==32&&(a=-1):a=-1,a>=0&&n.length===2+s&&s>=1&&s<=75){const o=QE.toWords(n.slice(2));return o.unshift(a),QE.encode(i.prefix,o)}}return null}getAddress(t){return gt(this,void 0,void 0,function*(){if(t==null&&(t=60),t===60)try{const n=yield this._fetch("0x3b3b57de");return n==="0x"||n===eZ?null:this.provider.formatter.callAddress(n)}catch(n){if(n.code===ae.errors.CALL_EXCEPTION)return null;throw n}const r=yield this._fetchBytes("0xf1cb7e06",c1(t));if(r==null||r==="0x")return null;const i=this._getAddress(t,r);return i==null&&At.throwError("invalid or unsupported coin data",ae.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${t})`,coinType:t,data:r}),i})}getAvatar(){return gt(this,void 0,void 0,function*(){const t=[{type:"name",content:this.name}];try{const r=yield this.getText("avatar");if(r==null)return null;for(let i=0;i<e3.length;i++){const n=r.match(e3[i]);if(n==null)continue;const s=n[1].toLowerCase();switch(s){case"https":return t.push({type:"url",content:r}),{linkage:t,url:r};case"data":return t.push({type:"data",content:r}),{linkage:t,url:r};case"ipfs":return t.push({type:"ipfs",content:r}),{linkage:t,url:d1(r)};case"erc721":case"erc1155":{const a=s==="erc721"?"0xc87b56dd":"0x0e89341c";t.push({type:s,content:r});const o=this._resolvedAddress||(yield this.getAddress()),l=(n[2]||"").split("/");if(l.length!==2)return null;const h=yield this.provider.formatter.address(l[0]),u=ar(Te.from(l[1]).toHexString(),32);if(s==="erc721"){const m=this.provider.formatter.callAddress(yield this.provider.call({to:h,data:Xi(["0x6352211e",u])}));if(o!==m)return null;t.push({type:"owner",content:m})}else if(s==="erc1155"){const m=Te.from(yield this.provider.call({to:h,data:Xi(["0x00fdd58e",ar(o,32),u])}));if(m.isZero())return null;t.push({type:"balance",content:m.toString()})}const c={to:this.provider.formatter.address(l[0]),data:Xi([a,u])};let d=t0(yield this.provider.call(c),0);if(d==null)return null;t.push({type:"metadata-url-base",content:d}),s==="erc1155"&&(d=d.replace("{id}",u.substring(2)),t.push({type:"metadata-url-expanded",content:d})),d.match(/^ipfs:/i)&&(d=d1(d)),t.push({type:"metadata-url",content:d});const f=yield Qb(d);if(!f)return null;t.push({type:"metadata",content:JSON.stringify(f)});let p=f.image;if(typeof p!="string")return null;if(!p.match(/^(https:\/\/|data:)/i)){if(p.match(d4)==null)return null;t.push({type:"url-ipfs",content:p}),p=d1(p)}return t.push({type:"url",content:p}),{linkage:t,url:p}}}}}catch{}return null})}getContentHash(){return gt(this,void 0,void 0,function*(){const t=yield this._fetchBytes("0xbc1c58d1");if(t==null||t==="0x")return null;const r=t.match(/^0xe3010170(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(r){const a=parseInt(r[3],16);if(r[4].length===a*2)return"ipfs://"+Px.encode("0x"+r[1])}const i=t.match(/^0xe5010172(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(i){const a=parseInt(i[3],16);if(i[4].length===a*2)return"ipns://"+Px.encode("0x"+i[1])}const n=t.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(n&&n[1].length===32*2)return"bzz://"+n[1];const s=t.match(/^0x90b2c605([0-9a-f]*)$/);if(s&&s[1].length===34*2){const a={"=":"","+":"-","/":"_"},o=h4("0x"+s[1]).replace(/[=+\/]/g,l=>a[l]);return"sia://"+o}return At.throwError("invalid or unsupported content hash data",ae.errors.UNSUPPORTED_OPERATION,{operation:"getContentHash()",data:t})})}getText(t){return gt(this,void 0,void 0,function*(){let r=ca(t);r=fn([c1(64),c1(r.length),r]),r.length%32!==0&&(r=fn([r,ar("0x",32-t.length%32)]));const i=yield this._fetchBytes("0x59d1d43c",tt(r));return i==null||i==="0x"?null:lf(i)})}}let f1=null,fte=1;class pte extends Km{constructor(t){if(super(),this._events=[],this._emitted={block:-2},this.disableCcipRead=!1,this.formatter=new.target.getFormatter(),Ae(this,"anyNetwork",t==="any"),this.anyNetwork&&(t=this.detectNetwork()),t instanceof Promise)this._networkPromise=t,t.catch(r=>{}),this._ready().catch(r=>{});else{const r=Ks(new.target,"getNetwork")(t);r?(Ae(this,"_network",r),this.emit("network",r,null)):At.throwArgumentError("invalid network","network",t)}this._maxInternalBlockNumber=-1024,this._lastBlockNumber=-2,this._maxFilterBlockRange=10,this._pollingInterval=4e3,this._fastQueryDate=0}_ready(){return gt(this,void 0,void 0,function*(){if(this._network==null){let t=null;if(this._networkPromise)try{t=yield this._networkPromise}catch{}t==null&&(t=yield this.detectNetwork()),t||At.throwError("no network detected",ae.errors.UNKNOWN_ERROR,{}),this._network==null&&(this.anyNetwork?this._network=t:Ae(this,"_network",t),this.emit("network",t,null))}return this._network})}get ready(){return kc(()=>this._ready().then(t=>t,t=>{if(!(t.code===ae.errors.NETWORK_ERROR&&t.event==="noNetwork"))throw t}))}static getFormatter(){return f1==null&&(f1=new Qe),f1}static getNetwork(t){return Yee(t==null?"homestead":t)}ccipReadFetch(t,r,i){return gt(this,void 0,void 0,function*(){if(this.disableCcipRead||i.length===0)return null;const n=t.to.toLowerCase(),s=r.toLowerCase(),a=[];for(let o=0;o<i.length;o++){const l=i[o],h=l.replace("{sender}",n).replace("{data}",s),u=l.indexOf("{data}")>=0?null:JSON.stringify({data:s,sender:n}),c=yield Qb({url:h,errorPassThrough:!0},u,(f,p)=>(f.status=p.statusCode,f));if(c.data)return c.data;const d=c.message||"unknown error";if(c.status>=400&&c.status<500)return At.throwError(`response not found during CCIP fetch: ${d}`,ae.errors.SERVER_ERROR,{url:l,errorMessage:d});a.push(d)}return At.throwError(`error encountered during CCIP fetch: ${a.map(o=>JSON.stringify(o)).join(", ")}`,ae.errors.SERVER_ERROR,{urls:i,errorMessages:a})})}_getInternalBlockNumber(t){return gt(this,void 0,void 0,function*(){if(yield this._ready(),t>0)for(;this._internalBlockNumber;){const n=this._internalBlockNumber;try{const s=yield n;if(_c()-s.respTime<=t)return s.blockNumber;break}catch{if(this._internalBlockNumber===n)break}}const r=_c(),i=Tr({blockNumber:this.perform("getBlockNumber",{}),networkError:this.getNetwork().then(n=>null,n=>n)}).then(({blockNumber:n,networkError:s})=>{if(s)throw this._internalBlockNumber===i&&(this._internalBlockNumber=null),s;const a=_c();return n=Te.from(n).toNumber(),n<this._maxInternalBlockNumber&&(n=this._maxInternalBlockNumber),this._maxInternalBlockNumber=n,this._setFastBlockNumber(n),{blockNumber:n,reqTime:r,respTime:a}});return this._internalBlockNumber=i,i.catch(n=>{this._internalBlockNumber===i&&(this._internalBlockNumber=null)}),(yield i).blockNumber})}poll(){return gt(this,void 0,void 0,function*(){const t=fte++,r=[];let i=null;try{i=yield this._getInternalBlockNumber(100+this.pollingInterval/2)}catch(n){this.emit("error",n);return}if(this._setFastBlockNumber(i),this.emit("poll",t,i),i===this._lastBlockNumber){this.emit("didPoll",t);return}if(this._emitted.block===-2&&(this._emitted.block=i-1),Math.abs(this._emitted.block-i)>1e3)At.warn(`network block skew detected; skipping block events (emitted=${this._emitted.block} blockNumber${i})`),this.emit("error",At.makeError("network block skew detected",ae.errors.NETWORK_ERROR,{blockNumber:i,event:"blockSkew",previousBlockNumber:this._emitted.block})),this.emit("block",i);else for(let n=this._emitted.block+1;n<=i;n++)this.emit("block",n);this._emitted.block!==i&&(this._emitted.block=i,Object.keys(this._emitted).forEach(n=>{if(n==="block")return;const s=this._emitted[n];s!=="pending"&&i-s>12&&delete this._emitted[n]})),this._lastBlockNumber===-2&&(this._lastBlockNumber=i-1),this._events.forEach(n=>{switch(n.type){case"tx":{const s=n.hash;let a=this.getTransactionReceipt(s).then(o=>(!o||o.blockNumber==null||(this._emitted["t:"+s]=o.blockNumber,this.emit(s,o)),null)).catch(o=>{this.emit("error",o)});r.push(a);break}case"filter":{if(!n._inflight){n._inflight=!0;const s=n.filter;s.fromBlock=n._lastBlockNumber+1,s.toBlock=i,s.toBlock-this._maxFilterBlockRange>s.fromBlock&&(s.fromBlock=s.toBlock-this._maxFilterBlockRange);const a=this.getLogs(s).then(o=>{n._inflight=!1,o.length!==0&&o.forEach(l=>{l.blockNumber>n._lastBlockNumber&&(n._lastBlockNumber=l.blockNumber),this._emitted["b:"+l.blockHash]=l.blockNumber,this._emitted["t:"+l.transactionHash]=l.blockNumber,this.emit(s,l)})}).catch(o=>{this.emit("error",o),n._inflight=!1});r.push(a)}break}}}),this._lastBlockNumber=i,Promise.all(r).then(()=>{this.emit("didPoll",t)}).catch(n=>{this.emit("error",n)})})}resetEventsBlock(t){this._lastBlockNumber=t-1,this.polling&&this.poll()}get network(){return this._network}detectNetwork(){return gt(this,void 0,void 0,function*(){return At.throwError("provider does not support network detection",ae.errors.UNSUPPORTED_OPERATION,{operation:"provider.detectNetwork"})})}getNetwork(){return gt(this,void 0,void 0,function*(){const t=yield this._ready(),r=yield this.detectNetwork();if(t.chainId!==r.chainId){if(this.anyNetwork)return this._network=r,this._lastBlockNumber=-2,this._fastBlockNumber=null,this._fastBlockNumberPromise=null,this._fastQueryDate=0,this._emitted.block=-2,this._maxInternalBlockNumber=-1024,this._internalBlockNumber=null,this.emit("network",r,t),yield ZE(0),this._network;const i=At.makeError("underlying network changed",ae.errors.NETWORK_ERROR,{event:"changed",network:t,detectedNetwork:r});throw this.emit("error",i),i}return t})}get blockNumber(){return this._getInternalBlockNumber(100+this.pollingInterval/2).then(t=>{this._setFastBlockNumber(t)},t=>{}),this._fastBlockNumber!=null?this._fastBlockNumber:-1}get polling(){return this._poller!=null}set polling(t){t&&!this._poller?(this._poller=setInterval(()=>{this.poll()},this.pollingInterval),this._bootstrapPoll||(this._bootstrapPoll=setTimeout(()=>{this.poll(),this._bootstrapPoll=setTimeout(()=>{this._poller||this.poll(),this._bootstrapPoll=null},this.pollingInterval)},0))):!t&&this._poller&&(clearInterval(this._poller),this._poller=null)}get pollingInterval(){return this._pollingInterval}set pollingInterval(t){if(typeof t!="number"||t<=0||parseInt(String(t))!=t)throw new Error("invalid polling interval");this._pollingInterval=t,this._poller&&(clearInterval(this._poller),this._poller=setInterval(()=>{this.poll()},this._pollingInterval))}_getFastBlockNumber(){const t=_c();return t-this._fastQueryDate>2*this._pollingInterval&&(this._fastQueryDate=t,this._fastBlockNumberPromise=this.getBlockNumber().then(r=>((this._fastBlockNumber==null||r>this._fastBlockNumber)&&(this._fastBlockNumber=r),this._fastBlockNumber))),this._fastBlockNumberPromise}_setFastBlockNumber(t){this._fastBlockNumber!=null&&t<this._fastBlockNumber||(this._fastQueryDate=_c(),(this._fastBlockNumber==null||t>this._fastBlockNumber)&&(this._fastBlockNumber=t,this._fastBlockNumberPromise=Promise.resolve(t)))}waitForTransaction(t,r,i){return gt(this,void 0,void 0,function*(){return this._waitForTransaction(t,r==null?1:r,i||0,null)})}_waitForTransaction(t,r,i,n){return gt(this,void 0,void 0,function*(){const s=yield this.getTransactionReceipt(t);return(s?s.confirmations:0)>=r?s:new Promise((a,o)=>{const l=[];let h=!1;const u=function(){return h?!0:(h=!0,l.forEach(d=>{d()}),!1)},c=d=>{d.confirmations<r||u()||a(d)};if(this.on(t,c),l.push(()=>{this.removeListener(t,c)}),n){let d=n.startBlock,f=null;const p=m=>gt(this,void 0,void 0,function*(){h||(yield ZE(1e3),this.getTransactionCount(n.from).then(g=>gt(this,void 0,void 0,function*(){if(!h){if(g<=n.nonce)d=m;else{{const v=yield this.getTransaction(t);if(v&&v.blockNumber!=null)return}for(f==null&&(f=d-3,f<n.startBlock&&(f=n.startBlock));f<=m;){if(h)return;const v=yield this.getBlockWithTransactions(f);for(let x=0;x<v.transactions.length;x++){const b=v.transactions[x];if(b.hash===t)return;if(b.from===n.from&&b.nonce===n.nonce){if(h)return;const _=yield this.waitForTransaction(b.hash,r);if(u())return;let E="replaced";b.data===n.data&&b.to===n.to&&b.value.eq(n.value)?E="repriced":b.data==="0x"&&b.from===b.to&&b.value.isZero()&&(E="cancelled"),o(At.makeError("transaction was replaced",ae.errors.TRANSACTION_REPLACED,{cancelled:E==="replaced"||E==="cancelled",reason:E,replacement:this._wrapTransaction(b),hash:t,receipt:_}));return}}f++}}h||this.once("block",p)}}),g=>{h||this.once("block",p)}))});if(h)return;this.once("block",p),l.push(()=>{this.removeListener("block",p)})}if(typeof i=="number"&&i>0){const d=setTimeout(()=>{u()||o(At.makeError("timeout exceeded",ae.errors.TIMEOUT,{timeout:i}))},i);d.unref&&d.unref(),l.push(()=>{clearTimeout(d)})}})})}getBlockNumber(){return gt(this,void 0,void 0,function*(){return this._getInternalBlockNumber(0)})}getGasPrice(){return gt(this,void 0,void 0,function*(){yield this.getNetwork();const t=yield this.perform("getGasPrice",{});try{return Te.from(t)}catch(r){return At.throwError("bad result from backend",ae.errors.SERVER_ERROR,{method:"getGasPrice",result:t,error:r})}})}getBalance(t,r){return gt(this,void 0,void 0,function*(){yield this.getNetwork();const i=yield Tr({address:this._getAddress(t),blockTag:this._getBlockTag(r)}),n=yield this.perform("getBalance",i);try{return Te.from(n)}catch(s){return At.throwError("bad result from backend",ae.errors.SERVER_ERROR,{method:"getBalance",params:i,result:n,error:s})}})}getTransactionCount(t,r){return gt(this,void 0,void 0,function*(){yield this.getNetwork();const i=yield Tr({address:this._getAddress(t),blockTag:this._getBlockTag(r)}),n=yield this.perform("getTransactionCount",i);try{return Te.from(n).toNumber()}catch(s){return At.throwError("bad result from backend",ae.errors.SERVER_ERROR,{method:"getTransactionCount",params:i,result:n,error:s})}})}getCode(t,r){return gt(this,void 0,void 0,function*(){yield this.getNetwork();const i=yield Tr({address:this._getAddress(t),blockTag:this._getBlockTag(r)}),n=yield this.perform("getCode",i);try{return tt(n)}catch(s){return At.throwError("bad result from backend",ae.errors.SERVER_ERROR,{method:"getCode",params:i,result:n,error:s})}})}getStorageAt(t,r,i){return gt(this,void 0,void 0,function*(){yield this.getNetwork();const n=yield Tr({address:this._getAddress(t),blockTag:this._getBlockTag(i),position:Promise.resolve(r).then(a=>kb(a))}),s=yield this.perform("getStorageAt",n);try{return tt(s)}catch(a){return At.throwError("bad result from backend",ae.errors.SERVER_ERROR,{method:"getStorageAt",params:n,result:s,error:a})}})}_wrapTransaction(t,r,i){if(r!=null&&ql(r)!==32)throw new Error("invalid response - sendTransaction");const n=t;return r!=null&&t.hash!==r&&At.throwError("Transaction hash mismatch from Provider.sendTransaction.",ae.errors.UNKNOWN_ERROR,{expectedHash:t.hash,returnedHash:r}),n.wait=(s,a)=>gt(this,void 0,void 0,function*(){s==null&&(s=1),a==null&&(a=0);let o;s!==0&&i!=null&&(o={data:t.data,from:t.from,nonce:t.nonce,to:t.to,value:t.value,startBlock:i});const l=yield this._waitForTransaction(t.hash,s,a,o);return l==null&&s===0?null:(this._emitted["t:"+t.hash]=l.blockNumber,l.status===0&&At.throwError("transaction failed",ae.errors.CALL_EXCEPTION,{transactionHash:t.hash,transaction:t,receipt:l}),l)}),n}sendTransaction(t){return gt(this,void 0,void 0,function*(){yield this.getNetwork();const r=yield Promise.resolve(t).then(s=>tt(s)),i=this.formatter.transaction(t);i.confirmations==null&&(i.confirmations=0);const n=yield this._getInternalBlockNumber(100+2*this.pollingInterval);try{const s=yield this.perform("sendTransaction",{signedTransaction:r});return this._wrapTransaction(i,s,n)}catch(s){throw s.transaction=i,s.transactionHash=i.hash,s}})}_getTransactionRequest(t){return gt(this,void 0,void 0,function*(){const r=yield t,i={};return["from","to"].forEach(n=>{r[n]!=null&&(i[n]=Promise.resolve(r[n]).then(s=>s?this._getAddress(s):null))}),["gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","value"].forEach(n=>{r[n]!=null&&(i[n]=Promise.resolve(r[n]).then(s=>s?Te.from(s):null))}),["type"].forEach(n=>{r[n]!=null&&(i[n]=Promise.resolve(r[n]).then(s=>s!=null?s:null))}),r.accessList&&(i.accessList=this.formatter.accessList(r.accessList)),["data"].forEach(n=>{r[n]!=null&&(i[n]=Promise.resolve(r[n]).then(s=>s?tt(s):null))}),this.formatter.transactionRequest(yield Tr(i))})}_getFilter(t){return gt(this,void 0,void 0,function*(){t=yield t;const r={};return t.address!=null&&(r.address=this._getAddress(t.address)),["blockHash","topics"].forEach(i=>{t[i]!=null&&(r[i]=t[i])}),["fromBlock","toBlock"].forEach(i=>{t[i]!=null&&(r[i]=this._getBlockTag(t[i]))}),this.formatter.filter(yield Tr(r))})}_call(t,r,i){return gt(this,void 0,void 0,function*(){i>=ote&&At.throwError("CCIP read exceeded maximum redirections",ae.errors.SERVER_ERROR,{redirects:i,transaction:t});const n=t.to,s=yield this.perform("call",{transaction:t,blockTag:r});if(i>=0&&r==="latest"&&n!=null&&s.substring(0,10)==="0x556f1830"&&ql(s)%32===4)try{const a=di(s,4),o=di(a,0,32);Te.from(o).eq(n)||At.throwError("CCIP Read sender did not match",ae.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:s});const l=[],h=Te.from(di(a,32,64)).toNumber(),u=Te.from(di(a,h,h+32)).toNumber(),c=di(a,h+32);for(let v=0;v<u;v++){const x=t0(c,v*32);x==null&&At.throwError("CCIP Read contained corrupt URL string",ae.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:s}),l.push(x)}const d=Hd(a,64);Te.from(di(a,100,128)).isZero()||At.throwError("CCIP Read callback selector included junk",ae.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:s});const f=di(a,96,100),p=Hd(a,128),m=yield this.ccipReadFetch(t,d,l);m==null&&At.throwError("CCIP Read disabled or provided no URLs",ae.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:s});const g={to:n,data:Xi([f,f4([m,p])])};return this._call(g,r,i+1)}catch(a){if(a.code===ae.errors.SERVER_ERROR)throw a}try{return tt(s)}catch(a){return At.throwError("bad result from backend",ae.errors.SERVER_ERROR,{method:"call",params:{transaction:t,blockTag:r},result:s,error:a})}})}call(t,r){return gt(this,void 0,void 0,function*(){yield this.getNetwork();const i=yield Tr({transaction:this._getTransactionRequest(t),blockTag:this._getBlockTag(r),ccipReadEnabled:Promise.resolve(t.ccipReadEnabled)});return this._call(i.transaction,i.blockTag,i.ccipReadEnabled?0:-1)})}estimateGas(t){return gt(this,void 0,void 0,function*(){yield this.getNetwork();const r=yield Tr({transaction:this._getTransactionRequest(t)}),i=yield this.perform("estimateGas",r);try{return Te.from(i)}catch(n){return At.throwError("bad result from backend",ae.errors.SERVER_ERROR,{method:"estimateGas",params:r,result:i,error:n})}})}_getAddress(t){return gt(this,void 0,void 0,function*(){t=yield t,typeof t!="string"&&At.throwArgumentError("invalid address or ENS name","name",t);const r=yield this.resolveName(t);return r==null&&At.throwError("ENS name not configured",ae.errors.UNSUPPORTED_OPERATION,{operation:`resolveName(${JSON.stringify(t)})`}),r})}_getBlock(t,r){return gt(this,void 0,void 0,function*(){yield this.getNetwork(),t=yield t;let i=-128;const n={includeTransactions:!!r};if(jt(t,32))n.blockHash=t;else try{n.blockTag=yield this._getBlockTag(t),jt(n.blockTag)&&(i=parseInt(n.blockTag.substring(2),16))}catch{At.throwArgumentError("invalid block hash or block tag","blockHashOrBlockTag",t)}return kc(()=>gt(this,void 0,void 0,function*(){const s=yield this.perform("getBlock",n);if(s==null)return n.blockHash!=null&&this._emitted["b:"+n.blockHash]==null||n.blockTag!=null&&i>this._emitted.block?null:void 0;if(r){let a=null;for(let l=0;l<s.transactions.length;l++){const h=s.transactions[l];if(h.blockNumber==null)h.confirmations=0;else if(h.confirmations==null){a==null&&(a=yield this._getInternalBlockNumber(100+2*this.pollingInterval));let u=a-h.blockNumber+1;u<=0&&(u=1),h.confirmations=u}}const o=this.formatter.blockWithTransactions(s);return o.transactions=o.transactions.map(l=>this._wrapTransaction(l)),o}return this.formatter.block(s)}),{oncePoll:this})})}getBlock(t){return this._getBlock(t,!1)}getBlockWithTransactions(t){return this._getBlock(t,!0)}getTransaction(t){return gt(this,void 0,void 0,function*(){yield this.getNetwork(),t=yield t;const r={transactionHash:this.formatter.hash(t,!0)};return kc(()=>gt(this,void 0,void 0,function*(){const i=yield this.perform("getTransaction",r);if(i==null)return this._emitted["t:"+t]==null?null:void 0;const n=this.formatter.transactionResponse(i);if(n.blockNumber==null)n.confirmations=0;else if(n.confirmations==null){let a=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-n.blockNumber+1;a<=0&&(a=1),n.confirmations=a}return this._wrapTransaction(n)}),{oncePoll:this})})}getTransactionReceipt(t){return gt(this,void 0,void 0,function*(){yield this.getNetwork(),t=yield t;const r={transactionHash:this.formatter.hash(t,!0)};return kc(()=>gt(this,void 0,void 0,function*(){const i=yield this.perform("getTransactionReceipt",r);if(i==null)return this._emitted["t:"+t]==null?null:void 0;if(i.blockHash==null)return;const n=this.formatter.receipt(i);if(n.blockNumber==null)n.confirmations=0;else if(n.confirmations==null){let a=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-n.blockNumber+1;a<=0&&(a=1),n.confirmations=a}return n}),{oncePoll:this})})}getLogs(t){return gt(this,void 0,void 0,function*(){yield this.getNetwork();const r=yield Tr({filter:this._getFilter(t)}),i=yield this.perform("getLogs",r);return i.forEach(n=>{n.removed==null&&(n.removed=!1)}),Qe.arrayOf(this.formatter.filterLog.bind(this.formatter))(i)})}getEtherPrice(){return gt(this,void 0,void 0,function*(){return yield this.getNetwork(),this.perform("getEtherPrice",{})})}_getBlockTag(t){return gt(this,void 0,void 0,function*(){if(t=yield t,typeof t=="number"&&t<0){t%1&&At.throwArgumentError("invalid BlockTag","blockTag",t);let r=yield this._getInternalBlockNumber(100+2*this.pollingInterval);return r+=t,r<0&&(r=0),this.formatter.blockTag(r)}return this.formatter.blockTag(t)})}getResolver(t){return gt(this,void 0,void 0,function*(){let r=t;for(;;){if(r===""||r==="."||t!=="eth"&&r==="eth")return null;const i=yield this._getResolver(r,"getResolver");if(i!=null){const n=new r3(this,i,t);return r!==t&&!(yield n.supportsWildcard())?null:n}r=r.split(".").slice(1).join(".")}})}_getResolver(t,r){return gt(this,void 0,void 0,function*(){r==null&&(r="ENS");const i=yield this.getNetwork();i.ensAddress||At.throwError("network does not support ENS",ae.errors.UNSUPPORTED_OPERATION,{operation:r,network:i.name});try{const n=yield this.call({to:i.ensAddress,data:"0x0178b8bf"+Kp(t).substring(2)});return this.formatter.callAddress(n)}catch{}return null})}resolveName(t){return gt(this,void 0,void 0,function*(){t=yield t;try{return Promise.resolve(this.formatter.address(t))}catch(i){if(jt(t))throw i}typeof t!="string"&&At.throwArgumentError("invalid ENS name","name",t);const r=yield this.getResolver(t);return r?yield r.getAddress():null})}lookupAddress(t){return gt(this,void 0,void 0,function*(){t=yield t,t=this.formatter.address(t);const r=t.substring(2).toLowerCase()+".addr.reverse",i=yield this._getResolver(r,"lookupAddress");if(i==null)return null;const n=t0(yield this.call({to:i,data:"0x691f3431"+Kp(r).substring(2)}),0);return(yield this.resolveName(n))!=t?null:n})}getAvatar(t){return gt(this,void 0,void 0,function*(){let r=null;if(jt(t)){const s=this.formatter.address(t).substring(2).toLowerCase()+".addr.reverse",a=yield this._getResolver(s,"getAvatar");if(!a)return null;r=new r3(this,a,s);try{const o=yield r.getAvatar();if(o)return o.url}catch(o){if(o.code!==ae.errors.CALL_EXCEPTION)throw o}try{const o=t0(yield this.call({to:a,data:"0x691f3431"+Kp(s).substring(2)}),0);r=yield this.getResolver(o)}catch(o){if(o.code!==ae.errors.CALL_EXCEPTION)throw o;return null}}else if(r=yield this.getResolver(t),!r)return null;const i=yield r.getAvatar();return i==null?null:i.url})}perform(t,r){return At.throwError(t+" not implemented",ae.errors.NOT_IMPLEMENTED,{operation:t})}_startEvent(t){this.polling=this._events.filter(r=>r.pollable()).length>0}_stopEvent(t){this.polling=this._events.filter(r=>r.pollable()).length>0}_addEventListener(t,r,i){const n=new ute(Mh(t),r,i);return this._events.push(n),this._startEvent(n),this}on(t,r){return this._addEventListener(t,r,!1)}once(t,r){return this._addEventListener(t,r,!0)}emit(t,...r){let i=!1,n=[],s=Mh(t);return this._events=this._events.filter(a=>a.tag!==s?!0:(setTimeout(()=>{a.listener.apply(this,r)},0),i=!0,a.once?(n.push(a),!1):!0)),n.forEach(a=>{this._stopEvent(a)}),i}listenerCount(t){if(!t)return this._events.length;let r=Mh(t);return this._events.filter(i=>i.tag===r).length}listeners(t){if(t==null)return this._events.map(i=>i.listener);let r=Mh(t);return this._events.filter(i=>i.tag===r).map(i=>i.listener)}off(t,r){if(r==null)return this.removeAllListeners(t);const i=[];let n=!1,s=Mh(t);return this._events=this._events.filter(a=>a.tag!==s||a.listener!=r||n?!0:(n=!0,i.push(a),!1)),i.forEach(a=>{this._stopEvent(a)}),this}removeAllListeners(t){let r=[];if(t==null)r=this._events,this._events=[];else{const i=Mh(t);this._events=this._events.filter(n=>n.tag!==i?!0:(r.push(n),!1))}return r.forEach(i=>{this._stopEvent(i)}),this}}var Oa=globalThis&&globalThis.__awaiter||function(e,t,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function o(u){try{h(i.next(u))}catch(c){a(c)}}function l(u){try{h(i.throw(u))}catch(c){a(c)}}function h(u){u.done?s(u.value):n(u.value).then(o,l)}h((i=i.apply(e,t||[])).next())})};const fi=new ae(ig),mte=["call","estimateGas"];function ad(e,t){if(e==null)return null;if(typeof e.message=="string"&&e.message.match("reverted")){const r=jt(e.data)?e.data:null;if(!t||r)return{message:e.message,data:r}}if(typeof e=="object"){for(const r in e){const i=ad(e[r],t);if(i)return i}return null}if(typeof e=="string")try{return ad(JSON.parse(e),t)}catch{}return null}function p4(e,t,r){const i=r.transaction||r.signedTransaction;if(e==="call"){const s=ad(t,!0);if(s)return s.data;fi.throwError("missing revert data in call exception; Transaction reverted without a reason string",ae.errors.CALL_EXCEPTION,{data:"0x",transaction:i,error:t})}if(e==="estimateGas"){let s=ad(t.body,!1);s==null&&(s=ad(t,!1)),s&&fi.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",ae.errors.UNPREDICTABLE_GAS_LIMIT,{reason:s.message,method:e,transaction:i,error:t})}let n=t.message;throw t.code===ae.errors.SERVER_ERROR&&t.error&&typeof t.error.message=="string"?n=t.error.message:typeof t.body=="string"?n=t.body:typeof t.responseText=="string"&&(n=t.responseText),n=(n||"").toLowerCase(),n.match(/insufficient funds|base fee exceeds gas limit/i)&&fi.throwError("insufficient funds for intrinsic transaction cost",ae.errors.INSUFFICIENT_FUNDS,{error:t,method:e,transaction:i}),n.match(/nonce (is )?too low/i)&&fi.throwError("nonce has already been used",ae.errors.NONCE_EXPIRED,{error:t,method:e,transaction:i}),n.match(/replacement transaction underpriced|transaction gas price.*too low/i)&&fi.throwError("replacement fee too low",ae.errors.REPLACEMENT_UNDERPRICED,{error:t,method:e,transaction:i}),n.match(/only replay-protected/i)&&fi.throwError("legacy pre-eip-155 transactions not supported",ae.errors.UNSUPPORTED_OPERATION,{error:t,method:e,transaction:i}),mte.indexOf(e)>=0&&n.match(/gas required exceeds allowance|always failing transaction|execution reverted/)&&fi.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",ae.errors.UNPREDICTABLE_GAS_LIMIT,{error:t,method:e,transaction:i}),t}function i3(e){return new Promise(function(t){setTimeout(t,e)})}function gte(e){if(e.error){const t=new Error(e.error.message);throw t.code=e.error.code,t.data=e.error.data,t}return e.result}function Sc(e){return e&&e.toLowerCase()}const Rx={};class m4 extends hf{constructor(t,r,i){if(super(),t!==Rx)throw new Error("do not call the JsonRpcSigner constructor directly; use provider.getSigner");Ae(this,"provider",r),i==null&&(i=0),typeof i=="string"?(Ae(this,"_address",this.provider.formatter.address(i)),Ae(this,"_index",null)):typeof i=="number"?(Ae(this,"_index",i),Ae(this,"_address",null)):fi.throwArgumentError("invalid address or index","addressOrIndex",i)}connect(t){return fi.throwError("cannot alter JSON-RPC Signer connection",ae.errors.UNSUPPORTED_OPERATION,{operation:"connect"})}connectUnchecked(){return new vte(Rx,this.provider,this._address||this._index)}getAddress(){return this._address?Promise.resolve(this._address):this.provider.send("eth_accounts",[]).then(t=>(t.length<=this._index&&fi.throwError("unknown account #"+this._index,ae.errors.UNSUPPORTED_OPERATION,{operation:"getAddress"}),this.provider.formatter.address(t[this._index])))}sendUncheckedTransaction(t){t=Xr(t);const r=this.getAddress().then(i=>(i&&(i=i.toLowerCase()),i));if(t.gasLimit==null){const i=Xr(t);i.from=r,t.gasLimit=this.provider.estimateGas(i)}return t.to!=null&&(t.to=Promise.resolve(t.to).then(i=>Oa(this,void 0,void 0,function*(){if(i==null)return null;const n=yield this.provider.resolveName(i);return n==null&&fi.throwArgumentError("provided ENS name resolves to null","tx.to",i),n}))),Tr({tx:Tr(t),sender:r}).then(({tx:i,sender:n})=>{i.from!=null?i.from.toLowerCase()!==n&&fi.throwArgumentError("from address mismatch","transaction",t):i.from=n;const s=this.provider.constructor.hexlifyTransaction(i,{from:!0});return this.provider.send("eth_sendTransaction",[s]).then(a=>a,a=>p4("sendTransaction",a,s))})}signTransaction(t){return fi.throwError("signing transactions is unsupported",ae.errors.UNSUPPORTED_OPERATION,{operation:"signTransaction"})}sendTransaction(t){return Oa(this,void 0,void 0,function*(){const r=yield this.provider._getInternalBlockNumber(100+2*this.provider.pollingInterval),i=yield this.sendUncheckedTransaction(t);try{return yield kc(()=>Oa(this,void 0,void 0,function*(){const n=yield this.provider.getTransaction(i);if(n!==null)return this.provider._wrapTransaction(n,i,r)}),{oncePoll:this.provider})}catch(n){throw n.transactionHash=i,n}})}signMessage(t){return Oa(this,void 0,void 0,function*(){const r=typeof t=="string"?ca(t):t,i=yield this.getAddress();return yield this.provider.send("personal_sign",[tt(r),i.toLowerCase()])})}_legacySignMessage(t){return Oa(this,void 0,void 0,function*(){const r=typeof t=="string"?ca(t):t,i=yield this.getAddress();return yield this.provider.send("eth_sign",[i.toLowerCase(),tt(r)])})}_signTypedData(t,r,i){return Oa(this,void 0,void 0,function*(){const n=yield on.resolveNames(t,r,i,a=>this.provider.resolveName(a)),s=yield this.getAddress();return yield this.provider.send("eth_signTypedData_v4",[s.toLowerCase(),JSON.stringify(on.getPayload(n.domain,r,n.value))])})}unlock(t){return Oa(this,void 0,void 0,function*(){const r=this.provider,i=yield this.getAddress();return r.send("personal_unlockAccount",[i.toLowerCase(),t,null])})}}class vte extends m4{sendTransaction(t){return this.sendUncheckedTransaction(t).then(r=>({hash:r,nonce:null,gasLimit:null,gasPrice:null,data:null,value:null,chainId:null,confirmations:0,from:null,wait:i=>this.provider.waitForTransaction(r,i)}))}}const yte={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0,type:!0,accessList:!0,maxFeePerGas:!0,maxPriorityFeePerGas:!0};class xte extends pte{constructor(t,r){let i=r;i==null&&(i=new Promise((n,s)=>{setTimeout(()=>{this.detectNetwork().then(a=>{n(a)},a=>{s(a)})},0)})),super(i),t||(t=Ks(this.constructor,"defaultUrl")()),typeof t=="string"?Ae(this,"connection",Object.freeze({url:t})):Ae(this,"connection",Object.freeze(Xr(t))),this._nextId=42}get _cache(){return this._eventLoopCache==null&&(this._eventLoopCache={}),this._eventLoopCache}static defaultUrl(){return"http://localhost:8545"}detectNetwork(){return this._cache.detectNetwork||(this._cache.detectNetwork=this._uncachedDetectNetwork(),setTimeout(()=>{this._cache.detectNetwork=null},0)),this._cache.detectNetwork}_uncachedDetectNetwork(){return Oa(this,void 0,void 0,function*(){yield i3(0);let t=null;try{t=yield this.send("eth_chainId",[])}catch{try{t=yield this.send("net_version",[])}catch{}}if(t!=null){const r=Ks(this.constructor,"getNetwork");try{return r(Te.from(t).toNumber())}catch(i){return fi.throwError("could not detect network",ae.errors.NETWORK_ERROR,{chainId:t,event:"invalidNetwork",serverError:i})}}return fi.throwError("could not detect network",ae.errors.NETWORK_ERROR,{event:"noNetwork"})})}getSigner(t){return new m4(Rx,this,t)}getUncheckedSigner(t){return this.getSigner(t).connectUnchecked()}listAccounts(){return this.send("eth_accounts",[]).then(t=>t.map(r=>this.formatter.address(r)))}send(t,r){const i={method:t,params:r,id:this._nextId++,jsonrpc:"2.0"};this.emit("debug",{action:"request",request:$a(i),provider:this});const n=["eth_chainId","eth_blockNumber"].indexOf(t)>=0;if(n&&this._cache[t])return this._cache[t];const s=Qb(this.connection,JSON.stringify(i),gte).then(a=>(this.emit("debug",{action:"response",request:i,response:a,provider:this}),a),a=>{throw this.emit("debug",{action:"response",error:a,request:i,provider:this}),a});return n&&(this._cache[t]=s,setTimeout(()=>{this._cache[t]=null},0)),s}prepareRequest(t,r){switch(t){case"getBlockNumber":return["eth_blockNumber",[]];case"getGasPrice":return["eth_gasPrice",[]];case"getBalance":return["eth_getBalance",[Sc(r.address),r.blockTag]];case"getTransactionCount":return["eth_getTransactionCount",[Sc(r.address),r.blockTag]];case"getCode":return["eth_getCode",[Sc(r.address),r.blockTag]];case"getStorageAt":return["eth_getStorageAt",[Sc(r.address),ar(r.position,32),r.blockTag]];case"sendTransaction":return["eth_sendRawTransaction",[r.signedTransaction]];case"getBlock":return r.blockTag?["eth_getBlockByNumber",[r.blockTag,!!r.includeTransactions]]:r.blockHash?["eth_getBlockByHash",[r.blockHash,!!r.includeTransactions]]:null;case"getTransaction":return["eth_getTransactionByHash",[r.transactionHash]];case"getTransactionReceipt":return["eth_getTransactionReceipt",[r.transactionHash]];case"call":{const i=Ks(this.constructor,"hexlifyTransaction");return["eth_call",[i(r.transaction,{from:!0}),r.blockTag]]}case"estimateGas":{const i=Ks(this.constructor,"hexlifyTransaction");return["eth_estimateGas",[i(r.transaction,{from:!0})]]}case"getLogs":return r.filter&&r.filter.address!=null&&(r.filter.address=Sc(r.filter.address)),["eth_getLogs",[r.filter]]}return null}perform(t,r){return Oa(this,void 0,void 0,function*(){if(t==="call"||t==="estimateGas"){const n=r.transaction;if(n&&n.type!=null&&Te.from(n.type).isZero()&&n.maxFeePerGas==null&&n.maxPriorityFeePerGas==null){const s=yield this.getFeeData();s.maxFeePerGas==null&&s.maxPriorityFeePerGas==null&&(r=Xr(r),r.transaction=Xr(n),delete r.transaction.type)}}const i=this.prepareRequest(t,r);i==null&&fi.throwError(t+" not implemented",ae.errors.NOT_IMPLEMENTED,{operation:t});try{return yield this.send(i[0],i[1])}catch(n){return p4(t,n,r)}})}_startEvent(t){t.tag==="pending"&&this._startPending(),super._startEvent(t)}_startPending(){if(this._pendingFilter!=null)return;const t=this,r=this.send("eth_newPendingTransactionFilter",[]);this._pendingFilter=r,r.then(function(i){function n(){t.send("eth_getFilterChanges",[i]).then(function(s){if(t._pendingFilter!=r)return null;let a=Promise.resolve();return s.forEach(function(o){t._emitted["t:"+o.toLowerCase()]="pending",a=a.then(function(){return t.getTransaction(o).then(function(l){return t.emit("pending",l),null})})}),a.then(function(){return i3(1e3)})}).then(function(){if(t._pendingFilter!=r){t.send("eth_uninstallFilter",[i]);return}return setTimeout(function(){n()},0),null}).catch(s=>{})}return n(),i}).catch(i=>{})}_stopEvent(t){t.tag==="pending"&&this.listenerCount("pending")===0&&(this._pendingFilter=null),super._stopEvent(t)}static hexlifyTransaction(t,r){const i=Xr(yte);if(r)for(const s in r)r[s]&&(i[s]=!0);TK(t,i);const n={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(function(s){if(t[s]==null)return;const a=kb(Te.from(t[s]));s==="gasLimit"&&(s="gas"),n[s]=a}),["from","to","data"].forEach(function(s){t[s]!=null&&(n[s]=tt(t[s]))}),t.accessList&&(n.accessList=Ku(t.accessList)),n}}const n3=new ae(ig);let wte=1;function s3(e,t){const r="Web3LegacyFetcher";return function(i,n){const s={method:i,params:n,id:wte++,jsonrpc:"2.0"};return new Promise((a,o)=>{this.emit("debug",{action:"request",fetcher:r,request:$a(s),provider:this}),t(s,(l,h)=>{if(l)return this.emit("debug",{action:"response",fetcher:r,error:l,request:s,provider:this}),o(l);if(this.emit("debug",{action:"response",fetcher:r,request:s,response:h,provider:this}),h.error){const u=new Error(h.error.message);return u.code=h.error.code,u.data=h.error.data,o(u)}a(h.result)})})}}function bte(e){return function(t,r){r==null&&(r=[]);const i={method:t,params:r};return this.emit("debug",{action:"request",fetcher:"Eip1193Fetcher",request:$a(i),provider:this}),e.request(i).then(n=>(this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:i,response:n,provider:this}),n),n=>{throw this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:i,error:n,provider:this}),n})}}class _te extends xte{constructor(t,r){t==null&&n3.throwArgumentError("missing provider","provider",t);let i=null,n=null,s=null;typeof t=="function"?(i="unknown:",n=t):(i=t.host||t.path||"",!i&&t.isMetaMask&&(i="metamask"),s=t,t.request?(i===""&&(i="eip-1193:"),n=bte(t)):t.sendAsync?n=s3(t,t.sendAsync.bind(t)):t.send?n=s3(t,t.send.bind(t)):n3.throwArgumentError("unsupported provider","provider",t),i||(i="unknown:")),super(i,r),Ae(this,"jsonRpcFetchFunc",n),Ae(this,"provider",s)}send(t,r){return this.jsonRpcFetchFunc(t,r)}}const Ste="units/5.6.1",Mte=new ae(Ste),Ate=["wei","kwei","mwei","gwei","szabo","finney","ether"];function Ete(e,t){if(typeof e!="string"&&Mte.throwArgumentError("value must be a string","value",e),typeof t=="string"){const r=Ate.indexOf(t);r!==-1&&(t=3*r)}return Ds(e,t!=null?t:18)}function Cte(e){return Ete(e,18)}const Tte="hh-sol-artifact-1",Dte="Transactions",Pte="contracts/Transactions.sol",Lte=[{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"from",type:"address"},{indexed:!1,internalType:"address",name:"receiver",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"string",name:"message",type:"string"},{indexed:!1,internalType:"uint256",name:"timestamp",type:"uint256"},{indexed:!1,internalType:"string",name:"keyword",type:"string"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address payable",name:"receiver",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"string",name:"message",type:"string"},{internalType:"string",name:"keyword",type:"string"}],name:"addToBlockchain",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"getAllTransactions",outputs:[{components:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"receiver",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"string",name:"message",type:"string"},{internalType:"uint256",name:"timestamp",type:"uint256"},{internalType:"string",name:"keyword",type:"string"}],internalType:"struct Transactions.TransferStructure[]",name:"",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTransactionCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"}],Rte="0x608060405234801561001057600080fd5b50610c0d806100206000396000f3fe608060405234801561001057600080fd5b50600436106100415760003560e01c806327506f53146100465780632e7700f014610064578063cc2d7ead14610082575b600080fd5b61004e61009e565b60405161005b91906108b9565b60405180910390f35b61006c6102e1565b60405161007991906108db565b60405180910390f35b61009c600480360381019061009791906105e1565b6102ea565b005b60606001805480602002602001604051908101604052809291908181526020016000905b828210156102d857838290600052602060002090600602016040518060c00160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020016001820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600282015481526020016003820180546101ab90610ad9565b80601f01602080910402602001604051908101604052809291908181526020018280546101d790610ad9565b80156102245780601f106101f957610100808354040283529160200191610224565b820191906000526020600020905b81548152906001019060200180831161020757829003601f168201915b505050505081526020016004820154815260200160058201805461024790610ad9565b80601f016020809104026020016040519081016040528092919081815260200182805461027390610ad9565b80156102c05780601f10610295576101008083540402835291602001916102c0565b820191906000526020600020905b8154815290600101906020018083116102a357829003601f168201915b505050505081525050815260200190600101906100c2565b50505050905090565b60008054905090565b60016000808282546102fc91906109bd565b9250508190555060016040518060c001604052803373ffffffffffffffffffffffffffffffffffffffff1681526020018673ffffffffffffffffffffffffffffffffffffffff16815260200185815260200184815260200142815260200183815250908060018154018082558091505060019003906000526020600020906006020160009091909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060408201518160020155606082015181600301908051906020019061043b9291906104ac565b506080820151816004015560a08201518160050190805190602001906104629291906104ac565b5050507f416cfa4330a4565f45c2fd2dd4826a83a37443aba2ce6f79477c7355afac35fa33858585428660405161049e9695949392919061084a565b60405180910390a150505050565b8280546104b890610ad9565b90600052602060002090601f0160209004810192826104da5760008555610521565b82601f106104f357805160ff1916838001178555610521565b82800160010185558215610521579182015b82811115610520578251825591602001919060010190610505565b5b50905061052e9190610532565b5090565b5b8082111561054b576000816000905550600101610533565b5090565b600061056261055d84610927565b6108f6565b90508281526020810184848401111561057a57600080fd5b610585848285610a97565b509392505050565b60008135905061059c81610ba9565b92915050565b600082601f8301126105b357600080fd5b81356105c384826020860161054f565b91505092915050565b6000813590506105db81610bc0565b92915050565b600080600080608085870312156105f757600080fd5b60006106058782880161058d565b9450506020610616878288016105cc565b935050604085013567ffffffffffffffff81111561063357600080fd5b61063f878288016105a2565b925050606085013567ffffffffffffffff81111561065c57600080fd5b610668878288016105a2565b91505092959194509250565b6000610680838361079c565b905092915050565b61069181610a61565b82525050565b6106a081610a13565b82525050565b6106af81610a13565b82525050565b60006106c082610967565b6106ca818561098a565b9350836020820285016106dc85610957565b8060005b8581101561071857848403895281516106f98582610674565b94506107048361097d565b925060208a019950506001810190506106e0565b50829750879550505050505092915050565b600061073582610972565b61073f818561099b565b935061074f818560208601610aa6565b61075881610b98565b840191505092915050565b600061076e82610972565b61077881856109ac565b9350610788818560208601610aa6565b61079181610b98565b840191505092915050565b600060c0830160008301516107b46000860182610697565b5060208301516107c76020860182610697565b5060408301516107da604086018261082c565b50606083015184820360608601526107f2828261072a565b9150506080830151610807608086018261082c565b5060a083015184820360a086015261081f828261072a565b9150508091505092915050565b61083581610a57565b82525050565b61084481610a57565b82525050565b600060c08201905061085f60008301896106a6565b61086c6020830188610688565b610879604083018761083b565b818103606083015261088b8186610763565b905061089a608083018561083b565b81810360a08301526108ac8184610763565b9050979650505050505050565b600060208201905081810360008301526108d381846106b5565b905092915050565b60006020820190506108f0600083018461083b565b92915050565b6000604051905081810181811067ffffffffffffffff8211171561091d5761091c610b69565b5b8060405250919050565b600067ffffffffffffffff82111561094257610941610b69565b5b601f19601f8301169050602081019050919050565b6000819050602082019050919050565b600081519050919050565b600081519050919050565b6000602082019050919050565b600082825260208201905092915050565b600082825260208201905092915050565b600082825260208201905092915050565b60006109c882610a57565b91506109d383610a57565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff03821115610a0857610a07610b0b565b5b828201905092915050565b6000610a1e82610a37565b9050919050565b6000610a3082610a37565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b6000610a6c82610a73565b9050919050565b6000610a7e82610a85565b9050919050565b6000610a9082610a37565b9050919050565b82818337600083830152505050565b60005b83811015610ac4578082015181840152602081019050610aa9565b83811115610ad3576000848401525b50505050565b60006002820490506001821680610af157607f821691505b60208210811415610b0557610b04610b3a565b5b50919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6000601f19601f8301169050919050565b610bb281610a25565b8114610bbd57600080fd5b50565b610bc981610a57565b8114610bd457600080fd5b5056fea2646970667358221220229e3d17a2257e8af1d8a4bf4de60152f6e1bc95ffaa592e77bd9c7b83226e1064736f6c63430008000033",Ote="0x608060405234801561001057600080fd5b50600436106100415760003560e01c806327506f53146100465780632e7700f014610064578063cc2d7ead14610082575b600080fd5b61004e61009e565b60405161005b91906108b9565b60405180910390f35b61006c6102e1565b60405161007991906108db565b60405180910390f35b61009c600480360381019061009791906105e1565b6102ea565b005b60606001805480602002602001604051908101604052809291908181526020016000905b828210156102d857838290600052602060002090600602016040518060c00160405290816000820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020016001820160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001600282015481526020016003820180546101ab90610ad9565b80601f01602080910402602001604051908101604052809291908181526020018280546101d790610ad9565b80156102245780601f106101f957610100808354040283529160200191610224565b820191906000526020600020905b81548152906001019060200180831161020757829003601f168201915b505050505081526020016004820154815260200160058201805461024790610ad9565b80601f016020809104026020016040519081016040528092919081815260200182805461027390610ad9565b80156102c05780601f10610295576101008083540402835291602001916102c0565b820191906000526020600020905b8154815290600101906020018083116102a357829003601f168201915b505050505081525050815260200190600101906100c2565b50505050905090565b60008054905090565b60016000808282546102fc91906109bd565b9250508190555060016040518060c001604052803373ffffffffffffffffffffffffffffffffffffffff1681526020018673ffffffffffffffffffffffffffffffffffffffff16815260200185815260200184815260200142815260200183815250908060018154018082558091505060019003906000526020600020906006020160009091909190915060008201518160000160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555060408201518160020155606082015181600301908051906020019061043b9291906104ac565b506080820151816004015560a08201518160050190805190602001906104629291906104ac565b5050507f416cfa4330a4565f45c2fd2dd4826a83a37443aba2ce6f79477c7355afac35fa33858585428660405161049e9695949392919061084a565b60405180910390a150505050565b8280546104b890610ad9565b90600052602060002090601f0160209004810192826104da5760008555610521565b82601f106104f357805160ff1916838001178555610521565b82800160010185558215610521579182015b82811115610520578251825591602001919060010190610505565b5b50905061052e9190610532565b5090565b5b8082111561054b576000816000905550600101610533565b5090565b600061056261055d84610927565b6108f6565b90508281526020810184848401111561057a57600080fd5b610585848285610a97565b509392505050565b60008135905061059c81610ba9565b92915050565b600082601f8301126105b357600080fd5b81356105c384826020860161054f565b91505092915050565b6000813590506105db81610bc0565b92915050565b600080600080608085870312156105f757600080fd5b60006106058782880161058d565b9450506020610616878288016105cc565b935050604085013567ffffffffffffffff81111561063357600080fd5b61063f878288016105a2565b925050606085013567ffffffffffffffff81111561065c57600080fd5b610668878288016105a2565b91505092959194509250565b6000610680838361079c565b905092915050565b61069181610a61565b82525050565b6106a081610a13565b82525050565b6106af81610a13565b82525050565b60006106c082610967565b6106ca818561098a565b9350836020820285016106dc85610957565b8060005b8581101561071857848403895281516106f98582610674565b94506107048361097d565b925060208a019950506001810190506106e0565b50829750879550505050505092915050565b600061073582610972565b61073f818561099b565b935061074f818560208601610aa6565b61075881610b98565b840191505092915050565b600061076e82610972565b61077881856109ac565b9350610788818560208601610aa6565b61079181610b98565b840191505092915050565b600060c0830160008301516107b46000860182610697565b5060208301516107c76020860182610697565b5060408301516107da604086018261082c565b50606083015184820360608601526107f2828261072a565b9150506080830151610807608086018261082c565b5060a083015184820360a086015261081f828261072a565b9150508091505092915050565b61083581610a57565b82525050565b61084481610a57565b82525050565b600060c08201905061085f60008301896106a6565b61086c6020830188610688565b610879604083018761083b565b818103606083015261088b8186610763565b905061089a608083018561083b565b81810360a08301526108ac8184610763565b9050979650505050505050565b600060208201905081810360008301526108d381846106b5565b905092915050565b60006020820190506108f0600083018461083b565b92915050565b6000604051905081810181811067ffffffffffffffff8211171561091d5761091c610b69565b5b8060405250919050565b600067ffffffffffffffff82111561094257610941610b69565b5b601f19601f8301169050602081019050919050565b6000819050602082019050919050565b600081519050919050565b600081519050919050565b6000602082019050919050565b600082825260208201905092915050565b600082825260208201905092915050565b600082825260208201905092915050565b60006109c882610a57565b91506109d383610a57565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff03821115610a0857610a07610b0b565b5b828201905092915050565b6000610a1e82610a37565b9050919050565b6000610a3082610a37565b9050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b6000610a6c82610a73565b9050919050565b6000610a7e82610a85565b9050919050565b6000610a9082610a37565b9050919050565b82818337600083830152505050565b60005b83811015610ac4578082015181840152602081019050610aa9565b83811115610ad3576000848401525b50505050565b60006002820490506001821680610af157607f821691505b60208210811415610b0557610b04610b3a565b5b50919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6000601f19601f8301169050919050565b610bb281610a25565b8114610bbd57600080fd5b50565b610bc981610a57565b8114610bd457600080fd5b5056fea2646970667358221220229e3d17a2257e8af1d8a4bf4de60152f6e1bc95ffaa592e77bd9c7b83226e1064736f6c63430008000033",Ite={},Nte={};var Bte={_format:Tte,contractName:Dte,sourceName:Pte,abi:Lte,bytecode:Rte,deployedBytecode:Ote,linkReferences:Ite,deployedLinkReferences:Nte};const kte="0xfB55766Ef0E1CAfcaB5169775BD507E0c0A0df55",zte=Bte.abi,Jb=Zs.createContext(),{ethereum:Da}=window,p1=()=>{const t=new _te(Da).getSigner();return new Vee(kte,zte,t)},Fte=({children:e})=>{const[t,r]=Yr.exports.useState({addressTo:"",amount:"",keyword:"",message:""}),[i,n]=Yr.exports.useState(""),[s,a]=Yr.exports.useState(!1),[o,l]=Yr.exports.useState(localStorage.getItem("transactionCount")),[h,u]=Yr.exports.useState([]),c=(v,x)=>{r(b=>qe(me({},b),{[x]:v.target.value}))},d=async()=>{try{if(Da){const b=(await p1().getAllTransactions()).map(_=>({addressTo:_.receiver,addressFrom:_.sender,timestamp:new Date(_.timestamp.toNumber()*1e3).toLocaleString(),message:_.message,keyword:_.keyword,amount:parseInt(_.amount._hex)/10**18}));console.log(b),u(b)}else console.log("Ethereum is not present")}catch(v){console.log(v)}},f=async()=>{try{if(!Da)return alert("Please connect MetaMask.");const v=await Da.request({method:"eth_accounts"});v.length?(n(v[0]),d()):console.log("No accounts found")}catch(v){console.log(v)}},p=async()=>{try{if(Da){const x=await p1().getTransactionCount();window.localStorage.setItem("transactionCount",x)}}catch(v){throw console.log(v),new Error("No ethereum object")}},m=async()=>{try{if(!Da)return alert("Please install MetaMask.");const v=await Da.request({method:"eth_requestAccounts"});n(v[0]),window.location.reload()}catch(v){throw console.log(v),new Error("No ethereum object")}},g=async()=>{try{if(Da){const{addressTo:v,amount:x,keyword:b,message:_}=t,E=p1(),S=Cte(x);await Da.request({method:"eth_sendTransaction",params:[{from:i,to:v,gas:"0x5208",value:S._hex}]});const P=await E.addToBlockchain(v,S,_,b);a(!0),console.log(`Loading - ${P.hash}`),await P.wait(),console.log(`Success - ${P.hash}`),a(!1);const M=await E.getTransactionCount();l(M.toNumber()),window.location.reload()}else console.log("No ethereum object")}catch(v){throw console.log(v),new Error("No ethereum object")}};return Yr.exports.useEffect(()=>{f(),p()},[o]),nt(Jb.Provider,{value:{transactionCount:o,connectWallet:m,transactions:h,currentAccount:i,isLoading:s,sendTransaction:g,handleChange:c,formData:t},children:e})},Ox=e=>`${e.slice(0,5)}...${e.slice(e.length-4)}`,Cp=({placeholder:e,name:t,type:r,value:i,handleChange:n})=>nt("input",{placeholder:e,type:r,step:"0.0001",value:i,onChange:s=>n(s,t),className:"my-2 w-full rounded-xm p-2 outline-none rounded-full text-[#444444] border-[1px] border-white  text-sm  placeholder:text-white bg-transparent"}),Ute=()=>{const{currentAccount:e,connectWallet:t,handleChange:r,sendTransaction:i,formData:n,isLoading:s}=Yr.exports.useContext(Jb),a=o=>{const{addressTo:l,amount:h,keyword:u,message:c}=n;o.preventDefault(),!(!l||!h||!u||!c)&&i()};return Dr("div",{className:"flex w-full justify-center items-center",children:[nt(dK,{}),Dr("div",{className:"mt-80 flex-wrap flex mf:flex-row flex-col justify-center items-center justify-between md:p-20 py-12 px-4",children:[Dr("div",{className:"flex flex-1 items-center flex-col mf:mr-10",children:[Dr("h1",{className:"text-4xl sm:text-7xl text-gradient py-1 tracking-wide font-bold",children:["mAilmetA ",nt("br",{})]}),nt("p",{className:"sm:text-2xl text-center mt-5 text-[#6c3a1a] font-semibold md:w-9/12 w-11/12 text-base",children:"Check and send messages attached to your Ethereum transacctions."}),!e&&nt("button",{type:"button",onClick:t,className:"z-10 flex flex-row justify-center items-center my-5 p-3 rounded-full drop-shadow text-[#444444] font-bold mt-2 border-[1px] p-2 border-white hover:bg-[#e7d5ec] hover:drop-shadow-lg",children:nt("p",{className:"text-base font-semibold",children:"Connect Wallet"})})]}),Dr("div",{className:"flex flex-col flex-1 items-center justify-start w-11/12 mf:mt-0 mt-10",children:[nt("div",{className:"p-3 flex justify-end items-start flex-col rounded-xl h-40 sm:w-72 w-full my-5 eth-card .white-glassmorphism ",children:Dr("div",{className:"flex justify-between flex-col w-full h-full",children:[Dr("div",{className:"flex justify-between items-start items-center ",children:[nt("div",{className:"w-20 h-20 rounded-full border-2 border-white flex justify-center items-center",children:nt(vK,{fontSize:90,color:"#444444"})}),nt("p",{className:"text-white text-right font-semibold text-2xl sm:text-4xl mt-1 z-10",children:"Use Ropsten TestNet"})]}),nt("div",{className:"m-auto",children:nt("p",{className:"text-white font-light text-4xl",children:Ox(e)})})]})}),Dr("div",{className:"p-5 sm:w-96 w-full flex flex-col justify-start items-center white-glassmorphism",children:[nt(Cp,{placeholder:"Send to",name:"addressTo",type:"text",handleChange:r}),nt(Cp,{placeholder:"Amount of ETH",name:"amount",type:"number",handleChange:r}),nt(Cp,{placeholder:"Subject (GIF Keyword)",name:"keyword",type:"text",handleChange:r}),nt(Cp,{placeholder:"Enter Message",name:"message",type:"text",handleChange:r}),nt("div",{className:"h-[1px] w-full bg-[#999999] my-2"}),s?nt(fK,{}):nt("button",{type:"button",onClick:a,className:"drop-shadow font-bold w-full mt-2 border-[1px] p-2 border-white hover:bg-[#e7d5ec] text-[#444444] hover:drop-shadow-lg rounded-full",children:"Send now"})]})]})]})]})},Hte=()=>Dr("div",{className:"w-full flex md:justify-center justify-between items-center flex-col p-4 gradient-bg-footer",children:[Dr("div",{className:"flex justify-center items-center flex-col mt-5",children:[nt("p",{className:"text-[#6c3a1a]  text-sm text-center",children:"Descentralize the world"}),nt("p",{className:"text-[#6c3a1a]  text-sm text-center font-medium mt-2",children:"info@davidwebdesigns.com"})]}),nt("div",{className:"sm:w-[90%] w-full h-[0.25px] bg-[#6c3a1a]  mt-5 "}),Dr("div",{className:"sm:w-[90%] w-full flex justify-between items-center mt-3",children:[nt("p",{className:"text-[#6c3a1a]  text-left text-xs",children:"@DavidWebDesigns 2022"}),nt("p",{className:"text-[#6c3a1a]  text-right text-xs",children:"All rights reserved"})]})]}),Gte="4MiPahqhpRyb4TQpc9kDX9973FOApEr4",Vte=({keyword:e})=>{const[t,r]=Yr.exports.useState(""),i=(s,a)=>Math.floor(Math.random()*(a-s))+s,n=async()=>{var s,a;try{const o=await fetch(`https://api.giphy.com/v1/gifs/search?api_key=${Gte}&q=${e.split(" ").join("")}&limit=6`),{data:l}=await o.json();console.log(l,"estadata"),r((a=(s=l[i(0,6)])==null?void 0:s.images)==null?void 0:a.downsized_medium.url)}catch{r("https://metro.co.uk/wp-content/uploads/2015/05/pokemon_crying.gif?quality=90&strip=all&zoom=1&resize=500%2C284")}};return Yr.exports.useEffect(()=>{e&&n()},[e]),t};var jte=[{id:1,url:"https://metro.co.uk/wp-content/uploads/2015/05/pokemon_crying.gif?quality=90&strip=all&zoom=1&resize=500%2C284",message:"",timestamp:"12/31/2020, 4:33:21 PM",addressFrom:"0xCF8e569A97C423952DdFf902375C7C76549A6A90",amount:"0.01",addressTo:"0x8aa395Ab97837576aF9cd6946C79024ef1acfdbE"},{id:2,url:"https://media4.popsugar-assets.com/files/2013/11/07/832/n/1922398/eb7a69a76543358d_28.gif",message:"",timestamp:"12/21/2021, 4:33:21 PM",addressFrom:"0xCF8e569A97C423952DdFf902375C7C76549A6A90",amount:"0.01",addressTo:"0x8aa395Ab97837576aF9cd6946C79024ef1acfdbE"},{id:3,url:"https://acegif.com/wp-content/uploads/gif-shaking-head-38.gif",message:"",timestamp:"12/21/2021, 4:33:21 PM",addressFrom:"0xCF8e569A97C423952DdFf902375C7C76549A6A90",amount:"0.01",addressTo:"0x8aa395Ab97837576aF9cd6946C79024ef1acfdbE"},{id:4,url:"https://i.pinimg.com/originals/68/a0/9e/68a09e774e98242871c2db0f99307420.gif",message:"",timestamp:"12/21/2021, 4:33:21 PM",addressFrom:"0xCF8e569A97C423952DdFf902375C7C76549A6A90",amount:"0.01",addressTo:"0x8aa395Ab97837576aF9cd6946C79024ef1acfdbE"},{id:5,url:"https://i.pinimg.com/originals/73/d3/a1/73d3a14d212314ab1f7268b71d639c15.gif",message:"",timestamp:"12/21/2021, 4:33:21 PM",addressFrom:"0xCF8e569A97C423952DdFf902375C7C76549A6A90",amount:"0.01",addressTo:"0x8aa395Ab97837576aF9cd6946C79024ef1acfdbE"},{id:6,url:"https://www.omnisend.com/blog/wp-content/uploads/2016/09/funny-gifs-9.gif",message:"",timestamp:"12/21/2021, 4:33:21 PM",addressFrom:"0xCF8e569A97C423952DdFf902375C7C76549A6A90",amount:"0.01",addressTo:"0x8aa395Ab97837576aF9cd6946C79024ef1acfdbE"}];const Wte=({addressTo:e,addressFrom:t,timestamp:r,message:i,keyword:n,amount:s,url:a})=>{const o=Vte({keyword:n});return nt("div",{className:"blue-glassmorphism m-4 flex flex-1 2xl:min-w-[450px] 2xl:min-h-[700px] 2xl:max-w-[500px] sm:min-w-[270px] sm:max-w-[300px] min-w-full flex-col p-3 rounded-md hover:shadow-2xl",children:Dr("div",{className:"flex flex-col m-auto items-center w-11/12 mt-3",children:[Dr("div",{className:"display-flex justify-start w-full mb-6 p-2",children:[nt("a",{href:`https://ropsten.etherscan.io/address/${t}`,target:"_blank",rel:"noreferrer",children:Dr("p",{className:"text-white text-base",children:[nt("b",{children:"From: "}),Ox(t)]})}),nt("a",{href:`https://ropsten.etherscan.io/address/${e}`,target:"_blank",rel:"noreferrer",children:Dr("p",{className:"text-white text-base",children:[nt("b",{children:"To: "}),Ox(e)]})}),Dr("p",{className:"text-white text-base",children:[nt("b",{children:"Amount: "}),s," ",nt("b",{children:"ETH"})]}),Dr("p",{className:"text-white text-base",children:[nt("b",{children:"Subject: "}),n]}),i&&nt(cK,{children:Dr("p",{className:"text-[#444444] font-bold text-base",children:[nt("b",{className:"text-white",children:"Message:"}),nt("br",{}),i]})})]}),nt("img",{src:o||a,alt:"nature",className:"w-11/12 h-56 2xl:h-56 rounded-md shadow-md object-cover border-[1px] border-white"}),nt("div",{className:"white-glassmorphism p-2 pt-3 w-6/12 rounded-3xl mt-2 text-center",children:nt("p",{className:"text-xs text-[#fff]",children:r})})]})})},qte=()=>{const{transactions:e,currentAccount:t}=Yr.exports.useContext(Jb);return nt("div",{className:"flex w-full justify-center items-center 2xl:px-20 gradient-bg-transactions",children:Dr("div",{className:"flex flex-col md:p-12 py-12 px-4",children:[t?nt("h3",{className:"text-[#444444] font-bold text-3xl text-center my-2",children:"Latest Transactions"}):nt("h3",{className:"text-[#444444] font-bold text-3xl text-center my-2",children:"Connect your account to see the latest transactions"}),nt("div",{className:"flex flex-wrap justify-center items-center mt-10",children:[...jte,...e].reverse().map((r,i)=>nt(Wte,me({},r),i))})]})})},Yte=()=>Dr("div",{className:"min-h-screen",children:[nt("div",{className:"gradient-bg-welcome",children:nt(Ute,{})}),nt(qte,{}),nt(Hte,{})]});m1.createRoot(document.getElementById("root")).render(nt(Fte,{children:nt(Zs.StrictMode,{children:nt(Yte,{})})}))});export default Xte();
